{
  "label": [
    {
      "id": 1371686610,
      "node_id": "MDU6TGFiZWwxMzcxNjg2NjEw",
      "url": "https://api.github.com/repos/bosens-China/blog/labels/css%20%E7%9B%B8%E5%85%B3",
      "name": "css ç›¸å…³",
      "color": "42b883",
      "default": false,
      "description": "css æŠ€å·§å’ŒåŸºç¡€ä¸ºä¸»"
    },
    {
      "id": 1908144759,
      "node_id": "MDU6TGFiZWwxOTA4MTQ0NzU5",
      "url": "https://api.github.com/repos/bosens-China/blog/labels/ES6%E7%B3%BB%E5%88%97",
      "name": "ES6ç³»åˆ—",
      "color": "0366d6",
      "default": false,
      "description": "ES6çš„æœ€æ–°è¯­æ³•"
    },
    {
      "id": 1371686609,
      "node_id": "MDU6TGFiZWwxMzcxNjg2NjA5",
      "url": "https://api.github.com/repos/bosens-China/blog/labels/JavaScript",
      "name": "JavaScript",
      "color": "F7DF1E",
      "default": false,
      "description": "JavaScriptç³»åˆ—çš„æ–‡ç« "
    },
    {
      "id": 3661377607,
      "node_id": "LA_kwDOCzPAy87aPDBH",
      "url": "https://api.github.com/repos/bosens-China/blog/labels/Node%E7%B3%BB%E5%88%97",
      "name": "Nodeç³»åˆ—",
      "color": "9F9262",
      "default": false,
      "description": "å’Œnode.jsç›¸å…³å†…å®¹"
    },
    {
      "id": 3041947800,
      "node_id": "MDU6TGFiZWwzMDQxOTQ3ODAw",
      "url": "https://api.github.com/repos/bosens-China/blog/labels/%E4%BB%A3%E7%A0%81%E4%BA%BA%E7%94%9F",
      "name": "ä»£ç äººç”Ÿ",
      "color": "7B17E3",
      "default": false,
      "description": "å’ŒæŠ€æœ¯æ— å…³ï¼Œäººç”Ÿçš„æ„Ÿæ‚Ÿ"
    },
    {
      "id": 3661376441,
      "node_id": "LA_kwDOCzPAy87aPCu5",
      "url": "https://api.github.com/repos/bosens-China/blog/labels/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83",
      "name": "ä»£ç è§„èŒƒ",
      "color": "5319e7",
      "default": false,
      "description": "å›¢é˜Ÿè§„èŒƒã€ä»£ç è§„èŒƒã€æŠ€æœ¯é€‰å‹ç­‰ç›¸å…³å†…å®¹"
    },
    {
      "id": 1371686611,
      "node_id": "MDU6TGFiZWwxMzcxNjg2NjEx",
      "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%85%B6%E4%BB%96",
      "name": "å…¶ä»–",
      "color": "f6ecbf",
      "default": false,
      "description": "æœªæ‰¾åˆ°åˆ†ç±»ï¼Œæš‚å®šçš„æ–‡ç« "
    },
    {
      "id": 1580833992,
      "node_id": "MDU6TGFiZWwxNTgwODMzOTky",
      "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%AE%9E%E9%AA%8C%E6%80%A7%20API",
      "name": "å®éªŒæ€§ API",
      "color": "7aa9d6",
      "default": false,
      "description": "è¿˜æœªå®šç¨¿çš„API"
    },
    {
      "id": 1740577858,
      "node_id": "MDU6TGFiZWwxNzQwNTc3ODU4",
      "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3",
      "name": "å·¥å…·ç›¸å…³",
      "color": "f73d62",
      "default": false,
      "description": "å·¥ç¨‹åŒ–ç›¸å…³çš„ä¸œè¥¿"
    },
    {
      "id": 1935755992,
      "node_id": "MDU6TGFiZWwxOTM1NzU1OTky",
      "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%BE%85%E5%AE%8C%E6%88%90%E7%B3%BB%E5%88%97",
      "name": "å¾…å®Œæˆç³»åˆ—",
      "color": "cc6e43",
      "default": false,
      "description": "ç­‰å¾…å®Œæˆçš„æ–‡ç« ..."
    },
    {
      "id": 1473940161,
      "node_id": "MDU6TGFiZWwxNDczOTQwMTYx",
      "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3",
      "name": "æ¡†æ¶ç›¸å…³",
      "color": "42b883",
      "default": false,
      "description": "ç›®å‰Vueå’ŒReactä¸ºä¸»"
    },
    {
      "id": 1602397157,
      "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
      "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
      "name": "æ·±å…¥ç³»åˆ—",
      "color": "719192",
      "default": false,
      "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
    },
    {
      "id": 1371686608,
      "node_id": "MDU6TGFiZWwxMzcxNjg2NjA4",
      "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%BC%AB%E8%B0%88%E7%B3%BB%E5%88%97",
      "name": "æ¼«è°ˆç³»åˆ—",
      "color": "e7f3ee",
      "default": false,
      "description": "æµ…è°ˆç±»æ–‡ç« "
    },
    {
      "id": 1740561541,
      "node_id": "MDU6TGFiZWwxNzQwNTYxNTQx",
      "url": "https://api.github.com/repos/bosens-China/blog/labels/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F",
      "name": "è®¾è®¡æ¨¡å¼",
      "color": "d1a540",
      "default": false,
      "description": "è®¾è®¡æ¨¡å¼åœ¨JavaScriptçš„å®ç°"
    }
  ],
  "issuesData": [
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/100",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/100/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/100/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/100/events",
      "html_url": "https://github.com/bosens-China/blog/issues/100",
      "id": 1955954444,
      "node_id": "I_kwDOCzPAy850lX8M",
      "number": 100,
      "title": "resso æºç è§£æ",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1473940161,
          "node_id": "MDU6TGFiZWwxNDczOTQwMTYx",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3",
          "name": "æ¡†æ¶ç›¸å…³",
          "color": "42b883",
          "default": false,
          "description": "ç›®å‰Vueå’ŒReactä¸ºä¸»"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2023-10-22T15:57:10Z",
      "updated_at": "2023-10-22T15:57:25Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "åœ¨ä¹‹å‰ç”¨ React å†™ä¸€äº›å°é¡¹ç›®çš„æ—¶å€™æœ‰æ—¶ä¹Ÿéœ€è¦ç”¨åˆ°çŠ¶æ€ç®¡ç†ï¼Œä½†æ˜¯ç”¨ Redux æœ‰ä¸€ç§â€œå¤§æå°ç”¨â€æ„Ÿè§‰ï¼Œå°±åœ¨å¯»æ‰¾æœ‰æ²¡æœ‰å¾ˆç²¾å·§çš„å®ç°ï¼Œæœ€å¥½æ˜¯å“åº”å¼çš„ï¼Œæœ€åæœç´¢äº†ä¸€ç•ªåœ¨ Github å‘ç°äº†ä¸¤ä¸ªæ»¡è¶³æˆ‘éœ€æ±‚çš„åº“ï¼š\r\n\r\n- [valtio](https://github.com/pmndrs/valtio)\r\n- [resso](https://github.com/nanxiaobei/resso)\r\n\r\n```jsx\r\n// valtio\r\nimport resso from 'resso';\r\nimport { proxy, useSnapshot } from 'valtio';\r\n\r\nconst state = proxy({ count: 0, text: 'hello' });\r\n\r\nfunction Counter() {\r\n  const snap = useSnapshot(state);\r\n  return (\r\n    <div>\r\n      {snap.count}\r\n      <button onClick={() => ++state.count}>+1</button>\r\n    </div>\r\n  );\r\n}\r\n// resso\r\nconst store = resso({ count: 0, text: 'hello' });\r\n\r\nfunction App() {\r\n  const { count } = store; // data used in UI â†’ must destructure at top first ğŸ¥·\r\n  return (\r\n    <>\r\n      {count}\r\n      <button onClick={() => (store.count += 1)}>+</button>\r\n    </>\r\n  );\r\n}\r\n```\r\n\r\nç»“åˆå®˜æ–¹ç»™å‡ºçš„æ–‡æ¡£ç¤ºä¾‹è¿˜æ˜¯æœ€ç»ˆåœ¨é¡¹ç›®ç”¨äº† ressoï¼Œæ‰€ä»¥å°±æœ‰äº†è¿™ç¯‡æ–‡ç« ï¼ŒåŒæ—¶ä½œè€…åœ¨çŸ¥ä¹ä¹Ÿä¸“é—¨å†™äº†ä¸€ç¯‡æ–‡ç« ä»‹ç»ä»–çš„æ€è·¯å®ç°[ressoï¼Œä¸–ç•Œä¸Šæœ€ç®€å•çš„ React çŠ¶æ€ç®¡ç†å™¨](https://zhuanlan.zhihu.com/p/468417292)ã€‚æœ‰å…´è¶£å°ä¼™ä¼´å¯ä»¥ä¸“é—¨å»ç…ç…ã€‚\r\n\r\nä¸è¿‡åœ¨é˜…è¯»æºç å®ç°ï¼Œéœ€è¦å…ˆäº†è§£ä¸¤ä¸ª APIï¼š\r\n\r\n- useSyncExternalStore\r\n- ReactDOM.unstable_batchedUpdates\r\n\r\n## useSyncExternalStore\r\n\r\nè¿™ä¸ª API å¯èƒ½ä½ å®Œå…¨é™Œç”Ÿï¼Œäº‹å®ä¸Šæˆ‘ä¹Ÿæ˜¯ï¼Œåé¢ä¸“é—¨å»å®˜æ–¹æ–‡æ¡£æŸ¥é˜…äº†ä¸€ä¸‹ [useSyncExternalStore](https://zh-hans.react.dev/reference/react/useSyncExternalStore)ï¼Œå®ƒçš„ä½œç”¨å¯ä»¥ç®€å•ç†è§£ä¸ºè®¢é˜…å¤–éƒ¨çš„ storeï¼Œä¾‹å¦‚æˆ‘ä»¬åœ¨ä½¿ç”¨ redux ä¹‹ç±»çš„æ—¶å€™ï¼Œå®ƒå¯èƒ½ä¸æ˜¯é€šè¿‡ useState çš„å½¢å¼è€Œæ˜¯åœ¨å¤–éƒ¨ç»´æŠ¤äº†ä¸€ä¸ª storeï¼Œç„¶åç»“åˆå‘å¸ƒè®¢é˜…æ¨¡å¼æ¥å®ç°æ•°æ®çš„æ›´æ–°ã€‚\r\n\r\nä¸‹é¢ç”¨å®˜æ–¹ç»™å‡ºçš„åˆ‡æ¢ç¦»çº¿å’Œåœ¨çº¿ hooks ä¾‹å­å¿«é€Ÿçœ‹ä¸‹è¿™ä¸ª api\r\n\r\n```js\r\nimport { useSyncExternalStore } from 'react';\r\n\r\nfunction getSnapshot() {\r\n  return navigator.onLine;\r\n}\r\nfunction subscribe(callback) {\r\n  window.addEventListener('online', callback);\r\n  window.addEventListener('offline', callback);\r\n  return () => {\r\n    window.removeEventListener('online', callback);\r\n    window.removeEventListener('offline', callback);\r\n  };\r\n}\r\n\r\nfunction ChatIndicator() {\r\n  const isOnline = useSyncExternalStore(subscribe, getSnapshot);\r\n  // ...\r\n}\r\n```\r\n\r\nè¿™é‡Œæ¯æ¬¡ online æˆ–è€… offline å‘ç”Ÿå˜åŒ–æ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œè€Œæ¯æ¬¡æ‰§è¡Œ getSnapshot å¦‚æœè¿”å›å€¼ä¸åŒï¼Œå°±ä¼šè®© React é‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚\r\n\r\n> æ¯æ¬¡å¯¹æ¯” getSnapshot è¿”å›å€¼ä½¿ç”¨çš„æ˜¯ Object.isã€‚\r\n\r\n## unstable_batchedUpdates\r\n\r\nä¹‹æ‰€ä»¥ä»‹ç»è¿™ä¸ª API å…¶å®å’Œæ€§èƒ½ä¼˜åŒ–æœ‰å…³ï¼Œåœ¨ React18 ä¹‹å‰å¯¹äºéåŒæ­¥ä»£ç å’Œä¸æ˜¯ react äº‹ä»¶å¤„ç†å‡½æ•° setState ä¸ä¼šè¿›è¡Œæ‰¹å¤„ç†ï¼Œä¾‹å¦‚ä¸‹é¢ä»£ç ï¼š\r\n\r\n```js\r\nimport React, { useEffect, useState } from 'react';\r\n\r\nconst App: React.FC = () => {\r\n  console.log('Appç»„ä»¶æ¸²æŸ“äº†ï¼');\r\n  const [count1, setCount1] = useState(0);\r\n  const [count2, setCount2] = useState(0);\r\n  useEffect(() => {\r\n    document.body.addEventListener('click', () => {\r\n      setCount1((count) => count + 1);\r\n      setCount2((count) => count + 1);\r\n    });\r\n    // åœ¨åŸç”Ÿjsäº‹ä»¶ä¸­ä¸ä¼šè¿›è¡Œæ‰¹å¤„ç†\r\n  }, []);\r\n  return (\r\n    <>\r\n      <div>count1ï¼š {count1}</div>\r\n      <div>count2ï¼š {count2}</div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default App;\r\n```\r\n\r\nè¿™é‡Œæ¯æ¬¡ç‚¹å‡»ç»„ä»¶éƒ½ä¼šæ¸²æŸ“ä¸¤æ¬¡ï¼Œå…±è®¡è¾“å‡ºå…­æ¬¡ console.log ä¿¡æ¯ã€‚\r\n\r\nä½†æ˜¯æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥æ”¹å˜å‘¢ï¼Ÿä¸‹é¢ç”¨ ReactDOM.unstable_batchedUpdates é‡å†™ä¸Šé¢è¿™ä¸ªä¾‹å­\r\n\r\n```js\r\nimport React, { useEffect, useState } from 'react';\r\n\r\nconst App: React.FC = () => {\r\n  console.log('Appç»„ä»¶æ¸²æŸ“äº†ï¼');\r\n  const [count1, setCount1] = useState(0);\r\n  const [count2, setCount2] = useState(0);\r\n  useEffect(() => {\r\n    document.body.addEventListener('click', () => {\r\n      ReactDOM.unstable_batchedUpdates(() => {\r\n        setCount1((count) => count + 1);\r\n        setCount2((count) => count + 1);\r\n      });\r\n    });\r\n  }, []);\r\n  return (\r\n    <>\r\n      <div>count1ï¼š {count1}</div>\r\n      <div>count2ï¼š {count2}</div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default App;\r\n```\r\n\r\nè¿™æ ·å°±ä¼šæ¯æ¬¡æ›´æ–°çŠ¶æ€ç»„ä»¶åªæ¸²æŸ“ä¸€æ¬¡äº†ï¼Œæœ€åæç¤ºä¸€ä¸‹ **unstable_batchedUpdates æ˜¯åŒæ­¥ä»£ç **ã€‚\r\n\r\n## å®ç°æ€æƒ³\r\n\r\nåœ¨ä»£ç é˜…è¯»ä¹‹å‰æœ‰å¿…è¦è¯´ä¸‹å®ƒçš„è®¾è®¡å®ç°æ€æƒ³æ˜¯å•¥å­ã€‚\r\n\r\nåœ¨ä½¿ç”¨ redux çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ›´æ–°å¯èƒ½æ˜¯é€šè¿‡ `dispatch` è¿™æ ·çš„ä¸€ä¸ªå‡½æ•°æ¥å®Œæˆï¼Œä½†æ˜¯æœ‰æ²¡æœ‰å…¶ä»–æ–¹å¼å‘¢ï¼ŸES6 å¼•å…¥äº† proxy å¯ä»¥å¯¹å¯¹è±¡çš„å€¼è¿›è¡ŒåŠ«æŒï¼Œæ¯æ¬¡æ›´æ–°éƒ½å¯ä»¥è·å–åˆ°å¯¹åº”çš„ key å’Œ valueã€‚\r\n\r\n> äº‹å®ä¸Šåœ¨ Vue2 ä¸­ä¹Ÿå¯ä»¥é€šè¿‡ç›‘å¬å±æ€§çš„ seter æ¥å®ç°ç›‘å¬ï¼Œè™½ç„¶æ•ˆæœä¸å®Œæ•´ã€‚\r\n\r\nè¯•ç€å®šä¹‰ä¸€ä¸ª store\r\n\r\n```js\r\nexport const store = { a: 123, b: 456 };\r\n```\r\n\r\nåœ¨ç»„ä»¶ä¸­åˆ†åˆ«ä½¿ç”¨\r\n\r\n```js\r\n// ç»„ä»¶ A\r\nconst {a} = store;\r\n\r\n// ç»„ä»¶B\r\nconst {a,b} = store;\r\n```\r\n\r\næ›´æ–°æ–¹å¼ä¹Ÿå¾ˆç®€å•ï¼Œç›´æ¥æ›´æ”¹ store å±æ€§å°±è¡Œï¼Œä¾‹å¦‚ï¼š\r\n\r\n```js\r\n// ç»„ä»¶ A å’Œ B éƒ½å¾—åˆ°æ›´æ–°\r\nstore.b = 'b';\r\n```\r\n\r\né‚£ä¹ˆè¦æ€ä¹ˆå®ç°ä¸Šè¿°æˆ‘ä»¬å®šä¹‰çš„è¿™æ ·ä¸€ä¸ªä½¿ç”¨æ–¹å¼å‘¢ï¼Ÿ\r\n\r\nä½œè€…æ˜¯é€šè¿‡ proxy æ¯æ¬¡ get çš„æ—¶å€™è‡ªåŠ¨æŠŠå¯¹åº”çš„ key å€¼ä¿å­˜åˆ° map é”®åï¼Œè€Œå¯¹åº”çš„ setState ä½œä¸º valueï¼Œä¾‹å¦‚åœ¨ç»„ä»¶ A å’Œ B å®ƒä»¬å¯èƒ½æ˜¯è¿™æ ·å‚¨å­˜çš„ã€‚\r\n\r\n```js\r\n// ç»„ä»¶ A\r\nconst [a, setA] = useState(store.a);\r\n// ç»„ä»¶ B\r\nconst [a, setA] = useState(store.a);\r\nconst [b, setB] = useState(store.b);\r\n// map\r\nconst listenerMap = {\r\n  a: [setA, setA],\r\n  b: [setB],\r\n};\r\n\r\n```\r\n\r\nä¹‹åç›‘å¬ä¿®æ”¹çš„å±æ€§ï¼Œå¦‚æœæœ‰æ›´æ–°ç›´æ¥è°ƒç”¨å¯¹åº” key ä¸‹çš„ setState å°±å¯ä»¥åšåˆ°æ›´æ–°ã€‚\r\n``` js\r\n// å‡è®¾æ›´æ–° A\r\nlistenerMap.a.forEach((setA) => setA(store.a));\r\n```\r\n\r\n## æºç åˆ†æ\r\n\r\nä½œè€…æ˜¯é€šè¿‡ TypeScript æ¥å®ç°çš„ï¼Œä½†æ˜¯è¿™é‡Œå…³æ³¨å…·ä½“çš„å®ç°ï¼Œå¯¹äºç±»å‹ç›´æ¥åˆ é™¤äº†ï¼Œå¦‚æœæœ‰éœ€è¦å°ä¼™ä¼´å¯ä»¥è‡ªè¡Œå»é˜…è¯»ã€‚\r\n\r\nå› ä¸ºä»£ç é‡ä¸æ˜¯å¾ˆå¤§ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥é€šè¿‡è´´ä»£ç +æ³¨é‡Šçš„å½¢å¼æ¥è¿›è¡Œè®²è§£ã€‚\r\n\r\n```js\r\n// è¿™é‡Œå› ä¸ºæ˜¯çŠ¶æ€åº“ï¼Œéœ€è¦è€ƒè™‘ä¸åŒçš„ React ç‰ˆæœ¬ï¼ŒReact18 å¯ä»¥ç›´æ¥ import React æ¥è·å– useSyncExternalStore\r\nimport { useSyncExternalStore } from 'use-sync-external-store/shim';\r\n\r\n// åˆ¤æ–­æ˜¯å¦ä¸ºå¼€å‘ç¯å¢ƒ\r\nconst __DEV__ = process.env.NODE_ENV !== 'production';\r\n\r\n// åˆ¤æ–­æ˜¯å¦ä¸ºå¯¹è±¡ï¼Œ {} è¿™æ ·çš„ï¼Œé€šç”¨çš„ mapã€set ä¹‹ç±»çš„å¯¹è±¡éƒ½ç»Ÿç»Ÿä¸å¯ä»¥\r\nconst isObj = (val) => {\r\n  return Object.prototype.toString.call(val) === '[object Object]';\r\n};\r\n\r\n// è¿™é‡Œæ˜¯ä¸€ä¸ªæ ‡è¯†ç¬¦åé¢è®²è§£\r\nlet isGetStateInMethod = false;\r\n\r\nlet run = (fn) => {\r\n  fn();\r\n};\r\n\r\nconst resso = (obj) => {\r\n  // åˆå§‹æ£€æŸ¥\r\n  if (__DEV__ && !isObj(obj)) {\r\n    throw new Error('object required');\r\n  }\r\n\r\n  /*\r\n   * å®ƒå‚¨å­˜çš„å½¢å¼ä¸º {[key:string]: Set()}\r\n   */\r\n  const state = {};\r\n  /*\r\n   * å®ƒå‚¨å­˜çš„å½¢å¼ä¸º {key: Function}\r\n   */\r\n  const methods = {};\r\n\r\n  Object.keys(obj).forEach((key) => {\r\n    const initVal = obj[key];\r\n    // ç»™ methods æ·»åŠ å±æ€§\r\n    if (initVal instanceof Function) {\r\n      methods[key] = (...args) => {\r\n        isGetStateInMethod = true;\r\n        const res = initVal(...args);\r\n        isGetStateInMethod = false;\r\n        return res;\r\n      };\r\n      return;\r\n    }\r\n    // ç»™ state æ·»åŠ å±æ€§\r\n    const listeners = new Set();\r\n\r\n    state[key] = {\r\n      // æ·»åŠ  getSnapshot åˆ° listeners\r\n      subscribe: (listener) => {\r\n        listeners.add(listener);\r\n        return () => listeners.delete(listener);\r\n      },\r\n      // æ•°æ®å¿«ç…§\r\n      getSnapshot: () => obj[key],\r\n      // æ›´æ–°æ–¹æ³•\r\n      setSnapshot: (val) => {\r\n        if (val !== obj[key]) {\r\n          obj[key] = val;\r\n          run(() => listeners.forEach((listener) => listener()));\r\n        }\r\n      },\r\n      useSnapshot: () => {\r\n        return useSyncExternalStore(\r\n          state[key].subscribe,\r\n          state[key].getSnapshot,\r\n          state[key].getSnapshot\r\n        );\r\n      },\r\n    };\r\n  });\r\n\r\n  const setState = (key, val) => {\r\n    // åªæ›´æ–°åˆå§‹ obj å®šä¹‰å±æ€§\r\n    if (key in obj) {\r\n      if (key in state) {\r\n        // åˆ¤æ–­æ˜¯å±æ€§æ›´æ–°è¿˜æ˜¯å‡½æ•°è°ƒç”¨æ›´æ–°\r\n        const newVal = val instanceof Function ? val(obj[key]) : val;\r\n        // è°ƒç”¨ä¸Šæ–‡çš„ setSnapshot\r\n        state[key].setSnapshot(newVal);\r\n      } else if (__DEV__) {\r\n        throw new Error(`\\`${key}\\` is a method, can not update`);\r\n      }\r\n    } else if (__DEV__) {\r\n      throw new Error(`\\`${key}\\` is not initialized in store`);\r\n    }\r\n  };\r\n\r\n  return new Proxy(() => undefined, {\r\n    get: (_target, key) => {\r\n      if (key in methods) {\r\n        return methods[key];\r\n      }\r\n      // é‡ç‚¹è®²ä¸‹è¿™æ®µä»£ç ï¼Œé¦–å…ˆåˆ¤æ–­æ˜¯å¦ä¸º stateï¼Œä¹Ÿå°±æ˜¯ä¸Šæ–‡ä¸­åˆå§‹ä¼ é€’çš„å¯¹è±¡éå‡½æ•°éƒ¨åˆ†\r\n      if (key in state) {\r\n        // è¿™é‡Œåˆ¤æ–­æ˜¯å¦ isGetStateInMethod ä¸»è¦æ˜¯å› ä¸ºå¯èƒ½å­˜åœ¨åœ¨ methods ä¸­æ¥å¼•ç”¨ store ä¸­çš„å±æ€§ï¼Œæ‰€ä»¥å¦‚æœæ˜¯è¿™ç§æƒ…å†µç›´æ¥è¿”å›\r\n        if (isGetStateInMethod) {\r\n          return obj[key];\r\n        }\r\n        // è¿™é‡Œä»å¤–éƒ¨æ‹¿åˆ°å¯¹åº”çš„å€¼è¿”å›ï¼Œå¦‚æœä¸æ˜¯åœ¨æœ€å¤–å±‚ä½¿ç”¨ï¼ˆReact é™åˆ¶ï¼Œä¸å¯ä»¥åœ¨å›è°ƒä¹‹ç±»çš„å‡½æ•°å†…ä½¿ç”¨useä¹‹ç±»æ–¹æ³•ï¼Œè¿™é‡Œç›´æ¥è¿”å› obj ä¸‹çš„å€¼ï¼‰\r\n        try {\r\n          return state[key].useSnapshot();\r\n        } catch (err) {\r\n          return obj[key];\r\n        }\r\n      }\r\n      if (__DEV__) {\r\n        if (key !== 'prototype' && key !== 'name' && key !== 'displayName') {\r\n          throw new Error(`\\`${key}\\` is not initialized in store`);\r\n        }\r\n      }\r\n    },\r\n    // è¿™é‡Œç›‘å¬å±æ€§å˜åŠ¨ï¼Œä¾‹å¦‚è¿™ç§å½¢å¼è°ƒç”¨æ›´æ–° store.count = 60;\r\n    set: (_target, key, val) => {\r\n      setState(key, val);\r\n      return true;\r\n    },\r\n\r\n    /* \r\n    * appleæ˜¯æŒ‡å‡½æ•°è°ƒç”¨ï¼Œå®˜æ–¹æ–‡æ¡£æ˜¯æ”¯æŒä¸‹é¢è¿™ç§å½¢å¼æ¥æ›´æ–°çš„\r\n    * store({ count: 60, text: 'world' });\r\n    * å‚æ•°åˆ†åˆ«æ˜¯ç›®æ ‡å¯¹è±¡ã€ç›®æ ‡å¯¹è±¡çš„ä¸Šä¸‹æ–‡å¯¹è±¡ï¼ˆthisï¼‰å’Œç›®æ ‡å¯¹è±¡çš„å‚æ•°æ•°ç»„\r\n    * è¿™é‡Œä¹‹æ‰€ä»¥è§£æ„æˆ [firstArg, oneAction] å½¢å¼æ˜¯å› ä¸ºï¼Œé™¤äº†ä¸Šé¢è¿™ç§æ–¹å¼è¿˜å¯ä»¥\r\n      store('count', (prev) => prev + 1); \r\n      store((prev) => ({\r\n        count: prev.count + 1,\r\n        text: prev.text === 'hello' ? 'world' : 'hello',\r\n      }));\r\n    */\r\n    apply: (_target, _thisArg, [firstArg, oneAction]) => {\r\n      // store('count', (prev) => prev + 1);\r\n      if (typeof firstArg === 'string') {\r\n        setState(firstArg, oneAction);\r\n        return;\r\n      }\r\n      // store({ count: 60, text: 'world' });\r\n      if (isObj(firstArg)) {\r\n        const newObj = firstArg;\r\n        Object.keys(newObj).forEach((key) => {\r\n          setState(key, newObj[key]);\r\n        });\r\n        return;\r\n      }\r\n      //  store((prev) => ({\r\n      //   count: prev.count + 1,\r\n      //   text: prev.text === 'hello' ? 'world' : 'hello',\r\n      // }));\r\n      if (typeof firstArg === 'function') {\r\n        const newObj = firstArg(obj);\r\n        Object.keys(newObj).forEach((key) => {\r\n          setState(key, newObj[key]);\r\n        });\r\n      }\r\n    },\r\n  });\r\n};\r\n\r\n// è¿™é‡Œæ˜¯ç»™ç”¨æˆ·æš´éœ²é…ç½®ï¼Œä¾‹å¦‚ä¸Šé¢è¯´çš„ï¼Œä½ æƒ³è¦åœ¨å¼‚æ­¥ä»£ç ä¸­æ‰§è¡Œæ‰¹é‡æ›´æ–° unstable_batchedupdates\r\nresso.config = ({ batch }) => {\r\n  run = batch;\r\n};\r\n\r\nexport default resso;\r\n```\r\n\r\n## æœ€å\r\n\r\nè¿™æ˜¯ä¸€ç¯‡å¾ˆæ—©ä¹‹å‰å°±æƒ³å†™çš„æ–‡ç« ï¼Œä¸€ç›´æ‹–åˆ°ç°åœ¨æ‰å®Œæˆï¼Œæœ€åå¦‚æœæœ‰ç†è§£é”™è¯¯æˆ–è€…æ–‡ç¬”é”™è¯¯æ¬¢è¿æŒ‡å‡ºï¼ŒåŒæ—¶æœ‰å¯ä»¥å†…æ¨çš„å²—ä½æ¬¢è¿æ»´æ»´ã€‚\r\n\r\næ–‡ç« å‚è€ƒï¼š\r\n\r\n- [React æ€§èƒ½ä¼˜åŒ–ä¹‹ unstable_batchedupdatesï¼ˆbatchï¼‰ç”¨æ³•è¯¦è§£](https://juejin.cn/post/6860308689313693709)\r\n- [React18 æ–°ç‰¹æ€§è§£è¯» & å®Œæ•´ç‰ˆå‡çº§æŒ‡å—](https://juejin.cn/post/7094037148088664078)\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/100/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/100/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/99",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/99/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/99/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/99/events",
      "html_url": "https://github.com/bosens-China/blog/issues/99",
      "id": 1951726236,
      "node_id": "I_kwDOCzPAy850VPqc",
      "number": 99,
      "title": "koaæ´‹è‘±ç»“æ„è§£æ",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 3661377607,
          "node_id": "LA_kwDOCzPAy87aPDBH",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/Node%E7%B3%BB%E5%88%97",
          "name": "Nodeç³»åˆ—",
          "color": "9F9262",
          "default": false,
          "description": "å’Œnode.jsç›¸å…³å†…å®¹"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2023-10-19T09:33:07Z",
      "updated_at": "2023-10-19T09:33:17Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dbf97f99bdf142bbb9c18449b82700e3~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1149&h=1000&s=159098&e=png&b=fefefe)\r\n\r\nç»å¸¸åœ¨ä½¿ç”¨ koa çš„æ—¶å€™ï¼Œé€šè¿‡ `.use` çš„å½¢å¼æ¥æ³¨å†Œå„ç§ä¸­é—´ä»¶ï¼Œä¾‹å¦‚ä¸‹é¢ä¸€æ®µä»£ç \r\n\r\n```js\r\napp.use(async (ctx, next) => {\r\n  console.log(1);\r\n  await next();\r\n  console.log(2);\r\n});\r\napp.use(async (ctx, next) => {\r\n  console.log(3);\r\n  await next();\r\n  console.log(4);\r\n});\r\n```\r\n\r\nè¿™é‡Œä¼šè¾“å‡º 1,3,4,2ï¼Œä¸‹é¢å°±æ¥ç¿»çœ‹ä¸€ä¸‹æºç çœ‹çœ‹è¿™ä¸ªä¸­é—´ä»¶å®ç°çš„å…·ä½“åŸç†ã€‚\r\n\r\nåœ¨çœ‹å…·ä½“ä»£ç ä¹‹å‰ï¼Œå…ˆæ¸©ä¹ ä¸€ä¸‹ï¼Œä½¿ç”¨ koa çš„æœ€å°è¿è¡Œä»£ç æ˜¯ä»€ä¹ˆæ ·çš„\r\n\r\n```js\r\nconst Koa = require(\"koa\");\r\nconst app = new Koa();\r\n\r\n// response\r\napp.use((ctx) => {\r\n  ctx.body = \"Hello Koa\";\r\n});\r\n\r\napp.listen(3000);\r\n```\r\n\r\nå¯ä»¥çœ‹åˆ°ï¼Œæœ€åé€šè¿‡ listen æ–¹æ³•æ¥å¯åŠ¨æœåŠ¡ï¼Œé‚£æˆ‘ä»¬é‡ç‚¹å…ˆçœ‹ä¸‹ use å’Œ listen åšäº†ä»€ä¹ˆäº‹æƒ…ã€‚\r\n\r\n## [use](https://github.com/koajs/koa/blob/master/lib/application.js#L140C1-L145C4)\r\n\r\n```js\r\n  use (fn) {\r\n    if (typeof fn !== 'function') throw new TypeError('middleware must be a function!')\r\n    debug('use %s', fn._name || fn.name || '-')\r\n    this.middleware.push(fn)\r\n    return this\r\n  }\r\n```\r\n\r\nä»£ç æ¯”è¾ƒå°‘ï¼Œè¿™é‡Œç›´æ¥è´´ä¸Šå»äº†ï¼Œuse çš„ä¸»è¦ä½œç”¨å°±æ˜¯ç»™ middleware æ·»åŠ ç›¸å¯¹åº”çš„ fnã€‚\r\n\r\n## [listen](https://github.com/koajs/koa/blob/master/lib/application.js#L97)\r\n\r\n```js\r\n  listen (...args) {\r\n    debug('listen')\r\n    const server = http.createServer(this.callback())\r\n    return server.listen(...args)\r\n  }\r\n```\r\n\r\nè¿™é‡Œ server æ˜¯ http çš„åº“çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å…ˆä¸ç®¡ï¼Œä¸»è¦çœ‹ä¸€ä¸‹ this.callback åšäº†ä»€ä¹ˆäº‹æƒ…ã€‚\r\n\r\n```js\r\n  callback () {\r\n    const fn = this.compose(this.middleware)\r\n\r\n    if (!this.listenerCount('error')) this.on('error', this.onerror)\r\n\r\n    const handleRequest = (req, res) => {\r\n      const ctx = this.createContext(req, res)\r\n      if (!this.ctxStorage) {\r\n        return this.handleRequest(ctx, fn)\r\n      }\r\n      return this.ctxStorage.run(ctx, async () => {\r\n        return await this.handleRequest(ctx, fn)\r\n      })\r\n    }\r\n\r\n    return handleRequest\r\n  }\r\n```\r\n\r\nhandleRequest è¿™ä¸ªå‡½æ•°çš„å®ç°å¦‚ä¸‹\r\n\r\n```js\r\n  handleRequest (ctx, fnMiddleware) {\r\n    const res = ctx.res\r\n    res.statusCode = 404\r\n    const onerror = err => ctx.onerror(err)\r\n    const handleResponse = () => respond(ctx)\r\n    onFinished(res, onerror)\r\n    return fnMiddleware(ctx).then(handleResponse).catch(onerror)\r\n  }\r\n\r\n```\r\n\r\nå¯ä»¥çœ‹åˆ°ï¼Œæœ€ç»ˆæ˜¯æŠŠ this.compose è¿”å›çš„ fn è¿›è¡Œäº†è°ƒç”¨ï¼Œé‚£ä¹ˆç”±æ­¤å¯ä»¥çŸ¥é“ this.compose å°±æ˜¯å…·ä½“ä¸­é—´ä»¶è°ƒåº¦çš„å…·ä½“å®ç°ã€‚\r\n\r\n## compose\r\n\r\nthis.compose å¯ä»¥åœ¨ constructor ä¸­çœ‹åˆ°ï¼Œé»˜è®¤æƒ…å†µä¸‹å°±æ˜¯ [koa-compose](https://github.com/koajs/compose)ï¼Œè¿™ä¸ªåº“ä¹Ÿéå¸¸ç²¾ç®€åªæœ‰ 50 è¡Œä»£ç ï¼Œä¸‹é¢ä¼šé€šè¿‡æ³¨é‡Šçš„å½¢å¼æ¥å¯¹æºç è¿›è¡Œä¸€ä¸ªè¯´æ˜ã€‚\r\n\r\n```js\r\n// çœç•¥éƒ¨åˆ†æ³¨é‡Šå’Œéƒ¨åˆ†ä»£ç \r\n\r\nfunction compose(middleware) {\r\n  // åˆ¤æ–­ä¼ é€’æ˜¯å¦ä¸ºæ•°ç»„ï¼Œä¸”æ¯ä¸ªæ•°ç»„éƒ½å¿…é¡»ä¸ºå‡½æ•°ï¼Œå¦åˆ™æŠ›å‡ºå¼‚å¸¸\r\n  if (!Array.isArray(middleware))\r\n    throw new TypeError(\"Middleware stack must be an array!\");\r\n  for (const fn of middleware) {\r\n    if (typeof fn !== \"function\")\r\n      throw new TypeError(\"Middleware must be composed of functions!\");\r\n  }\r\n  // è¿™é‡Œé»˜è®¤è¿”å›ä¸€ä¸ªå‡½æ•°ï¼ŒhandleRequestå‡½æ•°ä¼šè°ƒç”¨è¿™ä¸ªè¿”å›çš„å‡½æ•°ï¼Œå¹¶ä¸”ä¼ é€’ context\r\n  return function (context, next) {\r\n    let index = -1;\r\n    // é»˜è®¤æƒ…å†µä¸‹æ‰§è¡Œä¸€æ¬¡ dispatch ï¼Œdispatchå› ä¸ºæ˜¯å‡½æ•°å£°æ˜æ‰€ä»¥ä¼šæå‡åˆ°åšä½œç”¨åŸŸé¡¶éƒ¨\r\n    return dispatch(0);\r\n    function dispatch(i) {\r\n      // é€šå¸¸æƒ…å†µä¸‹ä¸ä¼šé‡åˆ°ï¼Œä½†æ˜¯å¦‚æœæ‰§è¡Œä¸¤æ¬¡å°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œä¾‹å¦‚ç¬¬ä¸€æ¬¡è°ƒç”¨indexä¸º-1ï¼Œiä¸º0ï¼Œç¬¬äºŒæ¬¡æ‰§è¡Œåˆ™å˜æˆindexä¸º0ï¼Œiä¹Ÿä¸º0åˆ™æŠ›å‡ºé”™è¯¯\r\n      if (i <= index)\r\n        return Promise.reject(new Error(\"next() called multiple times\"));\r\n      index = i;\r\n      let fn = middleware[i];\r\n      // è¿™é‡Œä»koaçš„å®ç°å¯ä»¥çœ‹åˆ°ï¼Œæ˜¯æ²¡æœ‰ä¼ é€’nextçš„ï¼Œæ‰€ä»¥è¿™è¡Œä»£ç å¯ä»¥è·³è¿‡\r\n      if (i === middleware.length) fn = next;\r\n      // æ‰§è¡Œåˆ°æœ€åä¸€é¡¹çš„æ—¶å€™ç›´æ¥è¿”å›ä¸å†ç»§ç»­é€’å½’ä¸‹å»\r\n      if (!fn) return Promise.resolve();\r\n      try {\r\n        // è¿™é‡Œå®ç°å¾ˆå·§å¦™ï¼Œåˆ©ç”¨äº†bindçš„åŸç†ï¼Œbindçš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºthisï¼Œä¹‹åçš„å‚æ•°ä¸ºå‡½æ•°çš„é¢„è®¾å€¼ï¼Œæœ€åè¿”å›ä¸€ä¸ªå‡½æ•°\r\n        // ç„¶åæ ¹æ®Promise.resolveçš„å®ç°è§„èŒƒï¼Œå¦‚æœä¼ é€’çš„Promise.resolveæ˜¯ä¸€ä¸ªPromiseè¦ç­‰å¾…æ–°çš„Promiseæ‰§è¡Œå®Œæˆä¹‹åå†³å®šçŠ¶æ€\r\n        // è¿™é‡Œæ¨èçœ‹ä¸‹PromiseA+è§„èŒƒå®ç°\r\n        return Promise.resolve(fn(context, dispatch.bind(null, i + 1)));\r\n      } catch (err) {\r\n        return Promise.reject(err);\r\n      }\r\n    }\r\n  };\r\n}\r\n```\r\n\r\nokï¼Œè¿™é‡ŒåŸºæœ¬ä¸Šå°±è®²å®Œäº†ï¼Œè¿˜æ˜¯å¯¹ç…§æœ€åˆçš„ç¤ºä¾‹æ¥çœ‹\r\n\r\n```js\r\napp.use(async (ctx, next) => {\r\n  console.log(1);\r\n  await next();\r\n  console.log(2);\r\n});\r\napp.use(async (ctx, next) => {\r\n  console.log(3);\r\n  await next();\r\n  console.log(4);\r\n});\r\n```\r\n\r\nè¿™é‡Œä¼ é€’ç»™ compose([fn1, fn2])ï¼Œä¹‹å i ä¸º 0ï¼Œè¿”å›\r\n\r\n```js\r\nconst fn = async (ctx, next) => {\r\n  console.log(1);\r\n  await next();\r\n  console.log(2);\r\n};\r\nreturn Promise.resolve(fn(context, dispatch.bind(null, i + 1)));\r\n```\r\n\r\nä¹‹å i ä¸º 1 çš„æ—¶å€™\r\n\r\n```js\r\nconst fn = async (ctx, next) => {\r\n  console.log(3);\r\n  await next();\r\n  console.log(4);\r\n};\r\nreturn Promise.resolve(fn(context, dispatch.bind(null, i + 1)));\r\n```\r\n\r\næ­¤æ—¶ i ä¸º 2ï¼Œå‘ç°æ•°ç»„å–ä¸åˆ°å€¼äº†ï¼Œæ‰§è¡Œ\r\n\r\n```js\r\nif (!fn) return Promise.resolve();\r\n```\r\n\r\nå›åˆ°æœ€æœ€åä¸€æ­¥ï¼Œè¿˜æ²¡æœ‰è§£é‡Šä¸ºä»€ä¹ˆä¼šæ´‹è‘±ç»“æ„è¿™æ ·æ¥æ‰§è¡Œä»£ç \r\n\r\n```js\r\napp.use(async (ctx, next) => {\r\n  console.log(1);\r\n  await next();\r\n  console.log(2);\r\n});\r\napp.use(async (ctx, next) => {\r\n  console.log(3);\r\n  await next();\r\n  console.log(4);\r\n});\r\n```\r\n\r\nè¿™é‡Œæˆ‘ä»¬çŸ¥é“å…ˆæ‰§è¡Œç¬¬ä¸€ä¸ªå‡½æ•°\r\n\r\n1. è¾“å‡º console.log(1);\r\n2. æ‰§è¡Œçš„è¿‡ç¨‹ä¸­é‡åˆ° `await next()` ä¼šæ‰§è¡Œ nextï¼Œè€Œä»æºç  `dispatch.bind(null, i + 1)` å¯ä»¥çŸ¥é“ä¸‹ä¸€é¡¹å°±æ˜¯ç¬¬äºŒä¸ªå‡½æ•°\r\n3. æ‰§è¡Œç¬¬äºŒä¸ªå‡½æ•°\r\n4. è¾“å‡º console.log(3)\r\n5. ç»§ç»­æ‰§è¡Œ `await next()` ä»æºç çŸ¥é“ i ä¸º 2 çš„æ—¶å€™ï¼Œè¿”å›çš„æ˜¯ `if (!fn) return Promise.resolve();`\r\n6. æ‰§è¡Œ conosle.log(4)ï¼Œè¿”å› Promise çŠ¶æ€ä¸ºå·²å®Œæˆï¼Œç»“æœä¸º undefined\r\n7. æ‰§è¡Œ console.log(2)\r\n\r\nä¸Šé¢å¯èƒ½æœ‰ç‚¹ç»•ï¼Œä½†æ˜¯å…¶å® koa-compose åˆ©ç”¨äº†äº‹ä»¶å¾ªç¯çš„æœºåˆ¶ï¼Œå¯¹äºå¾®ä»»åŠ¡æ¯æ¬¡æ‰§è¡Œéƒ½ä¼šæ”¾åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œç­‰å¾…ä¸»çº¿ç¨‹æ‰§è¡Œæ ˆè°ƒç”¨ï¼Œè€Œæ ˆçš„ç‰¹ç‚¹å°±æ˜¯å…ˆè¿›åå‡ºï¼Œæ‰€ä»¥è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¼šè¾“å‡º 1,3,4,2 çš„åŸå› äº†ã€‚\r\n\r\n## æœ€å\r\n\r\nå¦‚æœæ–‡ç« æœ‰è¯´çš„ä¸å¯¹åœ°æ–¹æ¬¢è¿æŒ‡å‡ºï¼Œæœ€åæœ¬äººæ­£åœ¨æ‰¾å·¥ä½œï¼Œæœ‰ç›¸å…³ hc å²—ä½æ¬¢è¿æ»´æ»´ã€‚\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/99/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/99/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/98",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/98/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/98/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/98/events",
      "html_url": "https://github.com/bosens-China/blog/issues/98",
      "id": 1849714138,
      "node_id": "I_kwDOCzPAy85uQGXa",
      "number": 98,
      "title": "[javaScript]ES2023 å¼•å…¥éç ´åæ€§æ–¹æ³•",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1908144759,
          "node_id": "MDU6TGFiZWwxOTA4MTQ0NzU5",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/ES6%E7%B3%BB%E5%88%97",
          "name": "ES6ç³»åˆ—",
          "color": "0366d6",
          "default": false,
          "description": "ES6çš„æœ€æ–°è¯­æ³•"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2023-08-14T12:49:24Z",
      "updated_at": "2023-08-14T12:51:32Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "å¯¹äº Array çš„ä¸€äº›æ“ä½œï¼Œä¾‹å¦‚ reverseã€sort ç­‰éƒ½ä¼šæ”¹å˜åŸæ•°ç»„ï¼ŒES2023 å¯¹ä»¥ä¸‹è¿™äº›æ–¹æ³•è¿›è¡Œäº†æ‹“å±•ï¼Œæä¾›äº†ç›¸åŒåŠŸèƒ½ä½†æ˜¯è¿”å›æ–°å‰¯æœ¬çš„æ–¹æ³•ã€‚\r\n\r\n- toReversed\r\n- toSorted\r\n- toSpliced\r\n- with\r\n\r\nä¸‹é¢è¿›è¡Œä¸€ä¸ªè¯¦ç»†çš„ä»‹ç»ã€‚\r\n\r\n## toReversed\r\n\r\n- reverseï¼šåè½¬æ•°ç»„å…ƒç´ ï¼Œä½†æ˜¯ä¼šæ”¹å˜æ•°ç»„æœ¬èº«\r\n- toReversedï¼šè·Ÿ reverse åŠŸèƒ½ç›¸åŒï¼Œä½†æ˜¯è¿”å›æ–°å‰¯æœ¬ä¸ä¼šæ”¹å˜æ•°ç»„æœ¬èº«\r\n\r\nç¤ºä¾‹ 1.js\r\n\r\n```\r\n// reverse\r\nconst a = [1, 2, 3];\r\nconst b = a.reverse();\r\n\r\nconsole.log(a); // [3, 2, 1]\r\nconsole.log(b); // [3, 2, 1]\r\n\r\n// toReversed ğŸ‘\r\nconst c = [1, 2, 3];\r\nconst d = c.toReversed();\r\n\r\nconsole.log(c); // [1, 2, 3]\r\nconsole.log(d); // [3, 2, 1]\r\n```\r\n\r\n## toSorted\r\n\r\n- sortï¼šå¯¹æ•°ç»„è¿›è¡Œæ’åºï¼Œä½†æ˜¯ä¼šæ”¹å˜æ•°ç»„æœ¬èº«\r\n- toSortedï¼šè·Ÿ sort æ–¹æ³•ä¸€æ ·ï¼Œä½†æ˜¯è¿”å›æ–°å‰¯æœ¬\r\n\r\nç¤ºä¾‹ 2.js\r\n\r\n```\r\n// sort\r\nconst a = [3, 1, 2];\r\nconst b = a.sort();\r\n\r\nconsole.log(a); // [1, 2, 3]\r\nconsole.log(b); // [1, 2, 3]\r\n\r\n// toSorted ğŸ‘\r\nconst c = [3, 1, 2];\r\nconst d = c.toSorted();\r\n\r\nconsole.log(c); // [3, 1, 2]\r\nconsole.log(d); // [1, 2, 3]\r\n```\r\n\r\n## toSpliced\r\n\r\n- spliceï¼šéå¸¸ä¸‡èƒ½çš„æ–¹æ³•å¯ä»¥å¯¹æ•°ç»„è¿›è¡Œåˆ é™¤ã€æ›¿æ¢æ•°å…ƒç´ ä»¥åŠæ·»åŠ æ–°å…ƒç´ \r\n- toSplicedï¼šè·Ÿ splice ä¸€æ ·ï¼Œä½†æ˜¯æ“ä½œä¸ä¼šå¯¹åŸæ•°ç»„è¿›è¡Œæ”¹å˜\r\n\r\nä¸è¿‡ï¼Œç”±äº splice å’Œ toSpliced çš„è¿”å›å€¼å­˜åœ¨ä»¥ä¸‹å·®å¼‚ï¼Œå› æ­¤å¤„ç†å®ƒä»¬æ—¶ä¼¼ä¹éœ€è¦å°å¿ƒã€‚\r\n\r\n- splice çš„è¿”å›å€¼è¢«åˆ é™¤å€¼çš„æ•°ç»„\r\n- toSpliced çš„è¿”å›å€¼è¿”å›ä»æ•°ç»„ä¸­åˆ é™¤å…ƒç´ çš„å‰¯æœ¬\r\n\r\nç¤ºä¾‹ 3.js\r\n\r\n```\r\n// splice\r\nconst a = [1, 2, 3, 4];\r\nconst b = a.splice(1,2);\r\n\r\nconsole.log(a); // [1,4]\r\nconsole.log(b); // [2,3]ã€€è¿”å›å€¼æ˜¯åˆ é™¤çš„å€¼æ’åˆ—çš„å€¼\r\n\r\n// toSpliced ğŸ‘\r\nconst c = [1, 2, 3, 4];\r\nconst d = c.toSpliced(1,2);\r\n\r\nconsole.log(c); // [1,2,3,4]\r\nconsole.log(d); // [1,4]ã€€è¿”å›ä»æ•°ç»„ä¸­åˆ é™¤å…ƒç´ çš„å‰¯æœ¬\r\n```\r\n\r\n## with\r\n\r\nåœ¨ç¬¬ä¸€ä¸ªå‚æ•°ä¸­æŒ‡å®šæ•°ç»„çš„ç´¢å¼•å·ï¼Œå¹¶å°†è¯¥å…ƒç´ æ›¿æ¢ä¸ºç¬¬äºŒä¸ªå‚æ•°çš„å€¼ã€‚\r\n\r\nJS å·²ç»æœ‰ä¸€ä¸ªå•ç‹¬çš„ [with](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/with)\r\nè¯­å¥ï¼Œä½†å®ƒå·²è¢«å¼ƒç”¨ï¼Œæ‰€ä»¥å®ƒå¾ˆæ··ä¹±ï¼Œå› ä¸ºå®ƒä¸è¿™æ¬¡æ·»åŠ çš„æ•°ç»„æ“ä½œçš„ with æ–¹æ³•é‡å ã€‚\r\n\r\nç¤ºä¾‹ 4.js\r\n\r\n```\r\n// with ğŸ‘\r\nconst c = [1, 2, 3, 4];\r\nconst d = c.with(1,'ğŸ‘');\r\n\r\nconsole.log(c); // [1, 2, 3, 4]\r\nconsole.log(d); // [1, 'ğŸ‘', 3, 4]\r\n```\r\n\r\n## æœ€å\r\n\r\nè¿™äº›æ–¹æ³•çš„å‡ºç°ï¼Œä½¿å¾—ä½ ä¸éœ€è¦æ¯æ¬¡éƒ½æµ…å¤åˆ¶ï¼Œä»£ç çœ‹èµ·æ¥å¾ˆæ¸…çˆ½ã€‚\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/98/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/98/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/97",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/97/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/97/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/97/events",
      "html_url": "https://github.com/bosens-China/blog/issues/97",
      "id": 1745358720,
      "node_id": "I_kwDOCzPAy85oCA-A",
      "number": 97,
      "title": "ä½¿ç”¨jsxæ¥ç¼–å†™æ¨¡æ¿",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1371686608,
          "node_id": "MDU6TGFiZWwxMzcxNjg2NjA4",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%BC%AB%E8%B0%88%E7%B3%BB%E5%88%97",
          "name": "æ¼«è°ˆç³»åˆ—",
          "color": "e7f3ee",
          "default": false,
          "description": "æµ…è°ˆç±»æ–‡ç« "
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2023-06-07T08:36:19Z",
      "updated_at": "2023-06-07T08:36:19Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "## å‰è¨€\r\n\r\næ¨¡æ¿å¼•æ“è¿™ä¸ªåº”è¯¥éƒ½ä¸é™Œç”Ÿï¼Œæœ€æ—©å¯ä»¥è¿½æº¯åˆ°å‰åç«¯è¿˜æ²¡åˆ†ç¦»çš„æ—¶å€™ï¼Œåç«¯ä¸ºäº†å¾ªç¯ã€åˆ¤æ–­å€¼ä¹‹ç±»ç®€åŒ–ç¼–å†™æµç¨‹è€Œä½¿ç”¨çš„ï¼Œæ¯•ç«Ÿæ‰‹åŠ¨æ‹¼æ¥å­—ç¬¦ä¸²ä¹‹ç±»çš„ä¹Ÿå¤ªéº»çƒ¦äº†ã€‚\r\n\r\nä¸‹é¢æ˜¯ php [easytpl](https://github.com/phppkg/easytpl) çš„ä¸€ä¸ªç¤ºä¾‹ï¼Œä»è¿™ä¸ªå¯ä»¥çœ‹åˆ°æ¨¡æ¿å¼•æ“çš„åŸºæœ¬ç”¨é€”ã€‚\r\n\r\n```php\r\nuse PhpPkg\\EasyTpl\\EasyTemplate;\r\n\r\n$tplCode = <<<'CODE'\r\nMy name is {{ $name | strtoupper }},\r\nMy develop tags:\r\n\r\n{{ foreach($tags as $tag) }}\r\n- {{ $tag }}\r\n\r\n{{ endforeach }}\r\nCODE;\r\n\r\n$t = new EasyTemplate();\r\n\r\n$str = $t->renderString($tplCode, [\r\n    'name' => 'inhere',\r\n    'tags' => ['php', 'go', 'java'],\r\n]);\r\n\r\necho $str;\r\n```\r\n\r\nä¸Šé¢è¿™å¯¹ä»£ç ä¼šè¾“å‡º\r\n\r\n```md\r\nMy name is INHERE,\r\nMy develop tags:\r\n\r\n- php\r\n- go\r\n- java\r\n```\r\n\r\nå›åˆ° JavaScriptï¼Œéšç€èŒèƒ½çš„ä¸æ–­æå‡å‰ç«¯ä¹Ÿé¢ä¸´åŒæ ·çš„é—®é¢˜ï¼Œäºæ˜¯ç¤¾åŒºæ¶Œç°äº†ä¸€å †åº“ï¼Œä¾‹å¦‚ï¼š\r\n\r\n- [ejs](https://ejs.co/)\r\n- [nunjucks](http://mozilla.github.io/nunjucks/templating.html)\r\n- [pug](https://pugjs.org/api/getting-started.html)\r\n- ...\r\n\r\nä¸Šé¢çš„å‡ ä¸ªä½¿ç”¨æ–¹æ³•éƒ½å¤§åŒå°å¼‚ï¼Œéƒ½æ˜¯é€šè¿‡å†…ç½®ä¸€äº›è¯­æ³•æ¥ç®€åŒ–é‡å¤çš„ä¹¦å†™ã€‚ä¸è¿‡æ€è€ƒä¸€ä¸‹ä½¿ç”¨æ¨¡æ¿å¼•æ“ä¼šæœ‰ä»€ä¹ˆç¼ºç‚¹ï¼Ÿ\r\n\r\nä¸‹é¢æ˜¯ä¸€æ®µ ejs ä»£ç ç¤ºä¾‹\r\n\r\n```html\r\n<% if (resultPreSale.length) { %>\r\n<h2>æœ¬æ¬¡æ–°å¢å…¥ç½‘æ¥¼æ ‹ï¼š<%= resultPreSale.length %>ä¸ª</h2>\r\n<ul>\r\n  <% resultPreSale.forEach(function(item){ %>\r\n  <li>\r\n    <p>\r\n      <a href=\"<%= item.url %>\"> é¡¹ç›®åç§°ï¼š<%= item.entryName %> </a>\r\n    </p>\r\n    <p>æ¥¼å¹¢å·ï¼š<%= item.buildingNumber %></p>\r\n    <p>è®¸å¯é¢ç§¯(ã¡)ï¼š<%= item.permittedArea %></p>\r\n    <p>å‘æ”¾æ—¥æœŸï¼š<%= item.time %></p>\r\n  </li>\r\n  <% }); %>\r\n</ul>\r\n<% } %>\r\n```\r\n\r\nä»ä¸Šé¢çš„ç¤ºä¾‹å¯ä»¥çœ‹åˆ°ä»¥ä¸‹ç¼ºç‚¹ï¼š\r\n\r\n1. ç¼ºå°‘è¯­æ³•æç¤ºï¼šåœ¨ä½¿ç”¨ç¼–è¾‘å™¨çš„æ—¶å€™ä½¿ç”¨ç›¸å¯¹åº”è¯­æ³•éƒ½ä¼šæœ‰æç¤ºï¼Œä½†æ˜¯ä¸Šé¢åœ¨ä½¿ç”¨ `forEach` ä¹‹ç±»çš„æ ¹æœ¬ä¸ä¼šæœ‰æç¤ºï¼›\r\n2. ä¸èƒ½å€ŸåŠ© Eslintã€TypeScript æ¥æå‰æ£€æŸ¥ç¼–å†™é”™è¯¯ï¼šä¾‹å¦‚æœ‰ä¸€äº› props æ²¡æœ‰ä¼ é€’æˆ–è€…ç±»å‹ç¼ºå°‘ï¼Œä»¥åŠå˜é‡ä¸å­˜åœ¨è€Œå¼•ç”¨ç­‰é”™è¯¯ï¼Œå¿…é¡»è¿è¡Œä¹‹åæ‰ä¼šå‘ç°é”™è¯¯ï¼›\r\n3. æœ‰é¢å¤–çš„å­¦ä¹ æˆæœ¬ï¼Œæ¯ä¸ªæ¨¡æ¿å¼•æ“çš„è¯­æ³•å…¶å®éƒ½ä¸ä¸€æ ·ï¼Œä¾‹å¦‚ ejs å’Œ pug å°±ä¸ä¸€è‡´ï¼›\r\n\r\n## jsx\r\n\r\nå›å½’åˆ°æœ€ç†Ÿæ‚‰çš„ jsx æœ¬èº«ï¼Œå¾—ç›Šäº React çš„æµè¡Œ jsx è¿™ç§çµæ´»æ–¹ä¾¿çš„è¯­æ³•å°±æ˜¯é¦–é€‰ï¼Œé¦–å…ˆç”Ÿæ€å¾ˆä¸°å¯Œå¯ä»¥è·Ÿ TypeScript å’Œ eslint æ— ç¼è¡”æ¥ï¼Œä¸”è¯­æ³•è·Ÿ js åŸºæœ¬ä¸€è‡´ä¸ä¼šå¢åŠ é¢å¤–çš„å­¦ä¹ æˆæœ¬ï¼Œä¸”è·Ÿç¼–è¾‘å™¨é…åˆå¾ˆå¥½å¯ä»¥æœ‰è¯­æ³•æç¤ºã€‚\r\n\r\nä¸‹é¢æ˜¯ä¸€æ®µç¤ºä¾‹\r\n\r\n```jsx\r\nconst App = (props: Props) => {\r\n  return (\r\n    <>\r\n      <PreSale resultPreSale={props.resultPreSale}></PreSale>\r\n      <List resultList={props.resultList}></List>\r\n      <List resultList={props.residueList} title={<h2>å…¶ä»–æ­£åœ¨æ‘‡å·é¡¹ç›®ï¼ˆ{props.residueList.length}ä¸ªï¼‰ï¼š</h2>}></List>\r\n      <p>æœ¬æ¬¡çˆ¬å–æ—¶é—´ï¼š{props.currentTime}</p>\r\n      <style>{style}</style>\r\n    </>\r\n  );\r\n};\r\n```\r\n\r\njsx åŸºç¡€çš„è¯­æ³•å’Œå¦‚ä½•è§£æè¿™é‡Œå¹¶ä¸å…³å¿ƒï¼Œè¯´å›ä¸»é¢˜å¦‚ä½•ä½¿ç”¨ jsx æ¥ç¼–å†™æ¨¡æ¿å‘¢ï¼Ÿ\r\n\r\n### è§£æ jsx\r\n\r\næ¨¡æ¿è¿”å›çš„éƒ½æ˜¯å­—ç¬¦ä¸²çš„å½¢å¼ï¼Œä½†æ˜¯ä¸Šé¢ç¤ºä¾‹çš„ App æ˜æ˜¾æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥é¦–å…ˆéœ€è¦æŠŠ jsx è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå¹¸è¿çš„æ˜¯ç¤¾åŒºæœ‰ç›¸å…³çš„åº“ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯ [preact-render-to-string](https://github.com/preactjs/preact-render-to-string)ï¼Œ[preact](https://preactjs.com/)æ˜¯ä¸€ä¸ªè·Ÿ React å®ç°å¾ˆæ¥è¿‘çš„åº“ï¼Œä½ å¯ä»¥ç†è§£ä¸º mini Reactã€‚\r\n\r\n> è¿™é‡Œå…¶å®å¹¶ä¸ä¼šä½¿ç”¨ hooks ä¹‹ç±»çš„åŠŸèƒ½ï¼Œä½¿ç”¨çš„åªæ˜¯ jsx è¯­æ³•æœ¬èº«ï¼Œæ‰€ä»¥é€‰ç”¨ä»€ä¹ˆæ¡†æ¶å¹¶ä¸å…³é”®ã€‚\r\n\r\n```jsx\r\nimport { render } from 'preact-render-to-string';\r\nconst html = render(<App {...props}></App>);\r\n```\r\n\r\nå¦‚æœç»“åˆ TypeScript ä½¿ç”¨ï¼Œè¿˜éœ€è¦åšä¸€äº›é¢å¤–çš„é…ç½®\r\n\r\n- å®‰è£… preact\r\n\r\n- ä¿®æ”¹ tsconfig.json\r\n\r\n```json\r\n{\r\n  \"compilerOptions\": {\r\n    \"jsx\": \"react-jsx\",\r\n    \"jsxImportSource\": \"preact\"\r\n  }\r\n}\r\n```\r\n\r\n### node ç¯å¢ƒä½¿ç”¨\r\n\r\nè¿™é‡Œå¹¶æ²¡æœ‰ä¸‡äº‹å¤§å‰ï¼Œåœ¨ node ç¯å¢ƒä½¿ç”¨æ¨¡æ¿å¼•æ“ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆæ­£å¸¸çš„äº‹æƒ…ï¼Œä½†æ˜¯ tsx æˆ–è€… jsx æ–‡ä»¶éƒ½æ˜¯å±äºéœ€è¦ç¼–è¯‘æ¥è¿›è¡Œå¤„ç†çš„ï¼Œå¦åˆ™ node å¹¶ä¸è®¤è¯†ã€‚\r\n\r\n1. [tsx](https://github.com/esbuild-kit/tsx)ï¼Œä½¿ç”¨ tsx è¿™ä¸ªåº“ï¼Œå®ƒé€šè¿‡ esbuild æ¥è¿è¡Œ TypeScript å’Œ ESM æ–‡ä»¶ï¼›\r\n2. webpack\r\n\r\nä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„ webpack ç¤ºä¾‹\r\n\r\n```js\r\nconst path = require('path');\r\nconst nodeExternals = require('webpack-node-externals');\r\nconst RunNodeWebpackPlugin = require('run-node-webpack-plugin');\r\n\r\nmodule.exports = {\r\n  entry: {\r\n    index: './src/index.ts',\r\n  },\r\n  target: 'node',\r\n  devtool: 'source-map',\r\n  externalsPresets: { node: true },\r\n  output: {\r\n    path: path.resolve(__dirname, 'dist'),\r\n    filename: '[name].cjs',\r\n    clean: true,\r\n  },\r\n  resolve: {\r\n    extensions: ['.js', '.jsx', '.ts', '.tsx'],\r\n  },\r\n  module: {\r\n    rules: [\r\n      {\r\n        test: /\\.(js|jsx|ts|tsx)$/,\r\n        exclude: /node_modules/,\r\n        use: [\r\n          {\r\n            loader: 'esbuild-loader',\r\n            options: {\r\n              target: 'es2022',\r\n            },\r\n          },\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n};\r\n```\r\n\r\n## æœ€å\r\n\r\nå¦‚æœæ–‡ç« æœ‰é”™è¯¯æ¬¢è¿ç•™è¨€æŒ‡å‡ºã€‚\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/97/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/97/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/96",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/96/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/96/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/96/events",
      "html_url": "https://github.com/bosens-China/blog/issues/96",
      "id": 1672296843,
      "node_id": "I_kwDOCzPAy85jrTmL",
      "number": 96,
      "title": "hookä¸‹å¦‚ä½•ä¹¦å†™å‘å¸ƒè®¢é˜…",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1473940161,
          "node_id": "MDU6TGFiZWwxNDczOTQwMTYx",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3",
          "name": "æ¡†æ¶ç›¸å…³",
          "color": "42b883",
          "default": false,
          "description": "ç›®å‰Vueå’ŒReactä¸ºä¸»"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 1,
      "created_at": "2023-04-18T03:43:26Z",
      "updated_at": "2023-06-01T08:44:54Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "è¿™ç¯‡æ–‡ç« çš„æ€è·¯æ¥æºä¸º [ahooks](https://github.com/alibaba/hooks/blob/master/packages/hooks/src/useEventEmitter/index.ts)ï¼Œå› ä¸º react å·²ç»æœ‰ç›¸å¯¹åº”çš„å®ç°äº†ï¼Œæ‰€ä»¥è¿™é‡Œä¸»è¦ä»‹ç» vue ä¸‹å¦‚ä½•å®ç°ä¸€ä¸ª hook çš„å‘å¸ƒè®¢é˜…ã€‚\r\n\r\nå‡è®¾æœ‰ä¸€ä¸ªéœ€æ±‚ï¼Œå½“ä»·æ ¼å‘ç”Ÿæ”¹å˜çš„æ—¶å€™åˆ·æ–°åˆ—è¡¨ï¼Œåœ¨ vue ä¸­å¾ˆè‡ªç„¶è€Œç„¶æƒ³åˆ°è°ƒç”¨ watch è§‚å¯Ÿï¼Œä½†æ˜¯è¿™æ ·çš„è°ƒç”¨è¿˜æ˜¯æœ‰ç‚¹ç¹çã€‚ä¾‹å¦‚ä¸‹é¢ä¸€æ®µä¼ªä»£ç \r\n\r\n```js\r\nimport { ref, watch } from 'vue';\r\n\r\nconst isChange = ref(false);\r\nconst refreshList = () => {\r\n  // çœç•¥\r\n  isChange.value = false;\r\n};\r\n\r\nconst onClick = () => {\r\n  isChange.value = true;\r\n};\r\n\r\nwatch(isChange, (val) => {\r\n  if (!val) {\r\n    return;\r\n  }\r\n  refreshList();\r\n});\r\n```\r\n\r\nä½†æ˜¯ä»”ç»†è§‚å¯Ÿä¸€ä¸‹ï¼Œå…¶å®æˆ‘ä»¬åªæ˜¯æƒ³è®©å˜åŒ–çš„æ—¶å€™é€šçŸ¥ä¸€ä¸‹ï¼Œç„¶åè°ƒç”¨ refreshList å³å¯ã€‚\r\n\r\nä¸”æˆ‘ä»¬ä¹Ÿä¸å¸Œæœ›æ¯æ¬¡éƒ½å¤åˆ¶è¿™æ ·ä¸€æ®µä»£ç åœ¨å…¶ä»–ç»„ä»¶ä¸­é‡å¤ä½¿ç”¨ï¼ŒåŸºäºä¸Šé¢çš„åœºæ™¯æˆ‘ä»¬å¾ˆå®¹æ˜“æƒ³åˆ°å¯ä»¥å†™ä¸€ä¸ªå‘å¸ƒè®¢é˜…çš„æ¨¡å—æ¥å®ç°æˆ‘ä»¬éœ€æ±‚ã€‚\r\n\r\n## EventEmitter\r\n\r\n```js\r\nclass EventEmitter {\r\n  subscriptions = new Set();\r\n\r\n  emit = (val) => {\r\n    for (const subscription of this.subscriptions) {\r\n      subscription(val);\r\n    }\r\n  };\r\n\r\n  useSubscription = (callback) => {\r\n    this.subscriptions.add(subscription);\r\n  };\r\n}\r\n```\r\n\r\nä¸Šé¢çš„å‘å¸ƒè®¢é˜…æ¨¡å—å¾ˆç®€å•ï¼Œ`useSubscription` æ¥è®¢é˜…ï¼Œ`emit` æ¥è¿›è¡Œé€šçŸ¥ã€‚ä¸‹é¢æ˜¯ä½¿ç”¨å½¢å¼\r\n\r\n```js\r\nconst event = new EventEmitter();\r\nconst refreshList = () => {};\r\nconst fn = (val) => {\r\n  if (val !== 'refresh') {\r\n    return;\r\n  }\r\n  refreshList();\r\n};\r\nevent.useSubscription('refresh', fn);\r\n\r\nconst onClick = () => {\r\n  event.emit('refresh');\r\n};\r\n\r\nonUnmounted(() => {\r\n  event.subscriptions.delete(fn);\r\n});\r\n```\r\n\r\nä½¿ç”¨æ–¹å¼ç¨å¾®ç®€åŒ–äº†ä¸€ä¸‹ï¼Œä¸è¿‡ä¹Ÿå¤šå‡ºäº† `onUnmounted`ï¼Œè¿™ä¹Ÿè°ˆä¸ä¸Šæ–¹ä¾¿ï¼Œå› ä¸ºä¼šæœ‰é¢å¤–çš„å¿ƒæ™ºè´Ÿæ‹…ï¼Œä¸Šé¢ä¹‹æ‰€ä»¥å•ç‹¬å†™ä¸€ä¸ª `fn` å°±æ˜¯å› ä¸ºå¸è½½çš„æ—¶å€™éœ€è¦å¸è½½å¯¹åº”çš„å‡½æ•°æ‰è¡Œã€‚\r\n\r\nåŸºäºç®€åŒ–å’Œä¸æƒ³é‡å¤ç®¡ç†çš„éœ€æ±‚ï¼Œæˆ‘ä»¬å†é‡æ–°å†™ä¸€ç‰ˆï¼Œè¿™é‡Œæˆ‘ä»¬é‡‡ç”¨ hook çš„å½¢å¼æ¥ä¹¦å†™\r\n\r\n## useEventEmitter\r\n\r\n```js\r\nclass EventEmitter {\r\n  subscriptions = new Set();\r\n\r\n  emit = (val) => {\r\n    for (const subscription of this.subscriptions) {\r\n      subscription(val);\r\n    }\r\n  };\r\n\r\n  useSubscription = (callback) => {\r\n    this.subscriptions.add(callback);\r\n    onUnmounted(() => {\r\n      this.subscriptions.delete(callback);\r\n    });\r\n  };\r\n}\r\nconst useEventEmitter = () => {\r\n  const event = new EventEmitter();\r\n\r\n  return event;\r\n};\r\n```\r\n\r\nä¸Šé¢çš„é€»è¾‘æ”¹å˜äº†ä¸€ä¸‹ï¼Œæˆ‘ä»¬åœ¨ `useSubscription` ä¸­è°ƒç”¨ `onUnmounted` æ¥å®Œæˆä¸€ä¸ªè‡ªåŠ¨çš„å¸è½½ã€‚\r\n\r\nä¹‹åä½¿ç”¨æ–¹æ³•\r\n\r\n```js\r\nconst event = useEventEmitter();\r\n\r\nconst refreshList = () => {};\r\n\r\nevent.useSubscription((val) => {\r\n  if (val !== 'refresh') {\r\n    return;\r\n  }\r\n  refreshList();\r\n});\r\n\r\nconst onClick = () => {\r\n  event.emit('refresh');\r\n};\r\n```\r\n\r\nè¿™é‡Œå°±è¾¾åˆ°æˆ‘ä»¬æœŸå¾…çš„ä¸€ä¸ªæ•ˆæœäº†ï¼Œä¸è¿‡è¿˜æ˜¯æœ‰éœ€è¦æ”¹è¿›çš„åœ°æ–¹ï¼š\r\n\r\nåœ¨ä½¿ç”¨å‘å¸ƒè®¢é˜…çš„åœºæ™¯åŸºæœ¬ä¸Šç»„ä»¶ä¹‹é—´çš„å±‚çº§ä¼šåµŒå¥—å¾ˆå¤šï¼Œä¾‹å¦‚ä¸Šé¢æ¯æ¬¡è°ƒç”¨ `useEventEmitter` ç”Ÿæˆä¸€ä¸ªæ–°çš„ `event` æ‰€ä»¥é€šè¿‡å•ä¾‹ç®€åŒ–ä¸ºå…¨å±€å”¯ä¸€çš„ event å³å¯ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥å€ŸåŠ© `provide` å’Œ `inject` è§£å†³è¿™ä¸€é—®é¢˜\r\n\r\n## æ”¹è¿›ä¹‹å\r\n\r\n```js\r\nclass EventEmitter {\r\n  subscriptions = new Set();\r\n\r\n  emit = (val) => {\r\n    for (const subscription of this.subscriptions) {\r\n      subscription(val);\r\n    }\r\n  };\r\n\r\n  useSubscription = (callback) => {\r\n    this.subscriptions.add(callback);\r\n    onUnmounted(() => {\r\n      this.subscriptions.delete(callback);\r\n    });\r\n  };\r\n}\r\nconst event = new EventEmitter();\r\nconst useEventEmitter = () => {\r\n  return event;\r\n};\r\n```\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/96/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/96/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/95",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/95/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/95/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/95/events",
      "html_url": "https://github.com/bosens-China/blog/issues/95",
      "id": 1520334523,
      "node_id": "I_kwDOCzPAy85anna7",
      "number": 95,
      "title": "monorepo å¦‚ä½•è§£å†³åˆ«åé—®é¢˜",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1740577858,
          "node_id": "MDU6TGFiZWwxNzQwNTc3ODU4",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3",
          "name": "å·¥å…·ç›¸å…³",
          "color": "f73d62",
          "default": false,
          "description": "å·¥ç¨‹åŒ–ç›¸å…³çš„ä¸œè¥¿"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2023-01-05T08:43:30Z",
      "updated_at": "2023-01-05T08:43:30Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "å¾—ç›Šäº pnpm è½¯é“¾æ¥å®ç°ç°åœ¨ monorepo é¡¹ç›®å·²ç»ååˆ†æˆç†Ÿäº†ï¼Œä¸è¿‡åœ¨å†™é¡¹ç›®æ—¶å€™è¿˜æ˜¯é‡åˆ°å¾ˆå¤šç—›ç‚¹ï¼Œä¾‹å¦‚ï¼š\r\n\r\n1. å¦‚æœæˆ‘æœ‰å¤šä¸ª packages é¡¹ç›®å¹¶ä¸”ä½¿ç”¨ TypeScriptï¼Œé‚£ä¹ˆæˆ‘è‚¯å®šå¸Œæœ›æ˜¯å†™çš„éƒ½æ˜¯ tsï¼Œåœ¨éœ€è¦è°ƒç”¨çš„æ—¶å€™é€šè¿‡å·¥å…·æ¥å®Œæˆè¿™ä¸€è¿‡ç¨‹çš„è½¬è¯‘ï¼Œä¸è¿‡åœ¨å®é™…å¼€å‘ä¸­å¯èƒ½ä½¿ç”¨äº† vite è¿™æ ·çš„å·¥å…·ï¼Œå¯¼è‡´é‡åˆ°é—®é¢˜åªèƒ½é€šè¿‡å…¶å®ƒæ–¹å¼æ¥ç»•è¿‡å»ï¼›\r\n2. å¦‚æœå†™ä¸€ä¸ªåç«¯é¡¹ç›®ï¼Œé‚£ä¹ˆæ•°æ®åº“å®šä¹‰çš„æ¨¡å‹æè¿°è‚¯å®šå¸Œæœ›åœ¨ web é¡¹ç›®ä¹Ÿå¯ä»¥å¤ç”¨ï¼Œä¸è¿‡åœ¨å¤šå…¥å£ä¸­å¯èƒ½è¿˜éœ€è¦é€šè¿‡ `@new-house/src/xxxx.ts` æ¥å¼•ç”¨ï¼Œè¿™ä¸ª `src/xxx` ä¹Ÿå¤ªä¸ç®€æ´äº†ã€‚\r\n\r\næ‰€ä»¥è¿™ç¯‡æ–‡ç« é‡ç‚¹å°±æ˜¯è§£å†³é—®é¢˜ 2 ï¼Œé—®é¢˜ 1 å¦‚æœæœ‰æœºä¼šå†å•ç‹¬å¼€ä¸€ä¸ªç¯‡å¹…æ¥è¯´ï¼Œåœ¨æ­£å¼è®²è§£ä¹‹å‰éœ€è¦ä»‹ç»ä¸€ä¸‹ `exports` è¿™ä¸ªå±æ€§\r\n\r\n## exports\r\n\r\nè¿™ä¸ªå±æ€§æ·»åŠ äº v12.7.0ï¼Œæœ€ç®€å•çš„ä½¿ç”¨æ–¹å¼å¦‚ä¸‹\r\n\r\n```js\r\n{\r\n  // package.json\r\n  \"exports\": \"./index.js\"\r\n}\r\n```\r\n\r\nå®ƒçš„ä¼˜å…ˆçº§é«˜äº `main`ï¼Œé™¤æ­¤ä¹‹å¤–æ›´å¤šæ˜¯ä½œä¸ºä¸åŒç¯å¢ƒå¯¼å…¥æ–‡ä»¶æ¥ä½¿ç”¨ï¼Œä¾‹å¦‚å¼€å‘äº†ä¸€ä¸ª utils çš„åŒ…å¸Œæœ›å®ƒå¯ä»¥åœ¨ node çš„ cjs å’Œ ems ç¯å¢ƒä¸‹å·¥ä½œï¼Œé‚£ä¹ˆå®ƒå°±å¯ä»¥å‘æŒ¥ä½œç”¨äº†ã€‚\r\n\r\n```js\r\n{\r\n  \"exports\": {\r\n    \".\": {\r\n      \"import\": \"./feature-node.mjs\",\r\n      \"require\": \"./feature-node.cjs\"\r\n    },\r\n  }\r\n}\r\n```\r\n\r\né™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥è§£å†³ç›®å½•åˆ«åé—®é¢˜ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä»‹ç»å®ƒçš„åŸå› \r\n\r\n```js\r\n{\r\n  \"name\": \"my-package\",\r\n  \"exports\": {\r\n    \".\": \"./lib/index.js\",\r\n    \"./lib\": \"./lib/index.js\",\r\n    \"./lib/*\": \"./lib/*.js\",\r\n    \"./lib/*.js\": \"./lib/*.js\",\r\n    \"./feature\": \"./feature/index.js\",\r\n    \"./feature/*\": \"./feature/*.js\",\r\n    \"./feature/*.js\": \"./feature/*.js\",\r\n    \"./package.json\": \"./package.json\"\r\n  }\r\n}\r\n```\r\n\r\nä¸Šé¢çš„ ` \"./feature/*\": \"./feature/*.js\",` ä»¥åŠ `\"./feature/*.js\": \"./feature/*.js\",` ç­‰éƒ½å¯ä»¥é€šè¿‡ `my-package/feature/xxx.js` æ¥å®Œæˆè°ƒç”¨\r\n\r\nexports å°±ä»‹ç»åˆ°è¿™é‡Œï¼Œäº†è§£åˆ°å®ƒå¯ä»¥é€‚é…ä¸åŒç¯å¢ƒä»¥åŠç”¨äºè§£å†³ç›®å½•åˆ«åï¼Œä¸‹é¢å°±æ˜¯é¡¹ç›®å®æˆ˜ã€‚\r\n\r\n## TypeScript ä¸‹ä½¿ç”¨\r\n\r\nä¸ºäº†æ–¹ä¾¿ï¼Œè¿™é‡Œæˆ‘å·²ç»æ­å»ºå¥½äº†ä¸€ä¸ª pnpm monorepo é¡¹ç›®ï¼Œå®ƒçš„æ–‡ä»¶ç»“æ„å¦‚ä¸‹\r\n\r\n```sh\r\ntest\r\nâ”œâ”€ node_modules\r\nâ”œâ”€ package.json\r\nâ”œâ”€ packages\r\nâ”‚    â”œâ”€ utils\r\nâ”‚    â”‚    â”œâ”€ package.json\r\nâ”‚    â”‚    â”œâ”€ src\r\nâ”‚    â”‚    â”‚    â”œâ”€ addition.ts\r\nâ”‚    â”‚    â”‚    â””â”€ subtraction.ts\r\nâ”‚    â”‚    â””â”€ tsconfig.json\r\nâ”‚    â””â”€ web\r\nâ”‚           â”œâ”€ babel.config.js\r\nâ”‚           â”œâ”€ dist\r\nâ”‚           â”‚    â””â”€ index.js\r\nâ”‚           â”œâ”€ node_modules\r\nâ”‚           â”œâ”€ package.json\r\nâ”‚           â”œâ”€ src\r\nâ”‚           â”‚    â””â”€ index.ts\r\nâ”‚           â”œâ”€ tsconfig.json\r\nâ”‚           â””â”€ webpack.config.js\r\nâ”œâ”€ pnpm-lock.yaml\r\nâ”œâ”€ pnpm-workspace.yaml\r\nâ””â”€ tsconfig.json\r\n```\r\n\r\nutils è¿™ä¸ªé¡¹ç›®ç”¨äºç»™ web é¡¹ç›®ä½¿ç”¨ï¼Œå®ƒçš„ package.json å†…å®¹å¦‚ä¸‹\r\n\r\n```js\r\n{\r\n  \"name\": \"@test/utils\",\r\n  \"version\": \"1.0.0\",\r\n  \"exports\": {\r\n    \"./*\": \"./src/*.ts\"\r\n  }\r\n}\r\n```\r\n\r\nè¿™é‡Œè®¾ç½® `\"./*\"` æ˜¯æç¤ºè¿™ä¸ªä¸ºä¸€ä¸ªå­ç›®å½•åˆ«åï¼ŒåŒç†ä½ ä¹Ÿå¯ä»¥è®¾ç½® `\"test/*\"` è¡¨ç¤ºä»¥ test ä¸ºå¼€å¤´ï¼Œå› ä¸º utils è¿™ä¸ªé¡¹ç›®éƒ½æ˜¯ ts æˆ‘å¹¶ä¸æƒ³èŠ±æ—¶é—´æ¯æ¬¡éƒ½ build ä¸€éæˆ js æ‰€ä»¥åªèƒ½å†™æˆ `./src/*.ts`\r\n\r\n> è¿™é‡Œæç¤ºä¸€ä¸‹ï¼Œå¦‚æœæ˜¯ ts é¡¹ç›®å¿…é¡»è¿™ä¸ªç»“å°¾ï¼Œå¦åˆ™ä¼šæç¤ºæ‰¾ä¸åˆ°ç±»å‹æ–‡ä»¶\r\n\r\nç¬¬äºŒæ­¥å°±æ˜¯åœ¨ web é¡¹ç›®ä¸­å¼•ç”¨\r\n\r\n```js\r\n// web/src/index.ts\r\nimport addition from '@test/utils/addition';\r\nimport subtraction from '@test/utils/subtraction';\r\n\r\nconsole.log(addition(1, 1));\r\nconsole.log(subtraction(1, 1));\r\n```\r\n\r\n> å¦‚æœ TypeScript æç¤ºè¯´ä¸åˆ°æ¨¡å—ä¹‹ç±»çš„é”™è¯¯ï¼Œé‚£ä¹ˆä½ éœ€è¦è°ƒæ•´ä¸€ä¸‹ tsconfig.json çš„é…ç½®\r\n>\r\n> ```json\r\n> {\r\n>   \"compilerOptions\": {\r\n>     \"moduleResolution\": \"NodeNext\" // node 16ä¹Ÿå¯ä»¥\r\n>   }\r\n> }\r\n> ```\r\n\r\nè¿™æ ·å°±æ¶ˆé™¤äº†é—¹å¿ƒçš„ src ç›®å½•\r\n\r\n## å…¶å®ƒé—®é¢˜\r\n\r\n### TypeScript ä½¿ç”¨åˆ«åå¦‚ä½•å®šä¹‰ç±»å‹æ–‡ä»¶\r\n\r\nè¿™ä¸ªå¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£çš„å®ç°\r\n\r\n```json\r\n// package.json\r\n{\r\n  \"name\": \"my-package\",\r\n  \"type\": \"module\",\r\n  \"exports\": {\r\n    \".\": {\r\n      // Entry-point for TypeScript resolution - must occur first!\r\n      \"types\": \"./types/index.d.ts\",\r\n      // Entry-point for `import \"my-package\"` in ESM\r\n      \"import\": \"./esm/index.js\",\r\n      // Entry-point for `require(\"my-package\") in CJS\r\n      \"require\": \"./commonjs/index.cjs\"\r\n    }\r\n  },\r\n  // CJS fall-back for older versions of Node.js\r\n  \"main\": \"./commonjs/index.cjs\",\r\n  // Fall-back for older versions of TypeScript\r\n  \"types\": \"./types/index.d.ts\"\r\n}\r\n```\r\n\r\né¢å¤–åœ¨ exports ä¸­æ·»åŠ  types å±æ€§ï¼Œç›¸å…³è®¨è®ºé“¾æ¥ https://github.com/microsoft/TypeScript/issues/33079#issuecomment-598961442\r\n\r\n### è®¾ç½®äº† moduleResolution å¯¼è‡´å¯¼å…¥å…¶å®ƒæ¨¡å—å¿…é¡»ä»¥.js ç»“å°¾\r\n\r\nä»¥.js ç»“å°¾æ˜¯è§„èŒƒçš„è§„å®šï¼Œå¦‚æœä½ ä½¿ç”¨ webpack5 æ¥æ‰“åŒ…é¡¹ç›®å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹\r\n\r\n```js\r\n{\r\n  resolve: {\r\n    extensionAlias: {\r\n      \".js\": [\".ts\", \".js\"],\r\n      \".cjs\": [\".cts\", \".cjs\"],\r\n      \".mjs\": [\".mts\", \".mjs\"],\r\n    }\r\n    // ...\r\n  }\r\n  // ...\r\n}\r\n```\r\n\r\nç›¸å…³é—®é¢˜é“¾æ¥ [Support TypeScript module resolution `node16` Â· Issue #12625 Â· facebook/create-react-app (github.com)](https://github.com/facebook/create-react-app/issues/12625)\r\n\r\n## å‚è€ƒé“¾æ¥\r\n\r\n- [æ¨¡å—ï¼šåŒ…|èŠ‚ç‚¹.js v19.3.0 æ–‡æ¡£ (nodejs.org)](https://nodejs.org/api/packages.html#subpath-imports)\r\n- [TypeScriptï¼š Documentation - ECMAScript Modules in Node.js (typescriptlang.org)](https://www.typescriptlang.org/docs/handbook/esm-node.html)\r\n- [Module çš„åŠ è½½å®ç° - ECMAScript 6 å…¥é—¨ (ruanyifeng.com)](https://es6.ruanyifeng.com/#docs/module-loader)\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/95/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/95/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/94",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/94/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/94/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/94/events",
      "html_url": "https://github.com/bosens-China/blog/issues/94",
      "id": 1361066184,
      "node_id": "I_kwDOCzPAy85RIDjI",
      "number": 94,
      "title": "TypeScript ç±»å‹æ”¶çª„",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1371686611,
          "node_id": "MDU6TGFiZWwxMzcxNjg2NjEx",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%85%B6%E4%BB%96",
          "name": "å…¶ä»–",
          "color": "f6ecbf",
          "default": false,
          "description": "æœªæ‰¾åˆ°åˆ†ç±»ï¼Œæš‚å®šçš„æ–‡ç« "
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2022-09-04T07:17:35Z",
      "updated_at": "2022-09-04T07:17:35Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "![image-20220904141910530](https://user-images.githubusercontent.com/39508895/188302110-a54f0cf4-ec09-4b1b-bcf0-2caf181351da.png)\r\n\r\n\r\nå†™è¿™ç¯‡æ–‡ç« æ˜¯å› ä¸ºæœ€è¿‘åœ¨å†™ä¸€ä¸ª[ç®¡ç†å¼‚æ­¥é˜Ÿåˆ—çš„åº“](https://github.com/bosens-China/async-queue)ï¼Œä½†æ˜¯æœ‰ä¸€äº›ç±»å‹æ¨å¯¼ä¸å¤ªå¥½å†™ï¼Œä¾‹å¦‚ä¸Šé¢çš„æœŸå¾…æ˜¯\r\n\r\n```js\r\nif (values.stauts === 'error') {\r\n  // values.data to Error\r\n}\r\n```\r\n\r\nåé¢æŸ¥è¯¢äº†ä¸€äº›æ–‡æ¡£å’Œèµ„æ–™å°±æœ‰äº†è¿™ç¯‡æ–‡ç« ã€‚\r\n\r\n## æ”¶çª„æ–¹å¼\r\n\r\nåœ¨å…·ä½“è®²è§£ä¸Šé¢å¦‚ä½•å®ç°ä¹‹å‰ï¼Œå…ˆä»‹ç»ä¸€ä¸‹å‡ ç§æ”¶çª„å¯¹è±¡çš„æ–¹å¼ã€‚\r\n\r\n### typeof ç±»å‹å®ˆå«\r\n\r\n```js\r\nfunction padLeft(padding: number | string, input: string): string {\r\n  throw new Error('Not implemented yet!');\r\n}\r\n```\r\n\r\nå¦‚æœåœ¨ padLeft å‡½æ•°å†…è°ƒç”¨ä¸æ˜¯ stirng å’Œ number ç›¸åŒçš„æ–¹æ³•ï¼Œä¾‹å¦‚ toStringã€valueOf ä¼šæç¤ºæ–¹æ³•ä¸å­˜åœ¨ã€‚\r\n\r\nä¹‹æ‰€ä»¥å‡ºç°è¿™æ ·é—®é¢˜æ˜¯å› ä¸º Typescript å¹¶ä¸çŸ¥é“ padding åˆ°åº•æ˜¯ number è¿˜æ˜¯ stringï¼Œä½†æ˜¯ä½ å¯ä»¥é€šè¿‡ typeof çš„æ˜¾å¼å‘Šè¯‰å®ƒçš„ç±»å‹ã€‚\r\n\r\n```js\r\nfunction padLeft(padding: number | string, input: string): string {\r\n  if (typeof padding === 'string') {\r\n    return padding.charAt(0);\r\n  }\r\n  // æ’é™¤äº†stringï¼Œå‰©ä¸‹å°±æ˜¯number\r\n  return padding.toFixed(2);\r\n}\r\n```\r\n\r\n### æ¡ä»¶è¯­å¥\r\n\r\nåœ¨ä½¿ç”¨æ¡ä»¶è¯­å¥ï¼Œä¾‹å¦‚ `if`ã€`&&`ã€`||` ã€`!` ç­‰æ¡ä»¶è¯­å¥çš„æ—¶å€™ä¹Ÿä¼šç¼©å°ç±»å‹ã€‚\r\n\r\nçœ‹ä¸€ä¸ªä¾‹å­\r\n\r\n```js\r\nfunction printAll(strs: string | string[] | null) {\r\n  //\r\n}\r\n```\r\n\r\næŒ‰ç…§ä¸Šé¢ typeof è¯­å¥å¾ˆè‡ªç„¶å°±æƒ³åˆ°åˆ¤æ–­æ˜¯ä¸æ˜¯ object æ¥å®Œæˆæ•°ç»„åŒºåˆ†\r\n\r\n```js\r\nfunction printAll(strs: string | string[] | null) {\r\n  if (typeof strs === 'object') {\r\n    strs.forEach((item) => {});\r\n    // Object is possibly 'null'.\r\n    //'item' is declared but its value is never read.\r\n  }\r\n}\r\n```\r\n\r\nä¸è¿‡å†™åˆ°ä¸€åŠå°±ä¼šå‘ç°æç¤ºæŠ¥é”™äº†ï¼Œstrs åœ¨ object çš„åˆ¤æ–­ä¸‹ä¾ç„¶å¯èƒ½ä¸º nullï¼Œå›å¿†ä¸€ä¸‹ typeof çš„è¿ç®—ç¬¦å¯ä»¥å¾—çŸ¥è¿™ä¸ªæ˜¯æ­£å¸¸ç°è±¡ï¼Œnull çš„ typeof è¿”å›å€¼ä¹Ÿæ˜¯ objectï¼Œè¿™ä¸ªæ˜¯ JavaScript è¯­è¨€è®¾è®¡çš„ä¸€ä¸ªç¼ºé™·ã€‚\r\n\r\nä¸è¿‡è¦æ€ä¹ˆæ¶ˆé™¤è¿™ä¸ªå½±å“å‘¢ï¼Ÿè¿™å°±ç”¨åˆ°è¿™æ¡ä»¶è¯­å¥ï¼Œå¯ä»¥é€šè¿‡åˆ¤æ–­ strs æ˜¯å¦å­˜åœ¨æ˜¾å¼æ’é™¤ null çš„å­˜åœ¨\r\n\r\n```js\r\nfunction printAll(strs: string | string[] | null) {\r\n  if (typeof strs === 'object' && strs) {\r\n    // object\r\n    return strs;\r\n    // è¿™é‡Œstrsç±»å‹å·²ç»è¢«æ’é™¤objectäº†\r\n  } else if (typeof strs === 'string') {\r\n    return strs;\r\n  }\r\n  // null\r\n  return strs;\r\n}\r\n```\r\n\r\n### ç›¸ç­‰è¿ç®—ç¬¦å’Œ switch æ”¶çª„\r\n\r\nè¿˜å¯ä»¥ä½¿ç”¨ `===`ã€`==`ã€`!=`ã€`!==` è¿ç®—ç¬¦æ¥å®Œæˆæ”¶çª„\r\n\r\n```js\r\ninterface Container {\r\n  value: number | null | undefined;\r\n}\r\n\r\nfunction multiplyValue(container: Container, factor: number) {}\r\n```\r\n\r\nä¾‹å¦‚ä¸Šé¢ï¼Œå¦‚æœæƒ³è®© container æ’é™¤ null å’Œ undefined å°±å¯ä»¥ä½¿ç”¨ `===` æ¥å®Œæˆï¼Œä¸‹é¢æ˜¯ç¤ºä¾‹\r\n\r\n```js\r\ninterface Container {\r\n  value: number | null | undefined;\r\n}\r\n\r\nfunction multiplyValue(container: Container, factor: number) {\r\n  if (container.value === undefined) {\r\n    return 0;\r\n  }\r\n  if (container.value === null) {\r\n    return 1;\r\n  }\r\n  return container.value === factor;\r\n}\r\n```\r\n\r\né€šè¿‡ === å®Œæˆäº† undefined å’Œ null çš„æ”¶çª„è¿‡ç¨‹ï¼Œè¿™é‡Œé¡ºä¾¿è¯´ä¸‹å…¶å®ä¸Šé¢çš„å†™æ³•å¯ä»¥ç®€å†™æˆ `==` ï¼Œ== åœ¨åˆ¤æ–­ undefined è·Ÿ null ä¹‹é—´æ—¶è¿”å› trueã€‚\r\n\r\n```js\r\ninterface Container {\r\n  value: number | null | undefined;\r\n}\r\n\r\nfunction multiplyValue(container: Container, factor: number) {\r\n  if (container.value == undefined) {\r\n    return 0;\r\n  }\r\n\r\n  return container.value === factor;\r\n}\r\n```\r\n\r\n### in è¿ç®—ç¬¦\r\n\r\nin è¿ç®—ç¬¦ç”¨äºåˆ¤æ–­ä¸€ä¸ªå±æ€§æ˜¯å¦å­˜åœ¨å¯¹è±¡ä¸Šï¼Œåœ¨ TypeScript åŒæ ·å¯ä»¥ä½¿ç”¨ in æ¥å®Œæˆæ”¶çª„ã€‚\r\n\r\n```js\r\ntype Fish = { swim: () => void };\r\ntype Bird = { fly: () => void };\r\n\r\nfunction move(animal: Fish | Bird) {\r\n  if ('swim' in animal) {\r\n    return animal.swim();\r\n  }\r\n\r\n  return animal.fly();\r\n}\r\n```\r\n\r\nä¸Šé¢ move é€šè¿‡æŒ‡å®š `swim in animal` å‘Šè¯‰ TypeScriptï¼Œåœ¨ if ä¸­ç±»å‹å°±æ˜¯ Fishï¼Œå› ä¸º Bird ä¸­ä¸å­˜åœ¨è¿™ä¸ªå±æ€§ã€‚\r\n\r\n> ä½¿ç”¨ in è¿ç®—ç¬¦æ”¶çª„æ—¶ï¼Œä½¿ç”¨å…¶ä»–è”åˆç±»å‹ä¸å­˜åœ¨çš„å±æ€§æ¥å®Œæˆå¯¹æŸä¸€ç±»å‹çš„æ”¶çª„\r\n\r\n### instanceof\r\n\r\nä¸ JavaScript ä¸­ä¸€æ ·ï¼Œinstanceof ä¹Ÿå¯ä»¥åˆ¤æ–­æŸä¸ªå±æ€§æ˜¯å¦åŒ¹é…å¯¹è±¡ã€‚\r\n\r\n```js\r\nfunction logValue(x: Date | string) {\r\n  if (x instanceof Date) {\r\n    console.log(x.toUTCString());\r\n  } else {\r\n    console.log(x.toUpperCase());\r\n  }\r\n}\r\n```\r\n\r\n### èµ‹å€¼\r\n\r\nè¿™é‡Œç›´æ¥çœ‹ä¾‹å­\r\n\r\n```js\r\nlet x = Math.random() < 0.5 ? 10 : 'hello world!';\r\n// let x: string | number\r\nx = 1;\r\n\r\nconsole.log(x);\r\n// let x: number\r\nx = 'goodbye!';\r\n\r\nconsole.log(x);\r\n// let x: string\r\n```\r\n\r\nä¸è¿‡æ³¨æ„ï¼Œåˆ†é…ç»™ä¸Šé¢çš„ x ä¸€å®šè¦ç¬¦åˆ x æœ€åˆçš„è”åˆç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¯´ç»™å®š boolean ä¼šæŠ¥é”™ã€‚\r\n\r\n### ç±»å‹è°“è¯\r\n\r\nåœ¨ä½¿ç”¨ lodash ç±»å‹çš„å‡½æ•°åº“ï¼Œé€šå¸¸éƒ½ä¼šæœ‰ isObjectï¼Œä½ å¯èƒ½å¾ˆå¥½å¥‡æ€ä¹ˆå®ç°ã€‚\r\n\r\nå…¶å®å®ƒä»¬å°±æ˜¯ä½¿ç”¨äº†ç±»å‹è°“è¯ï¼Œä¸‹é¢åŠ¨æ‰‹å®ç°ä¸€ä¸ª isObject\r\n\r\n```js\r\nfunction isObject (value:any) : value is object {\r\n    return value && typeof value === 'object'\r\n}\r\n```\r\n\r\nä¹‹ååœ¨é…åˆä½¿ç”¨å°±å¯ä»¥å®Œæˆç±»å‹æ”¶çª„\r\n\r\n```js\r\nfunction test(pet: object | null) {\r\n  if (isObject(pet)) {\r\n    return pet;\r\n  } else {\r\n    return {};\r\n  }\r\n}\r\n```\r\n\r\n### interface æ”¶çª„\r\n\r\nä¸Šé¢å°†æ”¶çª„çš„æ–¹å¼åˆ—ä¸¾äº†ä¸€ç•ªï¼Œä¸‹é¢å°±çœ‹ä¸‹åœ¨ interface ä¸­å¦‚ä½•å®ç°æ”¶çª„ï¼Œæœ€å¼€å§‹å·²ç»è¯´äº†ï¼Œæˆ‘ä»¬æœŸå¾…ä½¿ç”¨ if æ¡ä»¶è¯­å¥å¯ä»¥é€šè¿‡ status çš„ä¸åŒæ¥å®Œæˆ data çš„å˜åŒ–ã€‚\r\n\r\nåœ¨ TypeScript æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è”åˆç±»å‹å°†ä¸¤è€…é€šç”¨éƒ¨åˆ†åŒºåˆ†\r\n\r\n```js\r\nexport interface ChangeError {\r\n  status: 'error';\r\n  data: Error;\r\n}\r\n\r\nexport interface ChangeData<T> {\r\n  status: 'success';\r\n  data: T;\r\n}\r\n```\r\n\r\nä¹‹åæ‹¼æ¥ä¸€èµ·\r\n\r\n```js\r\nexport type Change<T = any> = {\r\n  index: number,\r\n  progress: number,\r\n  total: number,\r\n} & (ChangeError | ChangeData<T>);\r\n```\r\n\r\nä¹‹åé€šè¿‡ TypeScript çš„æ¡ä»¶æ”¶çª„å°±è‡ªåŠ¨å®Œæˆè¿™ä¸€è¿‡ç¨‹ã€‚\r\n\r\n### æ”¶çª„ç±»å‹çš„å®ç”¨ç¤ºä¾‹\r\n\r\næ”¶çª„ + never ç»“åˆå¯ä»¥å®Œæˆä¸€ä¸ªè”åˆç±»å‹æ·»åŠ æ–°å¯¹è±¡ä¸å¤„ç†æŠ¥é”™ã€‚\r\n\r\n```js\r\ninterface A {\r\n  name: 'a';\r\n}\r\ninterface B {\r\n  name: 'b';\r\n}\r\n\r\ntype Types = A | B;\r\n\r\nfunction check(values: Types) {\r\n  switch (values.name) {\r\n    case 'a':\r\n      return '';\r\n    case 'b':\r\n      return '';\r\n    default:\r\n      const _never: never = values;\r\n      return _never;\r\n  }\r\n}\r\n```\r\n\r\nnever è¡¨ç¤ºæ°¸è¿œä¸ºç©ºçš„ç±»å‹ï¼Œç»“åˆ switch å¯ä»¥å°†å¯¹è±¡ç±»å‹æ”¶çª„å°½ï¼Œè¿™æ—¶å¯¹è±¡çš„ç±»å‹å°±æ˜¯ neverã€‚\r\n\r\nç°åœ¨å¦‚æœç»™ Types æ·»åŠ æ–°çš„è”åˆç±»å‹ default å°±ä¼šæŠ›å‡ºé”™è¯¯\r\n\r\n```js\r\ninterface A {\r\n  name: 'a';\r\n}\r\ninterface B {\r\n  name: 'b';\r\n}\r\n\r\ntype Types = A | B | { name: 'c' };\r\n\r\nfunction check(values: Types) {\r\n  switch (values.name) {\r\n    case 'a':\r\n      return '';\r\n    case 'b':\r\n      return '';\r\n    default:\r\n      const _never: never = values;\r\n      return _never;\r\n  }\r\n}\r\n```\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/94/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/94/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/93",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/93/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/93/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/93/events",
      "html_url": "https://github.com/bosens-China/blog/issues/93",
      "id": 1254826397,
      "node_id": "I_kwDOCzPAy85KyyGd",
      "number": 93,
      "title": "nginx æç®€å…¥é—¨",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1740577858,
          "node_id": "MDU6TGFiZWwxNzQwNTc3ODU4",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3",
          "name": "å·¥å…·ç›¸å…³",
          "color": "f73d62",
          "default": false,
          "description": "å·¥ç¨‹åŒ–ç›¸å…³çš„ä¸œè¥¿"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2022-06-01T03:35:30Z",
      "updated_at": "2022-06-01T03:35:30Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "nginxï¼ˆè¯»éŸ³ï¼šengine-xï¼ŒéŸ³æ ‡ï¼š[ËˆendÊ’Éªnks']ï¼‰æ˜¯ HTTP å’Œåå‘ä»£ç†æœåŠ¡å™¨ã€é‚®ä»¶ä»£ç†æœåŠ¡å™¨å’Œé€šç”¨ TCP/UDP ä»£ç†æœåŠ¡å™¨ã€‚\r\n\r\næ—¥å¸¸ä¸­æœ€ç»å¸¸å¬åˆ°ç”¨åˆ°çš„å°±æ˜¯åå‘ä»£ç†ä»¥åŠè´Ÿè½½å‡è¡¡ï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯åå‘ä»£ç†å‘¢ï¼Ÿ\r\n\r\n## ä»€ä¹ˆæ˜¯åå‘ä»£ç†ï¼Ÿ\r\n\r\n![reverse-proxy](https://user-images.githubusercontent.com/39508895/171322376-dc12836e-435a-44c1-b3c8-cfdc3f8c4293.png)\r\n\r\n\r\nåå‘ä»£ç†ï¼ˆReverse Proxyï¼‰æ˜¯æŒ‡ä»¥ä»£ç†æœåŠ¡å™¨æ¥æ¥å— internetï¼ˆËˆÉªntÉ™ËŒnÉ›tï¼‰ ä¸Šçš„è¿æ¥è¯·æ±‚ï¼Œç„¶åå°†è¯·æ±‚è½¬å‘ç»™å†…éƒ¨ç½‘ç»œä¸Šçš„æœåŠ¡å™¨ï¼Œå¹¶å°†ä»æœåŠ¡å™¨ä¸Šå¾—åˆ°çš„ç»“æœè¿”å›ç»™ internet ä¸Šè¯·æ±‚è¿æ¥çš„å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶ä»£ç†æœåŠ¡å™¨å¯¹å¤–å°±è¡¨ç°ä¸ºä¸€ä¸ªåå‘ä»£ç†æœåŠ¡å™¨ã€‚\r\n\r\nç®€å•æ¦‚æ‹¬å°±æ˜¯æœ‰ä¸€ä¸ªä¸­è½¬æœåŠ¡å™¨æ¥è½¬å‘ä½ çš„è¯·æ±‚ï¼Œé‚£ä¹ˆä½¿ç”¨åå‘ä»£ç†æœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ\r\n\r\n- éšè—çœŸå®çš„æœåŠ¡åœ°å€\r\n- èŠ‚çœ ip èµ„æºï¼Œå…¬å…±çš„ ip åœ°å€æ˜¯æœ‰é™çš„ï¼Œåå‘ä»£ç†å¯ä»¥è§£å†³æ­¤é—®é¢˜\r\n\r\n### nginx ä¸­å¦‚ä½•é…ç½®åå‘ä»£ç†ï¼Ÿ\r\n\r\nåœ¨ nginx ä¸­é€šè¿‡æŒ‡å®š proxy_passï¼ˆËˆprÉ’ksi pÉ‘Ësï¼‰ å³å¯å®Œæˆè¯·æ±‚è½¬å‘åˆ°æŒ‡å®šæœåŠ¡å™¨\r\n\r\n```nginx\r\n# çœç•¥å…¶ä»–é…ç½®\r\n\r\nserver {\r\n  listen       80;\r\n  server_name  www.helloworld.com;\r\n\r\n  location /app1/ {\r\n    proxy_pass http://api_server;\r\n    rewrite \"^/app1/(.*)$\" /$1 break;\r\n  }\r\n\r\n  location /app2/ {\r\n    proxy_pass http://api_server;\r\n  }\r\n}\r\n```\r\n\r\nä¸Šé¢çš„ä¸¤ç§å½¢å¼æ˜¯æœ€é•¿ä½¿ç”¨çš„åœºæ™¯ã€‚\r\n\r\nå‡è®¾è®¿é—® `www.helloworld.com/api1/user/1`ï¼Œé‚£ä¹ˆçœŸå®è¯·æ±‚çš„æ˜¯ `http://api_server/user/1`ï¼›\r\n\r\nè€Œå¦‚æœè®¿é—®` www.helloworld.com/api2/user/2`ï¼ŒçœŸå®è¯·æ±‚åœ°å€ä¸º `http://api_server/app2/user/2`ã€‚\r\n\r\nä¸Šé¢çš„ `rewriteï¼ˆËˆriËraÉªtï¼‰` æ˜¯é‡å†™è¯·æ±‚åœ°å€ï¼Œè€Œ `(.*)` ä»£è¡¨æ­£åˆ™çš„ç»„åŒ¹é…ï¼Œ$1 æ˜¯è·å– `()` çš„å†…å®¹ï¼ŒåŒç†å¦‚æœå­˜åœ¨å¤šä¸ª `()` è¿˜å¯ä»¥é€šè¿‡$2,$3 çš„å½¢å¼æ¥ç®€å†™ã€‚\r\n\r\n### ä¸ dev å¼€å‘å¯¹æ¯”\r\n\r\nè€Œåœ¨çœŸå®çš„å¼€å‘ä¸­ï¼ˆå¯èƒ½æ˜¯é€šè¿‡ webpack æˆ–è€… vite è¿™æ ·çš„å·¥å…·ï¼‰ï¼Œä¸ºäº†è§£å†³è·¨åŸŸé—®é¢˜ï¼Œæˆ‘ä»¬ä¹Ÿä¼šå¼•å…¥åå‘ä»£ç†ï¼Œä¾‹å¦‚å¦‚ä¸‹é…ç½®ï¼š\r\n\r\n```js\r\nexport default defineConfig({\r\n  server: {\r\n    proxy: {\r\n      // å­—ç¬¦ä¸²ç®€å†™å†™æ³•\r\n      '/foo': 'http://localhost:4567',\r\n      // é€‰é¡¹å†™æ³•\r\n      '/api': {\r\n        target: 'http://jsonplaceholder.typicode.com',\r\n        changeOrigin: true,\r\n        rewrite: (path) => path.replace(/^\\/api/, ''),\r\n      },\r\n    },\r\n  },\r\n});\r\n```\r\n\r\næ‰€ä»¥ç»¼ä¸Šæ‰€è¿°ï¼Œåå‘ä»£ç†æˆ‘ä»¬ä¸€ç›´åœ¨ä½¿ç”¨å¯èƒ½ä½ å¹¶æ²¡æœ‰è§‰å¯Ÿåˆ°ã€‚\r\n\r\n## ä»€ä¹ˆæ˜¯è´Ÿè½½å‡è¡¡ï¼Ÿ\r\n\r\nè´Ÿè½½å‡è¡¡ï¼ˆLoad Balanceï¼‰è¿™ä¸ªè¯ç»å¸¸ä¼šå¬åˆ°ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯åˆ†æ‘Šåˆ°å¤šä¸ªæ“ä½œå•å…ƒä¸Šè¿›è¡Œæ‰§è¡Œã€‚\r\n\r\næ¦‚å¿µè¿˜æ˜¯ä¸å¤ªæ˜æ˜¾ï¼Œä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå¦‚æœæœ‰ä¸€ä¸ªç½‘ç«™ `www.helloworld.com`ï¼Œæ­£å¸¸æƒ…å†µä¸‹å®ƒçš„ web æ¶æ„å¦‚ä¸‹\r\n![demo1](https://pic3.zhimg.com/80/v2-6a7f624cd5e776a6b0b05a051e65666e_720w.jpg)\r\nè¿™é‡Œå¦‚æœæœåŠ¡å™¨å®•æœºäº†æˆ–è€…è¾¾åˆ°è®¿é—®ä¸Šé™å°±ä¼šå‡ºç°æ²¡åŠæ³•è®¿é—®æƒ…å†µã€‚\r\n\r\né‚£ä¹ˆè´Ÿè½½å‡è¡¡å¦‚ä½•è§£å†³å¦‚ä¸Šé—®é¢˜å‘¢ï¼Ÿ\r\n\r\n### è´Ÿè½½å‡è¡¡å¦‚ä½•è§£å†³\r\n\r\n\r\n\r\nåœ¨åç«¯å¼•å…¥ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨å’Œä¸€å°é¢å¤–çš„ web æœåŠ¡å™¨å°±å¯ä»¥ç¼“è§£è¿™ç§æƒ…å†µï¼ˆæ³¨æ„ï¼Œè¿™é‡Œçš„ web æœåŠ¡ä¼šæä¾›ä¸€è‡´çš„æœåŠ¡ï¼‰ã€‚\r\n\r\næ‰€ä»¥è´Ÿè½½å‡è¡¡çš„ä½œç”¨å°±æ˜¯åœ¨äºåˆ†æµï¼Œè€Œåƒä¸Šé¢éƒ¨ç½²ä¸¤å°æˆ–è€…ä»¥ä¸Šçš„ web æœåŠ¡ï¼Œæˆ‘ä»¬ç§°ä¸ºé›†ç¾¤ã€‚\r\n\r\nä¸‹é¢çœ‹ä¸€ä¸ª nginx çš„è´Ÿè½½å‡è¡¡ä¾‹å­ï¼Œä½œä¸ºé¢å¤–çŸ¥è¯†ç‚¹è¡¥å……\r\n\r\n### nginx è´Ÿè½½å‡è¡¡ç¤ºä¾‹\r\n\r\n```nginx\r\nhttp {\r\n     #è®¾å®šmimeç±»å‹,ç±»å‹ç”±mime.typeæ–‡ä»¶å®šä¹‰\r\n    include       /etc/nginx/mime.types;\r\n    default_type  application/octet-stream;\r\n    #è®¾å®šæ—¥å¿—æ ¼å¼\r\n    access_log    /var/log/nginx/access.log;\r\n\r\n    #è®¾å®šè´Ÿè½½å‡è¡¡çš„æœåŠ¡å™¨åˆ—è¡¨\r\n    upstream load_balance_server {\r\n        #weigthå‚æ•°è¡¨ç¤ºæƒå€¼ï¼Œæƒå€¼è¶Šé«˜è¢«åˆ†é…åˆ°çš„å‡ ç‡è¶Šå¤§\r\n        server 192.168.1.11:80   weight=5;\r\n        server 192.168.1.12:80   weight=1;\r\n        server 192.168.1.13:80   weight=6;\r\n    }\r\n\r\n   #HTTPæœåŠ¡å™¨\r\n   server {\r\n        #ä¾¦å¬80ç«¯å£\r\n        listen       80;\r\n\r\n        #å®šä¹‰ä½¿ç”¨www.xx.comè®¿é—®\r\n        server_name  www.helloworld.com;\r\n\r\n        #å¯¹æ‰€æœ‰è¯·æ±‚è¿›è¡Œè´Ÿè½½å‡è¡¡è¯·æ±‚\r\n        location / {\r\n            root        /root;                 #å®šä¹‰æœåŠ¡å™¨çš„é»˜è®¤ç½‘ç«™æ ¹ç›®å½•ä½ç½®\r\n            index       index.html index.htm;  #å®šä¹‰é¦–é¡µç´¢å¼•æ–‡ä»¶çš„åç§°\r\n            proxy_pass  http://load_balance_server ;#è¯·æ±‚è½¬å‘load_balance_server å®šä¹‰çš„æœåŠ¡å™¨åˆ—è¡¨\r\n\r\n            #ä»¥ä¸‹æ˜¯ä¸€äº›åå‘ä»£ç†çš„é…ç½®(å¯é€‰æ‹©æ€§é…ç½®)\r\n            #proxy_redirect off;\r\n            proxy_set_header Host $host;\r\n            proxy_set_header X-Real-IP $remote_addr;\r\n            #åç«¯çš„WebæœåŠ¡å™¨å¯ä»¥é€šè¿‡X-Forwarded-Forè·å–ç”¨æˆ·çœŸå®IP\r\n            proxy_set_header X-Forwarded-For $remote_addr;\r\n            proxy_connect_timeout 90;          #nginxè·Ÿåç«¯æœåŠ¡å™¨è¿æ¥è¶…æ—¶æ—¶é—´(ä»£ç†è¿æ¥è¶…æ—¶)\r\n            proxy_send_timeout 90;             #åç«¯æœåŠ¡å™¨æ•°æ®å›ä¼ æ—¶é—´(ä»£ç†å‘é€è¶…æ—¶)\r\n            proxy_read_timeout 90;             #è¿æ¥æˆåŠŸåï¼Œåç«¯æœåŠ¡å™¨å“åº”æ—¶é—´(ä»£ç†æ¥æ”¶è¶…æ—¶)\r\n            proxy_buffer_size 4k;              #è®¾ç½®ä»£ç†æœåŠ¡å™¨ï¼ˆnginxï¼‰ä¿å­˜ç”¨æˆ·å¤´ä¿¡æ¯çš„ç¼“å†²åŒºå¤§å°\r\n            proxy_buffers 4 32k;               #proxy_buffersç¼“å†²åŒºï¼Œç½‘é¡µå¹³å‡åœ¨32kä»¥ä¸‹çš„è¯ï¼Œè¿™æ ·è®¾ç½®\r\n            proxy_busy_buffers_size 64k;       #é«˜è´Ÿè·ä¸‹ç¼“å†²å¤§å°ï¼ˆproxy_buffers*2ï¼‰\r\n            proxy_temp_file_write_size 64k;    #è®¾å®šç¼“å­˜æ–‡ä»¶å¤¹å¤§å°ï¼Œå¤§äºè¿™ä¸ªå€¼ï¼Œå°†ä»upstreamæœåŠ¡å™¨ä¼ \r\n\r\n            client_max_body_size 10m;          #å…è®¸å®¢æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å•æ–‡ä»¶å­—èŠ‚æ•°\r\n            client_body_buffer_size 128k;      #ç¼“å†²åŒºä»£ç†ç¼“å†²ç”¨æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å­—èŠ‚æ•°\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nè¿™é‡Œåœ¨è®¿é—® www.helloworld.com ä¼šæŒ‰ç…§ä»¥ä¸‹æƒé‡è®¿é—®\r\n\r\n- 192.168.1.13:80\r\n- 192.168.1.11:80\r\n- 192.168.1.12:80\r\n\r\n## nginx å¸¸è§å‘½ä»¤\r\n\r\n| å‘½ä»¤                         | æè¿°                                                                                               |\r\n| ---------------------------- | -------------------------------------------------------------------------------------------------- |\r\n| <kbd>nginx -s stop</kbd>     | å¿«é€Ÿå…³é—­ Nginxï¼Œå¯èƒ½ä¸ä¿å­˜ç›¸å…³ä¿¡æ¯ï¼Œå¹¶è¿…é€Ÿç»ˆæ­¢ web æœåŠ¡ã€‚                                          |\r\n| <kbd>nginx -s quit</kbd>     | å¹³ç¨³å…³é—­ Nginxï¼Œä¿å­˜ç›¸å…³ä¿¡æ¯ï¼Œæœ‰å®‰æ’çš„ç»“æŸ web æœåŠ¡ã€‚                                              |\r\n| <kbd>nginx -s reload</kbd>   | å› æ”¹å˜äº† Nginx ç›¸å…³é…ç½®ï¼Œéœ€è¦é‡æ–°åŠ è½½é…ç½®è€Œé‡è½½ã€‚                                                  |\r\n| <kbd>nginx -s reopen</kbd>   | é‡æ–°æ‰“å¼€æ—¥å¿—æ–‡ä»¶ã€‚                                                                                 |\r\n| <kbd>nginx -c filename</kbd> | ä¸º Nginx æŒ‡å®šä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œæ¥ä»£æ›¿ç¼ºçœçš„ã€‚                                                          |\r\n| <kbd>nginx -t</kbd>          | ä¸è¿è¡Œï¼Œä»…ä»…æµ‹è¯•é…ç½®æ–‡ä»¶ã€‚nginx å°†æ£€æŸ¥é…ç½®æ–‡ä»¶çš„è¯­æ³•çš„æ­£ç¡®æ€§ï¼Œå¹¶å°è¯•æ‰“å¼€é…ç½®æ–‡ä»¶ä¸­æ‰€å¼•ç”¨åˆ°çš„æ–‡ä»¶ã€‚ |\r\n| <kbd>nginx -v</kbd>          | æ˜¾ç¤º nginx çš„ç‰ˆæœ¬ã€‚                                                                                |\r\n| <kbd>nginx -V</kbd>          | æ˜¾ç¤º nginx çš„ç‰ˆæœ¬ï¼Œç¼–è¯‘å™¨ç‰ˆæœ¬å’Œé…ç½®å‚æ•°ã€‚                                                          |\r\n\r\nè¿™é‡Œçš„ nginx -t è¿˜æœ‰ä¸€ä¸ªé¢å¤–ä½œç”¨ï¼Œåœ¨ä¸æŒ‡å®š-c çš„æƒ…å†µä¸‹ä¼šæµ‹è¯•é»˜è®¤çš„é…ç½®æ–‡ä»¶ï¼Œä¸”ä¼šè¾“å‡ºä¸€å¥é¢å¤–ä¿¡æ¯\r\n\r\n```sh\r\nginx: the configuration file /etc/nginx/nginx.conf syntax is ok\r\nnginx: configuration file /etc/nginx/nginx.conf test is successful\r\n```\r\n\r\nå¯ä»¥ä»ä¸Šé¢ä¿¡æ¯è·å–åˆ°é»˜è®¤çš„é…ç½®æ–‡ä»¶è·¯å¾„\r\n\r\n## location åŒ¹é…è§„åˆ™\r\n\r\n| åç§°           | æè¿°                                                               |\r\n| -------------- | ------------------------------------------------------------------ |\r\n| <kbd>=</kbd>   | è¡¨ç¤ºç²¾ç¡®åŒ¹é…                                                       |\r\n| <kbd>~</kbd>   | è¡¨ç¤ºè¯¥è§„åˆ™æ˜¯ä½¿ç”¨æ­£åˆ™å®šä¹‰çš„ï¼ŒåŒºåˆ†å¤§å°å†™                             |\r\n| <kbd>~\\*</kbd> | è¡¨ç¤ºè¯¥è§„åˆ™æ˜¯ä½¿ç”¨æ­£åˆ™å®šä¹‰çš„ï¼Œä¸åŒºåˆ†å¤§å°å†™                           |\r\n| <kbd>^~</kbd>  | è¡¨ç¤ºå¦‚æœè¯¥ç¬¦å·åé¢çš„å­—ç¬¦æ˜¯æœ€ä½³åŒ¹é…ï¼Œé‡‡ç”¨è¯¥è§„åˆ™ï¼Œä¸å†è¿›è¡Œåç»­çš„æŸ¥æ‰¾ |\r\n| <kbd>/</kbd>   | é€šç”¨åŒ¹é…                                                           |\r\n\r\nå®ƒä»¬ä¹‹å‰ä¼˜å…ˆçº§å¦‚ä¸‹\r\n\r\n1. å¦‚æœåŒ¹é…åˆ° `=` ä¸å†å¯»æ‰¾ï¼›\r\n2. å¦‚æœåŒ¹é…åˆ° `^~` ä¸å†å¯»æ‰¾ï¼›\r\n3. å¦‚æœåŒ¹é…åˆ°æ­£åˆ™è§„åˆ™ï¼ˆå­˜åœ¨å¤šæ¡å–ç¬¬ä¸€æ¡åŒ¹é…ï¼‰ï¼Œä¸å†æŸ¥æ‰¾ï¼›\r\n4. åŒ¹é…ä¸å¸¦ä»»ä½•å‰ç¼€çš„è§„åˆ™ï¼Œä¾‹å¦‚ `location /user/`\r\n5. å¦‚æœéƒ½ä¸å­˜åœ¨ï¼ŒåŒ¹é… `/`;\r\n\r\n### location å®æˆ˜\r\n\r\nä¸‹é¢çœ‹ä¸€ä¸ªä¾‹å­ï¼Œå‡è®¾ nginx é…ç½®å¦‚ä¸‹\r\n\r\n```nginx\r\nlocation = / {\r\n    [ configuration A ]\r\n}\r\n\r\nlocation / {\r\n    [ configuration B ]\r\n}\r\n\r\nlocation /user/ {\r\n    [ configuration C ]\r\n}\r\n\r\nlocation ^~ /images/ {\r\n    [ configuration D ]\r\n}\r\n\r\nlocation ~* \\.(gif|jpg|jpeg)$ {\r\n    [ configuration E ]\r\n}\r\n```\r\n\r\nåˆ†åˆ«è¯·æ±‚ä»¥ä¸‹å†…å®¹ä¼šåŒ¹é…åˆ°é‚£æ¡è§„åˆ™å‘¢ï¼Ÿ\r\n\r\n- /\r\n- /index.html\r\n- /user/index.html\r\n- /images/1.jpg\r\n- /documents/about.html\r\n\r\n## alias ä¸ root åŒºåˆ«\r\n\r\nalias ä¸ root æœ‰ç€ç»†å¾®çš„å·®å¼‚ï¼Œä»¥ä¸‹é¢ nginx é…ç½®ä¸ºä¾‹\r\n\r\n```nginx\r\nserver {\r\n  # çœç•¥å…¶ä»–\r\n  # è‡ªå®šä¹‰ä¸€äº›å˜é‡\r\n  set $path /usr/share/nginx/html/icare/dist;\r\n\r\n  charset utf-8;\r\n\r\n  location / {\r\n    root $path;\r\n    index index.html;\r\n    try_files $uri $uri/ /index.html;\r\n  }\r\n\r\n  location /media/ {\r\n    expires 1h;\r\n    alias /usr/share/nginx/html/icare/static/download/;\r\n  }\r\n\r\n  location ^~ /app/center/assets {\r\n    alias $path/assets/;\r\n    gzip on;\r\n    gzip_http_version 1.1;\r\n    gzip_min_length 1k;\r\n    gzip_comp_level 5;\r\n    gzip_types *;\r\n    expires 30d;\r\n  }\r\n\r\n}\r\n\r\n```\r\n\r\né™æ€èµ„æºçš„å­˜æ”¾è·¯å¾„ä¸ºï¼š `/usr/share/nginx/html/icare/dist`\r\n\r\né™æ€èµ„æºçš„å…¬å…±å‰ç¼€ä¸º/app/center/ï¼Œæ­¤å‰ç¼€æ˜¯é€šè¿‡ vite è®¾ç½® base æ¥å®Œæˆçš„\r\n\r\n```js\r\nbase: command === 'build' ? '/app/center/' : '/';\r\n```\r\n\r\nè€Œå‡å®šæˆ‘ä»¬è¯·æ±‚ä¸€ä¸ªèµ„æº `http://10.0.40.33:8000/app/center/assets/index.d1eb2512.js`\r\n\r\nå¦‚æœä¸Šé¢çš„ alias ä¸º `root` å°±ä¼šè¯·æ±‚ `/usr/share/nginx/html/icare/dist/app/center/assets/index.d1eb2512.js` è¿™æ¡èµ„æº\r\n\r\nè€Œå®é™…ä¸Š app/center è¿™ä¸ªç›®å½•æ˜¯ä¸å­˜åœ¨ï¼Œå¦‚æœä½¿ç”¨ root æŒ‡ä»¤å°±ä¼šå¯¼è‡´èµ„æºæ— æ³•æ­£å¸¸åŠ è½½ã€‚\r\n\r\nå¯¹æ­¤ä½¿ç”¨ aliasa æŒ‡ä»¤æ¥æŒ‡å®šç›®å½•ï¼Œè¿˜æ˜¯ä»¥ä¸Šé¢èµ„æºä¸ºä¾‹ï¼ŒæŒ‡å®š alias æƒ…å†µä¸‹ï¼ŒçœŸæ­£è¯·æ±‚çš„èµ„æºåœ°å€ä¸º `/usr/share/nginx/html/icare/dist/assets/index.d1eb2512.js`\r\n\r\næ‰€ä»¥æ¦‚æ‹¬ä¸€ä¸‹ï¼š\r\n\r\n- root è¯·æ±‚çš„èµ„æºè·¯å¾„ä¸º root + location åŒ¹é…è§„åˆ™ + èµ„æºåç¼€ï¼ˆindex.d1eb2512.jsï¼‰\r\n- alias è¯·æ±‚èµ„æºè·¯å¾„ä¸º alias + èµ„æºåç¼€ï¼ˆindex.d1eb2512.jsï¼‰\r\n\r\n## å®æˆ˜\r\n\r\nä¸Šé¢ç®€çŸ­çš„ä»‹ç»äº†ä¸€ä¸‹ nginx çš„ä¸€äº›çŸ¥è¯†ç‚¹ï¼Œä¸‹é¢çœ‹å‡ ç§å¸¸è§çš„åœºæ™¯\r\n\r\n- éƒ¨ç½²é™æ€ç«™ç‚¹\r\n- éƒ¨ç½² spa å•é¡µé¢\r\n\r\n### éƒ¨ç½²é™æ€ç«™ç‚¹\r\n\r\nä¸éœ€è¦ä»»ä½•åç«¯æœåŠ¡çš„é¡¹ç›®ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªçº¯å±•ç¤ºä¿¡æ¯ï¼Œå‡è®¾é™æ€èµ„æºæ”¾ç½®åˆ°äº†/app/dist ä¸‹\r\n\r\n```nginx\r\nworker_processes  1;\r\n\r\nevents {\r\n\tworker_connections  1024;\r\n}\r\n\r\nhttp {\r\n    include       mime.types;\r\n    default_type  application/octet-stream;\r\n    sendfile        on;\r\n    keepalive_timeout  65;\r\n\r\n    gzip on;\r\n    gzip_types text/plain application/x-javascript text/css application/xml text/javascript application/javascript image/jpeg image/gif image/png;\r\n    gzip_vary on;\r\n\r\n    server {\r\n\t\tlisten       80;\r\n\t\tserver_name  static.zp.cn;\r\n\r\n\t\tlocation / {\r\n\t\t\troot /app/dist;\r\n\t\t\tindex index.html;\r\n\t\t\t#è½¬å‘ä»»ä½•è¯·æ±‚åˆ° index.html\r\n\t\t}\r\n\t}\r\n}\r\n```\r\n\r\nè¿è¡Œ nginx å°±å¯ä»¥çœ‹åˆ°å±•ç¤ºçš„ä¿¡æ¯äº†ã€‚\r\n\r\n### éƒ¨ç½² spa å•é¡µé¢\r\n\r\nspa å•é¡µé¢éƒ¨ç½²å¯ä»¥æ ¹æ®è·¯ç”±åˆ†ä¸º history å’Œ hash æ¨¡å¼ï¼Œå³(/hello or #hello)åŒºåˆ«ã€‚\r\n\r\n- hash è·¯ç”±\r\n\r\n![hash](https://user-images.githubusercontent.com/39508895/171322500-143846c6-7d38-4909-99e0-c2d7c9dc0927.jpg)\r\n\r\n- history è·¯ç”±\r\n\r\n![history](https://user-images.githubusercontent.com/39508895/171322578-5d9dc8a3-841b-417b-9995-b74d1e5e5286.jpg)\r\n\r\n\r\nå¯¹äº hash åªéœ€è¦å‰ç«¯è¿™è¾¹è·¯ç”±å¤„ç†å³å¯ä¸æ¶‰åŠåˆ°æœåŠ¡ç«¯ï¼Œæ‰€ä»¥åªéœ€è¦ç¡®ä¿æŒ‡å‘æ­£ç¡®çš„ index.html å³å¯ã€‚\r\n\r\nè€Œ history æ¨¡å¼éœ€è¦åˆ™ä¿è¯åœ¨åˆ·æ–°é¡µé¢ä¹‹åï¼Œç”¨æˆ·è¯·æ±‚çš„é¡µé¢åœ°å€ä¾ç„¶å¯ä»¥æ­£ç¡®è¿”å›å†…å®¹ï¼Œåé¢ä¼šè¯¦ç»†ä»‹ç»ï¼Œä¸‹é¢çœ‹ä¸€ä¸‹ hash æ¨¡å¼ nginx å¦‚ä½•é…ç½®ï¼Ÿ\r\n\r\n#### hash nginx é…ç½®\r\n\r\n```nginx\r\nworker_processes 1;\r\n\r\nevents {\r\n  worker_connections 1024;\r\n}\r\n\r\nhttp {\r\n  include mime.types;\r\n  default_type application/octet-stream;\r\n  sendfile on;\r\n  keepalive_timeout 65;\r\n\r\n  gzip on;\r\n  gzip_types text/plain application/x-javascript text/css application/xml text/javascript application/javascript image/jpeg image/gif image/png;\r\n  gzip_vary on;\r\n\r\n  root /app/dist;\r\n\r\n  server {\r\n    listen 80;\r\n    server_name static.zp.cn;\r\n\r\n    location / {\r\n      index index.html index.htm;\r\n    }\r\n    location ^~ /assets/ {\r\n      add_header Cache-Control \"public,max-age=31536000\";\r\n      # Allow cross origin access\r\n      add_header Access-Control-Expose-Headers \"Access-Control-Allow-Origin\";\r\n      add_header Access-Control-Allow-Origin \"*\";\r\n    }\r\n\r\n  }\r\n}\r\n```\r\n\r\nè¿™é‡Œæ–°å¢äº† `^~ /assets/`å®ƒçš„æ„æ€æ˜¯å¦‚æœè¯·æ±‚ url åŒ…å«/assets/å†…å®¹å°±é‡‡ç”¨è¯¥åŒ¹é…è§„åˆ™ã€‚\r\n\r\n#### history nginx é…ç½®\r\n\r\n```nginx\r\nworker_processes 1;\r\n\r\nevents {\r\n  worker_connections 1024;\r\n}\r\n\r\nhttp {\r\n  include mime.types;\r\n  default_type application/octet-stream;\r\n  sendfile on;\r\n  keepalive_timeout 65;\r\n\r\n  gzip on;\r\n  gzip_types text/plain application/x-javascript text/css application/xml text/javascript application/javascript image/jpeg image/gif image/png;\r\n  gzip_vary on;\r\n\r\n  root /app/dist;\r\n\r\n  server {\r\n    listen 80;\r\n    server_name static.zp.cn;\r\n\r\n    location / {\r\n      try_files $uri /index.html;\r\n      index index.html index.htm;\r\n    }\r\n    location ^~ /assets/ {\r\n      add_header Cache-Control \"public,max-age=31536000\";\r\n      # Allow cross origin access\r\n      add_header Access-Control-Expose-Headers \"Access-Control-Allow-Origin\";\r\n      add_header Access-Control-Allow-Origin \"*\";\r\n    }\r\n\r\n  }\r\n}\r\n```\r\n\r\nå¯¹æ¯”ä¹‹ä¸‹ history æ¨¡å¼åˆ™å¤šäº†ä¸€ä¸ª try_filesã€‚\r\n\r\ntry_files çš„ä½œç”¨æ˜¯æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨è¿”å›è¯¥æ–‡ä»¶ï¼Œå¦åˆ™è¿”å›åç½®æ–‡ä»¶ã€‚\r\n\r\nä¸¾ä¸ªä¾‹å­ è®¿é—® static.zp.cn/a çš„æ—¶å€™$uri ä¸º/aï¼Œæ­¤æ—¶æŒ‰ç…§é¡ºåºä¼šæ£€æŸ¥å¦‚ä¸‹æ–‡ä»¶\r\n\r\n- æ£€æŸ¥ /$root/a æ–‡ä»¶æ˜¯å¦å­˜åœ¨\r\n- æ£€æŸ¥ /$root/a/ ç›®å½•æ˜¯å¦å­˜åœ¨\r\n- éƒ½ä¸å­˜åœ¨è¿”å› index.html å†…å®¹\r\n\r\n> ä¸ºäº†æ¼”ç¤ºæ–¹ä¾¿æ²¡æœ‰åŒ…å«æ¥å£è¯·æ±‚ï¼Œç”Ÿäº§ç¯å¢ƒä¸­ä¸€èˆ¬ä¼šå‡ºç° proxy_pass æŒ‡å®šã€‚\r\n\r\n# æœ€å\r\n\r\nåˆ°æ­¤åˆ†äº«å°±ç»“æŸäº†ï¼Œä¸‹é¢æ˜¯ä¸€äº›å·¥å…·é“¾æ¥ï¼Œå¦‚æœæœ‰éœ€è¦å¯ä»¥æ”¶è—ã€‚\r\n\r\nå¦‚æœæ–‡ç« æœ‰é”™è¯¯çš„åœ°æ–¹ä¹Ÿæ¬¢è¿æŒ‡å‡ºã€‚\r\n\r\n- [NGINX é…ç½®ç”Ÿæˆ](https://www.digitalocean.com/community/tools/nginx?global.app.lang=zhCN)\r\n- [æ­£åˆ™å¯è§†åŒ–å·¥å…·](https://regexper.com/#)\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/93/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/93/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/92",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/92/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/92/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/92/events",
      "html_url": "https://github.com/bosens-China/blog/issues/92",
      "id": 1187971933,
      "node_id": "I_kwDOCzPAy85GzwNd",
      "number": 92,
      "title": ".gitattributes æ­£ç¡®ä½¿ç”¨å§¿åŠ¿",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 3661376441,
          "node_id": "LA_kwDOCzPAy87aPCu5",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83",
          "name": "ä»£ç è§„èŒƒ",
          "color": "5319e7",
          "default": false,
          "description": "å›¢é˜Ÿè§„èŒƒã€ä»£ç è§„èŒƒã€æŠ€æœ¯é€‰å‹ç­‰ç›¸å…³å†…å®¹"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2022-03-31T12:00:40Z",
      "updated_at": "2022-04-16T03:28:38Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "è¿™ç¯‡æ–‡ç« çš„ç”±æ¥æ˜¯å› ä¸ºé¡¹ç›®ä¸Šçš„ä¸€ä¸ªç¥å¥‡é—®é¢˜ï¼Œä¹‹å‰è§‰å¾—å†™é‡å¤çš„åˆ›å»ºé¡¹ç›®å¤ªç¹çå°±å°è£…äº†ä¸€ä¸ª[åˆ›å»ºæ¨¡æ¿æ–‡ä»¶ CLI](https://github.com/bosens-China/template-create) ï¼Œå½“æ—¶å¿ƒæƒ³è‡ªå·±çœŸæ˜¯ä¸€ä¸ªä¸Šè¿›çš„å°ä¼™å­ã€‚\r\n\r\nåæ¥æŸå¤© xx é¢†å¯¼å¯¹æˆ‘è¯´æœ‰ä¸€ä¸ªæ–°é¡¹ç›®äº¤ç»™æˆ‘åšï¼Œå½“æ—¶å¿ƒæƒ³ç»ˆäºå¯ä»¥å¤§å±•æ‹³è„šè¯•è¯•æ–°çš„å·¥å…·äº†ï¼Œä¸€é¡¿æ“ä½œåé¡¹ç›®å®Œæˆäº†ï¼Œä¸è¿‡åœ¨æ¨é€ GitLab æ—¶å‘ç°å›¾ç‰‡ç«Ÿç„¶æ— æ³•é¢„è§ˆã€‚whyï¼Ÿåé¢æ ¹æ® git log è®°å½•ä¸€ä¸ªä¸ªå›æ»šå’Œä½†æ˜¯è¿™ä¹Ÿæ— æ³•å¤ç° entireï¼Œåé¢åˆå¯¹é¡¹ç›®æ–‡ä»¶å±è”½æ£€æŸ¥ç»ˆäºå‘ç°åŸæ¥æ˜¯ .gitattributes æ–‡ä»¶å¡«å†™é—®é¢˜ã€‚\r\n\r\n> ä¹‹å‰.gitattributes å†™æ³•\r\n>\r\n> ```sh\r\n> * text eol=lf\r\n> ```\r\n\r\né‚£æ˜¯ä¸æ˜¯ç›´æ¥åˆ é™¤ .gitattributes æ–‡ä»¶å°±å¯ä»¥äº†å‘¢ï¼Ÿå¦‚æœåªè€ƒè™‘è§£å†³å›¾ç‰‡æäº¤æ ¼å¼æŸåå½“æ—¶æ˜¯æ²¡é—®é¢˜ã€‚\r\n\r\n## .gitattributes ä½œç”¨\r\n\r\nä¸è¿‡å›åˆ°æ ‡é¢˜ï¼Œå½“æ—¶ä¹‹æ‰€ä»¥åœ¨æ¨¡æ¿æ–‡ä»¶ä¸­æ·»åŠ  .gitattributes ä¸»è¦æ˜¯æœ‰ä¸¤ä¸ªç›®çš„ï¼š\r\n\r\n- ç¡®ä¿æ–‡ä»¶è¡Œå°¾åºåˆ—ç¬¦åˆä¸€è‡´ï¼Œåœ¨ windows ä¸‹è¡Œå°¾åºåˆ—ä¸º CRLF è€Œåœ¨ mac å’Œ linux åˆ™æ˜¯ LFã€‚è¡Œå°¾åºåˆ—ä¸åŒåœ¨æŸäº› Eslint è§„åˆ™ä¸‹ä¼šæ˜¾ç¤ºæŠ¥é”™ï¼Œè¿™æ˜¯ä¸ºäº†è§„èŒƒä½ çš„ä»£ç ã€‚\r\n\r\n![Code File With Prettier Linting Errors - .gitattributes](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/2/11/17033a0f5ed87f6c~tplv-t2oaga2asx-zoom-in-crop-mark:1304:0:0:0.awebp)\r\n\r\n- é¿å… git æäº¤è®°å½•è«åå·®å¼‚ï¼Œä¾‹å¦‚ä»ä»“åº“ä¸‹æ‹‰å–äº†ä¸€ä¸ªé¡¹ç›®ï¼Œæ›´æ”¹äº†ä¸€ä¸ªæŸä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹å‘ç°ä¸å¯¹åˆæ’¤é”€äº†ï¼Œä½†æ˜¯å› ä¸ºç³»ç»Ÿä¸åŒè¡Œå°¾åºåˆ—å·²ç»å‘ç”Ÿäº†å˜æ›´ï¼Œgit ä¼šæ˜¾ç¤ºè¿™ä¸ªæ–‡ä»¶çš„å·®å¼‚ã€‚\r\n\r\n![image-20220410152753128.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4843f675b9cd448eaafa3e944cc5d7ec~tplv-k3u1fbpfcp-watermark.image?)\r\n\r\n> ä»¥ä¸Šæ“ä½œæ˜¯å‡è®¾ä»“åº“çš„æ–‡ä»¶æ˜¯ LF æ ¼å¼ï¼Œä¸”ä½ æ˜¯ windows ç”µè„‘ä¸‹æ“ä½œ\r\n\r\n## å¦‚ä½•ç¼–å†™.gitattributes æ–‡ä»¶\r\n\r\næŒ‰ç…§å¼€å¤´æˆ‘æœ€åˆçš„å†™æ³•è‚¯å®šæ˜¯é”™è¯¯çš„\r\n\r\n```sh\r\n* text eol=lf\r\n```\r\n\r\nè¿™é‡Œä¼šæŠŠä»£ç çš„æ‰€æœ‰æ–‡ä»¶éƒ½ LF åŒ–ï¼Œå¯¹äºæ–‡æœ¬æ–‡ä»¶æ˜¯æ²¡é—®é¢˜çš„ï¼Œä½†æ˜¯å¯¹äºä¸€äº›å›¾ç‰‡æ–‡ä»¶ã€pdf ç­‰äºŒè¿›åˆ¶æ–‡ä»¶å°±ä¼šå¯¼è‡´é¢å¤–çš„é—®é¢˜ã€‚\r\n\r\nè¿™é‡Œå‚è€ƒä¸¤ä¸ªåº“çš„å†™æ³• [v8 .gitattributes](https://github.com/v8/v8/blob/main/.gitattributes)\r\n\r\n```sh\r\n# Automatically normalize line endings (to LF) for all text-based files.\r\n* text=auto eol=lf\r\n# Do not modify line endings for binary files (which are sometimes auto\r\n# detected as text files by git).\r\n*.png binary\r\n# Don't include minified JS in git grep/diff output\r\ntest/mjsunit/asm/sqlite3/*.js -diff\r\n```\r\n\r\nä¸Šé¢ä¼šæŠŠæ‰€æœ‰çš„æ–‡ä»¶éƒ½ LF åŒ–ï¼Œä¸åŒçš„æ˜¯å•ç‹¬ä¸ºéœ€è¦çš„èµ„æºæ·»åŠ äº† binaryï¼Œè€Œç¿»é˜… git å®˜æ–¹ [gitattributes æ–‡æ¡£](https://git-scm.com/docs/gitattributes) å¯ä»¥çœ‹åˆ°\r\n\r\n> å¦‚æœä½ ä¸å¸Œæœ›äº§ç”Ÿæ–‡æœ¬å·®å¼‚ï¼Œä»¥åŠè¡Œå°¾è½¬æ¢åº”ç”¨åˆ°ä»»ä½•äºŒè¿›åˆ¶æ–‡ä»¶ã€‚å¯ä»¥ä½¿ç”¨ç³»ç»Ÿå†…ç½®çš„ binaryï¼Œå®ƒä¼šå–æ¶ˆ text å’Œ diff å±æ€§ã€‚\r\n\r\nè€Œç¬¬ä¸‰è¡Œ `test/mjsunit/asm/sqlite3/*.js -diff` åˆ™æ˜¯è¯´ä¸è¦è·Ÿè¸ª diff å·®å¼‚ã€‚\r\n\r\nå†æ¥çœ‹ä¸€ä¸ª [pdf .gitattributes](https://github.com/mozilla/pdf.js/blob/master/.gitattributes)\r\n\r\n```sh\r\n# Force Unix line endings for most file formats (except binary files)\r\n*.js         text eol=lf\r\n*.jsm        text eol=lf\r\n*.css        text eol=lf\r\n*.html       text eol=lf\r\n*.md         text eol=lf\r\n*.properties text eol=lf\r\n*.yml        text eol=lf\r\n*.json       text eol=lf\r\n*.config     text eol=lf\r\n*.inc        text eol=lf\r\n*.manifest   text eol=lf\r\n*.rdf        text eol=lf\r\n*.jade       text eol=lf\r\n*.coffee     text eol=lf\r\n\r\n# PDF files shall not modify CRLF line endings\r\n*.pdf -crlf\r\n\r\n# Linguist language overrides\r\n*.js linguist-language=JavaScript\r\n*.jsm linguist-language=JavaScript\r\n*.inc linguist-language=XML\r\n```\r\n\r\nå®ƒå°†èµ„æºå‰ç½®åŒ–å¤„ç†ï¼Œéœ€è¦çš„æ–‡ä»¶å…¨éƒ¨ LF å¤„ç†ï¼Œè€Œ `*.pdf -crlf` åˆ™æ˜¯è¯´å¼ºåˆ¶ crlf å¤„ç†ï¼Œä¸‹é¢çš„ `linguist-language` æ˜¯ [Linguist](https://github.com/github/linguist) åº“çš„å±æ€§ï¼Œå®ƒç”¨äºç”Ÿæˆæˆ‘ä»¬å¸¸è§çš„è¯­è¨€åˆ†å¸ƒ\r\n\r\n![image-20220410155340149.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f64c46b840a84381bfcea21d0fe87235~tplv-k3u1fbpfcp-watermark.image?)\r\n\r\nç»¼åˆä¸Šé¢ä¸¤ä¸ªåº“æ¥çœ‹ï¼Œæœ‰ä¸¤ç§ç¼–å†™ .gitattributes çš„æ–¹å¼\r\n\r\n### å‰ç½®åæ·»åŠ \r\n\r\nè¿™å°±æ˜¯ [pdf.js](https://github.com/mozilla/pdf.js) æ‰€é‡‡ç”¨çš„ï¼Œå°†éœ€è¦ç”¨çš„åºåˆ—åŒ–ï¼Œä¾‹å¦‚å¦‚æœä½ æ˜¯ React é¡¹ç›®ï¼Œåªå¯èƒ½åªéœ€è¦è¿™æ ·æŒ‡å®š\r\n\r\n```sh\r\n*.js        text eol=lf\r\n*.jsm       text eol=lf\r\n*.jsx     \ttext eol=lf\r\n*.ts        text eol=lf\r\n*.tsx   \ttext eol=lf\r\n*.json      text eol=lf\r\n*.css       text eol=lf\r\n*.html      text eol=lf\r\n```\r\n\r\nåé¢å¦‚æœè¿˜æœ‰æ–°çš„éœ€è¦è¡Œå°¾åºåˆ—çš„åç¼€å¯ä»¥ç»§ç»­æ·»åŠ \r\n\r\n### å…¨å±€åæ·»åŠ \r\n\r\nè¿™æ˜¯ [V8](https://github.com/v8/v8) çš„åšæ³•ï¼Œå‡å®šæ‰€æœ‰èµ„æºéƒ½æ˜¯æ–‡æœ¬ç›¸å…³ï¼Œå¦‚æœåç»­æœ‰æ–°çš„äºŒè¿›åˆ¶æ–‡ä»¶å†å¯¹ .gitattributes æ–‡ä»¶è¿›è¡Œç¼–è¾‘ã€‚\r\n\r\n```sh\r\n* text eol=lf\r\n# å¦‚æœæœ‰æ–°çš„äºŒè¿›åˆ¶æ–‡ä»¶\r\n* png eol=binary\r\n```\r\n\r\n## è¿ç§»æŒ‡å—\r\n\r\nå¦‚æœä½ çš„é¡¹ç›®å·²ç»å­˜åœ¨å¾ˆä¹…ï¼Œä½†æ˜¯ä¹Ÿæƒ³æ·»åŠ  .gitattributes æ–‡ä»¶æ¥ç»Ÿä¸€è¡Œå°¾åºåˆ—ï¼Œä¸‹é¢å°±ä»‹ç»ä¸€ä¸‹ç›¸å…³æ–¹æ³•ã€‚\r\n\r\n1. æ·»åŠ ç›¸å…³çš„ .gitattributes æ–‡ä»¶åˆ°é¡¹ç›®ï¼ˆè¯¦æƒ…è§å¦‚ä½•ç¼–å†™.gitattributes æ–‡ä»¶\r\n2. è¿è¡Œ `git add .` æ·»åŠ æ‰€æœ‰æ–‡ä»¶\r\n3. è¿è¡Œ `git commit -m \"Saving files before refreshing line endings\"` æ¥ä¿å­˜æœ¬æ¬¡æ›´æ”¹\r\n4. åˆ é™¤æ‰€æœ‰æ–‡ä»¶ï¼Œä¸åŒ…æ‹¬ .git ç›®å½•ï¼Œ`git rm -rf --cached .`\r\n5. è¿è¡Œ `git reset --hard HEAD`ï¼Œæ¢å¤ä¸Šä¸€æ¬¡çš„æäº¤ï¼Œè¿™é‡Œä¼šå¾—åˆ°æ­£ç¡®çš„è¡Œå°¾åºåˆ—\r\n\r\n## å…¼å®¹æŒ‡å—\r\n\r\nå¦‚æœä½ å‘ç° monorepo é¡¹ç›®ä¸­è¿˜æ˜¯æ²¡æœ‰å¾—åˆ°æ­£ç¡®çš„è¡Œå°¾åºåˆ—ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹ä¸‹é¢ [ .gitattributes çš„å†™æ³•](https://gist.github.com/dpalomar/ebc64d6f56cfc25a3e5c20fe7cdfbd4f)\r\n\r\n```sh\r\n* text=auto\r\n\r\n# Force the following filetypes to have unix eols, so Windows does not break them\r\n*.* text eol=lf\r\n\r\n# Windows forced line-endings\r\n/.idea/* text eol=crlf\r\n\r\n#\r\n## These files are binary and should be left untouched\r\n#\r\n\r\n# (binary is a macro for -text -diff)\r\n*.png binary\r\n```\r\n\r\næ·»åŠ äº†å…¼å®¹æ€§çš„å†™æ³•ï¼Œå¼ºåˆ¶åœ¨ window ä¸‹ lf åŒ–\r\n\r\n## æœ€å\r\n\r\nå¦‚æœæ–‡ç« æœ‰ç›¸å…³é”™è¯¯æ¬¢è¿æŒ‡å‡º\r\n\r\n> å‚è€ƒäº†\r\n>\r\n> - [é…ç½® Git å¤„ç†è¡Œç»“æŸç¬¦](https://docs.github.com/cn/get-started/getting-started-with-git/configuring-git-to-handle-line-endings)\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/92/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/92/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/91",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/91/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/91/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/91/events",
      "html_url": "https://github.com/bosens-China/blog/issues/91",
      "id": 1187970892,
      "node_id": "I_kwDOCzPAy85Gzv9M",
      "number": 91,
      "title": "yarn.lock å¼•å‘çš„è¡€æ¡ˆ",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1371686609,
          "node_id": "MDU6TGFiZWwxMzcxNjg2NjA5",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/JavaScript",
          "name": "JavaScript",
          "color": "F7DF1E",
          "default": false,
          "description": "JavaScriptç³»åˆ—çš„æ–‡ç« "
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2022-03-31T11:59:44Z",
      "updated_at": "2022-04-08T11:14:47Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "æœ€è¿‘å¼€å‘é¡¹ç›®çš„æ—¶å€™é‡åˆ°ä¸€ä¸ªç¥å¥‡çš„ bugï¼Œåœ¨å›æ»šäº†æ— æ•°æ¬¡ä¹‹åç»ˆäºå®šä½åˆ°äº†é—®é¢˜ï¼Œå°±æ˜¯ yarn.lock å¼•èµ·çš„ï¼Œå½“æ—¶å‡çº§ç›¸å…³ä¾èµ–ç‰ˆæœ¬ä¸å°å¿ƒæŠŠ yanr.lock æ–‡ä»¶ç»™å¹²æ‰äº†ï¼Œå¯¼è‡´ä¾èµ–å¼•ç”¨çš„æ¨¡å—æœ‰é—®é¢˜ã€‚\r\n\r\nä¸è¿‡è¿™ä¹Ÿå¼•èµ·äº†æˆ‘çš„æ€è€ƒä¸ºä»€ä¹ˆ yarn è¦æœ‰ä¸€ä¸ª `yarn.lock` æ–‡ä»¶å‘¢ï¼Ÿæˆ–è€…è¯´ä¸ºä»€ä¹ˆç°ä»£çš„åŒ…å®‰è£…éƒ½éœ€è¦æœ‰ lock æ–‡ä»¶å‘¢ï¼Ÿä¾‹å¦‚ npm çš„å«åš [package-lock.json](http://nodejs.cn/learn/the-package-lock-json-file)ï¼Œpnpm çš„å«åš `pnpm-lock.yaml`ã€‚\r\n\r\nåé¢è°ƒæŸ¥äº†ä¸€ä¸‹å‘ç°å…¶å®æ˜¯ä¸ºäº†ç¡®è®¤ä¾èµ–å…³ç³»ï¼Œè¿™é‡Œä»¥ npm çš„å‘å±•å†å²è¿›è¡Œè®²è§£ã€‚\r\n\r\n## æ‰å¹³åŒ–ä¾èµ–å®‰è£…\r\n\r\nä¸‹é¢çš„ä¾‹å­éƒ½ä»¥è¿™å¼ ä¾èµ–å›¾ä¸ºä¾‹\r\n\r\n![relyon.jpeg](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a70906a65fcb4dab971ee37e894c1e15~tplv-k3u1fbpfcp-watermark.image?)\r\n\r\nåœ¨ npm5 ä¹‹å‰ä¹Ÿå°±æ˜¯è¿˜æ²¡æœ‰ package-lock.json ä¹‹å‰ï¼Œä¼šå°†æ‰€æœ‰çš„ä¾èµ–éƒ½ä¸‹è½½åˆ° `node_modules` ç›®å½•ä¸‹ï¼Œå¦‚æœä¾èµ–è¿˜ä¾èµ–å…¶ä»–ä¾èµ–å°±ä¼šç»§ç»­ä¸‹è½½åˆ°ä¾èµ–æœ¬èº«ä¸‹çš„ `node_modules`ä¸‹ï¼Œä¾‹å¦‚ä¸Šå›¾æ‰€ç¤ºæœ€ç»ˆä¼šç”Ÿæˆå¦‚ä¸‹ä¾èµ–å…³ç³»ã€‚\r\n\r\n```sh\r\nnode_modules\r\n  modules1\r\n    a:1.0\r\n    b:1.0\r\n  modules2\r\n    a:1.0\r\n    b:2.0\r\n```\r\n\r\nè¿™æ ·åšè™½ç„¶ä¸ä¼šé‡åˆ°ä¾èµ–ç®¡ç†é—®é¢˜ï¼Œä½†æ˜¯å¾ˆæ˜æ˜¾å ç”¨ç£ç›˜ç©ºé—´å¤ªå¤§äº†ã€‚\r\nä¾‹å¦‚ä¸Šé¢æœ‰ä¸€ä¸ªå…±åŒæ¨¡å—æ˜¯ `a:1.0`ï¼Œå¦‚æœèƒ½æŠŠç›¸åŒçš„ä¾èµ–æå–å‡ºæ¥ä¸å°±æ˜¯å¯ä»¥å¤§å¤§èŠ‚çœå®‰è£…æ—¶é•¿å˜›ï¼Ÿ\r\n\r\nè€Œä¸”æœ€å…³é”®çš„æ—¶å› ä¸ºåŒ…çš„æ–‡ä»¶ä½“ç§¯å¾ˆå°ï¼Œä¾èµ–ä¸€æ—¦å¤šèµ·æ¥åå¤è¯»å†™åè€Œæˆä¸ºæ€§èƒ½çš„ç“¶é¢ˆã€‚\r\n\r\nnpm5 ä¹‹åå°±å°è¯•äº†æ‰å¹³åŒ–å®‰è£…ï¼Œå®ƒçš„æ€æƒ³å¾ˆç®€å•å°±æ˜¯å®‰è£…çš„æ—¶å€™å¦‚æœæœ‰å­ä¾èµ–å°±å®‰è£…åˆ°æ ¹ç›®å½•ä¸‹çš„ `node_modules` ï¼Œå¦‚æœè¿˜æœ‰ä¾èµ–è·Ÿæ ¹ç›®å½•ä¸‹çš„ä¾èµ–å†²çªå°±å’Œ npm5 ä¹‹å‰çš„å¤„ç†æ–¹å¼ä¸€æ ·ï¼Œåœ¨å­ä¾èµ–çš„ç›®å½•ä¸‹æ–°å»º `node_modules` ç„¶åé‡å¤ã€‚\r\nä»¥ä¸Šé¢çš„ä¾‹å­æ¼”ç¤º\r\n\r\n```sh\r\nnpm i modules1 modules2\r\n```\r\n\r\nä¼šå¾—åˆ°è¿™æ ·ä¸€ä¸ªä¾èµ–\r\n\r\n```sh\r\nnode_modules\r\n  modules1\r\n  a:1.0\r\n  b:1.0\r\n  modules2\r\n    b:2.0\r\n```\r\n\r\nè¿™æ ·åšå¾ˆæ˜æ˜¾æ”¹å–„äº†å®‰è£…æ—¶é•¿å’ŒèŠ‚çœäº†ç£ç›˜ç©ºé—´ï¼Œä½†æ˜¯å¸¦æ¥äº†ä¸€ä¸ªå®‰è£…é¡ºåºçš„é—®é¢˜ï¼Œå°±æ˜¯ä¸Šé¢æ˜¯å®‰è£… module1 ä¸ºå¼€å§‹ï¼Œä½†æ˜¯å‡è®¾å®‰è£… module2 ä¸ºå¼€å§‹å‘¢ï¼Ÿ\r\n\r\n```sh\r\nnpm i modules2 modules1\r\n```\r\n\r\nä¼šå¾—åˆ°è¿™æ ·ä¸€ä¸ªä¾èµ–\r\n\r\n```sh\r\nnode_modules\r\n  modules1\r\n  a:1.0\r\n  b:2.0\r\n  modules2\r\n    b:1.0\r\n```\r\n\r\n> æ³¨æ„ï¼Œä¸Šé¢ä¸è€ƒè™‘ç½‘é€Ÿç­‰é¢å¤–æƒ…å†µ\r\n\r\nä¼šå‘ç°ç»“æ„å·²ç»å‘ç”Ÿäº†æ”¹å˜ã€‚\r\n\r\næ¸©ä¹ ä¸€ä¸‹æŸ¥æ‰¾æ¨¡å—çš„æ–¹å¼ï¼šå¦‚æœåœ¨å½“å‰ `node_modules` æ‰¾ä¸åˆ°æ—¶ä¼šæ€ä¹ˆæŸ¥æ‰¾ï¼Ÿä¼šç»§ç»­å‘ä¸ŠæŸ¥æ‰¾ï¼Œç›´åˆ°æœ€é¡¶å±‚ä¸ºæ­¢ã€‚\r\n\r\nè€Œ module1 import çš„å¾ˆæ˜æ˜¾æ˜¯æœŸå¾… `b:1.0` è¿™ä¸ªä¾èµ–ï¼Œæœ€ç»ˆå´å¾—åˆ°äº† `b:2.0` ä¾èµ–ã€‚è¿™å°±ç»™ä»£ç æ–°å¢äº†ä¸ç¡®å®šæ€§ï¼Œæˆ‘æœ€å¼€å§‹é‡åˆ°çš„é—®é¢˜å°±æ˜¯è¿™ä¸ªåŸå› å¾—æ¥çš„ã€‚\r\n\r\n## è§£å†³æ–¹å¼\r\n\r\nä¸Šé¢æ¼”ç¤ºäº†æ‰å¹³åŒ–ä¾èµ–å¯èƒ½é‡åˆ°çš„ä¾èµ–ä¸ç¡®å®šé—®é¢˜ï¼Œé‚£èƒ½ä¸èƒ½é€šè¿‡æ–°å¢ä¸€ä¸ªæ–‡ä»¶æ¥è®°å½•æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»å‘¢ï¼Œä¹‹åå®‰è£…çš„æ—¶å€™å¤ç”¨ï¼Ÿè¿™å°±æ˜¯ yanr.lockã€package-lock.lock å’Œ pnpm-lock.yml çš„ç”±æ¥ã€‚\r\n\r\nä¸è¿‡é™¤äº†é”å®š lock æ–‡ä»¶çš„è¿™ç§æ–¹å¼è¿˜æœ‰ä»€ä¹ˆæ–°çš„åŠæ³•å‘¢ï¼Ÿpnpm ç»™å‡ºäº†ç­”æ¡ˆï¼Œå¯ä»¥ç»§ç»­é‡‡ç”¨ npm5 ä¹‹å‰çš„å®‰è£…æ–¹å¼ + è½¯è¿æ¥æ¥è§£å†³ã€‚\r\n\r\nä¸Šé¢è¯´åˆ°å› ä¸ºå®‰è£…é‡å¤çš„æ¨¡å—å¯¼è‡´å®‰è£…æ•ˆç‡å¾ˆä½ï¼Œæ‰è¢«è¿«é‡‡ç”¨æå–å…¬å…±æ¨¡å—çš„æ‰å¹³åŒ–å®‰è£…ï¼Œä½†æ˜¯å¦‚æœæŠŠå½“å‰é¡¹ç›®çš„æ¨¡å—æ”¾åˆ°æœ€é¡¶çš„ç£ç›˜æ–‡ä»¶å†…ï¼Œæ¯æ¬¡å®‰è£…æ–°çš„æ¨¡å—å…ˆæœå¯»æœ‰æ²¡æœ‰å¯¹åº”çš„ï¼Œå¦‚æœæœ‰ç»™ä¸€ä¸ªè½¯é“¾æ¥è€Œä¸ç”ŸæˆçœŸæ­£æ–‡ä»¶ï¼Œè¿™æ ·ä¸å°±æ˜¯å¤§å¤§èŠ‚çœäº†å®‰è£…æ•ˆç‡å˜›ï¼Ÿè™½ç„¶ lock æ–‡ä»¶è¿˜æ˜¯å­˜åœ¨ä½†æ˜¯å·²ç»æ”¹å–„é‡å¤ç£ç›˜çš„è¯»å†™é—®é¢˜ã€‚\r\n\r\n## æ–°çš„å±•æœ›\r\n\r\næœ€è¿‘åœ¨çŸ¥ä¹çœ‹åˆ°äº† [å¦‚ä½•çœ‹å¾…èš‚èšåœ¨ SEEConf åˆ†äº«çš„ NPM å®‰è£…ä¼˜åŒ–ï¼Œæé€Ÿ 3 å€ä¹‹å¤šï¼Ÿ](https://www.zhihu.com/question/511006062) æˆ‘è§‰å¾—è¿™å¯èƒ½æ˜¯åé¢çš„ç½‘é€Ÿä¸æ–­æå‡ä½†æ˜¯åŒ…å®‰è£…ä¾ç„¶å¾ˆæ…¢çš„è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯ç›®å‰è¿˜æœªå¼€æºæ‰€ä»¥æš‚æœªèƒ½ä½“éªŒã€‚\r\n\r\n## æœ€å\r\n\r\nå¦‚æœæœ‰ä»€ä¹ˆé”™è¯¯æ¬¢è¿æŒ‡å‡ºã€‚\r\n\r\n> å‚è€ƒäº†ä¸€äº›æ–‡ç« ï¼š\r\n>\r\n> - [æ·±å…¥æµ…å‡º tnpm rapid æ¨¡å¼ - å¦‚ä½•æ¯” pnpm å¿« 10 ç§’](https://zhuanlan.zhihu.com/p/455809528)\r\n> - [å…³äºç°ä»£åŒ…ç®¡ç†å™¨çš„æ·±åº¦æ€è€ƒâ€”â€”ä¸ºä»€ä¹ˆç°åœ¨æˆ‘æ›´æ¨è pnpm è€Œä¸æ˜¯ npm/yarn?](https://juejin.cn/post/6932046455733485575#heading-7)\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/91/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/91/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/90",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/90/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/90/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/90/events",
      "html_url": "https://github.com/bosens-China/blog/issues/90",
      "id": 1115786958,
      "node_id": "I_kwDOCzPAy85CgY7O",
      "number": 90,
      "title": "vite æºç è§£æä¹‹ create-vite ",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 3661377607,
          "node_id": "LA_kwDOCzPAy87aPDBH",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/Node%E7%B3%BB%E5%88%97",
          "name": "Nodeç³»åˆ—",
          "color": "9F9262",
          "default": false,
          "description": "å’Œnode.jsç›¸å…³å†…å®¹"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2022-01-27T05:20:46Z",
      "updated_at": "2022-01-27T05:20:46Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "\r\n![home](https://user-images.githubusercontent.com/39508895/151296625-9fdcf1c2-7cfb-40b8-8c55-4ffe42540073.png)\r\n\r\n\r\nå¦‚é¢˜è¿™æ˜¯ä¸€ä¸ªç³»åˆ—æ–‡ç« ä¸è¿‡æ›´æ–°èµ·æ¥å¯èƒ½å¾ˆç¼“æ…¢ï¼Œä» [vite](https://github.com/vitejs/vite) å‡ºæ¥ä¹‹é™…æˆ‘å°±å¼€å§‹å…³æ³¨ï¼Œç›®å‰ [npm](https://www.npmjs.com/package/vite) çš„åŒ…ä¸‹è½½é‡ä¸º `1,589,416+`ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»éå¸¸ç¨³å®šäº†ã€‚è€Œä¸”å¼€å‘ååˆ†é¦™ï¼Œå®Œå…¨å°±æ˜¯å¼€ç®±å³ç”¨ï¼Œä¸‹é¢å°±æ¥æ¢è®¨ä¸€ä¸‹ vite æ˜¯å¦‚ä½•å°†é¡¹ç›®åˆ›å»ºåˆ°ç›®å½•ä¸­çš„ã€‚\r\n\r\n## ä½¿ç”¨æ–¹å¼\r\n\r\nç›®å‰æ¯”è¾ƒç«çš„ç®¡ç†ä»£ç å½¢å¼ä¸º monorepoï¼ŒVue3 å’Œ vite éƒ½é‡‡å–äº†è¿™ç§æ–¹å¼ï¼Œæ‰“å¼€ [packages](https://github.com/vitejs/vite/tree/main/packages) å¯ä»¥å¾ˆæ˜æ˜¾çœ‹åˆ°åˆ†å¸ƒåœ¨ packages ä¸‹çš„å„ä¸ªåŒ…ï¼Œè¿™ç¯‡æ–‡ç« é‡ç‚¹èŠä¸€èŠ `create-vite`ã€‚\r\n\r\næ‰“å¼€ create-vite ç›®å½•å¯ä»¥çœ‹åˆ°ä¸‹é¢ç»“æ„\r\n\r\n![ç•Œé¢](https://user-images.githubusercontent.com/39508895/151296636-12bc9f7f-8483-42d2-b75b-8a95463e9a7a.png)\r\n\r\n\r\nå…¶ä¸­ä»¥ **template-** å¼€å¤´çš„æ–‡ä»¶ä¸ºæ¨¡æ¿æ–‡ä»¶ï¼Œè€Œ \\_\\_test\\_\\_ å¼€å¤´çš„æ˜¯æµ‹è¯•æ–‡ä»¶ï¼Œ`updateVersions.ts` æ˜¯æ›´æ–°ç›¸å…³ template æ–‡ä»¶å¤¹ä¸‹çš„ `package.json` æ–‡ä»¶è®©å…¶ä¸ vite çš„ç‰ˆæœ¬å·ä¿æŒä¸€è‡´ã€‚\r\n\r\næˆ‘ä»¬é‡ç‚¹çœ‹ index.js æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶è´Ÿè´£å…·ä½“çš„åˆ›å»ºï¼Œä¸è¿‡åœ¨è¯´æºç ä¹‹å‰å…ˆçœ‹ä¸‹æ–‡æ¡£çš„ä½¿ç”¨å½¢å¼\r\n\r\n- `npm init vite@latest`\r\n- `npm init vite@latest my-vue-app --template vue`\r\n\r\nè¿™é‡Œ init å…¶å®æ˜¯ä¸€ä¸ªå¿«æ·æŒ‡ä»¤ï¼Œå®ƒç›¸å½“äºæŠŠ `create-vite` ç®€åŒ–æˆåªéœ€è¦ `init create-åé¢éƒ¨åˆ†å³å¯`ï¼Œyarn ä¸‹çš„ create ä¹Ÿè·Ÿ npm init ç±»ä¼¼ã€‚\r\n\r\nå¦‚æœç›´æ¥ä½¿ç”¨ç¬¬ä¸€ç§å½¢å¼ï¼Œvite ä¼šè¯¢é—®ä¸€ç³»åˆ—ä¿¡æ¯ï¼Œä¾‹å¦‚åŒ…çš„åç§°ã€æ¨¡æ¿ç­‰ï¼Œè€Œä½¿ç”¨ç¬¬äºŒç§å½¢å¼åˆ™å¯ä»¥çœç•¥è¯¢é—®ä¿¡æ¯ã€‚\r\n\r\n> [vite é•œåƒç½‘ç«™](https://vitejs.bootcss.com/guide/#using-unreleased-commits)\r\n\r\n## æºç \r\n\r\nvite-create ä½¿ç”¨äº†ä¸‰ä¸ªæ¨¡å—ï¼Œè¿™é‡Œæå‰è¯´ä¸‹å®ƒä»¬çš„ä½œç”¨æ˜¯ä»€ä¹ˆ\r\n\r\n### minimist\r\n\r\n[minimist](https://www.npmjs.com/package/minimist) çš„ä½œç”¨å°±æ˜¯å°†å‘½ä»¤è¡Œè¾“å…¥çš„ä¿¡æ¯è§£æå‡ºæ¥ï¼Œä¾‹å¦‚ä¸Šé¢æˆ‘ä»¬ä½¿ç”¨ `npm init vite@latest my-vue-app --template vue` å®ƒä¼šå°†å…¶è§£ææˆä¸‹é¢å†…å®¹\r\n\r\n```js\r\n{\r\n  _: ['my-vue-app'],\r\n  template: 'vue'\r\n}\r\n```\r\n\r\n### prompts\r\n\r\n[prompts](https://www.npmjs.com/package/prompts) åˆ™æ˜¯ä¸ç”¨æˆ·äº¤äº’çš„ä¸€ä¸ªåŒ…ï¼Œå®ƒæä¾›äº† `input`ã€`select` ç­‰äº¤äº’æ–¹å¼ï¼Œæ›´å¤šå†…å®¹å¯ä»¥æŸ¥çœ‹æ–‡æ¡£äº†è§£ã€‚\r\n\r\n### kolorist\r\n\r\n[kolorist](https://www.npmjs.com/package/kolorist) å®ƒæ˜¯ä¸€ä¸ª color åŒ…ï¼Œä¸»è¦ä½œç”¨å°±æ˜¯è®© node å±•ç¤ºçš„æ–‡å­—æ›´æœ‰è¶£ï¼Œä¸å†æ˜¯é»˜è®¤çš„é¢œè‰²ã€‚\r\n\r\n### æµç¨‹\r\n\r\nvite-create å°†ä»»åŠ¡æ”¾åˆ°äº† init å‡½æ•°ä¸­ï¼Œä¸ºäº†ä¿æŒé˜…è¯»ä½“éªŒè¿™é‡Œç›´æ¥åœ¨ä»£ç ä¸­è¿›è¡Œè®²è§£\r\n\r\n```js\r\nasync function init() {\r\n  // è·å–é»˜è®¤è¾“å…¥çš„æ–‡ä»¶å¤¹åç§°ï¼Œä¾‹å¦‚ npm init vite@latest my-vue-app --template vue è¿™ä¸ªæ—¶å€™ targetDir ä¸º my-vue-app\r\n  let targetDir = argv._[0];\r\n  // è·å–æ˜¯å¦æœ‰æŒ‡å®šçš„ template\r\n  let template = argv.template || argv.t;\r\n  // é»˜è®¤åˆ›å»ºé¡¹ç›®åç§°\r\n  const defaultProjectName = !targetDir ? 'vite-project' : targetDir;\r\n  // prompts è¿”å›çš„ä¸€ç³»åˆ—ç»“æœ\r\n  let result = {};\r\n\r\n  /*\r\n   * prompts å¦‚æœ type ä¸º null ä¸ä¼šæ‰§è¡Œä¸‹å»ï¼Œå¹¶ä¸” prompts çš„ tasks æ˜¯æŒ‰ç…§é¡ºåºæ‰§è¡Œä¸‹å»çš„\r\n   */\r\n\r\n  try {\r\n    result = await prompts(\r\n      [\r\n        // å¦‚æœæ²¡æœ‰æŒ‡å®š targetDir åˆ™éœ€è¦ç”¨æˆ·æ‰‹åŠ¨è¾“å…¥\r\n        {\r\n          type: targetDir ? null : 'text',\r\n          name: 'projectName',\r\n          message: reset('Project name:'),\r\n          initial: defaultProjectName,\r\n          onState: (state) =>\r\n            (targetDir = state.value.trim() || defaultProjectName),\r\n        },\r\n        // å¦‚æœç›®æ ‡ç›®å½•å­˜åœ¨ï¼Œè¦æ±‚ç”¨æˆ·æŒ‡å®šå¤„ç†æ–¹å¼ï¼Œæ˜¯åˆ é™¤è¿˜æ˜¯é€€å‡º\r\n        {\r\n          type: () =>\r\n            !fs.existsSync(targetDir) || isEmpty(targetDir) ? null : 'confirm',\r\n          name: 'overwrite',\r\n          message: () =>\r\n            (targetDir === '.'\r\n              ? 'Current directory'\r\n              : `Target directory \"${targetDir}\"`) +\r\n            ` is not empty. Remove existing files and continue?`,\r\n        },\r\n        //å¦‚æœä¸Šä¸€æ­¥é€‰æ‹©åˆ é™¤ä¸º false é€€å‡º\r\n        {\r\n          type: (_, { overwrite } = {}) => {\r\n            if (overwrite === false) {\r\n              throw new Error(red('âœ–') + ' Operation cancelled');\r\n            }\r\n            return null;\r\n          },\r\n          name: 'overwriteChecker',\r\n        },\r\n        // æ ¡éªŒè¾“å…¥é¡¹ç›®åç§°æ˜¯å¦ç¬¦åˆ npm åç§°ï¼Œå¦‚æœä¸ç¬¦åˆè§„åˆ™åˆ™ä¸èƒ½é€šè¿‡\r\n        {\r\n          type: () => (isValidPackageName(targetDir) ? null : 'text'),\r\n          name: 'packageName',\r\n          message: reset('Package name:'),\r\n          initial: () => toValidPackageName(targetDir),\r\n          validate: (dir) =>\r\n            isValidPackageName(dir) || 'Invalid package.json name',\r\n        },\r\n        // ç”¨æˆ·å¦‚æœç›´æ¥ä¼ é€’çš„ template ä¸å­˜åœ¨æ¨¡æ¿ä¸­è®©å…¶é‡æ–°é€‰æ‹©\r\n        {\r\n          type: template && TEMPLATES.includes(template) ? null : 'select',\r\n          name: 'framework',\r\n          message:\r\n            typeof template === 'string' && !TEMPLATES.includes(template)\r\n              ? reset(\r\n                  `\"${template}\" isn't a valid template. Please choose from below: `\r\n                )\r\n              : reset('Select a framework:'),\r\n          initial: 0,\r\n          choices: FRAMEWORKS.map((framework) => {\r\n            const frameworkColor = framework.color;\r\n            return {\r\n              title: frameworkColor(framework.name),\r\n              value: framework,\r\n            };\r\n          }),\r\n        },\r\n        // é€‰æ‹©æ˜¯ js é¡¹ç›®è¿˜æ˜¯ ts é¡¹ç›®\r\n        {\r\n          type: (framework) =>\r\n            framework && framework.variants ? 'select' : null,\r\n          name: 'variant',\r\n          message: reset('Select a variant:'),\r\n          // @ts-ignore\r\n          choices: (framework) =>\r\n            framework.variants.map((variant) => {\r\n              const variantColor = variant.color;\r\n              return {\r\n                title: variantColor(variant.name),\r\n                value: variant.name,\r\n              };\r\n            }),\r\n        },\r\n      ],\r\n      // å¦‚æœæ²¡æœ‰é€‰æ‹© crrl + c é€€å‡º\r\n      {\r\n        onCancel: () => {\r\n          throw new Error(red('âœ–') + ' Operation cancelled');\r\n        },\r\n      }\r\n    );\r\n  } catch (cancelled) {\r\n    console.log(cancelled.message);\r\n    return;\r\n  }\r\n\r\n  // user choice associated with prompts\r\n  const { framework, overwrite, packageName, variant } = result;\r\n\r\n  const root = path.join(cwd, targetDir);\r\n  // ä¸Šé¢æåˆ°äº†å¦‚æœç›®å½•å­˜åœ¨ï¼Œåˆ™è¦æ±‚è¿›è¡Œåˆ é™¤\r\n  if (overwrite) {\r\n    emptyDir(root);\r\n  } else if (!fs.existsSync(root)) {\r\n    // å¦‚æœä¸å­˜åœ¨ç›®å½•åˆ›å»º\r\n    fs.mkdirSync(root);\r\n  }\r\n\r\n  // determine template\r\n  template = variant || framework || template;\r\n\r\n  console.log(`\\nScaffolding project in ${root}...`);\r\n\r\n  // å½“å‰æ¨¡æ¿æ–‡ä»¶æ‰€åœ¨è·¯å¾„\r\n  const templateDir = path.join(__dirname, `template-${template}`);\r\n\r\n  const write = (file, content) => {\r\n    const targetPath = renameFiles[file]\r\n      ? path.join(root, renameFiles[file])\r\n      : path.join(root, file);\r\n    if (content) {\r\n      fs.writeFileSync(targetPath, content);\r\n    } else {\r\n      copy(path.join(templateDir, file), targetPath);\r\n    }\r\n  };\r\n\r\n  /*\r\n   * å†™å…¥æ–‡ä»¶ï¼Œpackage.json å•ç‹¬å¤„ç†\r\n   */\r\n  const files = fs.readdirSync(templateDir);\r\n  for (const file of files.filter((f) => f !== 'package.json')) {\r\n    write(file);\r\n  }\r\n\r\n  const pkg = require(path.join(templateDir, `package.json`));\r\n\r\n  pkg.name = packageName || targetDir;\r\n\r\n  write('package.json', JSON.stringify(pkg, null, 2));\r\n\r\n  // è¿™é‡Œæ˜¯æŸ¥çœ‹è°ƒç”¨ç¨‹åºçš„æ˜¯ yarn è¿˜æ˜¯ npm æˆ–è€… pnpm\r\n  const pkgInfo = pkgFromUserAgent(process.env.npm_config_user_agent);\r\n  const pkgManager = pkgInfo ? pkgInfo.name : 'npm';\r\n\r\n  console.log(`\\nDone. Now run:\\n`);\r\n  if (root !== cwd) {\r\n    console.log(`  cd ${path.relative(cwd, root)}`);\r\n  }\r\n  switch (pkgManager) {\r\n    case 'yarn':\r\n      console.log('  yarn');\r\n      console.log('  yarn dev');\r\n      break;\r\n    default:\r\n      console.log(`  ${pkgManager} install`);\r\n      console.log(`  ${pkgManager} run dev`);\r\n      break;\r\n  }\r\n  console.log();\r\n}\r\n```\r\n\r\nä¸Šé¢çš„æµç¨‹è¿˜æ˜¯å¾ˆæ¸…æ™°çš„æ¦‚æ‹¬ä¸‹æ¥å°±æ˜¯\r\n\r\n- è¦æ±‚ç”¨æˆ·è¾“å…¥åˆ›å»ºæ‰€éœ€è¦çš„é¡¹ç›®åç§°ï¼ˆå¦‚æœç”¨æˆ·æŒ‡å®šè·³è¿‡\r\n- å¦‚æœé¡¹ç›®å­˜åœ¨ï¼Œåˆ™è¯¢é—®æ˜¯å¦åˆ é™¤\r\n- æ ¡éªŒè¾“å…¥çš„åç§°æ˜¯å¦ç¬¦åˆ `npm.name` çš„è¦æ±‚\r\n- å¦‚æœç”¨æˆ·æŒ‡å®š template åˆ™è¿›è¡Œæ ¡éªŒï¼ŒæŒ‡å®š template å¦‚æœä¸å­˜åœ¨é‡æ–°è¦æ±‚é€‰æ‹©\r\n- æ‹‰å–æŒ‡å®šæ¨¡æ¿ä»“åº“ï¼Œå°†å…¶ copy åˆ°ç›®æ ‡æ–‡ä»¶å¤¹ä¸‹\r\n- ä¿®æ”¹ package.json æ–‡ä»¶è¾“å…¥\r\n- è¾“å‡ºå®Œæˆä¿¡æ¯ï¼Œç»“æŸ\r\n\r\nä¹‹å‰è®²è§£ `init` å‡½æ•°ä¸ºäº†é˜…è¯»çœç•¥äº†ä¸€äº›å‰ç½®å®šä¹‰çš„å˜é‡ï¼Œè¿™é‡Œæ”¾å‡ºæ¥ã€‚\r\n\r\n```js\r\nconst cwd = process.cwd();\r\n\r\nconst FRAMEWORKS = [\r\n  {\r\n    name: 'vanilla',\r\n    color: yellow,\r\n    variants: [\r\n      {\r\n        name: 'vanilla',\r\n        display: 'JavaScript',\r\n        color: yellow,\r\n      },\r\n      {\r\n        name: 'vanilla-ts',\r\n        display: 'TypeScript',\r\n        color: blue,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: 'vue',\r\n    color: green,\r\n    variants: [\r\n      {\r\n        name: 'vue',\r\n        display: 'JavaScript',\r\n        color: yellow,\r\n      },\r\n      {\r\n        name: 'vue-ts',\r\n        display: 'TypeScript',\r\n        color: blue,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: 'react',\r\n    color: cyan,\r\n    variants: [\r\n      {\r\n        name: 'react',\r\n        display: 'JavaScript',\r\n        color: yellow,\r\n      },\r\n      {\r\n        name: 'react-ts',\r\n        display: 'TypeScript',\r\n        color: blue,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: 'preact',\r\n    color: magenta,\r\n    variants: [\r\n      {\r\n        name: 'preact',\r\n        display: 'JavaScript',\r\n        color: yellow,\r\n      },\r\n      {\r\n        name: 'preact-ts',\r\n        display: 'TypeScript',\r\n        color: blue,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: 'lit',\r\n    color: lightRed,\r\n    variants: [\r\n      {\r\n        name: 'lit',\r\n        display: 'JavaScript',\r\n        color: yellow,\r\n      },\r\n      {\r\n        name: 'lit-ts',\r\n        display: 'TypeScript',\r\n        color: blue,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: 'svelte',\r\n    color: red,\r\n    variants: [\r\n      {\r\n        name: 'svelte',\r\n        display: 'JavaScript',\r\n        color: yellow,\r\n      },\r\n      {\r\n        name: 'svelte-ts',\r\n        display: 'TypeScript',\r\n        color: blue,\r\n      },\r\n    ],\r\n  },\r\n];\r\n\r\nconst TEMPLATES = FRAMEWORKS.map(\r\n  (f) => (f.variants && f.variants.map((v) => v.name)) || [f.name]\r\n).reduce((a, b) => a.concat(b), []);\r\n\r\nconst renameFiles = {\r\n  _gitignore: '.gitignore',\r\n};\r\n```\r\n\r\n`FRAMEWORKS` å®šä¹‰äº†æ¨¡æ¿çš„ä¿¡æ¯ï¼Œè€Œ `TEMPLATES` ç®€å•æ¥è¯´å°±æ˜¯å°† `TEMPLATES.name` ä¸‹çš„ä¿¡æ¯è¿”å›ï¼Œ\r\né…åˆ prompts åšæ ¡éªŒå’Œé‡æ–°é€‰æ‹©ä½¿ç”¨ï¼Œå®ƒçš„å€¼å¦‚ä¸‹\r\n\r\n```js\r\n[\r\n  'vanilla',\r\n  'vanilla-ts',\r\n  'vue',\r\n  'vue-ts',\r\n  'react',\r\n  'react-ts',\r\n  'preact',\r\n  'preact-ts',\r\n  'lit',\r\n  'lit-ts',\r\n  'svelte',\r\n  'svelte-ts',\r\n];\r\n```\r\n\r\n`renameFiles` åˆ™æ˜¯é‡å‘½åæ–‡ä»¶ï¼Œå°†ä¸€äº›ç‰¹æ®Šçš„æ–‡ä»¶é‡æ–°å‘½åè¾“å‡ºã€‚\r\n\r\nå½“ç„¶ vite-create ä¹Ÿç”¨äº† `fs` çš„ `path` çš„ä¸€äº›æ–¹æ³•ï¼Œè¿™é‡Œé€‰å–é‡ç‚¹çš„å‡ ä¸ªå‡½æ•°è®²è§£ï¼Œå‰©ä½™çš„å‡ ä¸ªå‡½æ•°å¯ä»¥è‡ªè¡Œå»æºç æŸ¥çœ‹ [create-vite/index.js](https://github.com/vitejs/vite/blob/main/packages/create-vite/index.js)\r\n\r\n**emptyDir**\r\n\r\n```js\r\nfunction emptyDir(dir) {\r\n  if (!fs.existsSync(dir)) {\r\n    return;\r\n  }\r\n  for (const file of fs.readdirSync(dir)) {\r\n    const abs = path.resolve(dir, file);\r\n    // baseline is Node 12 so can't use rmSync :(\r\n    if (fs.lstatSync(abs).isDirectory()) {\r\n      emptyDir(abs);\r\n      fs.rmdirSync(abs);\r\n    } else {\r\n      fs.unlinkSync(abs);\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nè¿™ä¸ªæ–¹æ³•æ˜¯åˆ é™¤æ–‡ä»¶å¤¹ï¼Œnode çš„åˆ é™¤æ–‡ä»¶å¤¹å¿…é¡»ä¿è¯æ–‡ä»¶å¤¹å†…æ²¡æœ‰æ–‡ä»¶ï¼Œæ‰€ä»¥éœ€è¦é€’å½’ä¸€å±‚å±‚çš„åˆ é™¤ã€‚\r\n\r\n**isEmpty**\r\n\r\n```js\r\nfunction isEmpty(path) {\r\n  return fs.readdirSync(path).length === 0;\r\n}\r\n```\r\n\r\nè¿™ä¸ªæ–¹æ³•æ¯”è¾ƒç®€å•ï¼Œåˆ¤æ–­ç›®æ ‡æ–‡ä»¶å¤¹çš„æ–‡ä»¶æ•°é‡ï¼Œå¦‚æœä¸å­˜åœ¨è¡¨ç¤ºä¸ºç©ºã€‚\r\n\r\n**copy**\r\n\r\n```js\r\nfunction copy(src, dest) {\r\n  const stat = fs.statSync(src);\r\n  if (stat.isDirectory()) {\r\n    copyDir(src, dest);\r\n  } else {\r\n    fs.copyFileSync(src, dest);\r\n  }\r\n}\r\n```\r\n\r\né…åˆ `copyDir` æ–¹æ³•ï¼Œæ¥å®Œæˆæ•´ä½“ `copy` ç›®å½•çš„æ“ä½œ\r\n\r\n**copyDir**\r\n\r\n```js\r\nfunction copyDir(srcDir, destDir) {\r\n  fs.mkdirSync(destDir, { recursive: true });\r\n  for (const file of fs.readdirSync(srcDir)) {\r\n    const srcFile = path.resolve(srcDir, file);\r\n    const destFile = path.resolve(destDir, file);\r\n    copy(srcFile, destFile);\r\n  }\r\n}\r\n```\r\n\r\nå°† src ç›®å½•ä¸‹çš„å†…å®¹ copy åˆ° dest ä¸‹ï¼Œè¿™é‡Œé¦–å…ˆåˆ›å»º destDir ç›®å½•ï¼Œä¹‹åè°ƒç”¨ copy æ–¹æ³•ï¼Œè€Œ `copy` æ–¹æ³•åªä¼šæ‹·è´æ–‡ä»¶å¦‚æœæ˜¯æ–‡ä»¶å¤¹ç»§ç»­è°ƒç”¨ `copyDir`ã€‚\r\n\r\n## \\_\\_test\\_\\_\r\n\r\nä¸Šé¢å·²ç»æŠŠ create-vite åˆ›å»ºçš„æµç¨‹è®²äº†ä¸€éï¼Œä¸è¿‡åœ¨è½¯ä»¶å¼€å‘ä¸­å•å…ƒæµ‹è¯•ä¹Ÿæ˜¯ä¸€ä¸ªå¤§å¤´ï¼Œæ‰€ä»¥è¿™é‡Œçœ‹ä¸‹ vite-create æ˜¯æ€ä¹ˆå†™çš„å•å…ƒæµ‹è¯•ã€‚\r\n\r\nåœ¨ `cli.spec.ts` æ–‡ä»¶ä¸­ï¼Œvite å¼•ç”¨äº†ä¸¤ä¸ªåº“\r\n\r\n- [execa](https://github.com/sindresorhus/execa)ï¼šå°è£… `child_process` ä½¿ç”¨èµ·æ¥æ›´åŠ æ–¹ä¾¿ï¼›\r\n- [fs-extra](https://github.com/jprichardson/node-fs-extra)ï¼šå°è£…çš„ fs åº“ï¼Œæä¾›äº†æ›´é«˜çº§çš„ç”¨æ³•ï¼Œä¾‹å¦‚ copyã€remove ç­‰ï¼›\r\n\r\nåœ¨ jest è¿è¡Œä¹‹å‰ cli.spce.ts å®šä¹‰äº†ä¸€äº›å˜é‡\r\n\r\n```js\r\n// ..è¿”å›åˆ° index.js,package.json å­˜åœ¨çš„è¿™ä¸ªç›®å½•\r\nconst CLI_PATH = join(__dirname, '..');\r\n// é¡¹ç›®åç§°\r\nconst projectName = 'test-app';\r\n// ç”Ÿæˆçš„ç›®å½•è·¯å¾„\r\nconst genPath = join(__dirname, projectName);\r\n\r\n/*\r\n * å°è£…çš„ run æ–¹æ³•ï¼Œnode CLI_PATH ä¼šé»˜è®¤æ‰§è¡Œ CLI_PATH ä¸‹ index.js æ–‡ä»¶\r\n */\r\nconst run = (\r\n  args: string[],\r\n  options: SyncOptions<string> = {}\r\n): ExecaSyncReturnValue<string> => {\r\n  return commandSync(`node ${CLI_PATH} ${args.join(' ')}`, options);\r\n};\r\n\r\n/*\r\n * å†™å…¥ package.json æ–‡ä»¶ï¼Œä¸ºäº†æ–¹ä¾¿æµ‹è¯•åç»­çš„ package.json ä¿¡æ¯\r\n */\r\n// Helper to create a non-empty directory\r\nconst createNonEmptyDir = () => {\r\n  // Create the temporary directory\r\n  mkdirpSync(genPath);\r\n\r\n  // Create a package.json file\r\n  const pkgJson = join(genPath, 'package.json');\r\n  writeFileSync(pkgJson, '{ \"foo\": \"bar\" }');\r\n};\r\n\r\n// Vue 3 starter template\r\nconst templateFiles = readdirSync(join(CLI_PATH, 'template-vue'))\r\n  // _gitignore is renamed to .gitignore\r\n  .map((filePath) => (filePath === '_gitignore' ? '.gitignore' : filePath))\r\n  .sort();\r\n\r\n// è¿è¡Œä¹‹å‰æ‰§è¡Œæ­¥éª¤ï¼Œåªä¼šæ‰§è¡Œä¸€æ¬¡\r\nbeforeAll(() => remove(genPath));\r\n// æ¯æ¬¡è¿è¡Œä¹‹åæ‰§è¡Œæ­¥éª¤\r\nafterEach(() => remove(genPath));\r\n```\r\n\r\nokï¼Œä¸Šé¢å°±æŠŠä¸€äº›å…³é”®çš„ç‚¹è¯´äº†ï¼Œæˆ‘ä»¬æ¥é€æ¡åˆ†ææµ‹è¯•ç”¨ä¾‹\r\n\r\n### prompts for the project name if none supplied\r\n\r\n```js\r\ntest('prompts for the project name if none supplied', () => {\r\n  const { stdout, exitCode } = run([]);\r\n  expect(stdout).toContain('Project name:');\r\n});\r\n```\r\n\r\n[toContain](https://jestjs.io/zh-Hans/docs/expect) ä½œç”¨ç®€å•æ¥è¯´å°±æ˜¯åŒ¹é…æ•°ç»„æœ‰æ²¡æœ‰å½“å‰å€¼ä¿¡æ¯ï¼Œè¿™æ¡ test æ˜¯ä¸ºäº†éªŒè¯å¦‚æœæ²¡æœ‰è¾“å…¥é¡¹ç›®åç§°æ˜¯å¦å‡ºç° prompts äº¤äº’ä¿¡æ¯\r\n\r\n> è¿™é‡Œå¯ä»¥å‡ºç°äº¤äº’å¾—ç›Šäºä½¿ç”¨çš„ execa åº“ï¼Œè¿™ä¸ªæ˜¯å®ƒçš„åŠŸèƒ½ä¹‹ä¸€\r\n\r\n### prompts for the framework if none supplied\r\n\r\n```js\r\ntest('prompts for the framework if none supplied', () => {\r\n  const { stdout } = run([projectName]);\r\n  expect(stdout).toContain('Select a framework:');\r\n});\r\n```\r\n\r\næŒ‰ç…§ init å‡½æ•°çš„åˆ†æï¼Œè¾“å…¥åç§°å¹¶ä¸”é¡¹ç›®æ²¡æœ‰é‡å¤çš„ï¼Œä¸”ç”¨æˆ·ä¹Ÿæ²¡æœ‰æŒ‡å®š template å°±éœ€è¦é€‰æ‹©æ¡†æ¶äº†ï¼Œè¿™æ¡ jest å°±æ˜¯ä¸ºäº†æµ‹è¯• prompts é¡ºåºã€‚\r\n\r\n### prompts for the framework on not supplying a value for --template\r\n\r\n```js\r\ntest('prompts for the framework on not supplying a value for --template', () => {\r\n  const { stdout } = run([projectName, '--template']);\r\n  expect(stdout).toContain('Select a framework:');\r\n});\r\n```\r\n\r\nç»§ç»­æµ‹è¯• framework æƒ…å†µã€‚å¦‚æœæŒ‡å®š `--template` ä½†æ˜¯æ²¡æœ‰æŒ‡å®š vueã€reactï¼Œ minimist ä¼šå°†å…¶è§£ææˆ trueï¼Œå½“ç„¶ä¹Ÿä¸ç¬¦åˆæƒ…å†µã€‚\r\n\r\n### prompts for the framework on supplying an invalid template\r\n\r\n```js\r\ntest('prompts for the framework on supplying an invalid template', () => {\r\n  const { stdout } = run([projectName, '--template', 'unknown']);\r\n  expect(stdout).toContain(\r\n    `\"unknown\" isn't a valid template. Please choose from below:`\r\n  );\r\n});\r\n```\r\n\r\næŒ‡å®šé”™è¯¯çš„ template ä¼šå‡ºç°é”™è¯¯æç¤ºï¼Œæ ¡éªŒ init å‡½æ•°çš„éªŒè¯ã€‚\r\n\r\n### asks to overwrite non-empty target directory\r\n\r\n```js\r\ntest('asks to overwrite non-empty target directory', () => {\r\n  createNonEmptyDir();\r\n  const { stdout } = run([projectName], { cwd: __dirname });\r\n  expect(stdout).toContain(`Target directory \"${projectName}\" is not empty.`);\r\n});\r\n```\r\n\r\næµ‹è¯•é¡¹ç›®ç›®å½•å¦‚æœå­˜åœ¨æƒ…å†µï¼ŒcreateNonEmptyDir è¿™ä¸ªæ–¹æ³•å‰é¢æœ‰è®²åˆ°ï¼Œç¡®ä¿ç›®å½•ä¸€å®šå­˜åœ¨å¹¶ä¸”å†™å…¥ä¸€äº› package.json ä¿¡æ¯ã€‚\r\n\r\n### asks to overwrite non-empty current directory\r\n\r\n```js\r\ntest('asks to overwrite non-empty current directory', () => {\r\n  createNonEmptyDir();\r\n  const { stdout } = run(['.'], { cwd: genPath, input: 'test-app\\n' });\r\n  expect(stdout).toContain(`Current directory is not empty.`);\r\n});\r\n```\r\n\r\næµ‹è¯•è¾“å…¥é¡¹ç›®åç§°ä¸èƒ½ä¸º `.`ï¼Œ`.` ä¼šè¿”å›å½“å‰ `process.cwd()` ç›®å½•ï¼ŒæŒ‰ç…§ init å‡½æ•°çš„æµç¨‹ï¼Œå¦‚æœç›®å½•å­˜åœ¨ä¼šæç¤ºæ˜¯å¦åˆ é™¤ï¼Œå¦‚æœæ‰§è¡Œäº†åˆ é™¤å°±æ˜¯ä¸€ä¸ªé‡å¤§ bug äº†ã€‚\r\n\r\n### successfully scaffolds a project based on vue starter template\r\n\r\n```js\r\ntest('successfully scaffolds a project based on vue starter template', () => {\r\n  const { stdout } = run([projectName, '--template', 'vue'], {\r\n    cwd: __dirname,\r\n  });\r\n  const generatedFiles = readdirSync(genPath).sort();\r\n\r\n  // Assertions\r\n  expect(stdout).toContain(`Scaffolding project in ${genPath}`);\r\n  expect(templateFiles).toEqual(generatedFiles);\r\n});\r\n```\r\n\r\nè¿™é‡Œæµ‹è¯•äº†ä¸¤æ¡\r\n\r\n- èµ°å®Œäº†æ‰€æœ‰æµç¨‹ï¼›\r\n- ç¡®å®šè¾“å‡ºçš„æ–‡ä»¶ä¿¡æ¯å’Œ templateFiles æ˜¯ä¸€æ ·çš„ï¼›\r\n\r\n### works with the -t alias\r\n\r\n```js\r\ntest('works with the -t alias', () => {\r\n  const { stdout } = run([projectName, '-t', 'vue'], {\r\n    cwd: __dirname,\r\n  });\r\n  const generatedFiles = readdirSync(genPath).sort();\r\n\r\n  // Assertions\r\n  expect(stdout).toContain(`Scaffolding project in ${genPath}`);\r\n  expect(templateFiles).toEqual(generatedFiles);\r\n});\r\n```\r\n\r\nè¿™é‡Œä¸»è¦æ˜¯æµ‹è¯•ç®€å†™è¯­æ³•æ˜¯å¦å¯ä»¥è¯†åˆ«ã€‚\r\n\r\n## æœ€å\r\n\r\nå¦‚æœæ–‡ç« æœ‰é”™åˆ«å­—æˆ–è€…ä¸å¯¹çš„åœ°æ–¹æ¬¢è¿æŒ‡å‡ºã€‚\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/90/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/90/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/89",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/89/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/89/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/89/events",
      "html_url": "https://github.com/bosens-China/blog/issues/89",
      "id": 1103349199,
      "node_id": "I_kwDOCzPAy85Bw8XP",
      "number": 89,
      "title": "ä½¿ç”¨ TypeScript æ¥ç¼–å†™ cli ç¨‹åº",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 3661377607,
          "node_id": "LA_kwDOCzPAy87aPDBH",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/Node%E7%B3%BB%E5%88%97",
          "name": "Nodeç³»åˆ—",
          "color": "9F9262",
          "default": false,
          "description": "å’Œnode.jsç›¸å…³å†…å®¹"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2022-01-14T09:35:23Z",
      "updated_at": "2022-01-14T09:37:18Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "æ–°çš„ä¸€å¹´å·²ç»å¼€å§‹ï¼Œä¹‹å‰åœ¨çŸ¥ä¹åˆ·åˆ°ä¸€ç¯‡æ–°å¹´å±•æœ›è´´ [2022 å‰ç«¯æŠ€æœ¯é¢†åŸŸä¼šæœ‰å“ªäº›æ–°çš„å˜åŒ–ï¼Ÿ](https://www.zhihu.com/question/493891614/answer/2269197391)ï¼Œé‡Œé¢çš„å°ä¼™ä¼´å›ç­”äº†å¾ˆå¤šï¼Œè¿™é‡Œç¨å¾®å½’çº³ä¸€ä¸‹å›ç­”ï¼š\r\n\r\n- Monorepo\r\n- TypeScript\r\n- ESBuild\r\n- ESM åŒ–\r\n- pnpm\r\n- ...\r\n\r\nä¸Šé¢çš„å›ç­”ä¸­ `TypeScript` æåŠçš„æ¬¡æ•°å¾ˆå¤šï¼ŒåŸå› å¾ˆæ˜¯éšç€é¡¹ç›®å¤æ‚ç¨‹åº¦çš„æ—¥è¶‹å¢åŠ ï¼Œéœ€è¦å¯¹ä»£ç è¿›è¡Œä¸€ä¸ªä¸¥æ ¼ç®¡ç†ï¼Œä¸” TypeScript å¯¹ç¼–è¾‘å™¨çš„æ™ºèƒ½æç¤ºå¤ªé¦™äº†ï¼Œç”¨å®Œä¹‹åæ ¹æœ¬æ²¡åŠæ³•æ‹’ç»ã€‚ä¸”è¶Šå¤šæ¡†æ¶å’Œç”Ÿæ€éƒ½åœ¨å¾€å…¶è¿å¾™ï¼Œä½œä¸º er çš„ä¸€ä»½å­ï¼Œæˆ‘ä»¬ä¹Ÿåº”å½“è¿›è¡Œæ‹¥æŠ±ã€‚\r\n\r\nè¿™é‡Œä»¥ node cli çš„å¼€å‘åœºæ™¯è¿›è¡Œä¸¾ä¾‹ï¼Œå› ä¸ºå®ƒçš„ä½¿ç”¨éšå¤„å¯è§ï¼Œä¾‹å¦‚ `vite`ã€`react` æˆ–è€…å†…éƒ¨è‡ªå·±ä½¿ç”¨çš„è„šæ‰‹æ¶ã€‚\r\n\r\n## å¦‚ä½•å¼€å‘å‘½ä»¤è¡Œ\r\n\r\n> è¿™é‡Œæ¨èä¸€ä¸‹é˜®ä¸€å³°çš„ [Node.js å‘½ä»¤è¡Œç¨‹åºå¼€å‘æ•™ç¨‹](https://www.ruanyifeng.com/blog/2015/05/command-line-with-node.html) æ–‡ç« ï¼Œå› ä¸ºç¯‡å¹…çš„é—®é¢˜ï¼Œè¿™é‡Œä¸è¿‡å¤šè®²è§£æ— å…³å†…å®¹ã€‚\r\n\r\nåœ¨ç¼–å†™ä¸€ä¸ªå‘½ä»¤è¡Œç¨‹åºä¹‹å‰é€šå¸¸ä¼šåšä¸¤ä»¶äº‹æƒ…ï¼š\r\n\r\n1. åœ¨å…¥å£æ–‡ä»¶ç¬¬ä¸€è¡Œæ·»åŠ  `#!/usr/bin/env node`ï¼Œå®ƒçš„æ„æ€æ˜¯å‘Šè¯‰ç³»ç»Ÿå¦‚ä½•æ­£ç¡®å¤„ç†è¿™ä¸ªè„šæœ¬ï¼›\r\n2. åœ¨`package.json`çš„ bin å­—æ®µä¸‹æ·»åŠ è„šæœ¬çš„åç§°è·Ÿè·¯å¾„ï¼Œä¾‹å¦‚ï¼š\r\n\r\n```json\r\nbin: {\r\n    \"create\": \"xxx\"\r\n}\r\n```\r\n\r\nä¸Šé¢ bin å­—æ®µä¼šåœ¨å®‰è£… package çš„æ—¶å€™å°† `bin å‘½ä»¤` æ”¾ç½®åˆ° `node_modules` ä¸‹çš„ `bin ç›®å½•`ã€‚\r\n\r\nå¹³æ—¶ä½¿ç”¨çš„ webpack ä¹‹æ‰€ä»¥åœ¨ `scripts` æ‰§è¡Œçš„ `webpack xxx` å¯ä»¥é€šè¿‡ï¼Œå°±æ˜¯å› ä¸ºæŸ¥æ‰¾ `bin ç›®å½•` å­˜åœ¨ webpack çš„å‘½ä»¤ã€‚\r\n\r\nå›åˆ°ä¸»é¢˜ï¼Œä¸Šé¢è¯´äº†ä½¿ç”¨ TypeScript çš„åŸå› æ˜¯å› ä¸ºç¨‹åºçš„å¤æ‚ç¨‹åº¦åœ¨æ—¥è¶‹å¢åŠ ï¼Œé‚£å¦‚æœæˆ‘ä»¬æƒ³ä½¿ç”¨ TypeScript æ¥å¼€å‘ä¸€ä¸ª cli ç¨‹åºæœ‰æ­£ç¡®çš„å§¿åŠ¿æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ\r\n\r\nç›´æ¥åœ¨ TypeScript çš„æ–‡ä»¶ä¸Šæ·»åŠ  `#!/usr/bin/env node` ï¼Ÿ\r\n\r\n```ts\r\n#!/usr/bin/env node\r\nconst obj: Obj = {};\r\n// xxx\r\n```\r\n\r\nä¸Šé¢çš„åšæ³•è‚¯å®šä¸è¡Œï¼Œå› ä¸º node å¹¶ä¸è®¤è¯†è¿™äº›è¯­æ³•ï¼Œä¸‹é¢å°±æ¥åˆ—ä¸¾ä¸€ä¸‹æ—¥å¸¸ä½¿ç”¨çš„æ–¹å¼ã€‚\r\n\r\n## tsc\r\n\r\ntsc æ˜¯å®‰è£… TypeScript æä¾›ç»™æˆ‘ä»¬çš„ä¸€ä¸ªå‘½ä»¤ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯ç¼–è¯‘ TypeScript æ–‡ä»¶ï¼Œä¾‹å¦‚\r\n\r\n```sh\r\ntsc index.ts\r\n```\r\n\r\nå¦‚æœç›®å½•å­˜åœ¨ `tsconfig.json` æ–‡ä»¶ï¼Œè¿è¡Œ tsc ä¼šå°†æ‰€æœ‰ç¬¦åˆçš„ TypeScript æ–‡ä»¶è¾“å‡ºåˆ° `outDir` ç›®å½•ä¸‹ã€‚\r\n\r\nä¸è¿‡ä½¿ç”¨ tsc æ¥å®Œæˆæ„å»ºæœ‰ä¸¤ç‚¹é—®é¢˜ï¼š\r\n\r\n- ä¸èƒ½æ¸…ç†æ­»ä»£ç ï¼›\r\n- è¾“å‡ºçš„ `outDir`æ²¡æœ‰è·Ÿèµ„æºæ–‡ä»¶è¿›è¡Œç»‘å®šï¼›\r\n\r\nç¬¬ä¸€ç‚¹å¾ˆå¥½ç†è§£ï¼Œæˆ‘ä»¬ä½¿ç”¨ rollup ç­‰å·¥å…·ï¼Œåœ¨æŒ‡å®š input æ–‡ä»¶çš„æ—¶å€™ä¼šè¿›è¡Œä¸€ä¸ªä¾èµ–æ”¶é›†ï¼Œå¦‚æœæ²¡æœ‰æ‰§è¡Œåˆ°çš„ä»£ç å°±æ˜¯ä¸€ä¸ªæ­»ä»£ç ï¼Œä¸ä¼šè¢«æœ€ç»ˆ build å‡ºæ¥ï¼Œä¸è¿‡ä½¿ç”¨ tsc å¾ˆæ˜¾ç„¶å®ƒæ˜¯æ²¡æœ‰è¿™ä¸ªèƒ½åŠ›çš„ã€‚\r\n\r\nè€Œç¬¬äºŒç‚¹è¯´çš„åˆ™æ˜¯ï¼Œå¦‚æœ cli å·¥å…·éœ€è¦å®Œæˆæ‹‰å–ç›®å½•çš„æ“ä½œï¼Œä¾‹å¦‚\r\n\r\n```sh\r\n- index.ts\r\n- template-modules\r\n- template-server\r\n- template-react\r\n```\r\n\r\nä¸Šé¢ `index.ts` æ˜¯ç¨‹åºå…¥å£æ–‡ä»¶ï¼Œè€Œå…¶ä»–çš„ `template æ–‡ä»¶å¤¹` åªæ˜¯é™æ€èµ„æºï¼Œå¹³æ—¶ä½¿ç”¨ JavaScript é€šè¿‡ `__dirname + æ–‡ä»¶å¤¹åç§°` å³å¯ç¡®å®šç›®å½•ï¼Œè€Œç°åœ¨ä½¿ç”¨ tscï¼Œå®ƒåªä¼šå°† `index.ts` è¾“å‡ºåˆ° `outDir` ä¸‹ï¼Œå‡è®¾ `outDir` ä¸º `'./dist'`\r\n\r\n```sh\r\n- dist\r\n-  index.ts\r\n- template-modules\r\n- template-server\r\n- template-react\r\n```\r\n\r\nå¦‚æœè¿˜æŒ‰ç…§ `__dirname + æ–‡ä»¶å¤¹åç§°` å½¢å¼è¿è¡Œä»£ç æ˜¯è·å–ä¸åˆ° template ç­‰æ–‡ä»¶å¤¹çš„ã€‚\r\n\r\nç»¼åˆæ¥çœ‹ï¼Œå¦‚æœé¡¹ç›®å¾ˆç®€å•å¯ä»¥ä½¿ç”¨ tsc çš„å½¢å¼ï¼Œè€Œå¦‚æœåŒ…å« `__dirname` è¯­æ³•æˆ–è€…é™æ€èµ„æºçš„é¡¹ç›®åˆ™éœ€è¦æ³¨æ„è·¯å¾„é—®é¢˜ã€‚\r\n\r\n## rollup\r\n\r\nrollup æ˜¯ä¸‹ä¸€ä»£çš„æ‰“åŒ…å™¨ï¼Œvue å’Œ react éƒ½ä½¿ç”¨æ­¤è¿›è¡Œæ‰“åŒ…ï¼Œå› ä¸ºå®ƒçš„ä½¿ç”¨å¾ˆç®€å•å…¶æ¬¡ç”Ÿæˆçš„ä»£ç æ¯” webpack æ›´å¯è¯»ä½“ç§¯æ›´å°ã€‚\r\n\r\nä½¿ç”¨ rollup åŒæ ·ä¹Ÿå¯ä»¥å®Œæˆ cli æ‰“åŒ…ï¼Œåªéœ€è¦åœ¨ `rollup.config.js` è¿›è¡Œç›¸å…³çš„é…ç½®å³å¯ï¼Œä¸‹é¢ä»¥æˆ‘æœ€å¸¸ç”¨çš„é…ç½®ä¸ºä¾‹\r\n\r\n```js\r\n/* eslint-disable @typescript-eslint/indent */\r\n\r\nimport fs from \"fs-extra\";\r\nimport { defineConfig } from \"rollup\";\r\nimport { babel } from \"@rollup/plugin-babel\";\r\nimport commonjs from \"@rollup/plugin-commonjs\";\r\nimport path from \"path\";\r\nimport json from \"@rollup/plugin-json\";\r\nimport { preserveShebangs } from \"rollup-plugin-preserve-shebangs\";\r\nimport { terser } from \"rollup-plugin-terser\";\r\nimport { nodeResolve } from \"@rollup/plugin-node-resolve\";\r\nimport { dependencies } from \"../package.json\";\r\nimport { cwd } from \"process\";\r\nimport copyPlugin from \"rollup-plugin-copy\";\r\nimport { string } from \"rollup-plugin-string\";\r\nimport config from \"./config\";\r\n\r\nimport { DEFAULT_EXTENSIONS } from \"@babel/core\";\r\n\r\nconst extensions = [...DEFAULT_EXTENSIONS, \".ts\"];\r\n\r\nconst dist = path.join(cwd(), \"dist\");\r\nfs.removeSync(dist);\r\n\r\nexport default defineConfig(\r\n  config.map((item) => {\r\n    const { name } = path.parse(item.src);\r\n    // copyæ–‡ä»¶\r\n    const copy = item.copy || [];\r\n\r\n    return defineConfig({\r\n      input: item.src,\r\n      // ç¦æ­¢æ‰“åŒ…å¤–éƒ¨ä¾èµ–\r\n      external: [...Object.keys(dependencies), \"@babel/runtime\"],\r\n      plugins: [\r\n        nodeResolve({ extensions, rootDir: __dirname }),\r\n        commonjs(),\r\n        json(),\r\n        babel({\r\n          babelHelpers: \"runtime\",\r\n          exclude: /exclude/,\r\n          extensions,\r\n          presets: [[\"@babel/preset-env\"], \"@babel/preset-typescript\"],\r\n          // ç¦æ­¢æ‰“åŒ…é‡å¤æ¨¡å—\r\n          plugins: [\"@babel/plugin-transform-runtime\"],\r\n        }),\r\n        terser(),\r\n        copyPlugin({\r\n          targets: copy.map((item) => {\r\n            return { src: item, dest: dist };\r\n          }),\r\n        }),\r\n        preserveShebangs(),\r\n        // å¯¼å…¥éjsèµ„æº\r\n        string({\r\n          include: \"**/*.{md,html}\",\r\n          exclude: [],\r\n        }),\r\n      ],\r\n      output: {\r\n        file: path.join(\r\n          dist,\r\n          item.format === \"cjs\" ? `${name}.js` : `${name}.${item.format}.js`\r\n        ),\r\n        format: item.format,\r\n        sourcemap: true,\r\n        exports: \"auto\",\r\n      },\r\n    });\r\n  })\r\n);\r\n```\r\n\r\næŒ‡å®š inout è¿è¡Œ rollup å³å¯å®Œæˆæ‰“åŒ…ï¼Œä¸è¿‡ä½¿ç”¨ rollup æ‰“åŒ…åŒæ ·ä¹Ÿæœ‰ä¼˜ç¼ºç‚¹\r\n\r\n### ä¼˜ç‚¹\r\n\r\n- å¯ä»¥æ¸…é™¤æ— æ•ˆä»£ç ï¼›\r\n- å¯ä»¥è¿›è¡Œä»£ç å‹ç¼©ï¼›\r\n\r\n### ç¼ºç‚¹\r\n\r\n- ä¹¦å†™ä»£ç éœ€è¦é…ç½®ï¼Œä»¥åŠæ¯æ¬¡å‘å¸ƒä¹‹å‰éƒ½éœ€è¦ buildï¼ˆè™½ç„¶å¯ä»¥ watchï¼Œä½†æ˜¯ä¹Ÿæ˜¯å ç”¨èµ„æºï¼›\r\n- å¯¼å…¥é™æ€èµ„æºï¼Œä¾‹å¦‚ä¸Šé¢ tsc ä¸¾ä¾‹æ‹‰å–é™æ€èµ„æºçš„æ—¶å€™ï¼Œéœ€è¦é…ç½®æ’ä»¶å°†èµ„æºå¤åˆ¶åˆ° build ç›®å½•ä¸‹ï¼Œä¹‹åé€šè¿‡ `__dirname` å½¢å¼æ¥ä½¿ç”¨\r\n\r\n## ts-node\r\n\r\né™¤äº†ä¸Šé¢ä»‹ç»çš„ä¸¤ç§ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ ts-node æ¥å®Œæˆï¼Œæœ€å¼€å¤´çš„æ—¶å€™è®²äº†å¼€å‘ cli ä¸èƒ½ç›´æ¥ä½¿ç”¨ TypeScript çš„åŸå› å°±æ˜¯ node ä¸è¯†åˆ«è¯­æ³•ï¼Œé‚£å¦‚æœå¯ä»¥åšåˆ°è¿è¡Œæ—¶ç¼–è¯‘åˆ° JavaScript ä¸ä¹…å¯ä»¥äº†å—ï¼Ÿ\r\n\r\nå…¥å£æ–‡ä»¶è¿˜æ˜¯ä¸€ä¸ªæ™®é€šçš„ JavaScript æ–‡ä»¶ï¼Œåç»­çš„æ–‡ä»¶é€šè¿‡ ts-node æ¥è§£æè¯­æ³•è¿è¡Œã€‚\r\n\r\n```js\r\n#!/usr/bin/env node\r\nrequire(\"ts-node\").register({\r\n  /* options */\r\n});\r\n// åé¢å¯ä»¥ç›´æ¥åŠ è½½tsæ–‡ä»¶\r\nrequire(\"./index.ts\");\r\n```\r\n\r\n> æ›´å¤šé€‰é¡¹å¯ä»¥å‚è€ƒ https://typestrong.org/ts-node/api/interfaces/RegisterOptions.html\r\n\r\n### ä¼˜ç‚¹\r\n\r\n- æ”¹åŠ¨å¾ˆå°ï¼Œè·ŸåŸç”Ÿ TypeScript å†™æ³•æ²¡åŒºåˆ«ï¼›\r\n\r\n### ç¼ºç‚¹\r\n\r\n- ä¸æ”¯æŒæ­»ä»£ç å»é™¤ï¼›\r\n- è¿è¡Œé€Ÿåº¦å¾ˆæ…¢ï¼›\r\n\r\nä½¿ç”¨ ts-node æœ€è‡´å‘½çš„ç¼ºç‚¹è¿˜æ˜¯åŠ è½½å¾ˆæ…¢ï¼Œå› ä¸ºæ˜¯è¿è¡Œæ—¶è§£æï¼Œä¸”è¿˜ä¼šæ ¡éªŒ TypeScript æ–‡ä»¶ã€‚\r\n\r\n## es-build\r\n\r\nè¿™æ˜¯åŸºäº ts-node æ€è·¯æ¥çš„å˜å¼‚æ–¹æ³•ï¼Œes-build æ˜¯åŸºäº go è¯­è¨€å¼€å‘çš„æ‰“åŒ…å™¨ï¼Œå®ƒå»é™¤äº†è¿è¡Œæ—¶æ ¡éªŒï¼Œæ”¯æŒå¹¶å‘ã€‚\r\n\r\nè¿™é‡Œè´´ä¸€å¼ å®˜æ–¹çš„å¯¹æ¯”å›¾æ¥è¿›è¡Œå±•ç¤ºï¼Œå¦‚æœæƒ³äº†è§£æ›´å¤šå†…å®¹è¯·æŸ¥çœ‹ [å®˜æ–¹](https://esbuild.github.io/)ã€‚\r\n![image](https://user-images.githubusercontent.com/39508895/149493087-842eb40e-4a2e-4eac-9f48-a4f1cbc5a4b1.png)\r\n\r\n\r\nes-build ä¼šå°†ä»£ç ç¼–è¯‘ï¼Œä¸è¿‡è¿™é‡Œæˆ‘ä»¬éœ€è¦çš„æ˜¯ç›´æ¥è¿è¡Œï¼Œes-build æ²¡æœ‰æä¾›ç›¸å…³çš„æ–¹æ³•ã€‚æˆ‘ä»¬å–å·§ä¸€ä¸‹åœ¨å°†å…¥å£æ–‡ä»¶ require å¯¼å…¥çš„ TypeScript æ–‡ä»¶å…¨éƒ¨ç¼–è¯‘ï¼Œä¹‹åå†™åˆ°TypeScriptæ–‡ä»¶ç›®å½•ä¸‹è¿è¡Œï¼Œè¿è¡Œç¨‹åºç»“æŸä¹‹ååˆ é™¤æ–‡ä»¶ã€‚\r\n\r\nå¹¸è¿çš„æ˜¯ï¼Œä¸éœ€è¦æ‰‹åŠ¨æ¥å®Œæˆè¿™æ ·ä¸€ä»¶äº‹æƒ…ï¼Œç¤¾åŒºå·²ç»æœ‰ç›¸å…³çš„åº“ [esbuild-register](https://github.com/egoist/esbuild-register)ï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨å³å¯ã€‚\r\n\r\n```js\r\n#!/usr/bin/env node\r\nrequire(\"esbuild-register/dist/node\");\r\n// åé¢å¯ä»¥ç›´æ¥åŠ è½½tsæ–‡ä»¶\r\nrequire(\"./index.ts\");\r\n```\r\n\r\nå½“å‰ä¼˜ç¼ºç‚¹è·Ÿ ts-node åŸºæœ¬ç›¸åŒï¼Œè¿è¡Œé€Ÿåº¦æ…¢å¾—åˆ°äº†æ”¹å˜ã€‚\r\n\r\n## æœ€å\r\n\r\nç»¼åˆæ¥çœ‹ï¼Œå¦‚æœä½ æƒ³äº«å— TypeScript è¯­æ³•ä¸æƒ³åšå¤ªå¤šçš„æ”¹åŠ¨ï¼Œes-build çš„æ–¹æ¡ˆç»å¯¹æ˜¯æœ€ä½³å®è·µï¼Œè™½ç„¶ä¸æ”¯æŒ rollup ç­‰è¿™æ ·çš„ç”Ÿæ€ï¼Œä½†æ˜¯ç»“åˆ eslint çš„å·¥å…·å¯¹ä»£ç è¿›è¡Œæ£€æŸ¥ï¼Œè¿˜æ˜¯å¯ä»¥å¾ˆå¤§ç¨‹åº¦æ”¹å–„ã€‚\r\n\r\nå¦‚æœæ–‡ç« æœ‰ä»€ä¹ˆé”™åˆ«å­—æˆ–è€…è®²è§£ä¸å¯¹åœ°æ–¹æ¬¢è¿æŒ‡å‡ºï¼Œå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©å¯ä»¥ `star` æ”¯æŒä¸€ä¸‹ã€‚\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/89/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/89/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/82",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/82/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/82/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/82/events",
      "html_url": "https://github.com/bosens-China/blog/issues/82",
      "id": 1085661350,
      "node_id": "I_kwDOCzPAy85AteCm",
      "number": 82,
      "title": "Babel to Classä¹‹ç§æœ‰å±æ€§ï¼ˆ3ï¼‰",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1908144759,
          "node_id": "MDU6TGFiZWwxOTA4MTQ0NzU5",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/ES6%E7%B3%BB%E5%88%97",
          "name": "ES6ç³»åˆ—",
          "color": "0366d6",
          "default": false,
          "description": "ES6çš„æœ€æ–°è¯­æ³•"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2021-12-21T10:13:22Z",
      "updated_at": "2021-12-28T09:51:19Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "## å‰è¨€\r\n\r\nè¿™æ˜¯ã€ŠBabel to Classã€‹ç³»åˆ—çš„ç¬¬ä¸‰ç¯‡\r\n\r\n- [Babel to Classä¹‹ç¼–è¯‘ï¼ˆ1ï¼‰](https://github.com/bosens-China/blog/issues/80)\r\n- [Babel to Class åšäº†ä»€ä¹ˆï¼ˆ2ï¼‰](https://github.com/bosens-China/blog/issues/81)\r\n- [Babel to Classä¹‹åŸç”Ÿæ„é€ å‡½æ•°ç»§æ‰¿ï¼ˆ4ï¼‰](https://github.com/bosens-China/blog/issues/88)\r\n\r\nè¿™ä¸ªç³»åˆ—ä¸»è¦è®² Class çš„æ™®é€šå†™æ³•ã€ç»§æ‰¿ã€ç§æœ‰å±æ€§å’ŒåŸç”Ÿæ„é€ å‡½æ•°ç»§æ‰¿ `babel` æ˜¯å¦‚ä½•å®ç°è¿™ä¸€è¿‡ç¨‹çš„ã€‚\r\n> æ³¨ï¼šæ–‡ç« é¡ºåºå­˜åœ¨å…³è”ï¼Œè¯·æŒ‰ç…§é¡ºåºé˜…è¯»ã€‚\r\n\r\n## å‰ç½®çŸ¥è¯†ç‚¹\r\n\r\n### WeakMap\r\n\r\n`WeakMap` æ˜¯ ES6 æ–°åŠ å…¥çš„æ•°æ®ç»“æ„ï¼Œå®ƒä¸ `map` ç±»ä¼¼ï¼Œä½†æ˜¯é”®ä¸ºå¼±å¼•ç”¨ã€‚\r\n\r\n> å¼±å¼•ç”¨å°±æ˜¯æŒ‡ä¸è®¡å…¥åƒåœ¾å›æ”¶æ¬¡æ•°ï¼Œå½“å¼•ç”¨è¢«åƒåœ¾å›æ”¶ `WeakMap` å¯¹åº”é”®å€¼è‡ªåŠ¨æ¶ˆå¤±ã€‚\r\n\r\n> æ›´å¤šå†…å®¹è¯·å‚è€ƒ[æ–‡æ¡£](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/WeakMap)\r\n\r\n### WeakSet\r\n\r\nä¸ `WeakMap` ç±»ä¼¼ï¼Œä¸åŒåœ¨äº `WeakSet` åªæœ‰é”®åï¼Œæ²¡æœ‰é”®å€¼ã€‚\r\n\r\n> æ›´å¤šå†…å®¹è¯·å‚è€ƒ[æ–‡æ¡£](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/WeakSet)\r\n\r\n### Class ç§æœ‰å±æ€§\r\n\r\nä¹‹å‰ `Class` è¦å®ç°ç§æœ‰å±æ€§åªèƒ½é€šè¿‡ï¼Œ`Symbol` æˆ–è€…å¤–éƒ¨å˜é‡æ¥å®ç°ï¼Œä¸è¿‡éƒ½å„æœ‰ç¼ºç‚¹ï¼Œç°åœ¨æ–°çš„ææ¡ˆ [proposal-private-methods](https://github.com/tc39/proposal-private-methods) æ·»åŠ äº†ç§æœ‰å±æ€§å’Œç§æœ‰æ–¹æ³•ï¼Œä½¿ç”¨æ–¹å¼å¾ˆç®€å•ï¼Œç›´æ¥`#<name>`å³å¯ã€‚\r\n\r\n```js\r\nclass Test {\r\n  #age = 12;\r\n  #getage() {}\r\n}\r\n```\r\n\r\nç§æœ‰å±æ€§åªèƒ½åœ¨æ„é€ å‡½æ•°å†…éƒ¨è°ƒç”¨ï¼Œå¦‚æœåœ¨éå†…éƒ¨è°ƒç”¨åˆ™æŠ›å‡ºå¼‚å¸¸ï¼ˆåœ¨ static ä¸Šè°ƒç”¨ä¹Ÿæ˜¯å¯ä»¥çš„ï¼‰ã€‚\r\n\r\n## ç¤ºä¾‹æ–‡ä»¶\r\n\r\n```js\r\nclass Test {\r\n  #age = 17;\r\n  static #name = 'zhangsan';\r\n\r\n  #getAge() {\r\n    console.log(this.#age);\r\n  }\r\n  static #getName() {\r\n    console.log(this.#name);\r\n  }\r\n\r\n  all() {\r\n    this.#getAge();\r\n    Test.#getName();\r\n  }\r\n}\r\nconst test = new Test();\r\ntest.all();\r\n```\r\n\r\nä»¥ä¸‹å†…å®¹æ ¹æ®æ­¤æ–‡ä»¶è¿›è¡Œè®²è§£ã€‚\r\n\r\n## babel\r\n\r\n```js\r\n'use strict';\r\n\r\nfunction _classCallCheck(instance, Constructor) {\r\n  if (!(instance instanceof Constructor)) {\r\n    throw new TypeError('Cannot call a class as a function');\r\n  }\r\n}\r\n\r\nfunction _defineProperties(target, props) {\r\n  for (var i = 0; i < props.length; i++) {\r\n    var descriptor = props[i];\r\n    descriptor.enumerable = descriptor.enumerable || false;\r\n    descriptor.configurable = true;\r\n    if ('value' in descriptor) descriptor.writable = true;\r\n    Object.defineProperty(target, descriptor.key, descriptor);\r\n  }\r\n}\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\r\n  if (staticProps) _defineProperties(Constructor, staticProps);\r\n  Object.defineProperty(Constructor, 'prototype', { writable: false });\r\n  return Constructor;\r\n}\r\n\r\nfunction _classPrivateMethodInitSpec(obj, privateSet) {\r\n  _checkPrivateRedeclaration(obj, privateSet);\r\n  privateSet.add(obj);\r\n}\r\n\r\nfunction _classPrivateFieldInitSpec(obj, privateMap, value) {\r\n  _checkPrivateRedeclaration(obj, privateMap);\r\n  privateMap.set(obj, value);\r\n}\r\n\r\nfunction _checkPrivateRedeclaration(obj, privateCollection) {\r\n  if (privateCollection.has(obj)) {\r\n    throw new TypeError(\r\n      'Cannot initialize the same private elements twice on an object'\r\n    );\r\n  }\r\n}\r\n\r\nfunction _classStaticPrivateMethodGet(receiver, classConstructor, method) {\r\n  _classCheckPrivateStaticAccess(receiver, classConstructor);\r\n  return method;\r\n}\r\n\r\nfunction _classPrivateMethodGet(receiver, privateSet, fn) {\r\n  if (!privateSet.has(receiver)) {\r\n    throw new TypeError('attempted to get private field on non-instance');\r\n  }\r\n  return fn;\r\n}\r\n\r\nfunction _classStaticPrivateFieldSpecGet(\r\n  receiver,\r\n  classConstructor,\r\n  descriptor\r\n) {\r\n  _classCheckPrivateStaticAccess(receiver, classConstructor);\r\n  _classCheckPrivateStaticFieldDescriptor(descriptor, 'get');\r\n  return _classApplyDescriptorGet(receiver, descriptor);\r\n}\r\n\r\nfunction _classCheckPrivateStaticFieldDescriptor(descriptor, action) {\r\n  if (descriptor === undefined) {\r\n    throw new TypeError(\r\n      'attempted to ' + action + ' private static field before its declaration'\r\n    );\r\n  }\r\n}\r\n\r\nfunction _classCheckPrivateStaticAccess(receiver, classConstructor) {\r\n  if (receiver !== classConstructor) {\r\n    throw new TypeError('Private static access of wrong provenance');\r\n  }\r\n}\r\n\r\nfunction _classPrivateFieldGet(receiver, privateMap) {\r\n  var descriptor = _classExtractFieldDescriptor(receiver, privateMap, 'get');\r\n  return _classApplyDescriptorGet(receiver, descriptor);\r\n}\r\n\r\nfunction _classExtractFieldDescriptor(receiver, privateMap, action) {\r\n  if (!privateMap.has(receiver)) {\r\n    throw new TypeError(\r\n      'attempted to ' + action + ' private field on non-instance'\r\n    );\r\n  }\r\n  return privateMap.get(receiver);\r\n}\r\n\r\nfunction _classApplyDescriptorGet(receiver, descriptor) {\r\n  if (descriptor.get) {\r\n    return descriptor.get.call(receiver);\r\n  }\r\n  return descriptor.value;\r\n}\r\n\r\nvar _age = /*#__PURE__*/ new WeakMap();\r\n\r\nvar _getAge = /*#__PURE__*/ new WeakSet();\r\n\r\nvar Test = /*#__PURE__*/ (function () {\r\n  debugger;\r\n  function Test() {\r\n    _classCallCheck(this, Test);\r\n\r\n    _classPrivateMethodInitSpec(this, _getAge);\r\n\r\n    _classPrivateFieldInitSpec(this, _age, {\r\n      writable: true,\r\n      value: 17,\r\n    });\r\n  }\r\n\r\n  _createClass(Test, [\r\n    {\r\n      key: 'all',\r\n      value: function all() {\r\n        _classPrivateMethodGet(this, _getAge, _getAge2).call(this);\r\n\r\n        _classStaticPrivateMethodGet(Test, Test, _getName).call(Test);\r\n      },\r\n    },\r\n  ]);\r\n\r\n  return Test;\r\n})();\r\n\r\nfunction _getAge2() {\r\n  console.log(_classPrivateFieldGet(this, _age));\r\n}\r\n\r\nfunction _getName() {\r\n  console.log(_classStaticPrivateFieldSpecGet(this, Test, _name));\r\n}\r\n\r\nvar _name = {\r\n  writable: true,\r\n  value: 'zhangsan',\r\n};\r\nvar test = new Test();\r\ntest.all();\r\n```\r\n\r\nä»¥ä¸‹æ–¹æ³•å‡ºç°åœ¨ä¹‹å‰è®²è§£è¿‡çš„ç¯‡å¹…ä¸­å°±ä¸å†èµ˜è¿°\r\n\r\n- `_classCallCheck`\r\n- `_defineProperties`\r\n- `_createClass`\r\n\r\n### \\_checkPrivateRedeclaration\r\n\r\n```js\r\nfunction _checkPrivateRedeclaration(obj, privateCollection) {\r\n  if (privateCollection.has(obj)) {\r\n    throw new TypeError(\r\n      'Cannot initialize the same private elements twice on an object'\r\n    );\r\n  }\r\n}\r\n```\r\n\r\néªŒè¯ `WeakSet` ä¸Šæ˜¯å¦å­˜åœ¨æ„é€ å‡½æ•°ï¼Œå¦‚æœå­˜åœ¨ç›´æ¥æŠ›å‡ºé”™è¯¯ã€‚\r\n\r\n### \\_classPrivateMethodInitSpec\r\n\r\n```js\r\nfunction _classPrivateMethodInitSpec(obj, privateSet) {\r\n  _checkPrivateRedeclaration(obj, privateSet);\r\n  privateSet.add(obj);\r\n}\r\n```\r\n\r\nåœ¨ `WeakSet` ä¸Šæ·»åŠ æ„é€ å‡½æ•°ã€‚\r\n\r\n### \\_classPrivateFieldInitSpec\r\n\r\n```js\r\nfunction _classPrivateFieldInitSpec(obj, privateMap, value) {\r\n  _checkPrivateRedeclaration(obj, privateMap);\r\n  privateMap.set(obj, value);\r\n}\r\n```\r\n\r\nåœ¨ `WeakMap` ä¸Šæ·»åŠ ç§æœ‰å±æ€§ï¼ˆå±æ€§æè¿°ç¬¦å½¢å¼ï¼‰ã€‚\r\n\r\n### \\_classPrivateMethodGet\r\n\r\n```js\r\nfunction _classPrivateMethodGet(receiver, privateSet, fn) {\r\n  if (!privateSet.has(receiver)) {\r\n    throw new TypeError('attempted to get private field on non-instance');\r\n  }\r\n  return fn;\r\n}\r\n```\r\n\r\néªŒè¯æ˜¯å¦åœ¨æ„é€ å‡½æ•°å†…éƒ¨è°ƒç”¨ï¼Œå¦‚æœå¤–éƒ¨åˆ™æŠ›å‡ºé”™è¯¯ `è¯•å›¾åœ¨éå®ä¾‹ä¸Šè·å–ç§æœ‰å­—æ®µ`ã€‚\r\n\r\n### \\_classCheckPrivateStaticAccess\r\n\r\n```js\r\nfunction _classCheckPrivateStaticAccess(receiver, classConstructor) {\r\n  if (receiver !== classConstructor) {\r\n    throw new TypeError('Private static access of wrong provenance');\r\n  }\r\n}\r\n```\r\n\r\nåˆ¤æ–­é™æ€å±æ€§çš„æ¥æºæ˜¯å¦åˆæ³•ï¼Œä¾‹å¦‚\r\n\r\n```js\r\nclass A {\r\n  static #name() {}\r\n}\r\n\r\nclass Test {\r\n  static #name() {\r\n    A.#name();\r\n  }\r\n\r\n  all() {\r\n    Test.#name();\r\n  }\r\n}\r\n\r\nconst test = new Test();\r\ntest.all();\r\n```\r\n\r\næˆ‘ä»¬åœ¨ `Test` è·å–` A.#name` è¿™ç§æƒ…å†µä¸‹å°±è¦æŠ›å‡ºå¼‚å¸¸ã€‚\r\n\r\n### \\_classStaticPrivateMethodGet\r\n\r\n```js\r\nfunction _classStaticPrivateMethodGet(receiver, classConstructor, method) {\r\n  _classCheckPrivateStaticAccess(receiver, classConstructor);\r\n  return method;\r\n}\r\n```\r\n\r\néªŒè¯é€šè¿‡è¿”å› `method`ã€‚\r\n\r\n### \\_classExtractFieldDescriptor\r\n\r\n```js\r\nfunction _classExtractFieldDescriptor(receiver, privateMap, action) {\r\n  if (!privateMap.has(receiver)) {\r\n    throw new TypeError(\r\n      'attempted to ' + action + ' private field on non-instance'\r\n    );\r\n  }\r\n  return privateMap.get(receiver);\r\n}\r\n```\r\n\r\néªŒè¯ `WeakMap` æ˜¯å¦æœ‰æ„é€ å‡½æ•°ï¼Œå¦‚æœæ²¡æœ‰åˆ™æŠ›å‡ºéæ³•è·å–å®ä¾‹é”™è¯¯ï¼Œå¦åˆ™è¿”å›å¯¹åº”çš„ keyã€‚\r\n\r\n### \\_classApplyDescriptorGet\r\n\r\n```js\r\nfunction _classApplyDescriptorGet(receiver, descriptor) {\r\n  if (descriptor.get) {\r\n    return descriptor.get.call(receiver);\r\n  }\r\n  return descriptor.value;\r\n}\r\n```\r\n\r\nè¿”å›ç§æœ‰å±æ€§ï¼Œæ ¹æ®å±æ€§æè¿°ç¬¦ï¼Œå¦‚æœæ˜¯ `getã€set` è¿™ç§å½¢å¼å‚¨å­˜ï¼Œç›´æ¥è°ƒç”¨ `get å‡½æ•°` è¿”å›ï¼Œå¦åˆ™è¿”å› `value`ã€‚\r\n\r\n### \\_classCheckPrivateStaticFieldDescriptor\r\n\r\n```js\r\nfunction _classCheckPrivateStaticFieldDescriptor(descriptor, action) {\r\n  if (descriptor === undefined) {\r\n    throw new TypeError(\r\n      'attempted to ' + action + ' private static field before its declaration'\r\n    );\r\n  }\r\n}\r\n```\r\n\r\nåˆ¤æ–­å±æ€§æè¿°ç¬¦æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨æŠ›å‡ºå¼‚å¸¸ã€‚\r\n\r\n### \\_classStaticPrivateFieldSpecGet\r\n\r\n```js\r\nfunction _classStaticPrivateFieldSpecGet(\r\n  receiver,\r\n  classConstructor,\r\n  descriptor\r\n) {\r\n  _classCheckPrivateStaticAccess(receiver, classConstructor);\r\n  _classCheckPrivateStaticFieldDescriptor(descriptor, 'get');\r\n  return _classApplyDescriptorGet(receiver, descriptor);\r\n}\r\n```\r\n\r\nè¿”å›é™æ€ç§æœ‰æ–¹æ³•\r\n\r\n- è°ƒç”¨ `_classCheckPrivateStaticAccess` ç¡®ä¿æ„é€ å‡½æ•°å’Œè°ƒç”¨å‡½æ•°ä¸€è‡´ï¼›\r\n- è°ƒç”¨ `_classCheckPrivateStaticFieldDescriptor` ç¡®ä¿é™æ€ç§æœ‰å±æ€§ä¸€è‡´ï¼›\r\n- è°ƒç”¨ `_classApplyDescriptorGet` è¿”å›ç§æœ‰å±æ€§;\r\n\r\n### \\_classPrivateFieldGet\r\n\r\n```js\r\nfunction _classPrivateFieldGet(receiver, privateMap) {\r\n  var descriptor = _classExtractFieldDescriptor(receiver, privateMap, 'get');\r\n  return _classApplyDescriptorGet(receiver, descriptor);\r\n}\r\n```\r\n\r\nè¿”å›é™æ€ç§æœ‰å±æ€§ã€‚\r\n\r\n## æ‰§è¡Œè¿‡ç¨‹\r\n\r\nä¸Šé¢å·²ç»æ”¾è¿‡ babel è¿‡çš„ä»£ç ï¼Œè¿™é‡Œå°±ä¸é‡å¤äº†ï¼Œé‡ç‚¹çœ‹ä¸‹æ‰§è¡Œçš„è¿‡ç¨‹ï¼Œä»`var _age = /*#__PURE__*/ new WeakMap();`è¿™æ®µä»£ç å¼€å§‹ã€‚\r\n\r\n- åˆ›å»º `_age` å’Œ `_getAge` çš„ `Weak` å¯¹è±¡ï¼›\r\n- è°ƒç”¨ `_createClass` ç»™ Test å®Œæˆ prototype èµ‹å€¼ï¼›\r\n- `new Test`ï¼Œè¿›å…¥ Test æ„é€ å‡½æ•°å†…éƒ¨ï¼›\r\n- è°ƒç”¨ `_classCallCheck` ç¡®ä¿ä¸º `new` è°ƒç”¨ï¼›\r\n- è°ƒç”¨ `_classPrivateMethodInitSpec`ï¼Œè®© `_getAge` æ·»åŠ å½“å‰ `this`ï¼›\r\n- è°ƒç”¨ `_classPrivateFieldInitSpec`ï¼Œç»™ `_age` æ·»åŠ å±æ€§ï¼Œkey ä¸º thisï¼Œvalue ä¸ºå±æ€§æè¿°ç¬¦ï¼›\r\n- è°ƒç”¨ `all` æ–¹æ³•ï¼›\r\n- æ‰§è¡Œ `_classPrivateMethodGet(this, _getAge, _getAge2).call(this);`ï¼Œå®ƒçš„ä½œç”¨éªŒè¯é€šè¿‡åè°ƒç”¨ `_getAge2`ï¼›\r\n- `_getAge2` å†…éƒ¨æ‰§è¡Œ `_classPrivateFieldGet`ï¼Œè¿”å› `_age` è®¾ç½®çš„å±æ€§æè¿°ç¬¦;\r\n- è¿”å› `all` å†…éƒ¨æ‰§è¡Œ `_classStaticPrivateMethodGet(Test, Test, _getName).call(Test);`è¿™ä¸€è¡Œï¼Œå®ƒçš„ä½œç”¨æ˜¯éªŒè¯åæ‰§è¡Œ `_getName`ï¼›\r\n- `_getName` å†…éƒ¨æ‰§è¡Œ `_classStaticPrivateFieldSpecGet` å®ƒè¿”å›å±æ€§æè¿°ç¬¦ï¼›\r\n- è¾“å‡ºç»“æœï¼Œç»“æŸï¼›\r\n\r\n## å®ç°ç§æœ‰å±æ€§æ–¹æ³•\r\n\r\nä»ä¸Šé¢è¿‡ç¨‹ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå®ç°ç§æœ‰æ–¹æ³•çš„ä¸»è¦æ­¥éª¤æ˜¯é€šè¿‡ `WeakMap` æ¥å®Œæˆï¼Œå¦‚æœä¸è€ƒè™‘éªŒè¯è¿‡ç¨‹ï¼Œå¯ä»¥å¾ˆç®€å•å®ç°ã€‚\r\n\r\n```js\r\nconst privateName = new WeakMap();\r\n\r\nclass Test {\r\n  constructor() {\r\n    privateName.set(this, 'zhangsan');\r\n  }\r\n  getName() {\r\n    return privateName.get(this);\r\n  }\r\n}\r\n```\r\n\r\n## æœ€å\r\n\r\nå¦‚æœæœ‰ä»€ä¹ˆä¸æ­£ç¡®æˆ–è€…ä¹¦å†™é”™è¯¯æ¬¢è¿æŒ‡å‡ºã€‚\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/82/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/82/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/81",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/81/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/81/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/81/events",
      "html_url": "https://github.com/bosens-China/blog/issues/81",
      "id": 1085660852,
      "node_id": "I_kwDOCzPAy85Atd60",
      "number": 81,
      "title": "Babel to Classä¹‹ç»§æ‰¿ï¼ˆ2ï¼‰",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1908144759,
          "node_id": "MDU6TGFiZWwxOTA4MTQ0NzU5",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/ES6%E7%B3%BB%E5%88%97",
          "name": "ES6ç³»åˆ—",
          "color": "0366d6",
          "default": false,
          "description": "ES6çš„æœ€æ–°è¯­æ³•"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2021-12-21T10:12:50Z",
      "updated_at": "2021-12-28T09:51:06Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "## å‰è¨€\r\n\r\nè¿™æ˜¯ã€ŠBabel to Classã€‹ç³»åˆ—çš„ç¬¬äºŒç¯‡\r\n\r\n- [Babel to Classä¹‹ç¼–è¯‘ï¼ˆ1ï¼‰](https://github.com/bosens-China/blog/issues/80)\r\n- [Babel to Classä¹‹ç§æœ‰å±æ€§ï¼ˆ3ï¼‰](https://github.com/bosens-China/blog/issues/82)\r\n- [Babel to Classä¹‹åŸç”Ÿæ„é€ å‡½æ•°ç»§æ‰¿ï¼ˆ4ï¼‰](https://github.com/bosens-China/blog/issues/88)\r\n\r\nè¿™ä¸ªç³»åˆ—ä¸»è¦è®² Class çš„æ™®é€šå†™æ³•ã€ç»§æ‰¿ã€ç§æœ‰å±æ€§å’ŒåŸç”Ÿæ„é€ å‡½æ•°ç»§æ‰¿ `babel` æ˜¯å¦‚ä½•å®ç°è¿™ä¸€è¿‡ç¨‹çš„ã€‚\r\n> æ³¨ï¼šæ–‡ç« é¡ºåºå­˜åœ¨å…³è”ï¼Œè¯·æŒ‰ç…§é¡ºåºé˜…è¯»ã€‚\r\n\r\n## å‰ç½®çŸ¥è¯†ç‚¹\r\n\r\n### super\r\n\r\n`super` é€šå¸¸ç”¨äº Class ç»§æ‰¿ä¸­è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œä»¥åŠåœ¨æ–¹æ³•ä¸­è°ƒç”¨çˆ¶ç±»æ–¹æ³•ã€‚\r\n\r\n```js\r\nclass Rectangle {\r\n  logNbSides() {\r\n    return 'I have 4 sides';\r\n  }\r\n}\r\n\r\nclass Square extends Rectangle {\r\n  logDescription() {\r\n    return super.logNbSides() + ' which are all equal';\r\n  }\r\n}\r\n```\r\n\r\n> æ›´å¤šçš„å†…å®¹è¯·å‚è€ƒ [super](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/super)\r\n\r\n### Object.create\r\n\r\n`Object.create(protoï¼Œ[propertiesObject])`\r\n\r\n`Object.create` ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå¹¶å°†æ–°çš„å¯¹è±¡åŸå‹è®¾ç½®åœ¨ `proto` ä¸Šï¼Œå®ƒè¿˜æ”¯æŒç¬¬äºŒä¸ªå‚æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå¯¹è±¡æ¯ä¸ªå¯¹è±¡çš„å€¼ä¸ºå±æ€§æè¿°ç¬¦ã€‚\r\n\r\n```js\r\nvar o = Object.create(Object.prototype, {\r\n  // fooä¼šæˆä¸ºæ‰€åˆ›å»ºå¯¹è±¡çš„æ•°æ®å±æ€§\r\n  foo: {\r\n    writable: true,\r\n    configurable: true,\r\n    value: 'hello',\r\n  },\r\n  // barä¼šæˆä¸ºæ‰€åˆ›å»ºå¯¹è±¡çš„è®¿é—®å™¨å±æ€§\r\n  bar: {\r\n    configurable: false,\r\n    get: function () {\r\n      return 10;\r\n    },\r\n    set: function (value) {\r\n      console.log('Setting `o.bar` to', value);\r\n    },\r\n  },\r\n});\r\n```\r\n\r\n> æ›´å¤šå†…å®¹è¯·å‚è€ƒ [Object.create](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/create)\r\n\r\n### Reflect.construct\r\n\r\n```js\r\nReflect.construct(target, argumentsList[, newTarget])\r\n```\r\n\r\n- targetï¼šè¢«è¿è¡Œçš„ç›®æ ‡æ„é€ å‡½æ•°\r\n- argumentsListï¼šç±»æ•°ç»„ï¼Œç›®æ ‡æ„é€ å‡½æ•°è°ƒç”¨æ—¶çš„å‚æ•°ã€‚\r\n- newTargetï¼šä½œä¸ºæ–°åˆ›å»ºå¯¹è±¡çš„åŸå‹å¯¹è±¡çš„ constructor å±æ€§ï¼Œ å‚è€ƒ new.target æ“ä½œç¬¦ï¼Œé»˜è®¤å€¼ä¸º targetã€‚\r\n\r\n`Reflect.construct` çš„ä½œç”¨ç›¸å½“äºä¸ç”¨ `new` æ“ä½œç¬¦è°ƒç”¨æ„é€ å‡½æ•°ï¼Œåˆ›å»ºå¯¹è±¡ã€‚\r\n\r\n```js\r\nclass Foo {}\r\nvar obj = new Foo(...args);\r\nvar obj = Reflect.construct(Foo, args);\r\n```\r\n\r\næ³¨æ„ç‚¹ï¼š\r\n\r\n1. ä½¿ç”¨ `Reflect.construct` åˆ›å»ºå¯¹è±¡ï¼Œ`new.target` ä¼šè‡ªåŠ¨æŒ‡å‘ newTargetï¼Œ\r\n2. å¦‚æœæŒ‡å®š newTargetï¼Œ`new.target` ä¼šæŒ‡å‘ newTarget ä¸”æ„é€ å‡½æ•°å†…éƒ¨çš„ this ä¸º newTarget\r\n\r\n> æ›´å¤šå†…å®¹è¯·å‚è€ƒ [Reflect.construct](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Reflect/construct)\r\n\r\n### Class\r\n\r\n- Class extends ç»§æ‰¿çš„å¿…é¡»æ˜¯ `null` æˆ–è€… `function`ï¼ˆclass ä¹Ÿæ˜¯ functionï¼‰ï¼Œå¦åˆ™æŠ›å‡ºé”™è¯¯ï¼›\r\n- Class å­ç±» extends çˆ¶ç±»çš„æ—¶å€™å¿…é¡»åœ¨ `constructor` æ˜¾å¼è°ƒç”¨ `super()`ï¼Œå¦åˆ™æŠ›å‡ºé”™è¯¯ï¼›\r\n\r\n## ç¤ºä¾‹ä»£ç \r\n\r\n```js\r\nclass Parent {\r\n  constructor() {\r\n    this.age = 17;\r\n  }\r\n\r\n  getAge() {\r\n    return this.age;\r\n  }\r\n\r\n  static getName() {\r\n    return this.name;\r\n  }\r\n}\r\n\r\nclass Child extends Parent {\r\n  constructor() {\r\n    super();\r\n    this.name = 'child';\r\n  }\r\n\r\n  static name = 'child';\r\n\r\n  getAll() {\r\n    return {\r\n      name: this.name,\r\n      age: this.age,\r\n    };\r\n  }\r\n}\r\n\r\nconst child = new Child();\r\nconsole.log(child.getAll());\r\nconsole.log(Child.getName());\r\n```\r\n\r\nä»¥ä¸‹è®²è§£åŸºäºä¸Šé¢çš„å†…å®¹è€Œæ¥ã€‚\r\n\r\n## babel\r\n\r\n```js\r\n'use strict';\r\n\r\nfunction _typeof(obj) {\r\n  // ...çœç•¥å®ç°\r\n}\r\n\r\nfunction _inherits(subClass, superClass) {\r\n  // ...çœç•¥å®ç°\r\n}\r\n\r\nfunction _setPrototypeOf(o, p) {\r\n  // ...çœç•¥å®ç°\r\n}\r\n\r\nfunction _createSuper(Derived) {\r\n  // ...çœç•¥å®ç°\r\n}\r\n\r\nfunction _possibleConstructorReturn(self, call) {\r\n  // ...çœç•¥å®ç°\r\n}\r\n\r\nfunction _assertThisInitialized(self) {\r\n  // ...çœç•¥å®ç°\r\n}\r\n\r\nfunction _isNativeReflectConstruct() {\r\n  // ...çœç•¥å®ç°\r\n}\r\n\r\nfunction _getPrototypeOf(o) {\r\n  // ...çœç•¥å®ç°\r\n}\r\n\r\nfunction _defineProperty(obj, key, value) {\r\n  // ...çœç•¥å®ç°\r\n}\r\n\r\nfunction _classCallCheck(instance, Constructor) {\r\n  // ...çœç•¥å®ç°\r\n}\r\n\r\nfunction _defineProperties(target, props) {\r\n  // ...çœç•¥å®ç°\r\n}\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n  // ...çœç•¥å®ç°\r\n}\r\n\r\nvar Parent = /*#__PURE__*/ (function () {\r\n  function Parent() {\r\n    _classCallCheck(this, Parent);\r\n\r\n    this.age = 17;\r\n  }\r\n\r\n  _createClass(\r\n    Parent,\r\n    [\r\n      {\r\n        key: 'getAge',\r\n        value: function getAge() {\r\n          return this.age;\r\n        },\r\n      },\r\n    ],\r\n    [\r\n      {\r\n        key: 'getName',\r\n        value: function getName() {\r\n          return this.name;\r\n        },\r\n      },\r\n    ],\r\n  );\r\n\r\n  return Parent;\r\n})();\r\n\r\nvar Child = /*#__PURE__*/ (function (_Parent) {\r\n  _inherits(Child, _Parent);\r\n\r\n  var _super = _createSuper(Child);\r\n\r\n  function Child() {\r\n    var _this;\r\n\r\n    _classCallCheck(this, Child);\r\n\r\n    _this = _super.call(this);\r\n    _this.name = 'child';\r\n    return _this;\r\n  }\r\n\r\n  _createClass(Child, [\r\n    {\r\n      key: 'getAll',\r\n      value: function getAll() {\r\n        return {\r\n          name: this.name,\r\n          age: this.age,\r\n        };\r\n      },\r\n    },\r\n  ]);\r\n\r\n  return Child;\r\n})(Parent);\r\n\r\n_defineProperty(Child, 'name', 'child');\r\n\r\nvar child = new Child();\r\nconsole.log(child.getAll());\r\nconsole.log(Child.getName());\r\n```\r\n\r\nä¸‹é¢å‡½æ•°åœ¨ [Babel to Class åšäº†ä»€ä¹ˆï¼ˆ1ï¼‰](https://github.com/bosens-China/blog/issues/80) è®²è§£è¿‡äº†\r\n\r\n- `_defineProperty`\r\n- `_classCallCheck`\r\n- `_defineProperties`\r\n- `_createClass`\r\n\r\næ‰€ä»¥ä¸å†èµ˜è¿°ï¼Œé‡ç‚¹å…ˆçœ‹æ–°å‡ºç°çš„å‡½æ•°ã€‚\r\n\r\n### \\_typeof\r\n\r\n```js\r\nfunction _typeof(obj) {\r\n  '@babel/helpers - typeof';\r\n  return (\r\n    (_typeof =\r\n      'function' == typeof Symbol && 'symbol' == typeof Symbol.iterator\r\n        ? function (obj) {\r\n            return typeof obj;\r\n          }\r\n        : function (obj) {\r\n            return obj && 'function' == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype\r\n              ? 'symbol'\r\n              : typeof obj;\r\n          }),\r\n    _typeof(obj)\r\n  );\r\n}\r\n```\r\n\r\nè¿™ä¸ªå‡½æ•°çš„ä½œç”¨ä¸ºç±»å‹åˆ¤æ–­ã€‚\r\n\r\n- `'function' == typeof Symbol && 'symbol' == typeof Symbol.iterator`\r\n  è¿™æ®µåŒ–æ„æ€æ˜¯å¦‚æœæ”¯æŒåŸç”Ÿçš„ `Symbol` å°±ç›´æ¥æ‰§è¡Œ `typeof` å³å¯\r\n\r\n- `obj && 'function' == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype`\r\n  è¿™æ®µä»£ç ä¸»è¦æ˜¯ç”¨äºåˆ¤æ–­ä½ç‰ˆæœ¬ä¸å…¼å®¹ `Symbol` çš„æµè§ˆå™¨æ˜¯ä¸æ˜¯ä½¿ç”¨äº† `polyfill` åº“ï¼Œå¦‚æœæ˜¯çš„åŒ–å°±è¿”å› `symbol`\r\n\r\n- å…¶ä»–æƒ…å†µè¿”å› `typeof` ç»“æœ\r\n\r\n### \\_inherits\r\n\r\n```js\r\nfunction _inherits(subClass, superClass) {\r\n  if (typeof superClass !== 'function' && superClass !== null) {\r\n    throw new TypeError('Super expression must either be null or a function');\r\n  }\r\n  Object.defineProperty(subClass, 'prototype', {\r\n    value: Object.create(superClass && superClass.prototype, {\r\n      constructor: { value: subClass, writable: true, configurable: true },\r\n    }),\r\n    writable: false,\r\n  });\r\n  if (superClass) _setPrototypeOf(subClass, superClass);\r\n}\r\n```\r\n\r\n- è¿™æ®µä»£ç é¦–å…ˆåˆ¤æ–­ç»§æ‰¿çš„ `superClass` æ˜¯å¦ç¬¦åˆè¦æ±‚\r\n- å…¶æ¬¡å¯¹ `subClass.prototype` è¿›è¡Œè®¾ç½®ç¡®ä¿ `prototype` å±æ€§ééå†\r\n- è®¾ç½®åŸå‹ï¼Œå°† `subClass` çš„åŸå‹è®¾ç½®ä¸º `superClass`\r\n\r\n### \\_setPrototypeOf\r\n\r\n```js\r\nfunction _setPrototypeOf(o, p) {\r\n  _setPrototypeOf =\r\n    Object.setPrototypeOf ||\r\n    function _setPrototypeOf(o, p) {\r\n      o.__proto__ = p;\r\n      return o;\r\n    };\r\n  return _setPrototypeOf(o, p);\r\n}\r\n```\r\n\r\nè®¾ç½®åŸå‹é“¾çš„æ–¹æ³•ï¼Œé¦–å…ˆè°ƒç”¨åŸç”Ÿçš„ `Object.setPrototypeOf` æ–¹æ³•ï¼Œå¦‚æœä¸æ”¯æŒå°è¯•ä½¿ç”¨ `__proto__`ï¼Œ`__proto__`æ˜¯æµè§ˆå™¨å®ç°çš„ä¸€ä¸ªç§æœ‰å±æ€§ï¼Œåœ¨å…¶ä»–ç¯å¢ƒä¸‹ä¸æ˜¯å¿…é¡»å®ç°ã€‚\r\n\r\nä¸è¿‡ä»”ç»†è§‚å¯Ÿï¼Œä½ ä¼šå‘ç°å®ƒè¿˜ä½¿ç”¨äº†ä¸€ä¸ªå‡½æ•°æ‡’åŠ è½½ï¼Œç¡®ä¿åˆ¤æ–­åªæ‰§è¡Œä¸€æ¬¡ï¼Œåç»­ç›´æ¥ä¸ä¼šæ”¹å˜äº†ã€‚\r\n\r\n### \\_createSuper\r\n\r\n```js\r\nfunction _createSuper(Derived) {\r\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\r\n  return function _createSuperInternal() {\r\n    var Super = _getPrototypeOf(Derived),\r\n      result;\r\n    if (hasNativeReflectConstruct) {\r\n      var NewTarget = _getPrototypeOf(this).constructor;\r\n      result = Reflect.construct(Super, arguments, NewTarget);\r\n    } else {\r\n      result = Super.apply(this, arguments);\r\n    }\r\n    return _possibleConstructorReturn(this, result);\r\n  };\r\n}\r\n```\r\n\r\nè¿™æ®µä»£ç çš„ä½œç”¨æ˜¯è¿”å› `super`\r\n\r\n- `_isNativeReflectConstruct` è¿™ä¸ªå‡½æ•°æˆ‘ä»¬åé¢è®²è§£ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯åˆ¤æ–­å½“å‰ç¯å¢ƒæ”¯ä¸æ”¯æŒ `Reflect.construct`\r\n- `_possibleConstructorReturn` è¿™ä¸ªå‡½æ•°åé¢è®²è§£ï¼Œä½œç”¨ä¸ºåˆ¤æ–­ Class ç¬¦ä¸ç¬¦åˆè¦æ±‚\r\n\r\n### \\_possibleConstructorReturn\r\n\r\n```js\r\nfunction _possibleConstructorReturn(self, call) {\r\n  debugger;\r\n  if (call && (_typeof(call) === 'object' || typeof call === 'function')) {\r\n    return call;\r\n  } else if (call !== void 0) {\r\n    throw new TypeError('Derived constructors may only return object or undefined');\r\n  }\r\n  return _assertThisInitialized(self);\r\n}\r\n```\r\n\r\nè¿™ä¸ªå‡½æ•°ç”¨äºåˆ¤æ–­ Class å’Œ extends çš„ Class ç¬¦ä¸ç¬¦åˆè¦æ±‚\r\n\r\n- `call && (_typeof(call) === 'object' || typeof call === 'function')`\r\n\r\nè¿™ä¸ªç›¸å½“äºåˆ¤æ–­ isObjectï¼Œæ„é€ å‡½æ•°è¢«è°ƒç”¨æ˜¯å¯ä»¥è¿”å›ä¸€ä¸ªå¯¹è±¡çš„\r\n\r\n```js\r\nfunction Foo() {\r\n  return { name: 1 };\r\n}\r\nnew Foo();\r\n// {name: 1}\r\n```\r\n\r\nå¦‚æœä¸æ˜¯å¯¹è±¡ä¹Ÿæ²¡æœ‰é»˜è®¤è¿”å› `undefined`ï¼Œåˆ™ç›´æ¥æŠ›å‡ºé”™è¯¯\r\n\r\n- `_assertThisInitialized`ï¼Œè¿™ä¸ªå‡½æ•°ç”¨äºåˆ¤æ–­å­ç±»æœ‰æ²¡æœ‰è°ƒç”¨ `super`ï¼Œå¦‚æœæ²¡æœ‰è°ƒç”¨æŠ›å‡ºé”™è¯¯\r\n\r\n### \\_isNativeReflectConstruct\r\n\r\n```js\r\nfunction _isNativeReflectConstruct() {\r\n  if (typeof Reflect === 'undefined' || !Reflect.construct) return false;\r\n  if (Reflect.construct.sham) return false;\r\n  if (typeof Proxy === 'function') return true;\r\n  try {\r\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\r\n    return true;\r\n  } catch (e) {\r\n    return false;\r\n  }\r\n}\r\n```\r\n\r\nåˆ¤æ–­å½“å‰ç¯å¢ƒæ”¯ä¸æ”¯æŒ `Reflect.construct`ï¼Œå®ƒçš„åˆ¤æ–­æ€è·¯ä¸ºå‰ç½®åˆ¤æ–­ï¼Œå¦‚æœä¸ç¬¦åˆæ—©æ—©è¿”å›\r\n\r\n- `if (typeof Reflect === 'undefined' || !Reflect.construct) return false;`ï¼Œä¸æ”¯æŒåŸç”Ÿè¿”å› `false`\r\n- `if (Reflect.construct.sham) return false;`ï¼Œ`polyfill` çš„åˆ™ä¹Ÿè¿”å› `false`\r\n- `if (typeof Proxy === 'function') return true;`ï¼Œè¿”å› `true` çš„åŸå› æ˜¯å› ä¸ºï¼Œ`Proxy` çš„å…¼å®¹æ€§æ¯” `Reflect` å·®ï¼Œå¦‚æœ `Proxy` æ”¯æŒ `Reflect` ä¸€å®šä¹Ÿæ”¯æŒ\r\n  - [proxy å…¼å®¹æ€§æ€»è§ˆ](https://caniuse.com/?search=proxy)\r\n  - [Reflect å…¼å®¹æ€§æ€»è§ˆ](https://caniuse.com/?search=Reflect)\r\n- `Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));`ï¼Œå¦‚æœéƒ½ç¬¦åˆç›´æ¥è¿è¡Œï¼Œå‰é¢è¯´è¿‡ `Reflect.construct` æ”¯æŒç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå¦‚æœè¿è¡Œæ²¡æŠ¥é”™è¿”å› `true`\r\n\r\n### \\_getPrototypeOf\r\n\r\n```js\r\nfunction _getPrototypeOf(o) {\r\n  _getPrototypeOf = Object.setPrototypeOf\r\n    ? Object.getPrototypeOf\r\n    : function _getPrototypeOf(o) {\r\n        return o.__proto__ || Object.getPrototypeOf(o);\r\n      };\r\n  return _getPrototypeOf(o);\r\n}\r\n```\r\n\r\nè¿™æ®µä»£ç ä¸ºè·å–åŸå‹ï¼Œè·Ÿ `_setPrototypeOf` å‡½æ•°ç±»ä¼¼ï¼Œå¦‚æœå½“å‰ç¯å¢ƒæ”¯æŒä¼˜å…ˆä½¿ç”¨ `Object.getPrototypeOf` ä¸Šçš„ï¼Œå¦åˆ™å›æ»šã€‚\r\n\r\n## è¿è¡Œæµç¨‹\r\n\r\nè®²è§£åˆ°è¿™é‡Œï¼Œç»§æ‰¿åŸºæœ¬è®²å®Œäº†ï¼Œç°åœ¨æŠŠå®Œæ•´ä»£ç è´´ä»¥ä¸‹ï¼Œä¹‹åè®²ä¸€ä¸‹è¿è¡Œçš„æµç¨‹\r\n\r\n```js\r\n'use strict';\r\n\r\nfunction _typeof(obj) {\r\n  '@babel/helpers - typeof';\r\n  return (\r\n    (_typeof =\r\n      'function' == typeof Symbol && 'symbol' == typeof Symbol.iterator\r\n        ? function (obj) {\r\n            return typeof obj;\r\n          }\r\n        : function (obj) {\r\n            return obj && 'function' == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype\r\n              ? 'symbol'\r\n              : typeof obj;\r\n          }),\r\n    _typeof(obj)\r\n  );\r\n}\r\n\r\nfunction _inherits(subClass, superClass) {\r\n  if (typeof superClass !== 'function' && superClass !== null) {\r\n    throw new TypeError('Super expression must either be null or a function');\r\n  }\r\n  Object.defineProperty(subClass, 'prototype', {\r\n    value: Object.create(superClass && superClass.prototype, {\r\n      constructor: { value: subClass, writable: true, configurable: true },\r\n    }),\r\n    writable: false,\r\n  });\r\n  if (superClass) _setPrototypeOf(subClass, superClass);\r\n}\r\n\r\nfunction _setPrototypeOf(o, p) {\r\n  _setPrototypeOf =\r\n    Object.setPrototypeOf ||\r\n    function _setPrototypeOf(o, p) {\r\n      o.__proto__ = p;\r\n      return o;\r\n    };\r\n  return _setPrototypeOf(o, p);\r\n}\r\n\r\nfunction _createSuper(Derived) {\r\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\r\n  return function _createSuperInternal() {\r\n    var Super = _getPrototypeOf(Derived),\r\n      result;\r\n    if (hasNativeReflectConstruct) {\r\n      var NewTarget = _getPrototypeOf(this).constructor;\r\n      result = Reflect.construct(Super, arguments, NewTarget);\r\n    } else {\r\n      result = Super.apply(this, arguments);\r\n    }\r\n    return _possibleConstructorReturn(this, result);\r\n  };\r\n}\r\n\r\nfunction _possibleConstructorReturn(self, call) {\r\n  if (call && (_typeof(call) === 'object' || typeof call === 'function')) {\r\n    return call;\r\n  } else if (call !== void 0) {\r\n    throw new TypeError('Derived constructors may only return object or undefined');\r\n  }\r\n  return _assertThisInitialized(self);\r\n}\r\n\r\nfunction _assertThisInitialized(self) {\r\n  if (self === void 0) {\r\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\r\n  }\r\n  return self;\r\n}\r\n\r\nfunction _isNativeReflectConstruct() {\r\n  if (typeof Reflect === 'undefined' || !Reflect.construct) return false;\r\n  if (Reflect.construct.sham) return false;\r\n  if (typeof Proxy === 'function') return true;\r\n  try {\r\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\r\n    return true;\r\n  } catch (e) {\r\n    return false;\r\n  }\r\n}\r\n\r\nfunction _getPrototypeOf(o) {\r\n  _getPrototypeOf = Object.setPrototypeOf\r\n    ? Object.getPrototypeOf\r\n    : function _getPrototypeOf(o) {\r\n        return o.__proto__ || Object.getPrototypeOf(o);\r\n      };\r\n  return _getPrototypeOf(o);\r\n}\r\n\r\nfunction _defineProperty(obj, key, value) {\r\n  if (key in obj) {\r\n    Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true });\r\n  } else {\r\n    obj[key] = value;\r\n  }\r\n  return obj;\r\n}\r\n\r\nfunction _classCallCheck(instance, Constructor) {\r\n  if (!(instance instanceof Constructor)) {\r\n    throw new TypeError('Cannot call a class as a function');\r\n  }\r\n}\r\n\r\nfunction _defineProperties(target, props) {\r\n  for (var i = 0; i < props.length; i++) {\r\n    var descriptor = props[i];\r\n    descriptor.enumerable = descriptor.enumerable || false;\r\n    descriptor.configurable = true;\r\n    if ('value' in descriptor) descriptor.writable = true;\r\n    Object.defineProperty(target, descriptor.key, descriptor);\r\n  }\r\n}\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\r\n  if (staticProps) _defineProperties(Constructor, staticProps);\r\n  Object.defineProperty(Constructor, 'prototype', { writable: false });\r\n  return Constructor;\r\n}\r\n\r\nvar Parent = /*#__PURE__*/ (function () {\r\n  function Parent() {\r\n    _classCallCheck(this, Parent);\r\n\r\n    this.age = 17;\r\n  }\r\n\r\n  _createClass(\r\n    Parent,\r\n    [\r\n      {\r\n        key: 'getAge',\r\n        value: function getAge() {\r\n          return this.age;\r\n        },\r\n      },\r\n    ],\r\n    [\r\n      {\r\n        key: 'getName',\r\n        value: function getName() {\r\n          return this.name;\r\n        },\r\n      },\r\n    ],\r\n  );\r\n\r\n  return Parent;\r\n})();\r\n\r\nvar Child = /*#__PURE__*/ (function (_Parent) {\r\n  _inherits(Child, _Parent);\r\n\r\n  var _super = _createSuper(Child);\r\n\r\n  function Child() {\r\n    var _this;\r\n\r\n    _classCallCheck(this, Child);\r\n\r\n    _this = _super.call(this);\r\n    _this.name = 'child';\r\n    return _this;\r\n  }\r\n\r\n  _createClass(Child, [\r\n    {\r\n      key: 'getAll',\r\n      value: function getAll() {\r\n        return {\r\n          name: this.name,\r\n          age: this.age,\r\n        };\r\n      },\r\n    },\r\n  ]);\r\n\r\n  return Child;\r\n})(Parent);\r\n\r\n_defineProperty(Child, 'name', 'child');\r\n\r\nvar child = new Child();\r\nconsole.log(child.getAll());\r\nconsole.log(Child.getName());\r\n```\r\n\r\nä»£ç ä» `var Parent = /*#__PURE__*/ (function () {` è¿™æ®µå¼€å§‹\r\n\r\n- è°ƒç”¨ `_createClass`ï¼Œå°† `prototype å±æ€§` å’Œ `static å±æ€§` è®¾ç½®åˆ° Parent å‡½æ•°ä¸Š\r\n- ä¹‹åä»£ç å¾€ä¸‹æ‰§è¡Œï¼Œåˆ°`var Child = /*#__PURE__*/ (function (_Parent) {`\r\n- è°ƒç”¨ `_inherits`ï¼Œåˆ¤æ–­ Parent ç¬¦åˆè¦æ±‚ï¼Œè®¾ç½® `Child.prototype` å±æ€§ï¼Œè®¾ç½® Child åŸå‹\r\n- è°ƒç”¨ `_createSuper`ï¼Œè·å– `super`\r\n- è°ƒç”¨ `_createClass`ï¼Œè®¾ç½® `prototype å±æ€§` å’Œ `static å±æ€§` è®¾ç½®åˆ° Child å‡½æ•°ä¸Š\r\n- è°ƒç”¨ `_defineProperty`ï¼Œè¦†ç›– Child ä¸Šçš„å±æ€§ï¼Œç¡®ä¿æ˜¯å¯ä»¥éå†ä¿®æ”¹çš„\r\n- new Child\r\n- Child å‡½æ•°å†…éƒ¨æ‰§è¡Œ `_classCallCheck`ï¼Œç¡®ä¿ä¸€å®šä¸º `new` è°ƒç”¨\r\n- åœ¨ Child å‡½æ•°å†…éƒ¨æ‰§è¡Œ `_super.call(this)` æ“ä½œï¼Œè°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°\r\n- Parent å†…éƒ¨ï¼Œè°ƒç”¨ `_classCallCheck`ï¼Œç¡®ä¿ `new` è°ƒç”¨\r\n- è¿”å› Parent çš„ this å€¼\r\n- Child å†…éƒ¨ä¿®æ”¹ Parent è¿”å›çš„ this å€¼ï¼Œè¿›è¡Œé‡å†™\r\n- æ‰§è¡Œåç»­ä»£ç ...\r\n\r\n## è·Ÿ es5 ç»§æ‰¿çš„å·®å¼‚\r\n\r\nä»ä¸Šé¢ä»£ç ä¸éš¾çœ‹åˆ°è·Ÿ es5 å†™çš„ç»§æ‰¿æœ‰å¾ˆå¤§å·®å¼‚\r\n\r\n1. `prototype` ä¸å¯ä»¥éå†ï¼›\r\n2. ä¸é€šè¿‡ `new` è°ƒç”¨æ˜¾å¼æŠ¥é”™ï¼›\r\n3. Class çš„ç»§æ‰¿ä¸ä»…æ˜¯å°†å­ç±»çš„ `prototype` æŒ‡å‘çˆ¶ç±»çš„ `prototype`ï¼ŒåŒæ—¶ä¹Ÿå°†å­ç±»çš„åŸå‹æŒ‡å‘äº†çˆ¶ç±»ï¼›\r\n4. å¾—ç›Šäºå­ç±»åŸå‹æŒ‡å‘çˆ¶ç±»ï¼Œé™æ€æ–¹æ³•å’Œå±æ€§ä¹Ÿå¯ä»¥è°ƒç”¨ï¼›\r\n\r\n## æœ€å\r\n\r\nå¦‚æœæœ‰ä»€ä¹ˆä¸æ­£ç¡®æˆ–è€…ä¹¦å†™é”™è¯¯æ¬¢è¿æŒ‡å‡ºã€‚\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/81/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/81/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/80",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/80/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/80/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/80/events",
      "html_url": "https://github.com/bosens-China/blog/issues/80",
      "id": 1085660079,
      "node_id": "I_kwDOCzPAy85Atduv",
      "number": 80,
      "title": "Babel to Classä¹‹ç¼–è¯‘ï¼ˆ1ï¼‰",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1908144759,
          "node_id": "MDU6TGFiZWwxOTA4MTQ0NzU5",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/ES6%E7%B3%BB%E5%88%97",
          "name": "ES6ç³»åˆ—",
          "color": "0366d6",
          "default": false,
          "description": "ES6çš„æœ€æ–°è¯­æ³•"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2021-12-21T10:12:08Z",
      "updated_at": "2021-12-28T09:48:18Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "## å‰è¨€\r\n\r\nè¿™æ˜¯ã€ŠBabel to Classã€‹ç³»åˆ—çš„ç¬¬ä¸€ç¯‡\r\n\r\n- [Babel to Classä¹‹ç»§æ‰¿ï¼ˆ2ï¼‰](https://github.com/bosens-China/blog/issues/81)\r\n- [Babel to Classä¹‹ç§æœ‰å±æ€§ï¼ˆ3ï¼‰](https://github.com/bosens-China/blog/issues/82)\r\n- [Babel to Classä¹‹åŸç”Ÿæ„é€ å‡½æ•°ç»§æ‰¿ï¼ˆ4ï¼‰](https://github.com/bosens-China/blog/issues/88)\r\n\r\nè¿™ä¸ªç³»åˆ—ä¸»è¦è®² Class çš„æ™®é€šå†™æ³•ã€ç»§æ‰¿ã€ç§æœ‰å±æ€§å’ŒåŸç”Ÿæ„é€ å‡½æ•°ç»§æ‰¿ `babel` æ˜¯å¦‚ä½•å®ç°è¿™ä¸€è¿‡ç¨‹çš„ã€‚\r\n> æ³¨ï¼šæ–‡ç« é¡ºåºå­˜åœ¨å…³è”ï¼Œè¯·æŒ‰ç…§é¡ºåºé˜…è¯»ã€‚\r\n\r\n## å‰ç½®çŸ¥è¯†ç‚¹\r\n\r\n### Object.defineProperty\r\n\r\n`Object.defineProperty(obj, prop, descriptor)` ç”¨äºå®šä¹‰å¯¹è±¡å±æ€§ï¼Œå®ƒæœ‰ä¸‰ä¸ªå‚æ•°åˆ†ä¸ºåˆ«ï¼šå¯¹è±¡ï¼Œå¯¹è±¡ keyï¼Œä»¥åŠå±æ€§æè¿°ç¬¦ã€‚\r\n\r\nå±æ€§æè¿°ç¬¦é»˜è®¤ä¸ä¼ é€’å…·ä½“çš„å€¼åˆ™ä¸º `false`\r\n\r\n```js\r\nconst a = {};\r\nObject.defineProperty(a, 'd', {});\r\nObject.getOwnPropertyDescriptor(a, 'd');\r\n// {value: undefined, writable: false, enumerable: false, configurable: false}\r\n```\r\n\r\næœ‰ä¸¤ç§è°ƒç”¨å½¢å¼\r\n\r\n```js\r\nvar o = {};\r\n\r\n// 1.\r\nObject.defineProperty(o, 'a', {\r\n  value: 37,\r\n  writable: true,\r\n  enumerable: true,\r\n  configurable: true,\r\n});\r\n\r\n// 2.\r\nvar bValue = 38;\r\nObject.defineProperty(o, 'b', {\r\n  get() {\r\n    return bValue;\r\n  },\r\n  set(newValue) {\r\n    bValue = newValue;\r\n  },\r\n  enumerable: true,\r\n  configurable: true,\r\n});\r\n```\r\n\r\n> æ›´å¤šå†…å®¹ï¼Œä»¥åŠå±æ€§æè¿°ç¬¦åŒ…å«é‚£äº›ï¼Œè¯·[å‚è€ƒæ–‡æ¡£](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty)\r\n\r\n### Class\r\n\r\n- `Class`å¿…é¡»é€šè¿‡ `new` è°ƒç”¨ï¼Œå¦åˆ™æŠ›å‡º `Uncaught TypeError: Class constructor A cannot be invoked without 'new'`\r\n- `Class`çš„ `prototype` å±æ€§é»˜è®¤ä¸å¯éå†\r\n\r\n## ç¤ºä¾‹æ–‡ä»¶\r\n\r\n```js\r\nclass Test {\r\n  constructor() {\r\n    this.name = 'å¼ ä¸‰';\r\n  }\r\n\r\n  _age = 18;\r\n\r\n  get age() {\r\n    return this._age;\r\n  }\r\n\r\n  set age(value) {\r\n    this._age = value;\r\n  }\r\n\r\n  getName() {\r\n    return this.name;\r\n  }\r\n\r\n  static getClassName() {\r\n    return this.name;\r\n  }\r\n\r\n  static name = 'TestClass';\r\n}\r\n```\r\n\r\nä¸Šé¢å°±æ˜¯å‡†å¤‡å¥½çš„ç¤ºä¾‹æ–‡ä»¶ï¼Œç»“æ„å¾ˆç®€å•ï¼Œæˆ‘ä»¬çœ‹ä¸‹ `babel` ä¼šå°†ä»£ç è½¬ç æˆä»€ä¹ˆæ ·\r\n\r\n## babel\r\n\r\nä¸ºäº†æ–¹ä¾¿è®²è§£ï¼Œä¸‹é¢é€šè¿‡æ³¨é‡Šçš„å½¢å¼æ¥è§£è¯»ï¼Œé˜…è¯»éƒ¨åˆ†è¯·ä» `const Test = /* #__PURE__ */ (function () {` è¿™æ®µå¼€å§‹ã€‚\r\n\r\n```js\r\n'use strict';\r\n\r\nfunction _classCallCheck(instance, Constructor) {\r\n  /*\r\n   * Classå¿…é¡»é€šè¿‡newè°ƒç”¨ï¼Œè¿™æ˜¯åˆ¤æ–­è°ƒç”¨çš„thisè·ŸTestè¿›è¡Œinstanceofå¯¹æ¯”ï¼Œå¦‚æœä¸ç¬¦åˆæŠ›å‡ºé”™è¯¯\r\n   */\r\n  if (!(instance instanceof Constructor)) {\r\n    throw new TypeError('Cannot call a class as a function');\r\n  }\r\n}\r\n\r\n/**\r\n * ç”¨äºç»™å¯¹è±¡å®šä¹‰å±æ€§\r\n * æ³¨æ„å®ƒåˆ¤æ–­äº†valueå±æ€§æ˜¯å¦å­˜åœ¨ï¼Œè¿™æ˜¯å› ä¸ºå­˜åœ¨ä¸¤ç§å†™æ³•\r\n * ä¸€ç§æ˜¯ä¼ é€’valueçš„æ™®é€š\r\n * å¦å¤–ä¸€ç§æ˜¯ä¼ é€’getå’Œsetçš„å½¢å¼\r\n */\r\nfunction _defineProperties(target, props) {\r\n  for (let i = 0; i < props.length; i++) {\r\n    const descriptor = props[i];\r\n    descriptor.enumerable = descriptor.enumerable || false;\r\n    descriptor.configurable = true;\r\n    if ('value' in descriptor) descriptor.writable = true;\r\n    Object.defineProperty(target, descriptor.key, descriptor);\r\n  }\r\n}\r\n\r\n/**\r\n * åˆå§‹åŒ–Classå±æ€§\r\n * å…ˆä»å‡½æ•°çš„prototypeå±æ€§æ¥è¿›è¡Œå®šä¹‰\r\n * åé¢å®šä¹‰Constructoræœ¬èº«çš„å±æ€§\r\n */\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\r\n  if (staticProps) _defineProperties(Constructor, staticProps);\r\n  Object.defineProperty(Constructor, 'prototype', { writable: false });\r\n  return Constructor;\r\n}\r\n\r\n/**\r\n * ç”¨äºç»™Testå®ä¾‹å’Œæœ¬èº«å®šä¹‰å±æ€§\r\n * ä¹‹æ‰€ä»¥è¿›è¡Œä¸€ä¸ª in åˆ¤å®šæ˜¯ä¸ºäº†è¦†ç›–æœ¬èº«å·²ç»æœ‰çš„å±æ€§\r\n * ä¾‹å¦‚class.nameå±æ€§ï¼Œè¿™ä¸ªæœ¬èº«å·²ç»å­˜åœ¨ {value: 'A', writable: false, enumerable: false, configurable: true}\r\n * ä½†æ˜¯æˆ‘ä»¬ä»æ–°å®šä¹‰å°±è¦å±æ€§æè¿°ç¬¦å…¨éƒ¨ä¸ºtrue\r\n */\r\nfunction _defineProperty(obj, key, value) {\r\n  if (key in obj) {\r\n    Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true });\r\n  } else {\r\n    obj[key] = value;\r\n  }\r\n  return obj;\r\n}\r\n\r\nconst Test = /* #__PURE__ */ (function () {\r\n  function Test() {\r\n    // åˆå§‹è¿›è¡Œnewè°ƒç”¨åˆ¤æ–­\r\n    _classCallCheck(this, Test);\r\n    // å®ä¾‹å±æ€§å†™æ³•\r\n    _defineProperty(this, '_age', 18);\r\n\r\n    this.name = 'å¼ ä¸‰';\r\n  }\r\n\r\n  // åˆå§‹åŒ–ï¼Œåé¢åˆ†ä¸ºä¸ºprototypeå±æ€§ä»¥åŠé™æ€å±æ€§\r\n  _createClass(\r\n    Test,\r\n    [\r\n      {\r\n        key: 'age',\r\n        get: function get() {\r\n          return this._age;\r\n        },\r\n        set: function set(value) {\r\n          this._age = value;\r\n        },\r\n      },\r\n      {\r\n        key: 'getName',\r\n        value: function getName() {\r\n          return this.name;\r\n        },\r\n      },\r\n    ],\r\n    [\r\n      {\r\n        key: 'getClassName',\r\n        value: function getClassName() {\r\n          return this.name;\r\n        },\r\n      },\r\n    ],\r\n  );\r\n\r\n  return Test;\r\n})();\r\n\r\n_defineProperty(Test, 'name', 'TestClass');\r\n```\r\n\r\næ¦‚å†µä¸€ä¸‹ä¸Šé¢æµç¨‹ï¼š\r\n\r\n1. åˆå§‹åŒ– `Class` ä¸Šçš„ `prototype å±æ€§`ä»¥åŠ `static å±æ€§`\r\n2. `new Class` çš„æ—¶å€™ï¼Œå¯¹ Class çš„è°ƒç”¨å½¢å¼è¿›è¡Œåˆ¤æ–­\r\n3. `new` è¿‡ç¨‹ä¸­èµ‹å€¼å®ä¾‹å±æ€§\r\n4. æ‰§è¡Œ...\r\n\r\n## æœ€å\r\n\r\nå¦‚æœæœ‰ä»€ä¹ˆä¸æ­£ç¡®æˆ–è€…ä¹¦å†™é”™è¯¯æ¬¢è¿æŒ‡å‡ºã€‚\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/80/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/80/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/88",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/88/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/88/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/88/events",
      "html_url": "https://github.com/bosens-China/blog/issues/88",
      "id": 1089747064,
      "node_id": "I_kwDOCzPAy85A9Dh4",
      "number": 88,
      "title": "Babel to Classä¹‹åŸç”Ÿæ„é€ å‡½æ•°ç»§æ‰¿ï¼ˆ4ï¼‰",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1935755992,
          "node_id": "MDU6TGFiZWwxOTM1NzU1OTky",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%BE%85%E5%AE%8C%E6%88%90%E7%B3%BB%E5%88%97",
          "name": "å¾…å®Œæˆç³»åˆ—",
          "color": "cc6e43",
          "default": false,
          "description": "ç­‰å¾…å®Œæˆçš„æ–‡ç« ..."
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2021-12-28T09:44:09Z",
      "updated_at": "2021-12-28T09:44:09Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": null,
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/88/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/88/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/83",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/83/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/83/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/83/events",
      "html_url": "https://github.com/bosens-China/blog/issues/83",
      "id": 1085661652,
      "node_id": "I_kwDOCzPAy85AteHU",
      "number": 83,
      "title": "æ¼«è°ˆç¨‹åºåˆå§‹åŒ–",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1371686608,
          "node_id": "MDU6TGFiZWwxMzcxNjg2NjA4",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%BC%AB%E8%B0%88%E7%B3%BB%E5%88%97",
          "name": "æ¼«è°ˆç³»åˆ—",
          "color": "e7f3ee",
          "default": false,
          "description": "æµ…è°ˆç±»æ–‡ç« "
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2021-12-21T10:13:42Z",
      "updated_at": "2021-12-24T05:45:59Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "## å‰è¨€\r\n\r\nåœ¨è½¯ä»¶å·¥ç¨‹çš„å¼€å‘ä¸­æœ‰ç”Ÿå‘½å‘¨æœŸè¿™ä¸ªæ¦‚å¿µï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯å®šä¹‰å„ä¸ªé˜¶æ®µéœ€è¦å¤„ç†çš„äº‹æƒ…è·Ÿ `tcp/ip` åè®®åˆ†å±‚ä¸€ä¸ªæ„æ€ï¼Œä»Šå¤©é‡ç‚¹èŠä¸€èŠåˆå§‹åŒ–è¿™ä¸ªé˜¶æ®µã€‚\r\n\r\n- åœ¨æ—¥å¸¸ä½¿ç”¨çš„ `webpack`ã€`vite` ç­‰å·¥å…·ä¼šæœ‰ä¸€ä¸ªé…ç½®æ”¶é›†çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯åˆå§‹åŒ–ï¼›\r\n- åœ¨ä½¿ç”¨ `react`ã€`vue` ç­‰æ¡†æ¶æ—¶ä¹Ÿä¼šæœ‰ `created` ç­‰ç”Ÿå‘½å‘¨æœŸå‡½æ•°æš´éœ²ï¼Œåœ¨æ­¤é˜¶æ®µæ‰§è¡Œä¸€äº›è¯·æ±‚ api ç­‰æ“ä½œï¼Œè¿™ä¹Ÿæ˜¯åˆå§‹åŒ–ï¼›\r\n- åœ¨ä½¿ç”¨ `koa` ç­‰ `node` æ¡†æ¶å¯åŠ¨æœåŠ¡ä¹‹å‰è¿›è¡Œ `use` è£…è½½ä¹Ÿæ˜¯åˆå§‹åŒ–ï¼›\r\n- ç”šè‡³ï¼Œä¸€æ®µä»£ç åœ¨æ‰§è¡Œä¹‹å‰é€šå¸¸ä¼šç»å†ä»¥ä¸‹ä¸‰ä¸ªé˜¶æ®µï¼Œä¹Ÿå¯ä»¥æ¦‚æ‹¬ä¸ºåˆå§‹åŒ–\r\n  - åˆ†è¯/è¯æ³•åˆ†æ\r\n  - è§£æ/è¯­æ³•åˆ†æ\r\n  - ç”Ÿæˆä»£ç \r\n\r\nä¸‹é¢ï¼Œæˆ‘æŠŠä»»åŠ¡åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š\r\n\r\n- å¯ä»¥å‰ç½®åŒ–å¤„ç†\r\n- ä¸èƒ½å‰ç½®åŒ–å¤„ç†\r\n\r\n## å‰ç½®åˆå§‹åŒ–\r\n\r\nä¸Šé¢ä¸¾ä¾‹çš„ä¸€å¤§å †ï¼Œä½ ä¼šå‘ç°å¾ˆå¤šä»»åŠ¡æˆ‘ä»¬å¯ä»¥å¾ˆè‡ªç„¶å®Œæˆï¼Œä¾‹å¦‚ï¼š\r\n\r\n- `webpack`ã€`vite` è¯»å–é…ç½®ï¼Œå¦‚æœè®©ä½ å†™å¤§æ¦‚å°±æ˜¯æ ¹æ® `npm script` å¡«å†™ config çš„è·¯å¾„è¿›è¡Œè§£æï¼Œç„¶åé€šè¿‡ node çš„ `fs` æ¨¡å—è¿›è¡Œè¯»å–\r\n- `koa` åœ¨è£…è½½æ’ä»¶ä¹‹å‰å¯èƒ½è¿˜éœ€è¦è‡ªåŠ¨å¯¼å…¥æ‰€æœ‰ç¬¦åˆè¦æ±‚çš„æ–‡ä»¶ï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡ `glob` æ¨¡å—æ¥æŸ¥æ‰¾æ‰€æœ‰ç¬¦åˆè§„åˆ™çš„æ–‡ä»¶è¿›è¡Œæ‰¹é‡å¯¼å…¥\r\n\r\nä¸Šé¢çš„ä»»åŠ¡éƒ½å¯ä»¥é€šè¿‡ node æä¾›çš„åŒæ­¥ api è¿›è¡Œå®Œæˆï¼Œä¸”ä»–ä»¬åªä¼šè¿è¡Œä¸€æ¬¡å¹¶ä¸ä¼šå½±å“åˆ°ä¸»ä½“çš„åŠŸèƒ½ã€‚\r\n\r\nä½†æ˜¯æœ‰ä¸€äº›æ“ä½œï¼Œä¾‹å¦‚è¯·æ±‚ç½‘ç»œï¼Œå¼‚æ­¥åŠ è½½æ¨¡å—åç»­çš„æ“ä½œéƒ½éœ€è¦ç­‰å¾…åŠ è½½å®Œæˆä¹‹åæ‰èƒ½æ‰§è¡Œï¼Œè¿™ç§æƒ…å†µä¸‹æ²¡æœ‰åŒæ­¥çš„è¯­æ³•ä¾›ä½¿ç”¨ï¼Œæ²¡åŠæ³•å®Œæˆå‰ç½®ä¾èµ–çš„å¤„ç†ã€‚\r\n\r\nä¸‹é¢å°±æŠ›ç –å¼•ç‰èŠèŠè¿™ç§æƒ…å†µå¦‚ä½•å¤„ç†\r\n\r\n## éå‰ç½®åŒ–å¤„ç†\r\n\r\nä¸‹é¢çš„ä¾‹å­éƒ½ä»¥ db æ¨¡å—ä¸ºä¾‹ï¼Œå®ƒè´Ÿè´£è¿æ¥æ•°æ®åº“ä¹‹åè¿›è¡Œè¯»å–æ•°æ®ï¼Œå¯èƒ½æœ‰ä¸€ä¸ª connect çš„æ–¹æ³•å’Œ queue çš„æŸ¥è¯¢æ–¹æ³•ã€‚\r\n\r\n```js\r\nclass Db {\r\n  constructor() {\r\n    this.signIn = false;\r\n  }\r\n  connect() {\r\n    if (this.signIn) {\r\n      return Promise.resolve(true);\r\n    }\r\n    return new Promise((resolve) => {\r\n      setTimeout(() => {\r\n        this.signIn = true;\r\n        resolve(true);\r\n      }, 3000);\r\n    });\r\n  }\r\n  async queue(str) {\r\n    if (!this.signIn) {\r\n      throw new Error(`å¿…é¡»è¿æ¥æ•°æ®åº“æ‰èƒ½ä½¿ç”¨queueï¼`);\r\n    }\r\n    console.log(str);\r\n  }\r\n}\r\nconst db = new Db();\r\n\r\nconst app = async () => {\r\n  await db.connect();\r\n  await db.queue(`xx`);\r\n};\r\napp();\r\n```\r\n\r\n> ä¸ºäº†æ¼”ç¤ºï¼Œåé¢ä»£ç å…¨éƒ¨ä¸ºç®€åŒ–ç‰ˆæœ¬ï¼Œä¸æ‰§è¡Œå…·ä½“æ“ä½œ\r\n\r\næˆ‘ä»¬åœ¨ç¨‹åºä¸­è°ƒç”¨è¿™ä¸ª db æ¨¡å—ï¼Œä½ ä¼šå‘ç°å‘ç° `await db.connect()` è¿™æ®µä»£ç çœç•¥ä¸äº†ï¼Œæˆ‘ä»¬çš„ç¨‹åºä¾èµ– connect è¿™ä¸€æ­¥ã€‚\r\n\r\nä¸”å› ä¸ºåªæ˜¯æ¼”ç¤ºæ²¡æœ‰ä¼ é€’å…·ä½“çš„å¯†ç å’Œè´¦å·ï¼Œä½†æƒ³è±¡ä¸€ä¸‹æ¯æ¬¡è°ƒç”¨ db éƒ½éœ€è¦æ‰‹åŠ¨ä¼ é€’ä¸€æ¬¡è´¦å·å’Œå¯†ç ä¹Ÿå¤ªç³Ÿå¿ƒäº†ã€‚\r\n\r\næœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥ç®€åŒ–è¿™ä¸ªè¿‡ç¨‹å‘¢ï¼Ÿå¯ä»¥å¯¹ connect è¿›è¡Œä¸€æ¬¡å°è£…ï¼Œæœ€åæš´éœ² db æ¨¡å—å‡ºå»ã€‚\r\n\r\n### å°è£… connect\r\n\r\n```js\r\nclass Db {\r\n  constructor() {\r\n    this.signIn = false;\r\n  }\r\n  connect() {\r\n    if (this.signIn) {\r\n      return Promise.resolve(true);\r\n    }\r\n    return new Promise((resolve) => {\r\n      setTimeout(() => {\r\n        this.signIn = true;\r\n        resolve(true);\r\n      }, 3000);\r\n    });\r\n  }\r\n  async queue(str) {\r\n    if (!this.signIn) {\r\n      throw new Error(`å¿…é¡»è¿æ¥æ•°æ®åº“æ‰èƒ½ä½¿ç”¨queueï¼`);\r\n    }\r\n    console.log(str);\r\n  }\r\n}\r\nconst proxyDb = (() => {\r\n  const db = new Db();\r\n  let sign = false;\r\n  return async () => {\r\n    if (!sign) {\r\n      sign = await db.connect();\r\n    }\r\n    return db;\r\n  };\r\n})();\r\nconst app = async () => {\r\n  const db = await proxyDb();\r\n  await db.queue('xxx');\r\n};\r\napp();\r\n```\r\n\r\nä½¿ç”¨ä¸€ä¸ªä»£ç†å°† `connect` è¿›è¡Œç¼“å­˜èµ·æ¥ï¼Œç¡®ä¿æ‰§è¡Œä¸€æ¬¡ï¼Œåç»­ä½¿ç”¨ç›´æ¥ await è°ƒç”¨ã€‚\r\n\r\nä¸è¿‡è¿™ç§æ–¹æ³•è™½ç„¶å®ç°ç®€å•ï¼Œä½†æ˜¯ä½“éªŒåªèƒ½è¯´ä¸€èˆ¬ï¼Œæœ‰æ²¡æœ‰æ›´åŠ ä¼˜é›…çš„æ–¹æ³•å‘¢ï¼Ÿ\r\n\r\n### é¢„å…ˆé˜Ÿåˆ—\r\n\r\nè§‚å¯Ÿä¸Šé¢ db çš„æ“ä½œï¼Œå¯ä»¥çœ‹åˆ°ä¸¤éƒ¨åˆ†\r\n\r\n- ç™»å½•æ“ä½œ\r\n- ä¾èµ–ç™»å½•æ“ä½œçš„åç»­\r\n\r\næˆ‘ä»¬å¯ä»¥æŠŠéœ€è¦ä¾èµ–ç™»å½•çš„æ“ä½œè¿›è¡Œä¸€ä¸ªå°è£…ï¼Œå¦‚æœæ²¡æœ‰ç™»å½•å°± push åˆ°é˜Ÿåˆ—ä¸­ï¼Œç­‰åˆ°ç™»å½•çš„æ—¶å€™è¿›è¡Œä¸€ä¸ªæ•´ä½“çš„æ‰§è¡Œã€‚\r\n\r\n```js\r\nclass Db {\r\n  constructor() {\r\n    this.signIn = false;\r\n    this.list = [];\r\n  }\r\n  connect() {\r\n    if (this.signIn) {\r\n      return Promise.resolve(true);\r\n    }\r\n    return new Promise((resolve) => {\r\n      setTimeout(() => {\r\n        this.signIn = true;\r\n        this.list.forEach((fn) => fn());\r\n        this.list = [];\r\n        resolve(true);\r\n      }, 3000);\r\n    });\r\n  }\r\n  queue(str) {\r\n    return new Promise((resolve) => {\r\n      const fn = () => {\r\n        console.log(str);\r\n        resolve(undefined);\r\n      };\r\n      if (this.signIn) {\r\n        return fn();\r\n      }\r\n      this.list.push(fn);\r\n    });\r\n  }\r\n}\r\nconst db = new Db();\r\ndb.connect();\r\nconst app = async () => {\r\n  await db.queue('xxx');\r\n};\r\napp();\r\n```\r\n\r\n- åœ¨ç›´æ¥æ‰§è¡Œ `queue` çš„æ—¶å€™çŠ¶æ€è¿˜æ²¡æœ‰ç™»å½•ï¼Œæ·»åŠ åˆ° `list` ä¸­ï¼›\r\n- `connect` æ‰§è¡ŒæˆåŠŸï¼Œé‡Šæ”¾é˜Ÿåˆ—çš„å€¼\r\n\r\n### é¢„å…ˆé˜Ÿåˆ—çŠ¶æ€åˆ†ç¦»\r\n\r\nä¸Šè¿°çš„è¦æ±‚æˆ‘ä»¬å®ç°äº†ï¼Œä½†æ˜¯åé¢å¦‚æœè¿˜æœ‰å…¶ä»–çš„æ–¹æ³•ï¼Œä¾‹å¦‚ `toArray`ã€`findOne` ç­‰æ–¹æ³•ï¼Œä¸€ä¸ªä¸ªå†™é‡å¤çš„æ­¥éª¤å¤ªç¹çäº†ã€‚\r\n\r\næŒ‰ç…§è®¾è®¡æ¨¡å¼å•ä¸€åŸåˆ™ï¼Œæˆ‘ä»¬å°è¯•è¿›è¡Œåˆ†ç¦»ä¸€ä¸‹\r\n\r\n- æ‰§è¡Œ db ç›¸å…³çš„æ“ä½œåªæ‰§è¡Œè¿™éƒ¨åˆ†\r\n- å¯¹æœªç™»å½•çŠ¶æ€çš„æ“ä½œè¿›è¡Œä¸€ä¸ªç»Ÿä¸€æ‹¦æˆª\r\n\r\nè¿™éƒ¨åˆ†æ‹¦æˆªå¯ä»¥åŸºäº ES6 çš„ `proxy`ï¼Œä¹Ÿå¯ä»¥æ˜¯ class çš„ `extends`ï¼Œè¿™é‡Œé‡‡ç”¨ extends çš„æ–¹å¼æ¥è¿›è¡Œã€‚\r\n\r\n```js\r\nclass Db {\r\n  constructor() {\r\n    this.signIn = false;\r\n  }\r\n  connect() {\r\n    if (this.signIn) {\r\n      return Promise.resolve(true);\r\n    }\r\n    return new Promise((resolve) => {\r\n      setTimeout(() => {\r\n        this.signIn = true;\r\n        resolve(true);\r\n      }, 3000);\r\n    });\r\n  }\r\n  async queue(str) {\r\n    console.log(str);\r\n  }\r\n}\r\nclass ProxyDb extends Db {\r\n  constructor() {\r\n    super();\r\n    this.list = [];\r\n    ['queue'].forEach((item) => {\r\n      this[item] = (...rest) => {\r\n        return new Promise((resolve) => {\r\n          const fn = () => {\r\n            const result = super[item].apply(this, rest);\r\n            return resolve(result);\r\n          };\r\n          if (!super.signIn) {\r\n            this.list.push(fn);\r\n            return;\r\n          }\r\n          fn();\r\n        });\r\n      };\r\n    });\r\n  }\r\n  async connect() {\r\n    await super.connect();\r\n    this.list.forEach((fn) => fn());\r\n  }\r\n}\r\nconst db = new ProxyDb();\r\ndb.connect();\r\ndb.queue('xxx');\r\n```\r\n\r\né€šè¿‡ç»§æ‰¿é‡å†™ `connect` æ“ä½œï¼Œåœ¨ `constructor` é˜¶æ®µæŠŠéœ€è¦ä»£ç†çš„æ–¹æ³•æ‰‹å†™åˆ°å­ç±»ä¸­ï¼Œæœ€ååˆ©ç”¨ Promise çš„ç‰¹æ€§ï¼Œç­‰å¾… `connect `å®Œæˆä¹‹å `resolve`ã€‚\r\n\r\n### é¡¶å±‚ await\r\n\r\né™¤äº†ä¸Šè¿°çš„ä¸¤ç§æ–¹æ³•ï¼ŒES6 çš„æœ€æ–° `é¡¶å±‚ await` ä¹Ÿå¯ä»¥å¸®åŠ©å®ç°æ•ˆæœï¼Œé¡¶å±‚ await æ˜¯ä¸ºäº†è§£å†³æ¨¡å—å¼‚æ­¥åŠ è½½é—®é¢˜ï¼Œå¯¹äºæœ¬æ–‡åˆšå¥½å¯ä»¥ç”¨åˆ°ã€‚\r\n\r\næˆ‘ä»¬ä¹‹æ‰€ä»¥è¦å¯¹ `db` æ¨¡å— è¿›è¡Œç¼“å­˜å’Œé˜Ÿåˆ—ç­‰ä¸€ç³»åˆ—æ“ä½œï¼Œå°±æ˜¯å› ä¸ºåˆå§‹åŒ–è¿™éƒ¨åˆ†æˆ‘ä»¬æ²¡åŠæ³•å®Œæˆå‰ç½®ï¼Œä¸èƒ½åƒè¯»å–é…ç½®æ–‡ä»¶ä¸€æ ·é€šè¿‡åŒæ­¥ api è¯­æ³•å®Œæˆã€‚\r\n\r\nä½†æ˜¯é¡¶å±‚ await çš„å‡ºç°ï¼Œè®©å…¶æœ‰ä¸€ç§åŒæ­¥çš„è¯­æ³•å®Œæˆè¿™éƒ¨åˆ†å·¥ä½œã€‚\r\n\r\n```js\r\nclass Db {\r\n  constructor() {\r\n    this.signIn = false;\r\n  }\r\n  connect() {\r\n    if (this.signIn) {\r\n      return Promise.resolve(true);\r\n    }\r\n    return new Promise((resolve) => {\r\n      setTimeout(() => {\r\n        this.signIn = true;\r\n        resolve(true);\r\n      }, 3000);\r\n    });\r\n  }\r\n  async queue(str) {\r\n    if (!this.signIn) {\r\n      throw new Error(`å¿…é¡»è¿æ¥æ•°æ®åº“æ‰èƒ½ä½¿ç”¨queueï¼`);\r\n    }\r\n    console.log(str);\r\n  }\r\n}\r\n```\r\n\r\nè¿™æ˜¯æœ€åˆæˆ‘ä»¬çš„ db æ¨¡å—ï¼Œä½¿ç”¨é¡¶å±‚ await åªéœ€è¦ï¼Œç›´æ¥ `import` å\r\n\r\n```js\r\nconst db = new Db();\r\nawait db.connect();\r\nawait db.queue('xxx');\r\n```\r\n\r\n## æœ€å\r\n\r\næŠ›ç –å¼•ç‰èŠäº†åˆå§‹åŒ–åŠ è½½å¯èƒ½é‡åˆ°çš„æƒ…å†µï¼Œå—é™äºèŠå¤©çš„æ–¹å‘ï¼Œå¾ˆå¤šå¼‚å¸¸æƒ…å†µæ²¡æœ‰ç»™äºˆè€ƒè™‘ï¼Œä¾‹å¦‚æ•°æ®åº“å¦‚æœè¿æ¥æ“ä½œï¼Œéœ€è¦æ‰‹åŠ¨å¯¹é˜Ÿåˆ—çš„æ“ä½œè¿›è¡Œ `reject` çš„é”™è¯¯æŠ›å‡ºã€‚\r\n\r\næœ€åå¦‚æœæ–‡ç« æœ‰ä»€ä¹ˆé”™è¯¯æˆ–è€…é”™åˆ«å­—æ¬¢è¿æŒ‡å‡ºã€‚\r\n\r\n> å‚è€ƒï¼š\r\n>\r\n> - [é¡¶å±‚ await](https://es6.ruanyifeng.com/#docs/async#%E9%A1%B6%E5%B1%82-await)\r\n> - [ECMAScript proposal: Top-level `await`](https://github.com/tc39/proposal-top-level-await)\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/83/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/83/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/86",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/86/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/86/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/86/events",
      "html_url": "https://github.com/bosens-China/blog/issues/86",
      "id": 1085665053,
      "node_id": "I_kwDOCzPAy85Ate8d",
      "number": 86,
      "title": "æ¼«è°ˆå¼‚æ­¥å‡½æ•°æ‰§è¡Œçš„å‰ä¸–ä»Šç”Ÿ",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1371686608,
          "node_id": "MDU6TGFiZWwxMzcxNjg2NjA4",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%BC%AB%E8%B0%88%E7%B3%BB%E5%88%97",
          "name": "æ¼«è°ˆç³»åˆ—",
          "color": "e7f3ee",
          "default": false,
          "description": "æµ…è°ˆç±»æ–‡ç« "
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2021-12-21T10:17:10Z",
      "updated_at": "2021-12-23T05:42:51Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "ä»Šå¤©ç®€å•èŠèŠå¼‚æ­¥å‡½æ•°çš„æ¼”å˜å²ï¼Œä¸ç€é‡è®²è§£è¯­æ³•æœ¬èº«ï¼Œè€Œæ˜¯å€Ÿæ­¤çª¥æ¢ä¸€ä¸‹æ¼”å˜è¿‡ç¨‹ï¼Œä»¥åŠæ˜¯åŸºäºä»€ä¹ˆåŸå› ä¸€æ­¥æ­¥æ¨è¿›ã€‚\r\n\r\n## å›è°ƒå‡½æ•°\r\n\r\nå›è°ƒå‡½æ•°æ˜¯æœ€ç®€å•å¤„ç†å¼‚æ­¥çš„æ–¹å¼ï¼Œä¹‹æ‰€ä»¥ä¼šæœ‰å›è°ƒå‡½æ•°åŸå› åœ¨äº `JavaScript` æ˜¯å•çº¿ç¨‹çš„è¯­è¨€ï¼Œå¦‚æœé‡åˆ° io è¾“å…¥å°±ä¼šé˜»å¡åœ¨è¿™é‡Œï¼Œä½“éªŒæ„Ÿå—è¾ƒå·®ï¼Œä¸ºäº†ä¸å½±å“æ€§èƒ½åˆ»æ„è®¾è®¡ã€‚\r\n\r\nå½“ç„¶å›è°ƒå‡½æ•°æœ¬èº«ä¸æ˜¯é—®é¢˜ï¼Œä¾‹å¦‚æˆ‘ä»¬ç‚¹å‡»æäº¤æŒ‰é’®ï¼Œåœ¨ `jQuery` å¯èƒ½ä¼šè¿™æ ·å†™\r\n\r\n```js\r\n$(\".btn\").on(\"click\", () => {\r\n  // éªŒè¯é€šè¿‡ï¼Œæ‰§è¡Œå‘é€\r\n  $.ajax({\r\n    url: url,\r\n    data: data,\r\n    success: success,\r\n    dataType: dataType,\r\n  });\r\n});\r\n```\r\n\r\nå¯ä»¥çœ‹åˆ°ï¼Œåœ¨åŠŸèƒ½ç®€å•çš„æƒ…å†µä¸‹ä½¿ç”¨å›è°ƒå‡½æ•°æ˜¯æœ€ç®€æ´çš„å†™æ³•ã€‚\r\n\r\nå›è°ƒå‡½æ•°çš„é—®é¢˜åœ¨äºéœ€æ±‚çš„ä¸æ–­æ‰©å……ï¼Œä½¿å¾—æˆ‘ä»¬åœ¨å›è°ƒå‡½æ•°ä¸åœçš„åµŒå¥—ï¼Œä¸”è¿˜è¦åœ¨æ¯å±‚è€ƒè™‘æŠ›å‡ºå¼‚å¸¸çš„æƒ…å†µï¼Œæƒ³æƒ³å°±è®©äººå¤´å¤§ã€‚\r\n\r\n```js\r\nfn1(fn2(fn3(fn4())));\r\n```\r\n\r\nä¸‹é¢é€šè¿‡ä¸€ä¸ªçˆ¬è™«ä¾‹å­ä¸¾ä¾‹ï¼Œæˆ‘ä»¬éœ€è¦è·å–æŸç½‘ç«™åˆ—è¡¨å­—æ®µè¿˜æœ‰æ¯ä¸ªåˆ—è¡¨å¯¹åº”çš„è¯¦æƒ…å­—æ®µã€‚\r\n\r\n```js\r\nconst request = require(\"request\");\r\n\r\nconst reptile = (fn) => {\r\n  request(\"xxx/list\", function (error, response, body) {\r\n    if (error) {\r\n      return fn(error);\r\n    }\r\n    request(\"xxx/details\", function (err, res, data) {\r\n      if (error) {\r\n        return fn(error);\r\n      }\r\n      fn(body, data);\r\n    });\r\n  });\r\n};\r\n```\r\n\r\né¦–å…ˆæˆ‘ä»¬çœ‹ä¸Šé¢è¿™æ®µä»£ç ï¼Œå› ä¸ºæ˜¯åªè¯·æ±‚ä¸¤æ¬¡æ‰€ä»¥çœ‹èµ·æ¥ä¸ç®—æ··ä¹±ï¼Œä¸è¿‡ä¹Ÿå¯ä»¥å‘ç°ä¸¤å¤„é—®é¢˜ï¼š\r\n\r\n- å›è°ƒå‡½æ•°å†…çš„å‘½åï¼ŒæŒ‰ç…§å¥½çš„åšæ³•ä¸åº”å½“å­˜åœ¨é®è”½ç°è±¡ï¼Œå†…éƒ¨çš„ä»£ç è¦†ç›–å¤–å±‚çš„å˜é‡ï¼Œè¿™æ ·ä¼šå¯¼è‡´å¼•ç”¨å’Œæ­§ä¹‰\r\n- ä»£ç åœ¨æœè¿™ `>>>` çš„å½¢å¼æ‹“å±•\r\n\r\nå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡èŒè´£åˆ†ç¦»æ¥è¿›è¡Œä¸€å®šç¨‹åº¦çš„ç¼“è§£ï¼Œä¾‹å¦‚ä¸Šé¢ä»£ç æˆ‘ä»¬æŠŠçˆ¬å–åˆ—è¡¨å’Œçˆ¬å–è¯¦æƒ…åˆ†ç¦»å¼€ï¼Œé€šè¿‡ä¸€ä¸ªä¸»å‡½æ•°æ¥è¿›è¡Œç»„è£…ï¼Œä¸è¿‡è¿™æ ·çš„ä½œæ³•ä¹Ÿåªæ˜¯ç¼“è§£ï¼Œå½“ç¨‹åºè¶Šæ¥è¶Šåºå¤§ç»´æŠ¤å’Œè°ƒè¯•çš„æˆæœ¬ä¹Ÿä¼šè¶Šæ¥è¶Šé«˜ã€‚\r\n\r\n## Promise\r\n\r\n`Promise` æ˜¯ç¤¾åŒºä¸ºäº†è§£å†³å›è°ƒé—®é¢˜è€Œå‡ºç°çš„ææ¡ˆï¼Œ`ES6` çš„æ—¶å€™å°†å…¶å¸æ”¶åˆ°è§„èŒƒå†…ï¼Œå˜æˆäº†è¯­è¨€å†…ç½®çš„ç‰¹æ€§ã€‚\r\nä¸ºäº†ä¿æŒè·Ÿä¹‹å‰ä»£ç å…¼å®¹ï¼Œç°åœ¨ Promise çš„æ£€æµ‹éƒ½æ˜¯åŸºäº`.then`æ–¹æ³•ã€‚\r\n\r\nåœ¨è¯´ Promise ä¹‹å‰ï¼Œæˆ‘ä»¬æ¥å›å¿†ä¸€ä¸‹å®ƒçš„ç‰¹æ€§\r\n\r\n- Promise åˆ›å»ºä¹‹åä¸å¯å–æ¶ˆ\r\n- Promise åªæœ‰ä¸‰ç§çŠ¶æ€ï¼šè¿›è¡Œã€å®Œæˆå’Œå¤±è´¥ï¼ŒçŠ¶æ€å˜æ›´åä¸ä¼šæ”¹å˜\r\n- Promise å¯ä»¥éšæ—¶ `.then`ï¼Œæ¯æ¬¡ then éƒ½è¿”å›ä¸€ä¸ªæ–°çš„ Promise å®ä¾‹\r\n\r\nä¸Šé¢çš„ç‰¹æ€§æ€»ç»“ä¸‹æ¥å°±æ˜¯ç»™æˆ‘ä»¬ä¸€ä¸ªç»Ÿä¸€çš„å¤„ç†æœºåˆ¶ï¼Œå¯ä»¥éšæ—¶è°ƒç”¨ä¸ç”¨æ‹…å¿ƒé”™è¿‡ï¼Œè¿™ä¸ªåœ¨å›è°ƒå‡½æ•°æ˜¯å¯èƒ½å‘ç”Ÿçš„ï¼Œä¾‹å¦‚ä¸€ä¸ªäº‹ä»¶æ²¡æœ‰åˆå§‹ç›‘å¬ï¼Œåœ¨å‘ç”Ÿä¹‹åç›‘å¬æ˜¯ä¸ä¼šç›‘å¬åˆ°çš„ã€‚\r\n\r\nè¿˜æ˜¯æ‹¿ä¸Šé¢çš„çˆ¬è™«ä¾‹å­ï¼Œçœ‹åŸºäº Promise å†™æ˜¯ä¸æ˜¯æ›´ä¼˜é›…ä¸€äº›\r\n\r\n```js\r\nconst rp = require(\"request-promise\");\r\n// è¿™é‡ŒPromiseåŸæœ¬çš„åº“ä¸æ”¯æŒï¼Œæ‰€ä»¥æ”¹ç”¨ä¸€ä¸‹Promiseç‰ˆæœ¬\r\nconst reptile = () => {\r\n  return rp(\"xxx/list\").then((listData) => {\r\n    return rp(\"xxx/details\").then((detailsData) => {\r\n      return {\r\n        listData,\r\n        detailsData,\r\n      };\r\n    });\r\n  });\r\n};\r\nreptile()\r\n  .then((res) => {\r\n    console.log(res);\r\n  })\r\n  .catch((err) => {\r\n    console.log(err);\r\n  });\r\n```\r\n\r\nè§‚å¯Ÿä¸Šé¢ä»£ç ï¼Œå¯ä»¥æ˜æ˜¾çœ‹åˆ°\r\n\r\n- æ”¹å–„äº†`>>>`ä¹‹å‰æ¨ªå‘ä»£ç çš„å‘å±•ï¼Œç»“æ„æ›´åŠ æ¸…æ™°\r\n- æ‹¥æœ‰äº†ç»Ÿä¸€çš„é”™è¯¯å¤„ç†ï¼Œåœ¨è¯·æ±‚åˆ—è¡¨å¦‚æœå¤±è´¥ï¼Œåç»­çš„.then ä¹Ÿä¸ä¼šæ‰§è¡Œ\r\n\r\nè€Œä¸” Promise åŒ…è£…èµ·æ¥ä¹Ÿååˆ†ç®€å•ï¼Œä¸‹é¢ä»¥ wait å‡½æ•°ä¸ºä¾‹\r\n\r\n```js\r\nconst wait = (time) => new Promise((resolve) => setTimeout(resolve, time));\r\n```\r\n\r\nä¸è¿‡ Promise ä¹Ÿä¸å®Œå…¨éƒ½æ˜¯ä¼˜ç‚¹ï¼Œä¾‹å¦‚å®ƒåªæ˜¯æŠŠä»£ç çš„ä¹¦å†™ç»“æ„ä»`>>>`å˜æˆå¾€ä¸‹çš„å»¶ä¼¸ï¼Œä»£ç ç»“æ„å¤šèµ·æ¥ä¹Ÿæ˜¯æŒºç³Ÿå¿ƒã€‚\r\n\r\n## Generator\r\n\r\n`Generator` æ˜¯ ES6 æ–°å‡ºç°çš„ APIï¼Œå®ƒçš„å‡ºç°è§£å†³äº†ä¸¤ä¸ªé—®é¢˜ï¼š\r\n\r\n- ç»™ Symbol.iterator æä¾›äº†ç®€å•çš„å®ç°\r\n- ç»™å¼‚æ­¥å˜æˆæä¾›äº†æ–°çš„æ€è·¯\r\n\r\næˆ‘ä»¬é‡ç‚¹èŠä¸€èŠç¬¬äºŒç‚¹ï¼Œè¿˜æ˜¯ä¸Šé¢çš„çˆ¬è™«ä¾‹å­ï¼Œçœ‹ä¸‹ç”¨ Generator åº”å½“å¦‚ä½•ä¹¦å†™ï¼Œä¸ºäº†çœå»ä¸€äº›å†™æ‰§è¡Œå™¨çš„è¿‡ç¨‹ï¼Œè¿™é‡Œç›´æ¥ç»“åˆ`co`æ¨¡å—è¿›è¡Œä¹¦å†™ã€‚\r\n\r\n> å¦‚æœå¯¹è¿™éƒ¨åˆ†æ„Ÿå…´è¶£ï¼Œå¯ä»¥ç‚¹å‡»äº†è§£[Generator å‡½æ•°çš„å¼‚æ­¥åº”ç”¨](https://es6.ruanyifeng.com/#docs/generator-async)ï¼Œé‡Œé¢ä¼šä¸€æ­¥æ­¥åŒ…å«å¦‚ä½•å®ç°ä¸€ä¸ªç®€å•æ‰§è¡Œå™¨ã€‚\r\n\r\n```js\r\nconst rp = require(\"request-promise\");\r\n// è¿™é‡ŒPromiseåŸæœ¬çš„åº“ä¸æ”¯æŒï¼Œæ‰€ä»¥æ”¹ç”¨ä¸€ä¸‹Promiseç‰ˆæœ¬\r\nconst co = require(\"co\");\r\nfunction* getList() {\r\n  return rp(\"xxx/list\");\r\n}\r\nfunction* getDetails() {\r\n  return rp(\"xxx/details\");\r\n}\r\nfunction* peptile() {\r\n  const listData = yield getList();\r\n  const detailsData = yield getDetails();\r\n  return {\r\n    listData,\r\n    detailsData,\r\n  };\r\n}\r\nco(peptile);\r\n```\r\n\r\nå†æ¥è§‚å¯Ÿä¸€ä¸‹ä¸Šé¢ä»£ç ï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰å·²ç»æ¥è¿‘åŒæ­¥å‡½æ•°çš„å†™æ³•äº†ï¼Œè¿™å°±æ˜¯ Generator å¸¦æ¥çš„å½±å“ã€‚\r\n\r\nä¸è¿‡å®ƒçš„ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œæ²¡æœ‰å†…ç½®æ‰§è¡Œå™¨ï¼Œéœ€è¦é¢å¤–è‡ªå·±ç¼–å†™ã€‚\r\n\r\n## async\r\n\r\n`ES2017` å¼•ç”¨äº† `async` å‡½æ•°ï¼Œå®ƒæœ¬èº«æ˜¯ Generator çš„è¯­æ³•ç³–ï¼Œæˆ‘ä»¬ä¸Šé¢è¯´ Generator æœ€å¤§ç¼ºç‚¹å°±æ˜¯æ²¡æœ‰è‡ªå¸¦æ‰§è¡Œå™¨ï¼Œasync å‡½æ•°å‡ºç°å¼¥è¡¥äº†è¿™ä¸€ç¼ºé™·ã€‚\r\n\r\n- å®ƒæœ¬èº«è‡ªå¸¦æ‰§è¡Œå™¨ï¼Œawait æ‰§è¡Œçš„å¯ä»¥æ˜¯ä»»ä½•è¡¨è¾¾å¼ï¼Œä¸éœ€è¦ä¸€å®šåŸºäº Promise\r\n- è¯­æ³•æ›´åŠ ç®€æ´ï¼Œè¿”å›å€¼æ˜¯åŸºäº Promise\r\n\r\nè¿˜æ˜¯çˆ¬è™«çš„ä¾‹å­ï¼Œè¿™æ¬¡æˆ‘ä»¬æ”¹ç”¨ async å‡½æ•°ä¹¦å†™\r\n\r\n```js\r\nconst rp = require(\"request-promise\");\r\n// è¿™é‡ŒPromiseåŸæœ¬çš„åº“ä¸æ”¯æŒï¼Œæ‰€ä»¥æ”¹ç”¨ä¸€ä¸‹Promiseç‰ˆæœ¬\r\nfunction getList() {\r\n  return rp(\"xxx/list\");\r\n}\r\nfunction getDetails() {\r\n  return rp(\"xxx/details\");\r\n}\r\nconst peptile = async () => {\r\n  const listData = await getList();\r\n  const detailsData = await getDetails();\r\n  return {\r\n    listData,\r\n    detailsData,\r\n  };\r\n};\r\n```\r\n\r\nä»ä¸Šé¢çš„ä»£ç ä¸éš¾çœ‹å‡º async å‡½æ•°çš„å‡ºç°ï¼Œæ ‡å¿—å¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆçš„æœ€ç»ˆæˆç†Ÿï¼Œç»“åˆ `babel` ç°åœ¨å°±å¯ä»¥åœ¨ä½ç‰ˆæœ¬æµè§ˆå™¨è¿è¡Œèµ·æ¥ã€‚\r\n\r\nä¸è¿‡ async è™½ç„¶å¾ˆå¥½ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›å®ç°ä¸äº†çš„ç‚¹ï¼Œä¾‹å¦‚è®² Promise çš„æ—¶å€™ wait å‡½æ•°ï¼Œç”¨ async å‡½æ•°å°±æ˜¯å®ç°ä¸äº†ï¼Œåœ¨è§£å†³é—®é¢˜ä¸€å®šè¦é›¶å’Œç»„åˆã€‚\r\n\r\n## æœ€å\r\n\r\nç®€å•å›é¡¾äº†ä¸€ä¸‹ js çš„å¼‚æ­¥å²ï¼š`å›è°ƒ > Promise > Generator > async`ã€‚å—é™äºç¯‡å¹…å¹¶æ²¡æœ‰è®²è§£å¤ªå¤šï¼Œä½†æ˜¯ä»å¼‚æ­¥çš„è§£å†³å¯ä»¥çœ‹åˆ° JavaScript æ­£åœ¨èµ°å‘æˆç†Ÿã€‚\r\n\r\næœ€åå¦‚æœè¿™ç¯‡æ–‡ç« æœ‰ä»€ä¹ˆé”™è¯¯æ¬¢è¿æŒ‡ç‚¹ï¼Œå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ä¹Ÿå¯ä»¥`start`ä¸‹ã€‚\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/86/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/86/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/87",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/87/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/87/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/87/events",
      "html_url": "https://github.com/bosens-China/blog/issues/87",
      "id": 1085665660,
      "node_id": "I_kwDOCzPAy85AtfF8",
      "number": 87,
      "title": "å‡½æ•°ç»„åˆ",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1935755992,
          "node_id": "MDU6TGFiZWwxOTM1NzU1OTky",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%BE%85%E5%AE%8C%E6%88%90%E7%B3%BB%E5%88%97",
          "name": "å¾…å®Œæˆç³»åˆ—",
          "color": "cc6e43",
          "default": false,
          "description": "ç­‰å¾…å®Œæˆçš„æ–‡ç« ..."
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2021-12-21T10:17:50Z",
      "updated_at": "2021-12-21T10:17:50Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": null,
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/87/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/87/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/85",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/85/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/85/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/85/events",
      "html_url": "https://github.com/bosens-China/blog/issues/85",
      "id": 1085663742,
      "node_id": "I_kwDOCzPAy85Aten-",
      "number": 85,
      "title": "æ‰‹å†™PromiseA+è§„èŒƒ",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1935755992,
          "node_id": "MDU6TGFiZWwxOTM1NzU1OTky",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%BE%85%E5%AE%8C%E6%88%90%E7%B3%BB%E5%88%97",
          "name": "å¾…å®Œæˆç³»åˆ—",
          "color": "cc6e43",
          "default": false,
          "description": "ç­‰å¾…å®Œæˆçš„æ–‡ç« ..."
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2021-12-21T10:15:52Z",
      "updated_at": "2021-12-21T10:15:52Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": null,
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/85/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/85/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/84",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/84/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/84/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/84/events",
      "html_url": "https://github.com/bosens-China/blog/issues/84",
      "id": 1085661897,
      "node_id": "I_kwDOCzPAy85AteLJ",
      "number": 84,
      "title": "å¦‚ä½•ç¼–å†™çˆ¬è™«",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1935755992,
          "node_id": "MDU6TGFiZWwxOTM1NzU1OTky",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%BE%85%E5%AE%8C%E6%88%90%E7%B3%BB%E5%88%97",
          "name": "å¾…å®Œæˆç³»åˆ—",
          "color": "cc6e43",
          "default": false,
          "description": "ç­‰å¾…å®Œæˆçš„æ–‡ç« ..."
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2021-12-21T10:13:58Z",
      "updated_at": "2021-12-21T10:13:58Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": null,
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/84/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/84/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/79",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/79/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/79/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/79/events",
      "html_url": "https://github.com/bosens-China/blog/issues/79",
      "id": 1085659613,
      "node_id": "I_kwDOCzPAy85Atdnd",
      "number": 79,
      "title": "ä»Vue3çœ‹ç»„ä»¶å¼€å‘æ–°å†™æ³•",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1935755992,
          "node_id": "MDU6TGFiZWwxOTM1NzU1OTky",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%BE%85%E5%AE%8C%E6%88%90%E7%B3%BB%E5%88%97",
          "name": "å¾…å®Œæˆç³»åˆ—",
          "color": "cc6e43",
          "default": false,
          "description": "ç­‰å¾…å®Œæˆçš„æ–‡ç« ..."
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2021-12-21T10:11:38Z",
      "updated_at": "2021-12-21T10:11:38Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": null,
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/79/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/79/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/69",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/69/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/69/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/69/events",
      "html_url": "https://github.com/bosens-China/blog/issues/69",
      "id": 911281718,
      "node_id": "MDU6SXNzdWU5MTEyODE3MTg=",
      "number": 69,
      "title": "Webpack æ’ä»¶å…¥é—¨",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1740577858,
          "node_id": "MDU6TGFiZWwxNzQwNTc3ODU4",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3",
          "name": "å·¥å…·ç›¸å…³",
          "color": "f73d62",
          "default": false,
          "description": "å·¥ç¨‹åŒ–ç›¸å…³çš„ä¸œè¥¿"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2021-06-04T08:53:06Z",
      "updated_at": "2021-12-21T10:04:02Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "# webpack æ’ä»¶å…¥é—¨\r\n\r\n![bg](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/69547c8c2fe9429faf29c425de792cb3~tplv-k3u1fbpfcp-zoom-1.image)\r\n\r\næœ€è¿‘å†™äº†ä¸€ä¸ªç§»åŠ¨ç«¯é¡¹ç›®ï¼Œä¸è¿‡æ¯æ¬¡ build çš„æ—¶å€™è¿˜éœ€è¦æ‰‹åŠ¨ä¸Šä¼ æœåŠ¡å™¨æ„Ÿè§‰å¾ˆä¸æ–¹ä¾¿ï¼Œæ¯•ç«Ÿæ¯æ¬¡åˆ é™¤æ–‡ä»¶å¤¹ç„¶åæ‹–æ‹½ä¸Šä¼ çš„è¿‡ç¨‹å¤ªé‡å¤äº†ï¼Œæœ¬ç€ä¸é‡å¤é€ è½®å­çš„åŸåˆ™å» Github ç¿»äº†ä¸€ä¸‹ï¼Œå‘ç° `Upload`ä¸Šä¼ æ’ä»¶è¿˜æ˜¯è›®å¤šçš„ï¼Œä¸è¿‡è·ç¦»è‡ªå·±çš„è¦æ±‚è¿˜æ˜¯æœ‰äº›å·®å¼‚ï¼Œå¾ˆå¤šæ’ä»¶åªæ˜¯åªæ˜¯å•ä¸€èŒè´£ï¼Œåªè´Ÿè´£ä¸Šä¼ è¿™ä»¶äº‹æƒ…ã€‚\r\n\r\nè€Œå¦‚æœåªè´Ÿè´£ä¸Šä¼ æ–‡ä»¶ä¸åšåˆ é™¤ä¼šå¯¼è‡´æœåŠ¡å™¨æ–‡ä»¶è¶Šæ¥è¶Šå¤šï¼Œå ç”¨é¢å¤–çš„å‚¨å­˜æˆæœ¬ï¼ŒWebPack åœ¨ build è¿‡ç¨‹ä¸­ä¼šæ£€æµ‹ç›¸å…³ä¾èµ–æ˜¯å¦å˜æ›´ï¼Œå¦‚æœå˜æ›´ç›¸å…³æ–‡ä»¶çš„ `hash` ä¹Ÿæ˜¯å‘ç”Ÿå˜æ›´ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´æ–°çš„æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œè€Œæ—§èµ„æºå´ä¸ä¼šè¢«è¦†ç›–æ›¿æ¢æ‰ã€‚\r\n\r\n## åŸºæœ¬æ¦‚å¿µ\r\n\r\nWebPack çš„æ’ä»¶æ˜¯åŸºäº `Tapable` å®ç°çš„ï¼Œå®ƒæ˜¯ä¸€ç§å‘å¸ƒè®¢é˜…çš„å®ç°ï¼Œä½œç”¨å°±æ˜¯å°†æ’ä»¶çš„å„ä¸ªç”Ÿå‘½å‘¨æœŸé’©å­å¹¿æ’­å‡ºå»ï¼Œç„¶ååœ¨åˆé€‚çš„æ—¶æœºæ‰§è¡Œã€‚åŒæ—¶åªè®©æ’ä»¶å…³æ³¨è‡ªèº«çš„è®¢é˜…ï¼Œä¿è¯æ’ä»¶ç»„åˆèµ·æ¥æœ‰åºè¿›è¡Œã€‚\r\n\r\n`Tapable`æš´éœ²äº†ä¸‰ä¸ªæ–¹æ³•ï¼š\r\n\r\n- tapï¼š å¯ä»¥æ³¨å†ŒåŒæ­¥é’©å­å’Œå¼‚æ­¥é’©å­\r\n- tapAsyncï¼š å›è°ƒå½¢å¼æ³¨å†Œå¼‚æ­¥é’©å­\r\n- tapPromiseï¼š Promise å½¢å¼æ³¨å†Œå¼‚æ­¥é’©å­\r\n\r\nåœ¨ç¼–å†™æ’ä»¶æ—¶ WebPack æ˜¾ç¤ºè¦æ±‚æˆ‘ä»¬æœ‰ `apply` æ–¹æ³•ï¼Œè¿™æ ·åšçš„åŸå› æ˜¯ WebPack æ‰§è¡ŒæœŸé—´ä¼šæ‰§è¡Œ apply æ–¹æ³•ï¼Œå¹¶ä¸”æ³¨å…¥`compiler`ï¼Œä¹‹ååœ¨`compiler`ä¸Šè®¢é˜…é’©å­äº‹ä»¶ï¼Œåœ¨åˆé€‚æ—¶é—´è§¦å‘å·²è®¢é˜…çš„ apply æ–¹æ³•\r\n\r\nå†çœ‹ä¸€ä¸‹å®˜æ–¹ç»™å‡ºçš„ç¤ºä¾‹ä»£ç \r\n\r\n```js\r\n// A JavaScript class.\r\nclass MyExampleWebpackPlugin {\r\n  // Define `apply` as its prototype method which is supplied with compiler as its argument\r\n  apply(compiler) {\r\n    // Specify the event hook to attach to\r\n    compiler.hooks.emit.tapAsync('MyExampleWebpackPlugin', (compilation, callback) => {\r\n      console.log('This is an example plugin!');\r\n      console.log(\r\n        'Hereâ€™s the `compilation` object which represents a single build of assets:',\r\n        compilation\r\n      );\r\n\r\n      // Manipulate the build using the plugin API provided by webpack\r\n      compilation.addModule(/* ... */);\r\n\r\n      callback();\r\n    });\r\n  }\r\n}\r\n```\r\n\r\nä¸Šé¢æ’ä»¶åœ¨`compiler`ä¸­è®¢é˜…äº† `emit` çš„å¼‚æ­¥é’©å­ï¼Œç„¶ååšäº†ä¸€äº›æ“ä½œä¹‹åï¼Œæ‰§è¡Œ `callback()` å›è°ƒ\r\n\r\n> è¿™é‡Œç¨å¾®è¯´ä¸‹ï¼Œå¯¹äº `tapAsync` çš„é’©å­ï¼Œ`callback` å¿…é¡»æ‰§è¡Œï¼Œå¦åˆ™ç¨‹åºä¼šä¸€è‡´åœ¨ç­‰å¾…ï¼Œè€Œ callback å·¦ä¾§çš„ `compilation` æ˜¯ç”¨æ¥è®¿é—®è¿™ä¸€æ¬¡çš„èµ„æºæ„å»ºä¿¡æ¯ï¼Œä¾‹å¦‚ä¸€äº›è¾“å‡ºçš„èµ„æºï¼Œç›¸äº’ä¾èµ–çš„å…³ç³»ç­‰ã€‚\r\n\r\näº†è§£äº†ä¸Šé¢çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬æ‰¾ä¸€ä¸‹ [compiler é’©å­ ](https://webpack.docschina.org/api/compiler-hooks/)æœ‰æ²¡æœ‰æˆ‘ä»¬éœ€è¦çš„ï¼Œæ–‡æ¡£ä¸­åˆ—ä¸¾çš„é’©å­å¾ˆå¤šï¼š\r\n\r\n- environment\r\n- afterEnvironment\r\n- entryOption\r\n- ...\r\n\r\nç¿»åˆ°æœ€åä¼šçœ‹åˆ°ä¸€ä¸ª `done` çš„é’©å­ï¼Œå®ƒåœ¨ `compilation` å®Œæˆæ—¶æ‰§è¡Œã€‚\r\n\r\nè¿™é‡Œæˆ‘ä»¬éœ€è¦çš„å‰ç½®åŸºæœ¬å‡†å¤‡é½å…¨äº†ï¼Œä¸‹é¢è¦åšçš„å°±æ˜¯åœ¨ `done` è§¦å‘æ—¶\r\n\r\n- è¿æ¥ ssh æœåŠ¡å™¨ï¼Œæ‰§è¡Œ`rm-rf xx`çš„æ“ä½œ\r\n- ä¸Šä¼  build åçš„èµ„æºåˆ° xx ç›®å½•ä¸‹\r\n\r\n## æ’ä»¶å¼€å‘å‡†å¤‡\r\n\r\n> ä¹‹åçš„å†…å®¹é‡‡ç”¨ `TypeScript` ä½œä¸ºå¼€å‘ï¼Œå¦‚æœä½ æ²¡æœ‰ç›¸å…³ç»éªŒç›´æ¥è·³è¿‡ç±»å‹æ³¨é‡Šå³å¯\r\n\r\nä¸ºäº†æ–¹ä¾¿è§£è€¦å’Œå¤ç”¨æ–‡ä»¶ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª utils.ts æ–‡ä»¶\r\n\r\n```ts\r\n// utils.ts\r\nimport { NodeSSH } from 'node-ssh';\r\n\r\nimport { Option } from './typings';\r\n\r\nexport const isObject = (obj: any): obj is Object => typeof obj === 'object' && obj;\r\n\r\n// åˆ é™¤æ–‡ä»¶å¤¹\r\nexport const removeDir = async (option: Option) => {\r\n  const ssh = new NodeSSH();\r\n  await ssh.connect(option);\r\n  await ssh.execCommand(`rm -rf ${option.to}`);\r\n  await ssh.dispose();\r\n};\r\n\r\n// ä¸Šä¼ æ–‡ä»¶å¤¹\r\nexport const uploadDir = async (option: Option) => {\r\n  const ssh = new NodeSSH();\r\n  await ssh.connect(option);\r\n  await ssh.putDirectory(option.src!, option.to, {\r\n    recursive: true,\r\n  });\r\n  await ssh.dispose();\r\n};\r\n```\r\n\r\nå®ƒæš´éœ²ä¸‰ä¸ªæ–¹æ³•ï¼Œåˆ é™¤æ–‡ä»¶å¤¹å’Œä¸Šä¼ æ–‡ä»¶å¤¹è¿˜æœ‰ä¸€ä¸ªåˆ¤æ–­ object çš„æ–¹æ³•ï¼Œä¸Šé¢çš„åˆ é™¤å’Œä¸Šä¼ æ–‡ä»¶å¤¹åŸºäº [node-ssh](https://github.com/steelbrain/node-ssh) å°è£…è€Œæ¥ï¼Œå¦‚æœä½ æœ‰å…´è¶£äº†è§£å¯ä»¥å»é˜…è¯»ä¸€ä¸‹æ–‡æ¡£\r\n\r\n## æ’ä»¶å¼€å‘\r\n\r\nå‰©ä¸‹çš„æ’ä»¶å¼€å‘ï¼Œå°±æ˜¯è·å–ç”¨æˆ·å¡«å†™ä¸€äº›å¿…è¦å­—æ®µï¼Œä¾‹å¦‚å¯†ç ã€ä¸Šä¼ çš„æœåŠ¡å™¨è·¯å¾„ã€host ç­‰ä¿¡æ¯ï¼Œç»“åˆä¸Šé¢çš„ `utils` å’Œé’©å­ï¼Œå®Œæˆè¿™ä¸ªä¸Šä¼ è¿‡ç¨‹\r\n\r\n```ts\r\n// upload-plugin.ts\r\nimport { Compiler, Stats } from 'webpack';\r\nimport { isObject, uploadDir, removeDir } from './utils';\r\nimport { Option } from './typings';\r\n\r\nclass UploadPlugin {\r\n  public stats: Stats;\r\n\r\n  public option: Option & Record<string, any>;\r\n\r\n  public removeDir: boolean;\r\n\r\n  constructor(option: Option, remove = true) {\r\n    this.stats = null as unknown as Stats;\r\n    this.option = option;\r\n    this.removeDir = remove;\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    this.checkOption();\r\n    this.setOption();\r\n  }\r\n\r\n  // æ£€éªŒå‚æ•°\r\n  checkOption(option = this.option) {\r\n    if (!isObject(option)) {\r\n      throw new Error('option Must be an object!');\r\n    }\r\n    const result = ['to', 'host'].filter((f) => !option[f]);\r\n    if (result.length) {\r\n      throw new Error(`The ${result.join(',')} parameter is required!`);\r\n    }\r\n    if (!option.password && !option.privateKey) {\r\n      throw new Error('password and privateKey must have one entry!');\r\n    }\r\n  }\r\n\r\n  // åˆå§‹åŒ–é»˜è®¤å€¼\r\n  setOption() {\r\n    const option = {\r\n      port: 22,\r\n      username: 'root',\r\n    };\r\n    this.option = {\r\n      ...option,\r\n      ...this.option,\r\n    };\r\n  }\r\n\r\n  apply(compiler: Compiler) {\r\n    compiler.hooks.done.tap('upload-plugin', async (stats) => {\r\n      console.time('time');\r\n      // è·å–é»˜è®¤çš„ä¿¡æ¯ï¼Œå¦‚æœsrcä¸å­˜åœ¨ç›´æ¥ä½¿ç”¨webpackçš„é…ç½®\r\n      const src = stats.compilation.outputOptions.path;\r\n      this.option.src = this.option.src ?? src;\r\n      if (this.removeDir) {\r\n        await removeDir(this.option);\r\n      }\r\n      await uploadDir(this.option);\r\n      console.timeEnd('time');\r\n    });\r\n  }\r\n}\r\n\r\nexport default UploadPlugin;\r\n```\r\n\r\næ•´ä½“ä»£ç è¿˜æ˜¯å¾ˆç®€æ´çš„ï¼Œå»é™¤å‚æ•°æ ¡éªŒéƒ¨åˆ†è¿˜æœ‰èµ‹å€¼é»˜è®¤å€¼å‚æ•°ï¼Œå‰©ä¸‹çš„å°±æ˜¯æ ¹æ®å‚æ•°æ¥æ˜¯å¦åˆ é™¤è¿œç¨‹æ–‡ä»¶å¤¹ï¼Œä¹‹åæ‰§è¡Œä¸Šä¼ æ–¹æ³•ã€‚\r\n\r\nä½ å¯èƒ½å¾ˆå¥½å¥‡ `Option` çš„å®šä¹‰æ˜¯å•¥ï¼Œè¿™ä¸ªæ˜¯ç»“åˆ `node-ssh` çš„è¿æ¥ä¿¡æ¯åŠ ä¸Šè‡ªå®šä¹‰æ‰©å±•çš„ä¸€äº›å­—æ®µè€Œæ¥çš„\r\n\r\n```ts\r\n// typings.d.ts\r\nexport interface Option {\r\n  src?: string;\r\n  to: string;\r\n  port?: number;\r\n  host: string;\r\n  username?: string;\r\n  password?: string;\r\n  privateKey?: string;\r\n}\r\n```\r\n\r\n## æœ€å\r\n\r\nå®Œæ•´ä»£ç å·²ç»ä¸Šä¼ äº†[Github ä»“åº“](https://github.com/bosens-China/upload-plugin)ï¼Œå¦‚æœä½ æœ‰å…´è¶£å¯ä»¥å…·ä½“çœ‹ä¸‹æ›´å…·ä½“çš„ä¸€äº›ä¿¡æ¯ï¼Œå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ä¹Ÿæ¬¢è¿ `star`ã€‚\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/69/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/69/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/70",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/70/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/70/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/70/events",
      "html_url": "https://github.com/bosens-China/blog/issues/70",
      "id": 913346542,
      "node_id": "MDU6SXNzdWU5MTMzNDY1NDI=",
      "number": 70,
      "title": "å›¢é˜Ÿè§„èŒƒç³»åˆ—ä¹‹ git è§„èŒƒ",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 3661376441,
          "node_id": "LA_kwDOCzPAy87aPCu5",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83",
          "name": "ä»£ç è§„èŒƒ",
          "color": "5319e7",
          "default": false,
          "description": "å›¢é˜Ÿè§„èŒƒã€ä»£ç è§„èŒƒã€æŠ€æœ¯é€‰å‹ç­‰ç›¸å…³å†…å®¹"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2021-06-07T09:37:17Z",
      "updated_at": "2021-12-21T10:03:46Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "æœ€è¿‘ä¸€å‘¨çš„å·¥ä½œé‡å¿ƒå°±æ˜¯åœ¨æ¢³ç†å›¢é˜Ÿè§„èŒƒï¼Œåœ¨å†™çš„è¿‡ç¨‹ä¹ŸæŸ¥ç¼ºè¡¥æ¼äº†ä¸å°‘çŸ¥è¯†ï¼Œå‰”é™¤æ‰å…³äºå…¬å¸åœºæ™¯çš„éƒ¨åˆ†å°±æœ‰äº†è¿™ä¸€ç³»åˆ—çš„æ–‡ç« ï¼Œé¢„è®¡å†™å››éƒ¨åˆ†ï¼š\r\n1. gitè§„èŒƒ\r\n2. [å·¥ç¨‹è§„èŒƒ](https://github.com/bosens-China/blog/issues/71)\r\n3. [ç”¨æˆ·ä½“éªŒè§„èŒƒ](https://github.com/bosens-China/blog/issues/72)\r\n4. [å‘½åè§„èŒƒ](https://github.com/bosens-China/blog/issues/73)\r\n\r\n\r\n# Git è§„èŒƒ\r\n\r\nGit ä½œä¸ºç°åœ¨æœ€æµè¡Œçš„åˆ†å¸ƒå¼ç®¡ç†å·¥å…·ï¼ŒåŸºæœ¬ä¸Šæ˜¯æ¯ä¸ªå›¢é˜Ÿçš„å¿…å¤‡ï¼Œä¸‹é¢å°±ä»åˆ†æ”¯å’Œæäº¤è¿™ä¸¤éƒ¨åˆ†å±•å¼€\r\n\r\n## ä»€ä¹ˆæ˜¯åˆ†æ”¯\r\n\r\nåˆ†æ”¯å°±æ˜¯æŠŠä½ çš„å·¥ä½œä»å¼€å‘ä¸»çº¿ä¸Šåˆ†ç¦»å¼€æ¥ï¼Œä»¥å…å½±å“å¼€å‘ä¸»çº¿ï¼Œå‡è®¾ä½ å‡†å¤‡å¼€å‘ä¸€ä¸ªæ–°åŠŸèƒ½ï¼Œä½†æ˜¯éœ€è¦ä¸¤å‘¨æ‰èƒ½å®Œæˆï¼Œç¬¬ä¸€å‘¨ä½ å†™äº† 50%çš„ä»£ç ï¼Œå¦‚æœç«‹åˆ»æäº¤ï¼Œç”±äºä»£ç è¿˜æ²¡å†™å®Œï¼Œä¸å®Œæ•´çš„ä»£ç åº“ä¼šå¯¼è‡´åˆ«äººä¸èƒ½å¹²æ´»äº†ã€‚å¦‚æœç­‰ä»£ç å…¨éƒ¨å†™å®Œå†ä¸€æ¬¡æäº¤ï¼Œåˆå­˜åœ¨ä¸¢å¤±æ¯å¤©è¿›åº¦çš„å·¨å¤§é£é™©ã€‚\r\n\r\nç°åœ¨æœ‰äº†åˆ†æ”¯ï¼Œå°±ä¸ç”¨æ€•äº†ã€‚ä½ åˆ›å»ºäº†ä¸€ä¸ªå±äºä½ è‡ªå·±çš„åˆ†æ”¯ï¼Œåˆ«äººçœ‹ä¸åˆ°ï¼Œè¿˜ç»§ç»­åœ¨åŸæ¥çš„åˆ†æ”¯ä¸Šæ­£å¸¸å·¥ä½œï¼Œè€Œä½ åœ¨è‡ªå·±çš„åˆ†æ”¯ä¸Šå¹²æ´»ï¼Œæƒ³æäº¤å°±æäº¤ï¼Œç›´åˆ°å¼€å‘å®Œæ¯•åï¼Œå†ä¸€æ¬¡æ€§åˆå¹¶åˆ°åŸæ¥çš„åˆ†æ”¯ä¸Šï¼Œè¿™æ ·ï¼Œæ—¢å®‰å…¨ï¼Œåˆä¸å½±å“åˆ«äººå·¥ä½œã€‚\r\n\r\n![1.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/305ee83c688b49ae859b493fbf7d7218~tplv-k3u1fbpfcp-watermark.image)\r\n\r\n## åˆ†æ”¯å¦‚ä½•å‘½å\r\n\r\nåˆ†æ”¯æŒ‰ç…§ç±»å‹å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç§\r\n\r\n| åˆ†æ”¯åç§°         |       å‘½å        |                                                       è¯´æ˜ |\r\n| ---------------- | :---------------: | ---------------------------------------------------------: |\r\n| ä¸»åˆ†æ”¯           |      master       | ä¸»åˆ†æ”¯ï¼Œæ‰€æœ‰æä¾›ç»™ç”¨æˆ·ä½¿ç”¨çš„æ­£å¼ç‰ˆæœ¬ï¼Œéƒ½åœ¨è¿™ä¸ªä¸»åˆ†æ”¯ä¸Šå‘å¸ƒ |\r\n| å¼€å‘ä¸»åˆ†æ”¯       |      develop      |                         å¼€å‘åˆ†æ”¯ï¼Œæ°¸è¿œæ˜¯åŠŸèƒ½æœ€æ–°æœ€å…¨çš„åˆ†æ”¯ |\r\n| åŠŸèƒ½åˆ†æ”¯         |    feature-\\*     |                         æ–°åŠŸèƒ½åˆ†æ”¯ï¼ŒæŸä¸ªåŠŸèƒ½ç‚¹æ­£åœ¨å¼€å‘é˜¶æ®µ |\r\n| å‘å¸ƒç‰ˆæœ¬         |    release-\\*     |                                       å‘å¸ƒå®šæœŸè¦ä¸Šçº¿çš„åŠŸèƒ½ |\r\n| ä¿®å¤å‘å¸ƒç‰ˆæœ¬åˆ†æ”¯ | bugfix-release-\\* |                                               ä¿®å¤æµ‹è¯• bug |\r\n| ç´§æ€¥ä¿®å¤åˆ†æ”¯     | bugfix-master-\\*  |                                     ç´§æ€¥ä¿®å¤çº¿ä¸Šä»£ç çš„ bug |\r\n\r\n## å¼€å‘æµç¨‹ç¤ºä¾‹\r\n\r\nä¸‹é¢å°±ä»¥ä¸€ä¸ªäº§å“ä»æœ€åˆåˆ°å‘å¸ƒä¸Šçº¿ä¸ºä¾‹å­ï¼Œè®²è§£ git æµç¨‹\r\n\r\n### åˆå§‹åŒ–\r\n\r\nç¬¬ä¸€æ­¥ï¼Œåˆå§‹ä»“åº“çš„ä¿¡æ¯ï¼ŒåŒæ—¶åˆ›å»º`develop`åˆ†æ”¯\r\n\r\n![2.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cf641e319fd14f93a08b9ee748b0706b~tplv-k3u1fbpfcp-watermark.image)\r\n\r\n### å¼€å‘æ–°åŠŸèƒ½\r\n\r\nå¼€å‘äººå‘˜åœ¨`develop`åˆ†æ”¯å¼€å‘æ–°çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬:æ–°ç‰¹æ€§ä¸ Bug ä¿®å¤\r\n\r\n![3.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2656d065a3714906a8a503b318698841~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nå¦‚æœå¹¶è¡Œå¼€å‘å¤šä¸ªéœ€æ±‚ï¼Œå¯ä»¥åˆ›å»º `feature åˆ†æ”¯`ï¼Œå‘½åè§„åˆ™ä¸º`feature-åˆ†æ”¯åˆ›å»ºæ—¥æœŸ-æ–°ç‰¹æ€§å…³é”®å­—`ï¼Œä¾‹å¦‚:`feature-20190919-i18n`\r\n\r\n![4.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dba19d9f51714f7caa6f8e45ebd1e120~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nå¼€å‘å®Œæˆä¹‹åå°† feature åˆ†æ”¯åˆå¹¶åˆ° develop åˆ†æ”¯ï¼Œæœ€ååˆ é™¤ feature åˆ†æ”¯\r\n\r\n> ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ feature\r\n>\r\n> - å¼€å‘ä¸€ä¸ªç‹¬ç«‹çš„æ–°ç‰¹æ€§(å®Œæˆæ—¶ï¼Œéœ€åˆå¹¶åˆ° develop åˆ†æ”¯)\r\n> - æŠ€æœ¯ç ”ç©¶ä¸å°è¯•(è‹¥å¤±è´¥ï¼Œå¯éšæ—¶åˆ é™¤ feature åˆ†æ”¯)\r\n> - æå‰å®ç°ä¸‹ä¸€ä¸ªç‰ˆæœ¬éœ€è¦å¼€å‘çš„ç‰¹æ€§(å¯ä¸åœ¨æœ¬æ¬¡è¿­ä»£ä¸­å‘å¸ƒ)\r\n\r\n### å‡†å¤‡å‘å¸ƒç‰ˆæœ¬\r\n\r\nå¦‚æœ develop åˆ†æ”¯ä¸Šçš„åŠŸå¼€å‘å®Œæ¯•\r\n\r\n1. å»º release åˆ†æ”¯(å‘å¸ƒåˆ†æ”¯)å‘½åè§„åˆ™:release-åˆ†æ”¯åˆ›å»ºæ—¥æœŸ-å¾…å‘å¸ƒç‰ˆæœ¬å·ï¼Œä¾‹å¦‚ï¼š`release-20190919-v1.0.0`\r\n2. å¯¹ release åˆ†æ”¯çš„ç‰ˆæœ¬å·è¿›è¡Œä¿®æ”¹ï¼ˆä¹‹åæäº¤ä¸€æ¬¡ï¼‰\r\n3. é€šçŸ¥æµ‹è¯•äººå‘˜æµ‹è¯•\r\n\r\n![5.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f639127d864f404b9cd12d85cc8e5547~tplv-k3u1fbpfcp-watermark.image)\r\n\r\n### ä¿®å¤é—®é¢˜\r\n\r\nå¼€å‘äººå‘˜åœ¨ release ä¿®å¤é—®é¢˜ï¼Œæ­¤æ—¶ç¦æ­¢å¼€å‘æ–°åŠŸèƒ½ï¼Œåªå¯¹ bug è¿›è¡Œä¿®å¤\r\n\r\n![6.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5566fa0226ee43b78f8daf7d4ed14950~tplv-k3u1fbpfcp-watermark.image)\r\n\r\n### æœ€ç»ˆå‘å¸ƒ\r\n\r\nç»è¿‡æµ‹è¯•æ²¡æœ‰å‘ç°é—®é¢˜ï¼Œæˆ–è€…é—®é¢˜å·²ç»å…¨éƒ¨ä¿®å¤ï¼Œè¿™ä¸ªæ—¶å€™\r\n\r\n1. å°† release åˆ†æ”¯åŒæ—¶åˆå¹¶åˆ° master åˆ†æ”¯ä¸ develop åˆ†æ”¯\r\n\r\n   - é€šçŸ¥æµ‹è¯•ï¼Œè¿›è¡Œä¸»åˆ†æ”¯æµ‹è¯•\r\n   - å¦‚æœæ²¡é—®é¢˜ï¼Œè¿›è¡Œä¸‹ä¸€æ­¥ï¼Œå¦‚æœæœ‰é—®é¢˜å›åˆ° release\r\n\r\n1. åˆ é™¤ release åˆ†æ”¯\r\n1. æ„å»ºåº”ç”¨åˆ°æœåŠ¡å™¨\r\n\r\n![7.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ad87a01a2eb845a99dfc4ff489e6b4e9~tplv-k3u1fbpfcp-watermark.image)\r\n\r\n## commit è§„èŒƒ\r\n\r\nç›®å‰å¼€æºç¤¾åŒºä¸»è¦åº”ç”¨æ˜¯è§„èŒƒæ˜¯[Angular Git Commit Guidelines](https://github.com/angular/angular.js/blob/master/DEVELOPERS.md#-git-commit-guidelines)\r\n\r\nå®ƒç”±ä¸‹é¢å‡ éƒ¨åˆ†ç»„æˆ:\r\n\r\n```sh\r\n<type>: <subject>\r\n<BLANK LINE>\r\n<body>\r\n<BLANK LINE>\r\n<footer>\r\n```\r\n\r\n### type\r\n\r\næœ¬æ¬¡ commit çš„ç±»å‹ï¼Œè¯¸å¦‚ bugfixã€docsã€style ç­‰\r\n\r\nå®Œæ•´çš„ç±»å‹å¦‚ä¸‹ï¼š\r\n\r\n| åç§°     |                        æè¿°                        |\r\n| -------- | :------------------------------------------------: |\r\n| feat     |                     æ·»åŠ æ–°ç‰¹æ€§                     |\r\n| fix      |                      ä¿®å¤ bug                      |\r\n| docs     |                   ä»…ä»…ä¿®æ”¹äº†æ–‡æ¡£                   |\r\n| style    | ä»…ä»…ä¿®æ”¹äº†ç©ºæ ¼ã€æ ¼å¼ç¼©è¿›ã€éƒ½å¥½ç­‰ç­‰ï¼Œä¸æ”¹å˜ä»£ç é€»è¾‘ |\r\n| refactor |         ä»£ç é‡æ„ï¼Œæ²¡æœ‰åŠ æ–°åŠŸèƒ½æˆ–è€…ä¿®å¤ bug         |\r\n| perf     |                å¢åŠ ä»£ç è¿›è¡Œæ€§èƒ½æµ‹è¯•                |\r\n| test     |                    å¢åŠ æµ‹è¯•ç”¨ä¾‹                    |\r\n| chore    |        æ”¹å˜æ„å»ºæµç¨‹ã€æˆ–è€…å¢åŠ ä¾èµ–åº“ã€å·¥å…·ç­‰        |\r\n\r\n### scope\r\n\r\næœ¬æ¬¡ commit æ³¢åŠçš„èŒƒå›´\r\n\r\n### subject\r\n\r\nç®€æ˜æ‰¼è¦çš„é˜è¿°ä¸‹æœ¬æ¬¡ commit çš„ä¸»æ—¨\r\n\r\næœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š\r\n\r\n1. é¦–å­—æ¯ä¸è¦å¤§å†™\r\n2. ç»“å°¾æ— éœ€æ·»åŠ æ ‡ç‚¹\r\n\r\n### body\r\n\r\nä¸»ä½“å†…å®¹ï¼Œæˆ‘ä»¬éœ€è¦æŠŠæœ¬æ¬¡ commit è¯¦ç»†çš„æè¿°ä¸€ä¸‹ï¼Œæ¯”å¦‚æ­¤æ¬¡å˜æ›´çš„åŠ¨æœºç­‰ï¼Œä¸èƒ½è¶…å‡º 72 ä¸ªå­—ç¬¦\r\n\r\n> ä¸ºä»€ä¹ˆéœ€è¦\r\n>\r\n> - å®ƒå¯èƒ½æ˜¯ç”¨æ¥ä¿®å¤ä¸€ä¸ª bugï¼Œå¢åŠ ä¸€ä¸ª featureï¼Œæå‡æ€§èƒ½ã€å¯é æ€§ã€ç¨³å®šæ€§ç­‰ç­‰\r\n> - å®ƒå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜? å…·ä½“æè¿°è§£å†³é—®é¢˜çš„æ­¥éª¤\r\n> - æ˜¯å¦å­˜åœ¨å‰¯ä½œç”¨ã€é£é™©?\r\n\r\n### footer\r\n\r\næè¿°ä¸‹ä¸ä¹‹å…³è”çš„ issue æˆ– break changeï¼Œåœ¨å…¬å¸é¡¹ç›®ä¸­åŸºæœ¬å¿½ç•¥å³å¯\r\n\r\n## å‚è€ƒæ–‡ç« \r\n\r\n- [Git åˆ†æ”¯ç®¡ç†è§„èŒƒ](https://juejin.cn/post/6844903945245048846#heading-1)\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/70/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/70/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/74",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/74/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/74/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/74/events",
      "html_url": "https://github.com/bosens-China/blog/issues/74",
      "id": 931481508,
      "node_id": "MDU6SXNzdWU5MzE0ODE1MDg=",
      "number": 74,
      "title": "ä¸º React æ·»åŠ åŒå‘ç»‘å®š hooks",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1473940161,
          "node_id": "MDU6TGFiZWwxNDczOTQwMTYx",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3",
          "name": "æ¡†æ¶ç›¸å…³",
          "color": "42b883",
          "default": false,
          "description": "ç›®å‰Vueå’ŒReactä¸ºä¸»"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2021-06-28T11:43:52Z",
      "updated_at": "2021-12-21T10:03:06Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "æœ€è¿‘æ¢äº†ä¸€å®¶æ–°å…¬å¸ï¼Œç”¨çš„æŠ€æœ¯æ ˆ`react`ä¸ºä¸»ï¼Œæ‰€ä»¥ä¸Šå‘¨ç´§æ€¥çš„çœ‹äº†ä¸€ä¸‹`react`ç›¸å…³çš„æ–‡æ¡£ï¼Œä¹Ÿå¯¹ç…§æ–‡æ¡£å†™äº†å‡ ä¸ª demoï¼Œä¸è¿‡åœ¨å¼€å‘é˜¶æ®µæˆ‘çš„ä½“éªŒè¿˜æ˜¯è›®å·®çš„ã€‚\r\n\r\n- ç”Ÿæ€å¾ˆç¹è£ï¼Œä½†æ˜¯ä¸çŸ¥é“é‚£ç§æ–¹æ¡ˆæ˜¯æœ€ä½³\r\n- å¼€å‘æ•ˆç‡å¾ˆç¹çï¼ˆè¿™ä¸€ç‚¹å¾…å•†æ¦·ï¼‰\r\n\r\nåˆšåˆšç®€å•å†™äº†ä¸€ä¸ª todolist çš„åŠŸèƒ½ï¼Œä¸è¿‡åœ¨å¯¹ list è¿›è¡Œä¿å­˜ã€ä¿®æ”¹ã€åˆ é™¤çš„æ—¶å€™ï¼Œæ„Ÿè§‰å¾ˆé…¸çˆ½\r\n\r\n```js\r\n// ...\r\nconst list = myContent.list[props.index]!;\r\nlist.title = inp;\r\nlist.show = false;\r\nmyContent.setlist([...myContent.list]);\r\n```\r\n\r\nå¤§é‡è¿™æ ·çš„ä»£ç ï¼Œæ‰€ä»¥å°±æƒ³é€šè¿‡ hook + æ•°æ®åŠ«æŒ æ¥å®ç°ä¸‹é¢è¿™æ ·çš„åŠŸèƒ½\r\n\r\n```js\r\nimport { useModel } from './utils';\r\nconst app = () => {\r\n  // ... çœç•¥å…¶ä»–ä»£ç \r\n  const [arr] = useModel([]);\r\n  arr.push(1);\r\n};\r\n```\r\n\r\nåœ¨ push ä¹‹ç±»çš„æ“ä½œæ—¶ï¼Œè‡ªåŠ¨å¸®æˆ‘ä»¬å®Œæˆ`setArr([...arr])`è¿™æ ·çš„æ“ä½œ\r\n\r\n## å®ç°æ€è·¯\r\n\r\nä¹‹å‰æƒ³å€Ÿé‰´`useEffect, useCallback`ä¹‹ç±»è‡ªå¸¦çš„ hook æ¥å®ç°ï¼Œä¸è¿‡å¾ˆé—æ†¾è¿™ä¸ªå¿…é¡»è¦æ˜¾ç¤ºè°ƒç”¨`setxxx`æ‰ä¼šè§¦å‘ï¼Œæ‰€ä»¥ç°åœ¨æ‘†åœ¨é¢å‰çš„å¦‚ä½•é€šè¿‡å˜åŒ–ä¹‹åé€šè¿‡å›è°ƒæ¥è§¦å‘ set çš„æ“ä½œã€‚\r\n\r\nå› ä¸ºä¹‹å‰ä½¿ç”¨çš„æ˜¯ vue æ‰€ä»¥è„‘æµ·ä¸­æœ€å…ˆè¹¦å‡ºçš„å°±æ˜¯é€šè¿‡`Object.defineProperty`æ¥åŠ«æŒæ•°æ®\r\n\r\n> è¿™é‡Œè¡¥å……ä¸€ç‚¹ï¼Œproxy çš„æ•ˆæœæ›´å¥½ï¼Œä¸è¿‡è¿™é‡Œä¼šæœ‰ä¸€äº›å…¼å®¹æ€§é—®é¢˜ï¼Œåé¢æˆ‘ä¼šå°†è¿™äº›åŠŸèƒ½å°è£…æˆä¸€ä¸ªåº“ï¼Œä¼˜å…ˆä½¿ç”¨`proxy`ä¹‹åé™çº§åˆ°`Object.defineProperty`\r\n\r\n## Object.defineProperty\r\n\r\nåˆ·è¿‡é¢è¯•é¢˜çš„åº”è¯¥å¯¹è¿™ä¸ª api åº”è¯¥ä¸é™Œç”Ÿï¼Œå®ƒæ˜¯ vue2.x å®ç°æ•°æ®åŠ«æŒçš„å…³é”®ï¼Œé€šè¿‡æ‹¦æˆªå¯¹è±¡çš„ get å’Œ set å±æ€§ï¼Œä¹‹ååˆ†å‘äº‹ä»¶æ¥é€šçŸ¥è§†å›¾è¿›è¡Œæ›´æ–°ã€‚\r\n\r\nä¸è¿‡è¿™ä¸ª api æ˜¯æœ‰ä¸€äº›ç¼ºç‚¹çš„ï¼Œå°¤å…¶æ˜¯å¯¹æ•°ç»„è€Œè¨€\r\n\r\n- ä¸æ”¯æŒæ‹¦æˆª`length`å±æ€§ï¼Œè¿™ç‚¹å¾ˆå…³é”®ï¼Œä¼šå¯¼è‡´æˆ‘ä»¬ç›´æ¥ä¿®æ”¹`arr.length = 0`æ— æ•ˆï¼ŒåŸå› æ˜¯å†…éƒ¨å¼•æ“çš„è§„å®šä¸å…è®¸ç›‘å¬\r\n\r\n- ä¸æ”¯æŒæ–¹æ³•ç›‘å¬ï¼Œä¾‹å¦‚ä½¿ç”¨ push ç­‰\r\n\r\næ˜ç¡®ä¸Šé¢ä¸¤ç‚¹ä¹‹åï¼Œæˆ‘ä»¬å°±æ¥åŠ¨æ‰‹è®¾è®¡è¿™ä¸ª`useModel`åº”è¯¥æ€ä¹ˆå†™ï¼Œæ€è·¯å€Ÿé‰´ vue2.x çš„å†™æ³•ï¼Œ\r\n\r\n- çº¦å®šä¸èƒ½ç›´æ¥ä¿®æ”¹`length`ï¼Œä¾‹å¦‚ï¼š`arr[100] = {}`ï¼›\r\n- ä½¿ç”¨å˜å¼‚æ–¹æ³•`pushã€popã€shiftã€unshiftã€spliceã€sortã€reverse`æ¥å®Œæˆå¯¹æ•°ç»„çš„åˆ é™¤å’Œå…¶ä»–ä¿®æ”¹ï¼›\r\n- å…è®¸ä¿®æ”¹å­˜åœ¨çš„æ•°ç»„ä¸‹æ ‡ï¼Œå¯ä»¥ç›´æ¥ä¿®æ”¹ arr[0]è¿™æ ·çš„æ•°æ®ï¼›\r\n\r\n> è¿™é‡Œç¨å¾®æä¸€ä¸‹ vue å®˜æ–¹ä¸å…è®¸ä¿®æ”¹å·²å­˜åœ¨æ•°ç»„ä¸‹æ ‡æ˜¯å› ä¸ºå­˜åœ¨æ€§èƒ½è€ƒè™‘\r\n\r\n## å®ç°æ€è·¯\r\n\r\nå®ç°æ€è·¯å¾ˆç®€å•ï¼Œä¸»è¦å°±æ˜¯é€’å½’éå†å¯¹è±¡çš„æ‰€æœ‰å±æ€§ï¼Œä¹‹åå°†å±æ€§æ”¹ç”¨`get`å’Œ`set`çš„å½¢å¼è¿›è¡Œå®šä¹‰ï¼Œåœ¨å¯¹è±¡å±æ€§å€¼æ›´æ”¹çš„æ—¶å€™æ¥è°ƒç”¨`useState`è¿”å›çš„ set æ–¹æ³•è¿›è¡Œæ•°æ®çš„æ›´æ–°ã€‚\r\n\r\nè€Œæ•°ç»„çš„å˜å¼‚æ–¹æ³•ç›‘å¬ï¼Œåˆ™æ˜¯é€šè¿‡æ”¹å†™æ•°ç»„çš„åŸå‹é“¾å®ç°ï¼Œä¾‹å¦‚\r\n\r\n```js\r\nconst arr = [];\r\nconst myProto = Object.create(Array.prototype);\r\nconst arrFn = arr.push;\r\nmyProto.push = (...rest) => {\r\n  consoole.log(1);\r\n  arrFn.push.apply(arr, rest);\r\n};\r\nObject.setPrototypeOf(arr, myProto);\r\n// 1\r\narr.push(1);\r\n```\r\n\r\nå°†è¿™ä¸ªæ•°ç»„çš„ `__propo__`æŒ‡å‘æˆ‘ä»¬è‡ªå®šä¹‰çš„åŸå‹å¯¹è±¡ä¸Šï¼Œè¿™ä¸ªåŸå‹å¯¹è±¡ä¸Šæœ‰ pushã€pop ç­‰å˜å¼‚æ–¹æ³•ï¼Œé€šè¿‡è°ƒç”¨å˜å¼‚æ–¹æ³•å®Œæˆå¯¹åŸæ•°ç»„çš„çš„æ“ä½œå’Œå¯¹ set çš„æ›´æ–°\r\n\r\n![å®ç°æ€è·¯](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/db03f6a89974472f9bd617577d3b6365~tplv-k3u1fbpfcp-zoom-1.image)\r\n\r\n## å…·ä½“å®ç°\r\n\r\nä»£ç é‡å¹¶ä¸æ˜¯å¾ˆå¤§ï¼Œæ‰€ä»¥ç›´æ¥æ”¾ä»£ç äº†ï¼Œä¸€äº›å…³é”®çš„åœ°æ–¹å·²ç»è¿›è¡Œäº†æ³¨é‡Š\r\n\r\n```js\r\nimport { useState } from 'react';\r\nconst isObject = (obj) => {\r\n  return (typeof obj === 'object' && obj) || typeof obj === 'function';\r\n};\r\n// ç›´æ¥æ”¹å†™æˆä¸€ä¸ªé€šç”¨éå†ï¼Œè¿™é‡Œè¿›è¡Œç±»å‹åˆ¤æ–­ï¼Œåç»­çš„useModelåˆ™ä¸éœ€è¦è¿›è¡Œåˆ¤æ–­äº†\r\nconst each = (obj, change) => {\r\n  if (!isObject(obj)) {\r\n    return;\r\n  }\r\n  const isArr = Array.isArray(obj);\r\n  const keys = isArr ? obj : Object.keys(obj);\r\n  for (let i = 0, len = keys.length; i < len; i++) {\r\n    const key = isArr ? i : keys[i];\r\n    const value = obj[key];\r\n    change(key, value);\r\n  }\r\n};\r\nexport const useModel = (obj) => {\r\n  const [model, setModel] = useState(obj);\r\n  // æ›´æ–°çš„æ—¶å€™ç›´æ¥æ›´æ–°é¡¶å±‚å¯¹è±¡å³å¯ï¼Œå› ä¸ºè¿™æ˜¯hookå†™æ³•ä¸å­˜åœ¨classçš„å±€éƒ¨æ›¿æ¢\r\n  const setRootValue = () => {\r\n    if (Array.isArray(model)) {\r\n      setModel([...model]);\r\n      return;\r\n    }\r\n    setModel(Object.assign({...model});\r\n  };\r\n  // å®šä¹‰å¯¹è±¡çš„key\r\n  const defineProperty = (key, value, o) => {\r\n    Object.defineProperty(o, key, {\r\n      enumerable: true,\r\n      get() {\r\n        return value;\r\n      },\r\n      set(v) {\r\n        if (v === value || (Number.isNaN(v) && Number.isNaN(value))) {\r\n          return;\r\n        }\r\n        value = v;\r\n        setRootValue();\r\n      },\r\n    });\r\n  };\r\n  const definePropertyArray = (all) => {\r\n    const myProto = Object.create(Array.prototype);\r\n    each(['push', 'pop', 'shift', 'unshift', 'splice', 'sort', 'reverse'], (_, value) => {\r\n      const fn = all[value];\r\n      myProto[value] = (...rest) => {\r\n        fn.apply(all, rest);\r\n        setRootValue();\r\n      };\r\n    });\r\n    Object.setPrototypeOf(all, myProto);\r\n  };\r\n  const observer = (all) => {\r\n    each(all, (key, value) => {\r\n      defineProperty(key, value, all);\r\n      observer(value);\r\n    });\r\n    if (Array.isArray(all)) {\r\n      definePropertyArray(all);\r\n    }\r\n  };\r\n  observer(model);\r\n  return [model, setRootValue];\r\n};\r\n```\r\n\r\n> æ³¨æ„ï¼Œä¸Šé¢å¹¶æ²¡æœ‰åœ¨`Object.defineProperty`set çš„æ—¶å€™ç»§ç»­æ‰§è¡Œæ·±åº¦ç›‘å¬ï¼Œæ˜¯å› ä¸º hook åœ¨æ”¹å˜çš„æ—¶å€™å°±ä¼šé‡æ–°æ‰§è¡Œè¿™ä¸ªæ–¹æ³•ï¼Œæ‰€ä»¥å¹¶ä¸éœ€è¦æ·±åº¦ç›‘å¬\r\n\r\n## æœ€å\r\n\r\nå¦‚æœå†™çš„æœ‰ä»€ä¹ˆä¸å¯¹çš„åœ°æ–¹æ¬¢è¿æŒ‡å‡ºï¼Œå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©å¯ä»¥ç‚¹ä¸€ä¸‹`start`\r\n\r\nä¸ºäº†æ–¹ä¾¿éªŒè¯æ•ˆæœï¼Œæ”¾ä¸€ä¸ª[ç¤ºä¾‹ä»£ç ï¼ˆå¯èƒ½éœ€è¦ç¿»å¢™ï¼‰](https://codesandbox.io/s/eloquent-kilby-1cdj7?from-embed=&file=/src/App.js)\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/74/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/74/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/68",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/68/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/68/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/68/events",
      "html_url": "https://github.com/bosens-China/blog/issues/68",
      "id": 906504178,
      "node_id": "MDU6SXNzdWU5MDY1MDQxNzg=",
      "number": 68,
      "title": "å¦‚ä½•é€‰æ‹©åˆé€‚çš„å…¬å¸ï¼Ÿ",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 3041947800,
          "node_id": "MDU6TGFiZWwzMDQxOTQ3ODAw",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E4%BB%A3%E7%A0%81%E4%BA%BA%E7%94%9F",
          "name": "ä»£ç äººç”Ÿ",
          "color": "7B17E3",
          "default": false,
          "description": "å’ŒæŠ€æœ¯æ— å…³ï¼Œäººç”Ÿçš„æ„Ÿæ‚Ÿ"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2021-05-29T16:03:33Z",
      "updated_at": "2021-12-21T10:00:56Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "![èƒŒæ™¯å›¾ç‰‡](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7fc336f293cb45d3a308a9ccc0a1aa17~tplv-k3u1fbpfcp-zoom-1.image)\r\n\r\nè™½ç„¶é‡‘ä¸‰é“¶å››æ—©ä¹Ÿè¿‡å»ï¼Œä¸è¿‡å¦ç‡çš„è¯´å¥½å¤šå…¬å¸æ‹›è˜çš„éœ€æ±‚é‡ä¾ç„¶å¾ˆå¤§ï¼Œå†åŠ ä¸Šè‡ªå·±è¿™æ®µæ—¶é—´ä¹Ÿåœ¨å…³æ³¨ï¼Œè¿™å—æ‰€ä»¥å°±ç®€å•èŠèŠä»é€‰æ‹©å…¬å¸åˆ°å…¥èŒçš„ä¸€ç³»åˆ—é—®é¢˜\r\n\r\n> è¿™é‡Œä¸æ¶‰åŠå¦‚ä½•å†™ç®€å†ä»¥åŠå¦‚ä½•å›ç­”é¢è¯•çš„é—®é¢˜ï¼Œåé¢å¦‚æœæœ‰æ—¶é—´ä¼šè€ƒè™‘æ–°å¼€ä¸€ä¸ªç¯‡å¹…æ¥è¯´\r\n\r\n## æ±‚èŒæ¸ é“\r\n\r\né¦–å…ˆå¦‚æœè‡ªå·±æ—©å·²æœ‰å¿ƒä»ªçš„ç›®æ ‡é‚£å¯ä»¥è·³è¿‡è¿™ä¸€æ­¥ï¼Œç›´æ¥ä»è„‰è„‰æˆ–è€…çŸ¥ä¹ç­‰å„ç§ç¤¾äº¤ app ä¸Šæ‰¾åˆ°å†…æ¨ä¿¡æ¯ï¼Œç„¶åæŠ•é€’ç®€å†ç­‰å¾…é¢è¯•ã€‚\r\n\r\nä½†æ˜¯å¦‚æœæ²¡æœ‰æ‰¾åˆ°æ»¡æ„çš„ç›®æ ‡ï¼Œé‚£ä¸å¦¨ä» `boss ç›´è˜`ç€æ‰‹ï¼Œä¹‹å‰ä¹Ÿç”¨äº†å¾ˆå¤šå…¶ä»–çš„æ‹›è˜ app æ¯”å¦‚æ‹‰é’©ï¼Œä¸è¿‡å¦ç‡çš„è¯´æ²Ÿé€šæ¨¡å¼æˆ–è€…è¯´å›å¤æ¶ˆæ¯è¿™å—å§‹ç»ˆæ²¡æœ‰ boss ç›´è˜æ¥çš„ç®€æ´å’Œæ¸…çˆ½ã€‚\r\n\r\n## ç­›é€‰å…¬å¸\r\n\r\nä¹‹å‰åœ¨çŸ¥ä¹çœ‹åˆ°ä¸€ä¸ªé—®é¢˜å°±æ˜¯è¯´`â€œå¹´è½»äººåˆ°åº•é€‰æ‹©å¤§å…¬å¸è¿˜æœ‰å°å…¬å¸â€`ï¼Œå½“ç„¶å„ç§ç­”æ¡ˆå„ä¸ç›¸åŒï¼Œä½†æ˜¯ç«™åœ¨è‡ªå·±è¸©è¿‡å‘çš„æƒ…å†µæ¥è¯´è¿˜æ˜¯å»ºè®®å¤§å®¶é€‰æ‹©ä¸€ä¸ªå¤§å…¬å¸ï¼Œå› ä¸ºå¯ä»¥èŠ‚çœä½ å¾ˆå¤šé¢å¤–çš„é‡‡å‘æˆæœ¬\r\n\r\n- æœ‰ç€å®Œæ•´åŠ è–ªç»“æ„ï¼Œä¸å†æ˜¯å£å¤´ä¸Šçš„ä¸€å¹´ä¸¤è°ƒæˆ–è€…ä¸€è°ƒï¼›\r\n- å„ç§ç¦åˆ©æ¯”è¾ƒé½å…¨ï¼Œå…¬ç§¯é‡‘å’Œç¤¾ä¿ç¼´çº³ç­‰ï¼›\r\n- å¼€å‘è§„èŒƒå’Œå›¢é˜Ÿåä½œæµç¨‹æ¯”è¾ƒæˆç†Ÿï¼Œå¯ä»¥æ¥è§¦åˆ°å®Œæ•´çš„å¼€å‘æµç¨‹ï¼›\r\n\r\nå…¶æ¬¡è¦æƒ³å¥½è‡ªå·±åšä»€ä¹ˆæ ·çš„äº§å“ï¼Œç›®å‰æŒ‰ç…§äº§å“åˆ’åˆ†å¯ä»¥åˆ†ä¸ºä¸¤ç§\r\n\r\n- to Bï¼šæä¾›ç»™ä¼ä¸šçš„äº§å“\r\n- to Cï¼šæä¾›ç»™ä¸ªäººçš„äº§å“\r\n\r\næ‰€ä»¥æ ¹æ®ä¸Šé¢ä¸¤æ¡ï¼Œåœ¨åŠ ä¸Šè‡ªå·±çš„ä¸€äº›å¿ƒç†åº•çº¿ï¼š\r\n\r\n1. ç¡®å®šå¥½è‡ªå·±æƒ³å»ä»€ä¹ˆè§„æ¨¡çš„å…¬å¸\r\n2. åšçš„äº§å“ä¸šåŠ¡æ˜¯ä»€ä¹ˆæ ·å­çš„\r\n3. æœŸå¾…çš„è–ªèµ„ç»“æ„ + ä¸Šä¸‹ç­æ—¶é—´ + åŸºç¡€æ€§çš„ç¦åˆ©ç­‰\r\n\r\næ ¹æ®ä¸Šé¢æ¡ä»¶åˆæ­¥ç­›é€‰å‡ºä¸€äº›å…¬å¸ï¼Œä¸‹é¢çš„è¯å°±æ˜¯çœ‹å…¬å¸çš„ä»‹ç»è·Ÿè‡ªå·±çš„ç¬¦åˆåº¦æ€ä¹ˆæ ·ï¼Œè¿™é‡Œå»ºè®®å¤§å®¶ä¸è¦å¹¿æ’’ç½‘è€Œæ˜¯ä¸“é—¨ç²¾é€‰è¿™æ ·ä¼šæ›´æœ‰æ•ˆçš„é’ˆå¯¹å…¬å¸è¿›è¡Œå‡†å¤‡ï¼Œå…¶å®ä¸ä»…ä»…æ˜¯å…¬å¸åœ¨é€‰æ‹©ä¸ªäººï¼Œä¸ªäººä¹Ÿè¦é€‰æ‹©å…¬å¸ï¼Œä¸ç„¶å…¶å®ä½ ä¼šå¾…çš„å¾ˆå‹æŠ‘æˆ–è€…è¯´è·Ÿä½ ä¸åŒ¹é…å°±æ˜¯æµªè´¹åŒæ–¹çš„æ—¶é—´ã€‚\r\n\r\nè¿™é‡Œé¢å¤–è¡¥å……ä¸€ç‚¹ï¼Œåœ¨é¢è¯•ä¹‹å‰å¯ä»¥äº‹å…ˆæ²Ÿé€šå¥½ä½ è‡ªå·±çš„ä¸€äº›åº•çº¿ä¿¡æ¯ã€‚é¿å…æ›´å¤šçš„æ—¶é—´æˆæœ¬æµªè´¹ï¼Œæ¯”å¦‚æˆ‘å°±æ˜¯è¦è¿‡æ»¤æ‰å…¬ç§¯é‡‘ç¤¾ä¿ä¸è¶³é¢ç¼´çº³çš„å…¬å¸ï¼Œé‚£ä½ å°±å¯ä»¥ç›´æ¥è¯´ï¼Œä½ å¥½æ–¹ä¾¿é—®ä¸€ä¸‹ä½ ä»¬å…¬ç§¯é‡‘ç¼´çº³æ¯”ä¾‹å’ŒåŸºæ•°å—ï¼Ÿ\r\n\r\næœ€åï¼Œå¦‚æœå¯¹æ–¹å·²è¯»ä¸å›é‚£å°±é»˜è®¤å‡‰äº†ï¼Œä½œä¸ºä¸è¦æ€€ç–‘è‡ªå·±ï¼Œæ‰¾å·¥ä½œä»æ¥ä¸æ˜¯ä¸€ä¸ªç®€å•çš„äº‹æƒ…ã€‚\r\n\r\n## é¢è¯•å‡†å¤‡\r\n\r\nç¡®å®šå¥½ç›®æ ‡è·Ÿ hr æ²Ÿé€šçš„æ—¶å€™æˆ‘ä¸ªäººè§‰å¾—ç¨å¾®çªå‡ºä¸»é¢˜å¯ä»¥æé«˜ä¸å°‘é¢è¯•å‡ ç‡ï¼Œæˆ‘ä¸€èˆ¬å–œæ¬¢è¯´ï¼šâ€œä½ å¥½çœ‹åˆ°è´µå…¬å¸çš„æ‹›è˜æƒ…å†µè§‰å¾—è›®ç¬¦åˆçš„ï¼Œå¯ä»¥å‘ä¸€ä»½ç®€å†ç»™ä½ çœ‹çœ‹å—ï¼Ÿâ€\r\n\r\nä¸è¿‡è¿™ä¸ªä¹Ÿä¸æ˜¯ç»å¯¹çš„ï¼Œæ¯•ç«Ÿæ±‚èŒè¿˜æ˜¯çœ‹ç¬¦ä¸ç¬¦åˆå²—ä½è¦æ±‚ï¼Œå¦‚æœä½ çš„ç®€å†è¶³å¤Ÿä¸°å¯Œï¼Œä¼°è®¡æ¯å¤©æ²Ÿé€šä½ çš„ hr è‡ªå·±éƒ½è¦æ’é˜Ÿå¤„ç†ã€‚\r\n\r\nè¯´å®Œæ‰“æ‹›å‘¼è¿˜æœ‰ä¸€ä¸ªéœ€è¦ç¡®è®¤å°±æ˜¯é¢è¯•æ—¶é—´å’Œæ–¹å¼ï¼Œä¸€èˆ¬è€Œè¨€å¦‚æœæ˜¯åœ¨èŒçš„è¯ä¼˜å…ˆè¿œç¨‹æˆ–è€…ç”µè¯é¢è¯•ï¼Œä¸ç„¶é‡åˆ°å‘çš„é¢è¯•å®˜è®©ä½ æ„Ÿè§‰æ—¶é—´è¢«æµªè´¹ï¼Œè€Œå¦‚æœä½ åœ¨å¤–åœ°æ±‚èŒçš„åœ°ç‚¹è·Ÿä½ ä¸åœ¨åŒä¸€ä¸ªåœ°æ–¹é‚£å¦‚æœå¯¹æ–¹ä¸æ”¯æŒè¿œç¨‹æˆ‘å»ºè®®ä½ å°±ä¸è¦å»äº†ï¼Œå› ä¸ºå¾ˆå¤šå…¬å¸çš„ hr å¯¹æŒ‡æ ‡æœ‰è¦æ±‚ï¼Œå¯èƒ½ä½ åªæ˜¯ä¸€ä¸ªä»–ä»¬çš„ kpiã€‚\r\n\r\nå½“ç„¶å¦‚æœèƒ½å®åœ°é¢è¯•æ›´å¥½ï¼Œå¯ä»¥é€šè¿‡è§‚å¯Ÿå…¬å¸é™„è¿‘çš„ç¯å¢ƒï¼Œå…¬å¸çš„ç¯å¢ƒä»¥åŠäººå‘˜åˆæ­¥åˆ¤æ–­ä¸€ä¸‹ã€‚\r\n\r\n## é¢è¯•ç»“æŸ\r\n\r\nå¦‚æœä½ å·²ç»æŠŠä¸€é¢ã€äºŒé¢ä¹‹ç±»çš„å…¨éƒ¨éƒ½è¿‡äº†ï¼Œåªå‰©ä¸‹ hr è¿™ä¸€å…³äº†é‚£ä½ å°±å¯ä»¥èŠä¸€ä¸‹å…³ä¹åˆ‡èº«çš„ç¦åˆ©ä¹‹ç±»äº†ã€‚\r\n\r\n### å·¥èµ„\r\n\r\nåŠ³åŠ¨åˆåŒä¼šç­¾è®¢å¤šå°‘ï¼Œç»©æ•ˆä¼šå æ¯”å¤šå°‘ï¼Œä»¥åŠç»©æ•ˆæ˜¯æŒ‰ç…§æ¯ä¸ªæœˆå‘æ”¾è¿˜æ˜¯ä¸€ä¸ªå­£åº¦å‘æ”¾ï¼Œè¯•ç”¨æœŸå·¥èµ„éƒ½éœ€è¦è¯¦ç»†äº†è§£æ¸…æ¥šï¼Œè€Œä¸”å…³äºåˆåŒä¸Šçš„å·¥èµ„ï¼Œä¹Ÿæ˜¯åé¢å¦‚æœéœ€è¦ç»´æƒæƒ…å†µçš„çš„ä¸€ä¸ªé‡è¦ä¾æ®ã€‚\r\n\r\n### äº”é™©ä¸€é‡‘ç¼´çº³çš„åŸºæ•°å’Œæ¯”ä¾‹\r\n\r\näº”é™©ä¸€é‡‘ä¸ç¼´çº³æ˜¯è¿æ³•çš„ï¼Œä½†æ˜¯æœ‰çš„ä¼ä¸šä¸ºäº†é™ä½æˆæœ¬é€‰æ‹©åªç¼´çº³æœ€ä½çš„åŸºæ•°ã€‚\r\n\r\nå…¬ç§¯é‡‘ä¼šè·Ÿä½ ä¹°æˆ¿çš„å…¬ç§¯é‡‘è´·æ¬¾è¿˜æœ‰è¿˜æ¬¾æŒ‚é’©ï¼Œæ˜¯ä¸€ä¸ªçœŸæ­£çš„ç¦åˆ©ï¼›\r\n\r\nè€Œäº”é™©è™½ç„¶ç›®å‰å¯èƒ½ç”¨ä¸åˆ°ï¼Œä½†æ˜¯å°‘äº¤è‚¯å®šæ˜¯ä¸ªäººçš„ä¸€ä¸ªæŸå¤±\r\n\r\n### åŠ ç­\r\n\r\næ˜¯å¦æœ‰åŠ ç­å·¥èµ„æˆ–è€…è°ƒä¼‘ï¼Œå…¶å®æˆ‘ä¸ªäººæ˜¯ä¸æ€ä¹ˆå–œæ¬¢åŠ ç­å¤šçš„å…¬å¸ï¼Œå°¤å…¶æ˜¯å› ä¸ºä¸šåŠ¡å¾ˆèµ¶çš„åŸå› æˆ–è€…å›¢é˜Ÿå…¬å¸æ°›å›´é€ æˆçš„ï¼Œå› ä¸ºè¿™ä¸ªä¼šå½±å“åˆ°ä½ çš„åç»­å­¦ä¹ ï¼Œè€Œä¸”æ¯å¤©ä½¿ä½ å¾ˆç–²å€¦ï¼Œä»é•¿è¿œæ¥çœ‹é€ƒç¦»åŠ ç­å¤šçš„å…¬å¸å¯¹ä½ çš„èŒä¸šç”Ÿæ¶¯æ›´å‹å¥½ã€‚\r\n\r\n### ä½œæ¯æ—¶é—´æ˜¯æ€ä¹ˆæ ·çš„\r\n\r\nç¡®å®šå¥½ä½œæ¯æ—¶é—´ï¼Œçœ‹çœ‹è‡ªå·±æ¯å¤©éœ€è¦é€šå‹¤å¤šä¹…ï¼Œå¦‚æœæ¡ä»¶å…è®¸å°±æ¬åˆ°å…¬å¸é™„è¿‘æ¥å§ï¼Œæ¯å¤©é€šå‹¤åå‡ åˆ†é’ŸçœŸçš„å¾ˆæœ‰å¹¸ç¦æ„Ÿã€‚\r\n\r\nè¿˜æœ‰ç¡®å®šå¥½æ˜¯å¦å¯ä»¥å¼¹æ€§æ‰“å¡ï¼Œå¦‚æœä½ åƒæˆ‘ä¸€æ ·æ¯å¤©å–œæ¬¢å¡ç€ç‚¹ä¸Šç­è¿˜æœ‰æ‰£é’±å•¥çš„ï¼Œå°±éœ€è¦ä»”ç»†æƒ³ä¸‹äº†ï¼Œä¸è¿‡å¯¹äºè¿™ç§å…¬å¸å»ºè®®è·‘è·¯ä¹‹ã€‚\r\n\r\n### æ¯å¹´ä¼šæœ‰è°ƒè–ªçš„æœºä¼šå—ï¼Œä¸€ä¸ªæµç¨‹æ˜¯æ€ä¹ˆæ ·çš„\r\n\r\nè¿™é‡Œå¯ä»¥ç®€å•äº†è§£ä¸‹ï¼Œå¯¹äºäº’è”ç½‘æ¥è¯´è·³æ§½æ°¸è¿œæ˜¯æ¶¨è–ªçš„æœ€å¥½æœºä¼šï¼Œä¸è¿‡å¦‚æœå›¢é˜Ÿæ°›å›´ä¸é”™ï¼Œå†åŠ ä¸Šæ¶¨è–ªå¹…åº¦ä¹Ÿ ok æˆ‘è§‰å¾—ç•™ä¸‹æ¥ä¹Ÿæ²¡æœ‰ä»€ä¹ˆä¸å¥½çš„\r\n\r\n### å…¶ä»–å„ç§ç¦åˆ©\r\n\r\næ¯”å¦‚é¤è¡¥ã€æˆ¿è¡¥ã€äº¤é€šè¡¥ã€èŠ‚å‡æ—¥ç¦åˆ©ã€å¦å¤–çš„ä¿é™©ç­‰ï¼Œä¸è¿‡æ³¨æ„ä¸è¦è·Ÿä½ è°ˆçš„è–ªèµ„æ··åˆåœ¨äº†ä¸€èµ·ï¼Œæ¯”å¦‚ä½ ç¨å‰ 20Kï¼Œç»“æœæ˜¯å„ç§ç¦åˆ©åŠ åœ¨ä¸€èµ·çš„ï¼Œé‚£æˆ‘è§‰å¾—å°±æ²¡æœ‰ä»€ä¹ˆå¿…è¦äº†ï¼Œè¿˜ä¸å¦‚ä¸å†™ã€‚\r\n\r\n### å¹´ç»ˆå¥–\r\n\r\nå¹´ç»ˆå¥–ä¹Ÿå¯ä»¥é—®ä¸‹ï¼Œä¸€èˆ¬æ¥è¯´æœ€å°‘ä¸€ä¸ªæœˆï¼Œå¤šçš„è¯ä¸‰å››ä¸ªæœˆçš„ä¹Ÿæ˜¯æœ‰ã€‚\r\n\r\nå¯¹äºæœŸæƒä¹‹ç±»çš„ï¼Œæˆ‘ä¸ªäººå»ºè®®å…ˆæš‚æ—¶æ— è§†ä¹‹ï¼Œå› ä¸ºè¿™ä¸ªä¸œè¥¿éœ€è¦æœ‰æ—¶é—´å‰ç½®æ¡ä»¶ï¼Œåˆ°æ—¶å€™ä½ èƒ½ä¸èƒ½å¾…æ»¡è¿™ä¹ˆä¹…éƒ½ä¸å¥½è¯´ï¼Œå¦‚æœçœŸçš„å¾…è¿™ä¹ˆä¹…å†äº†è§£ä¹Ÿä¸è¿Ÿã€‚\r\n\r\n## æœ€å\r\n\r\nå¦‚æœç¡®å®šå¥½å‡†å¤‡å»ï¼Œè®°å¾—è®©å¯¹æ–¹å…¬å¸å‘ä¸€ä»½`offer`è¿‡æ¥ï¼Œè¾èŒçš„è¯æ­£å¼å‘˜å·¥éœ€è¦ä¸€ä¸ªæœˆï¼Œè¯•ç”¨æœŸä¸‰å¤©ï¼Œæ‰€ä»¥ä½ éœ€è¦è·Ÿæ–°å…¬å¸çš„ hr ç¡®å®šå¥½å…·ä½“çš„å…¥èŒæ—¶é—´ï¼Œä»¥åŠç¡®å®šå¥½ç¤¾ä¿çš„ç¼´çº³æ—¶é—´ï¼Œé¿å…æ–­äº¤ç¤¾ä¿é€ æˆçš„å½±å“ã€‚\r\n\r\næœ€åï¼Œå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©å¯ä»¥ç‚¹ä¸€ä¸‹`statr`\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/68/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/68/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/71",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/71/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/71/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/71/events",
      "html_url": "https://github.com/bosens-China/blog/issues/71",
      "id": 914142576,
      "node_id": "MDU6SXNzdWU5MTQxNDI1NzY=",
      "number": 71,
      "title": "å›¢é˜Ÿè§„èŒƒç³»åˆ—ä¹‹å·¥ç¨‹è§„èŒƒ",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 3661376441,
          "node_id": "LA_kwDOCzPAy87aPCu5",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83",
          "name": "ä»£ç è§„èŒƒ",
          "color": "5319e7",
          "default": false,
          "description": "å›¢é˜Ÿè§„èŒƒã€ä»£ç è§„èŒƒã€æŠ€æœ¯é€‰å‹ç­‰ç›¸å…³å†…å®¹"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2021-06-08T01:42:17Z",
      "updated_at": "2021-12-21T10:00:23Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "![bg](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7235b285206d49f5bb8f0cc2e43771c9~tplv-k3u1fbpfcp-zoom-1.image)\r\n\r\næœ€è¿‘ä¸€å‘¨çš„å·¥ä½œé‡å¿ƒå°±æ˜¯åœ¨æ¢³ç†å›¢é˜Ÿè§„èŒƒï¼Œåœ¨å†™çš„è¿‡ç¨‹ä¹ŸæŸ¥ç¼ºè¡¥æ¼äº†ä¸å°‘çŸ¥è¯†ï¼Œå‰”é™¤æ‰å…³äºå…¬å¸åœºæ™¯çš„éƒ¨åˆ†å°±æœ‰äº†è¿™ä¸€ç³»åˆ—çš„æ–‡ç« ï¼Œé¢„è®¡å†™å››éƒ¨åˆ†ï¼š\r\n\r\n1. [git è§„èŒƒ](https://github.com/bosens-China/blog/issues/70)\r\n2. å·¥ç¨‹è§„èŒƒ\r\n3. [ç”¨æˆ·ä½“éªŒè§„èŒƒ](https://github.com/bosens-China/blog/issues/72)\r\n4. [å‘½åè§„èŒƒ](https://github.com/bosens-China/blog/issues/73)\r\n\r\n# å·¥ç¨‹è§„èŒƒ\r\n\r\n## é¡¹ç›®ç›®å½•\r\n\r\né¡¹ç›®ç›®å½•å®šä¹‰çš„åç§°åº”å½“åšåˆ°æ¸…æ™°æ˜“è¯»ï¼Œå¯¹äºæ¯ä¸ªæ–‡ä»¶å¤¹å¯ä»¥æ”¾ç½®ä¸€ä¸ª`README.md`çš„æ–‡ä»¶ï¼Œå¯¹é‡è¦éƒ¨åˆ†å’ŒèŒè´£è¿›è¡Œæè¿°ï¼Œä¸‹é¢ç»™ä¸€ä»½å¸¸ç”¨çš„ç¤ºä¾‹ï¼š\r\n\r\n```sh\r\nâ”œâ”€â”€ public                          // é™æ€é¡µé¢\r\nâ”œâ”€â”€ scripts                         // ç›¸å…³è„šæœ¬é…ç½®\r\nâ”œâ”€â”€ src                             // ä¸»ç›®å½•\r\n    â”œâ”€â”€ assets                      // é™æ€èµ„æº\r\n    â”œâ”€â”€ components                  // å…¨å±€ç»„ä»¶\r\n    â”œâ”€â”€ lib                         // å…¨å±€æ’ä»¶\r\n    â”œâ”€â”€ router                      // è·¯ç”±é…ç½®\r\n    â”œâ”€â”€ store                       // vuex é…ç½®\r\n    â”œâ”€â”€ styles                      // æ ·å¼\r\n    â”œâ”€â”€ utils                       // å·¥å…·æ–¹æ³•(axioså°è£…ï¼Œå…¨å±€æ–¹æ³•ç­‰)\r\n    â”œâ”€â”€ views                       // é¡µé¢\r\n    â”œâ”€â”€ App.vue                     // é¡µé¢ä¸»å…¥å£\r\n    â”œâ”€â”€ main.js                     // è„šæœ¬ä¸»å…¥å£\r\n```\r\n\r\nä¸‹é¢å†è¯´å‡ æ¡å»ºè®®ï¼š\r\n\r\n- å¦‚æœå­˜åœ¨åµŒå¥—è·¯ç”±çš„é¡µé¢ï¼Œå¯ä»¥åœ¨ src å®šä¹‰ä¸€ä¸ª `layout` å½“åšåŸºç¡€çš„è§†å›¾ç»„ä»¶ä½¿ç”¨\r\n- `components` æ–‡ä»¶å†…çš„ç»„ä»¶è¯·ä¿æŒé€šç”¨æ€§\r\n- å¦‚æœ views å­˜åœ¨ä¸šåŠ¡ç»„ä»¶ï¼Œå¯ä»¥åœ¨å½“å‰ç›®å½•ä¸‹æ–°å»º components ä½¿ç”¨ï¼Œæˆ–è€…åŸºäºå…¨å±€ components è¿›è¡ŒäºŒæ¬¡å°è£…\r\n- views ä¸‹çš„é¡µé¢ä½¿ç”¨æ–‡ä»¶å¤¹çš„å½¢å¼æ¥å®šä¹‰ï¼Œä¾‹å¦‚æœ‰ä¸€ä¸ªç»Ÿè®¡é¡µé¢ï¼Œå¦‚æœåªå†™ä¸€ä¸ª`.vue`æ–‡ä»¶ä¼šå¯¼è‡´æ–‡ä»¶å†…å®¹è¿‡å¤šï¼Œè€Œå¦‚æœç›´æ¥åœ¨ views ä¸‹è¿›è¡ŒæŠ½ç¦»å¤šä¸ª`.vue`ä¼šå¯¼è‡´ç»“æ„ä¸ç»Ÿä¸€\r\n\r\n## utils\r\n\r\nå¯¹äº utils ä¸‹çš„æ–‡ä»¶ï¼Œè¯·ä¿æŒæŒ‰ç…§æ–‡ä»¶ç±»å‹è¿›è¡Œåˆ’åˆ†ï¼Œä¸‹é¢æˆªå–[ant-design-pro](https://github.com/ant-design/ant-design-pro/tree/master/src/utils)çš„ utils æ–‡ä»¶ä¸ºä¾‹\r\n\r\n| åç§°          |                            æäº¤ä¿¡æ¯                             |\r\n| ------------- | :-------------------------------------------------------------: |\r\n| Authorized.ts |                     use @umijs/fabric@2.5.0                     |\r\n| authority.ts  |       ğŸŒ localization: docs translated to english (#7938)       |\r\n| request.ts    |       ğŸŒ localization: docs translated to english (#7938)       |\r\n| utils.less    |                clean: remove unuse less (#6214)                 |\r\n| utils.test.ts | feat: @umijs/route-utils replace getAuthorityFromRouter (#7319) |\r\n| utils.ts      |       ğŸŒ localization: docs translated to english (#7938)       |\r\n\r\n> åœ¨å¼€å‘é¡¹ç›®ä¸­ï¼Œè¯·ä¼˜å…ˆä½¿ç”¨ [lodash](https://www.lodashjs.com/) è¿™æ ·çš„å·¥å…·åº“ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šå°è£…è‡ªå·±çš„æ–¹æ³•ï¼Œå¦‚æœçœŸçš„ä¸å­˜å†åœ¨è€ƒè™‘æ‰‹åŠ¨å®ç°ä» 0 åˆ° 1 å®ç°\r\n\r\n## VueX\r\n\r\nåœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œå¯¹ VueX çš„æ‹†åˆ†é€šå¸¸æ ¹æ®ä¸šåŠ¡ï¼Œè¯·ä¸è¦ç›´æ¥ä½¿ç”¨ VueX ä¸‹çš„`State`ã€`Getter`ã€`Mutation`ç­‰ï¼Œè€Œæ˜¯æ”¹ç”¨`Module`å°†ç›¸å…³ä¾èµ–èšåˆåœ¨ä¸€èµ·ï¼Œæœ€åé€šè¿‡`import`æ•´åˆåœ¨ä¸€èµ·ï¼Œä¸‹é¢ä»¥ home æ–‡ä»¶å¤¹ä¸ºä¾‹ï¼š\r\n\r\n```sh\r\nâ”œâ”€â”€ home                            // ä¸»ç›®å½•\r\n    â”œâ”€â”€ index.js                    // VueX state getters mutations action ç®¡ç†\r\n    â”œâ”€â”€ ...                         // å¯èƒ½å­˜åœ¨çš„å…¶å®ƒæ–‡ä»¶\r\nâ””â”€â”€ index.js                        // VueX ä¸»å…¥å£\r\n```\r\n\r\nhome/index.js\r\n\r\n```js\r\nexport default {\r\n  namespaced: true,\r\n  state: () => ({ ... }),\r\n  mutations: { ... },\r\n  actions: { ... },\r\n  getters: { ... }\r\n}\r\n```\r\n\r\nindex.js\r\n\r\n```js\r\nimport { createStore } from 'vuex';\r\nimport home from './home';\r\n\r\nconst store = createStore({\r\n  modules: {\r\n    home,\r\n  },\r\n});\r\n\r\nexport default store;\r\n```\r\n\r\n## Router\r\n\r\n### è·¯ç”±å±‚çº§\r\n\r\nè·¯ç”±å±‚çº§ååˆ†é‡è¦ï¼Œåœ¨ Router4 ä¹‹å‰ï¼Œä¼šæ ¹æ®è·¯ç”±å®šä¹‰çš„é¡ºåºæ¥å†³å®šè·¯ç”±çš„å…ˆåé¡ºåºï¼Œå¦‚æœå±‚çº§å¾ˆä¸æ¸…æ™°ä¼šå¯¼è‡´ä¸¤ä¸ªé—®é¢˜ï¼š\r\n\r\n- ç»´æŠ¤æˆ–è€…å®šä¹‰æ–°è·¯ç”±éœ€è¦æŸ¥æ‰¾åŠå¤©\r\n- éå† routes ä¿¡æ¯ååˆ†å›°éš¾ï¼Œåšæƒé™ä¹‹ç±»çš„çš„å¾ˆéº»çƒ¦\r\n\r\n![1.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8312de118fe34964afb919655f2f7292~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nä¸¾ä¸ªä¾‹å­ï¼Œå¯¹äºä¸Šé¢çš„ä¸€ä¸ªè®¾è®¡å›¾ï¼ŒåŒ…å«ï¼š`headã€contentã€footer`ä¸‰ä¸ªéƒ¨åˆ†ï¼Œè§‚å¯Ÿä»–ä»¬å‰©ä½™è®¾è®¡å›¾é¡¶éƒ¨å’Œåº•éƒ¨åŸºæœ¬ç›¸åŒï¼Œåªæ˜¯ content åŒºåŸŸçš„å†…å®¹æœ‰æ‰€ä¸åŒã€‚\r\n\r\nè€Œå¯¹è¿™æ ·ä¸€ä¸ªè®¾è®¡å›¾è¿›è¡Œå¼€å‘ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ª`layout`ç»„ä»¶å½“åšåŸºç¡€å…¬å…±ç»“æ„ï¼Œä¹‹åä¹¦å†™`routers`çš„å…·ä½“ä¿¡æ¯\r\n\r\n```sh\r\nâ”œâ”€â”€ routes                            // routesçš„å®šä¹‰ç›®å½•\r\n    â”œâ”€â”€ home.js                       // é¦–é¡µ\r\n    â”œâ”€â”€ type.js                       // åˆ†ç±»\r\n    â”œâ”€â”€ food.js                       // ä¸œå®¶èœ\r\n    â”œâ”€â”€ brand.js                       // å¤§ç‰Œ\r\nâ””â”€â”€ index.js                          // vue router ä¸»å…¥å£\r\nâ””â”€â”€ routes.js                         // å°†routersç›®å½•ä¸‹çš„æ–‡ä»¶åˆ†å‘æˆæœ€ç»ˆvue routerä½¿ç”¨ç»“æ„\r\n```\r\n\r\nroutes.js\r\n\r\n```js\r\nimport layout from '@/layout';\r\nimport home from './routes/home';\r\nimport type from './routes/type';\r\nimport food from './routes/food';\r\nimport brand from './routes/brand';\r\n\r\nconst routes = [\r\n  {\r\n    path: '/',\r\n    component: layout,\r\n    children: home,\r\n  },\r\n  {\r\n    path: '/',\r\n    component: layout,\r\n    children: type,\r\n  },\r\n  {\r\n    path: '/',\r\n    component: layout,\r\n    children: food,\r\n  },\r\n  {\r\n    path: '/',\r\n    component: layout,\r\n    children: brand,\r\n  },\r\n];\r\n\r\nexport default routes;\r\n```\r\n\r\nindex.js\r\n\r\n```js\r\nimport { createRouter, createWebHistory, createWebHashHistory } from 'vue-router';\r\n\r\nimport routes from './routes';\r\n\r\nconst router = createRouter({\r\n  routes,\r\n});\r\n\r\n// å…¨å±€å¯¼èˆªå®ˆå«\r\nrouter.beforeEach(async (to) => {\r\n  // ...\r\n});\r\n\r\nexport default router;\r\n```\r\n\r\n### æ•è·æœªçŸ¥è·¯ç”±\r\n\r\næ— è®ºåœ¨åšä¸­å°è¿˜æ˜¯ç§»åŠ¨ç«¯çš„äº§å“ï¼Œéƒ½éœ€è¦æ­£ç¡®å¤„ç†æœªçŸ¥çš„è·¯ç”±ï¼Œä¸€èˆ¬è€Œè¨€æœ‰äºŒç§å¤„ç†æ–¹å¼ï¼Œå…·ä½“å‚è€ƒé¡¹ç›®çš„ç±»å‹è¿›è¡Œé€‰æ‹©ï¼š\r\n\r\n1. ç›´æ¥ç»™å‡º 404 ä¹‹ç±»çš„æç¤ºï¼Œæç¤ºé¡µé¢ä¸å­˜åœ¨ç­‰ä¿¡æ¯ï¼›\r\n2. å¸®åŠ©å…¶é‡å®šå‘åˆ°é¦–é¡µæˆ–è€…å…¶å®ƒé¡µé¢ï¼›\r\n\r\n```js\r\n// vue router4\r\n{ path: '/:pathMatch(._)_', name: 'NotFound', redirect: { name: 'home' } };\r\n\r\n// vue router3\r\n{ path: '*', name: 'NotFound', redirect: { name: 'home' } };\r\n```\r\n\r\n### è·¯ç”±æ‡’åŠ è½½\r\n\r\nä½¿ç”¨æ‡’åŠ è½½å¯ä»¥èŠ‚çœç™½å±æ—¶é—´ï¼Œæ‡’åŠ è½½çš„æœºåˆ¶åˆ©ç”¨äº† webpack ä»£ç åˆ†å‰² + import()ï¼Œåªåœ¨è¿›å…¥å½“å‰è·¯ç”±çš„æ—¶å€™åŠ è½½æ‰€ä¾èµ–çš„ js æ–‡ä»¶ã€‚\r\n\r\n```js\r\n  { path: '/', name: 'home', component: () => import(/* webpackChunkName: \"home\" */ 'views/home/index.vue') }\r\n```\r\n\r\n> é™¤äº†éœ€è¦`children`çš„çˆ¶çº§é¡µé¢ï¼Œæ‰€æœ‰å…¶å®ƒé¡µé¢ç»Ÿä¸€ä½¿ç”¨æ‡’åŠ è½½\r\n>\r\n> `/* webpackChunkName: \"home\" */`è¿™æ ·çš„æ³¨é‡Šè¯­æ³•ï¼Œæ˜¯ webpack ç‹¬æœ‰çš„ï¼Œå®ƒè´Ÿè´£ build æ‰“åŒ…ä¹‹åçš„æ–‡ä»¶åç§°\r\n\r\n## ç»„ä»¶æ‹†åˆ†å»ºè®®\r\n\r\n![2.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/620871b1cb374af4a5995db475119ba6~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nä¸€ä¸ªå¤§å‹é¡¹ç›®ç”±æ— æ•°å­ç»„ä»¶ç»„åˆè€Œæˆï¼Œæœ‰ç‚¹åƒä¹é«˜ç§¯æœ¨ä¸€æ ·ï¼Œç›´æ¥å¼€å‘ä¸€ä¸ªå¤§å‹é¡¹ç›®è‚¯å®šå¾ˆéš¾ï¼Œä½†æ˜¯å¦‚æœç»™æ— æ•°å­ç»„ä»¶è®©ä½ æ‹¼æ¥åˆ™ç›¸å¯¹ç®€å•ã€‚\r\n\r\nç»„ä»¶çš„æ‹†åˆ†ï¼Œåº”è¯¥éµå¾ªä¸¤ä¸ªåŸåˆ™ï¼š\r\n\r\n### é¢—ç²’åº¦ç»†åˆ†\r\n\r\nåœ¨å­¦ä¹ è®¾è®¡æ¨¡å¼ä¸­æœ‰å¾ˆé‡è¦çš„ä¸€å¥è¯å°±æ˜¯**å•ä¸€èŒè´£**ï¼Œåœ¨ç»„ä»¶å¼€å‘ä¹Ÿæ˜¯åŒç†ï¼ŒåŸåˆ™ä¸Šè®©ä¸€ä¸ªç»„ä»¶åªè´Ÿè´£ä¸€ä»¶äº‹æƒ…ï¼Œå¯ä»¥æœ€å¤§ç¨‹åº¦çš„å¤ç”¨ç»„ä»¶ï¼Œæ–¹ä¾¿æµ‹è¯•å’Œå®šä½é—®é¢˜ã€‚\r\n\r\nä½†æ˜¯è¿‡åº¦çš„å•ä¸€èŒè´£ç»„ä»¶ä¹Ÿä¼šå¯¼è‡´ä¸€ä¸ªé—®é¢˜å°±æ˜¯é¢—ç²’åº¦å¤ªç»†é€ æˆç»„ä»¶çš„ç¢ç‰‡åŒ–ï¼Œä¸¾ä¸€ä¸ªä¾‹å­æ¥è¯´ï¼Œè‡ªåŠ¨å®Œæˆç»„ä»¶ï¼Œå®ƒæ˜¯æœç´¢æ¡† + select ç»„åˆè€Œæˆï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æ¥å¤ç”¨ï¼Œå› ä¸ºå‰ä¸¤ä¸ªç»„ä»¶çš„é¢—ç²’åº¦åˆšåˆšå¥½ã€‚\r\n\r\n![3.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0e6da1bee9e44e9a9059520b8555a99b~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nè¿˜æœ‰ä¸€ä¸ªä¾‹å­å°±æ˜¯å¾½ç« æ•°ç»„ä»¶(Badge)ï¼Œå®ƒçš„å³ä¸Šè§’ä¼šæœ‰çº¢ç‚¹æç¤ºï¼Œå¯èƒ½æ˜¯æ•°å­—ä¹Ÿå¯èƒ½æ˜¯ iconï¼Œå®ƒçš„èŒè´£å½“ç„¶ä¹Ÿå¾ˆå•ä¸€ï¼Œè¿™ä¸ªçº¢ç‚¹æç¤ºä¹Ÿç†æ‰€å½“ç„¶ä¹Ÿå¯ä»¥è¢«å•ç‹¬æŠ½è±¡ä¸ºä¸€ä¸ªç‹¬ç«‹ç»„ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¬é€šå¸¸ä¸ä¼šå°†å®ƒä½œä¸ºç‹¬ç«‹ç»„ä»¶ï¼Œå› ä¸ºåœ¨å…¶å®ƒåœºæ™¯ä¸­è¿™ä¸ªç»„ä»¶æ˜¯æ— æ³•è¢«å¤ç”¨çš„ï¼Œå› ä¸ºæ²¡æœ‰ç±»ä¼¼çš„åœºæ™¯å†éœ€è¦å°çº¢ç‚¹è¿™ä¸ªå°ç»„ä»¶äº†\r\n\r\n![4.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/517274f4b3744cd9acd35e15c091425f~tplv-k3u1fbpfcp-watermark.image)\r\n\r\n### é€šç”¨æ€§è€ƒè™‘\r\n\r\nç»„ä»¶åˆ†ä¸ºåŸºç¡€ç»„ä»¶å’Œä¸šåŠ¡ç»„ä»¶ï¼Œå½“å­˜åœ¨ä¸šåŠ¡å¸¸è§é‡å¤ä½¿ç”¨çš„æ—¶å€™é€šå¸¸ä¼šå¯¹é€šç”¨ç»„ä»¶è¿›è¡ŒäºŒæ¬¡å°è£…ï¼Œä¾‹å¦‚æœ‰ä¸€ä¸ªæœç´¢éƒ¨é—¨çš„ç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶åœ¨å¾ˆå¤š view éƒ½æœ‰å¤ç”¨è€Œä¸”ä¹Ÿå¯¹è¿™ä¸ªç»„ä»¶é›†æˆäº†è‡ªåŠ¨æœç´¢ + åˆå§‹ loading + è‡ªåŠ¨åŠ è½½ä¸‹ä¸€é¡µï¼Œæœ€åä½¿ç”¨æ•ˆæœç”¨èµ·æ¥ä¹Ÿå¾ˆæ–¹ä¾¿ã€‚\r\n\r\nä½†æ˜¯ç°åœ¨çªç„¶æ¥ä¸€ä¸ªéœ€æ±‚ï¼Œè¯´å¯¹æœç´¢çš„ç»„ä»¶è¿›è¡Œåº•éƒ¨æç¤ºï¼Œé‚£éš¾é“ç›´æ¥æ›´æ”¹æºç å—ï¼Ÿä½†æ˜¯å¦‚æœç›´æ¥æ›´æ”¹ç»„ä»¶ï¼Œè¿™æ ·ä¹Ÿè¿èƒŒäº†`å¼€æ”¾ã€å…³é—­åŸåˆ™`\r\n\r\nå…¶å®è¯´è¿™ä¸ªä¾‹å­å°±æ˜¯å¸Œæœ›æ€è€ƒç»„ä»¶å¹¿çš„é€‚é…æ€§ï¼Œåœ¨ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„ç»„ä»¶ï¼Œä¼šçœ‹åˆ°å®ƒä»¬æš´éœ²äº†å¾ˆå¤šæ’æ§½ã€jsx çš„æ¸²æŸ“å‡½æ•°ï¼Œæœ€ç»ˆçš„ç›®çš„ä¹Ÿå°±æ˜¯åº”å¯¹å„ç§å„æ ·çš„åœºæ™¯\r\n\r\n> ç»„ä»¶çš„å½¢æ€(DOM ç»“æ„)æ°¸è¿œæ˜¯åƒå˜ä¸‡åŒ–çš„ï¼Œä½†æ˜¯å…¶è¡Œä¸º(é€»è¾‘)æ˜¯å›ºå®šçš„ï¼Œå› æ­¤é€šç”¨ç»„ä»¶çš„ç§˜è¯€ä¹‹ä¸€å°±æ˜¯å°† DOM ç»“æ„çš„æ§åˆ¶æƒäº¤ç»™å¼€å‘è€…,ç»„ä»¶åªè´Ÿè´£è¡Œä¸ºå’Œæœ€åŸºæœ¬çš„ DOM ç»“æ„\r\n\r\n## å·¥ç¨‹ä¼˜åŒ–\r\n\r\nä¼˜åŒ–æ˜¯ä¸€ä¸ªå¾ˆåºå¤§çš„å‘½é¢˜ï¼Œæ ¹æ®é¡¹ç›®çš„ä¸åŒæ‰€é‡‡å–çš„æ–¹å¼ä¹Ÿä¸å°½ç›¸åŒï¼Œä¸‹é¢åªæ€»ç»“ä¸€äº›å¸¸ç”¨çš„æ–¹å¼\r\n\r\n### é¡¹ç›®ä¼˜åŒ–\r\n\r\n- CND\r\n- gzipï¼Œè®©åç«¯æ”¯æŒ gzip å‹ç¼©ï¼Œå‰ç«¯ä¹Ÿç”Ÿæˆ gzip æ–‡ä»¶\r\n- ä½¿ç”¨ webp æ ¼å¼ï¼Œç”Ÿäº§ç¯å¢ƒä¸‹å‹ç¼©å›¾ç‰‡\r\n- è·¯ç”±æ‡’åŠ è½½\r\n- ç¬¬ä¸‰æ–¹ç»„ä»¶æŒ‰éœ€åŠ è½½\r\n- æŠ½ç¦»ç¬¬ä¸‰æ–¹åº“ï¼Œé¿å…å’Œä¸šåŠ¡ç»„ä»¶è€¦åˆä¸€èµ·æ‰“åŒ…\r\n- ...\r\n\r\n### code ä¼˜åŒ–\r\n\r\n- å‡å°‘å¯¹ dom æ“ä½œï¼Œå¦‚æœæ“ä½œå°†æ‰€æœ‰ dom èšåˆåœ¨ä¸€èµ·ä¿®æ”¹\r\n- ä¸ç›´æ¥ä¿®æ”¹ style æ”¹ç”¨ class ä¿®æ”¹ï¼›\r\n- å°½é‡ä¸é€‚ç”¨ tableï¼Œç»‘å®šäº‹ä»¶é‡‡ç”¨äº‹ä»¶å§”æ‰˜å½¢å¼\r\n- å¯¹åŠ¨ç”»å…ƒç´ ï¼Œè®©å…¶è„±ç¦»æ–‡æ¡£æµï¼Œå‡å°‘é‡ç»˜å’Œé‡æ’\r\n- ...\r\n\r\n### æ„å»ºè¿‡ç¨‹ä¼˜åŒ–\r\n\r\n- åˆ é™¤ eslint-loaderï¼Œæ”¹ç”¨ç¼–è¾‘å™¨è‡ªå¸¦çš„ eslint\r\n- ä½¿ç”¨ catch-loaderï¼Œå¯¹èµ„æºè¿›è¡ŒåŠ é€Ÿ\r\n- ç”Ÿäº§ç¯å¢ƒä¸‹åˆ é™¤`.map`æ–‡ä»¶ï¼Œç¼©çŸ­`import`æŸ¥æ‰¾åç¼€\r\n- ...\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/71/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/71/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/72",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/72/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/72/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/72/events",
      "html_url": "https://github.com/bosens-China/blog/issues/72",
      "id": 914175625,
      "node_id": "MDU6SXNzdWU5MTQxNzU2MjU=",
      "number": 72,
      "title": "å›¢é˜Ÿè§„èŒƒç³»åˆ—ä¹‹ç”¨æˆ·ä½“éªŒè§„èŒƒ",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 3661376441,
          "node_id": "LA_kwDOCzPAy87aPCu5",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83",
          "name": "ä»£ç è§„èŒƒ",
          "color": "5319e7",
          "default": false,
          "description": "å›¢é˜Ÿè§„èŒƒã€ä»£ç è§„èŒƒã€æŠ€æœ¯é€‰å‹ç­‰ç›¸å…³å†…å®¹"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2021-06-08T02:22:11Z",
      "updated_at": "2021-12-21T10:00:18Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "![bg](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b9625a50c497462ab14fb45ab08d21d6~tplv-k3u1fbpfcp-zoom-1.image)\r\n\r\næœ€è¿‘ä¸€å‘¨çš„å·¥ä½œé‡å¿ƒå°±æ˜¯åœ¨æ¢³ç†å›¢é˜Ÿè§„èŒƒï¼Œåœ¨å†™çš„è¿‡ç¨‹ä¹ŸæŸ¥ç¼ºè¡¥æ¼äº†ä¸å°‘çŸ¥è¯†ï¼Œå‰”é™¤æ‰å…³äºå…¬å¸åœºæ™¯çš„éƒ¨åˆ†å°±æœ‰äº†è¿™ä¸€ç³»åˆ—çš„æ–‡ç« ï¼Œé¢„è®¡å†™å››éƒ¨åˆ†ï¼š\r\n\r\n1. [git è§„èŒƒ](https://github.com/bosens-China/blog/issues/70)\r\n2. [å·¥ç¨‹è§„èŒƒ](https://github.com/bosens-China/blog/issues/71)\r\n3. ç”¨æˆ·ä½“éªŒè§„èŒƒ\r\n4. [å‘½åè§„èŒƒ](https://github.com/bosens-China/blog/issues/73)\r\n\r\n# ç”¨æˆ·ä½“éªŒè§„èŒƒ\r\n\r\nå…³äºç”¨æˆ·ä½“éªŒæ˜¯ä¸€ä¸ªå¾ˆåºå¤§çš„å‘½é¢˜å¹¶ä¸”æ¯ä¸ªäººå¯¹äºä½“éªŒçš„ç†è§£ä¹Ÿå„ä¸ç›¸åŒï¼ŒåŒæ—¶ä¼´éšç€æ—¶æ•ˆæ€§ï¼Œéšç€æ–°æŠ€æœ¯çš„å‡ºç°å¯èƒ½ä¹‹å‰çš„ä½“éªŒå°±å¾ˆå¿«è½ä¼äº†ï¼Œæ‰€ä»¥ä¸‹é¢å†…å®¹åªèƒ½ç®€çŸ­æ¦‚æ‹¬ä¸‹ã€‚\r\n\r\n## é€šç”¨å‡†åˆ™\r\n\r\n### å¢åŠ å¯ç‚¹å‡»åŒºåŸŸå¤§å°\r\n\r\n![1.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a2fb47391323406d90d3cc8a350bdf0b~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nä»¥ä¸Šå›¾ä¸ºä¾‹ï¼Œå¦‚æœå¿…é¡»ç‚¹å‡»åˆ°`checkbox`åŒºåŸŸæ‰èƒ½ç‚¹å‡»ç”Ÿæ•ˆï¼Œå¿…ç„¶ä¼šå¯¼è‡´ä½“éªŒä¸ä½³\r\n\r\nç»„ä»¶çš„è€ƒè™‘ä¸€è‡´æ€§åŒæ—¶ä¹ŸåŒ…å«äº†é¡µé¢ç»“æ„ï¼Œå¯¹äºä¸Šå›¾æ‰€ç¤º label å’Œ checkbox å°±æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œè¿™é‡ŒæŠ›ç –å¼•ç‰è¯´ä¸€äº›å¸¸è§é€‚ç”¨è¯¥å‡†åˆ™çš„å…ƒç´ ï¼š\r\n\r\n- header åŒºåŸŸå³ä¸Šè§’å¤´åƒå’Œå§“åéƒ¨åˆ†ï¼›\r\n- Labelã€li ç­‰æ•´ä½“ä¸€è¡Œå…ƒç´ ï¼›\r\n- è‡ªå®šä¹‰å›¾æ ‡\r\n- ...\r\n\r\nåœ¨å¯¹ä¸Šé¢å…ƒç´ è¿›è¡Œäº¤äº’çš„æ—¶å€™ï¼Œå°½é‡é¿å…ç”¨æˆ·çš„ç‚¹å‡»æˆæœ¬ï¼Œä¸‹é¢è¯´ä¸¤ä¸ªå¸¸è§çš„åšæ³•\r\n\r\n#### å¢å¤§æ•´ä½“åŒºåŸŸç‚¹å‡»ï¼Œä¾‹å¦‚æœ‰ä¸‹é¢ä¸€ä¸ªå¤´åƒåŒºåŸŸ\r\n\r\n```html\r\n<p class=\"portrait\">\r\n  <img class=\"portrait-img\" src=\"xxx\" />\r\n  <span class=\"portrait-name\">xxxx</span>\r\n</p>\r\n```\r\n\r\nå¦‚æœåŸæœ¬æ˜¯ç‚¹å‡»äº‹ä»¶ç»‘å®šåœ¨`.portrait-img`ï¼Œé‚£ä¹ˆè¯·è€ƒè™‘å¢åŠ åˆ°`.portrait`\r\n\r\n#### å¢å¤§å…ƒç´ æœ¬èº«çš„ç‚¹å‡»åŒºåŸŸ\r\n\r\n```html\r\n<i class=\"i-con\"></i>\r\n```\r\n\r\nå¯¹äºä¸Šé¢çš„ i å…ƒç´ ï¼Œé€šå¸¸ç”¨æ¥è®¾ç½®è‡ªå®šä¹‰å›¾æ ‡ï¼Œä½†æ˜¯åœ¨å®é™…æ“ä½œä¸­ï¼Œç”¨æˆ·çš„é¼ æ ‡æˆ–è€…æ‰‹åŠ¿å¯èƒ½å­˜åœ¨åå·®æ‰€ä»¥éœ€è¦å¢åŠ è¿™ä¸ªå…ƒç´ çš„æœ¬èº«èŒƒå›´ã€‚\r\n\r\nå›å½’`css box`çš„æ¦‚å¿µï¼Œæˆ‘ä»¬å¯ä»¥å¢åŠ `border`æ¥å®Œæˆå¢åŠ åŒºåŸŸçš„æ•ˆæœ\r\n\r\n```css\r\n.i-con {\r\n  /* çœç•¥å…¶å®ƒä»£ç  */\r\n  border: 5px solid transparent;\r\n}\r\n```\r\n\r\n> æ³¨æ„ï¼špc ä¸Šè¿˜éœ€è¦è€ƒè™‘å…‰æ ‡çš„ä¸€è‡´æ€§ï¼Œä»¥åŠ hover ç­‰ä¸€ç³»åˆ—æ•´ä½“çš„æ•ˆæœ\r\n\r\n### å›¾ç‰‡ç›¸å…³ä¼˜åŒ–\r\n\r\nå¯¹äºå¾ˆå¤šé¡¹ç›®è€Œè¨€ï¼Œå›¾ç‰‡æ˜¯å¸¸è§çš„ä¼˜åŒ–ç‚¹ï¼Œæ¯•ç«Ÿå¤šæ–¹é¢çš„ä¼˜åŒ–è¿œæ²¡æœ‰å‹ç¼©ä¸€å¼ å›¾ç‰‡æ¥çš„ç›´è§‚ï¼Œè€Œå¯¹äºç”¨æˆ·ä½“éªŒæ¥è¯´ä¹ŸåŒæ ·æ˜¯\r\n\r\n#### é¢„åŠ è½½\r\n\r\nä¸åŒäºæ‡’åŠ è½½ï¼Œé¢„åŠ è½½çš„ç›®çš„å°±æ˜¯æå‰è¾“å‡ºå›¾ç‰‡ï¼Œé¿å…ç”¨æˆ·ç­‰å¾…ã€‚\r\n\r\nä¸¾ä¸€ä¸ªå¸¸è§çš„ä¾‹å­ï¼šè½®æ’­å›¾å°±å¾ˆé€‚åˆä½¿ç”¨é¢„åŠ è½½ï¼Œå¦åˆ™ç”¨æˆ·çœ‹åˆ°ä¸‹ä¸€å¼ å›¾ç‰‡çš„æ—¶å€™è¿˜ç»§ç»­ç­‰å¾…åŠ è½½å°±ä¼šæ„Ÿè§‰å¾ˆçªå…€ã€‚\r\n\r\né¢„åŠ è½½çš„åŸç†å°±æ˜¯æå‰è¯·æ±‚ï¼Œä¹‹åé‡å¤è¯·æ±‚ç›¸åŒèµ„æºæ—¶ä¼šè¿”å›ç¼“å­˜æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å°è£…ä¸€ä¸ªæ–¹æ³•ï¼Œåˆ©ç”¨`Image`å¯¹ src èµ‹å€¼å³å¯\r\n\r\n```js\r\nconst preloading = (src) => {\r\n  return new Promise((resolve, reject) => {\r\n    const img = new Image();\r\n    img.src = src;\r\n    img.onload = resolve;\r\n    img.onerror = reject;\r\n  });\r\n};\r\n```\r\n\r\n#### é”™è¯¯å›¾ç‰‡\r\n\r\nå„ä¸ªæµè§ˆå™¨å¯¹é”™è¯¯å›¾ç‰‡çš„å¤„ç†æ–¹å¼å„ä¸ç›¸åŒï¼Œè™½ç„¶å­˜åœ¨`alt`æç¤ºä¿¡æ¯ï¼Œä½†æ˜¯ä¸å¤Ÿç»Ÿä¸€å’Œç¾è§‚\r\n\r\n![2.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/eb2385e0dcf34915b0ada7050405f3a5~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nä¾‹å¦‚ä¸Šé¢è¿™ç§é”™è¯¯ä¿¡æ¯çœ‹èµ·æ¥å°±ä¸å¤Ÿç¾è§‚ï¼Œæ›´å¥½çš„åšæ³•ç»™å‡ºé»˜è®¤çš„é”™è¯¯å›¾ç‰‡ï¼Œç›‘å¬å›¾ç‰‡çš„`onerror`äº‹ä»¶æ¥é‡æ–°èµ‹å€¼ï¼Œå¦‚æœä¸æƒ³ä¸€ä¸ªä¸ªå†™ï¼Œå¯ä»¥ç›‘å¬`window.addEventListener error`æ¥å®Œæˆå…¨å±€ç›‘å¬\r\n\r\n```js\r\nwindow.addEventListener(\r\n  'error',\r\n  function (event) {\r\n    var dom = event.target;\r\n    if (/img/i.test(dom.nodeName)) {\r\n      dom.src = 'xxxx.png';\r\n    }\r\n  },\r\n  true\r\n);\r\n```\r\n\r\n> å¦‚æœæƒ³å¢åŠ å¯¹é”™è¯¯å›¾ç‰‡è¿›è¡Œé‡è¯•ï¼Œæˆ–è€…å¯¹ JSP åŠ¨æ€æ¸²æŸ“å†…å®¹è¿›è¡Œæ‹¦æˆªï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« [å¦‚ä½•ä¼˜é›…å¤„ç†å›¾ç‰‡å¼‚å¸¸](https://juejin.cn/post/6844904046705246216#heading-2)\r\n\r\n### ç©ºæ•°æ®é»˜è®¤å¤„ç†\r\n\r\nå¯¹ç©ºæ•°æ®æ”¾ä»»ä¸ç®¡ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç”¨æˆ·è®¤ä¸ºç³»ç»Ÿå‡ºç°äº†é—®é¢˜ï¼Œé€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬è¦å°½é‡é¿å…ç©ºæ•°æ®çš„å‡ºç°ï¼Œä¸€èˆ¬è€Œè¨€æœ‰ä¸¤ç§å¤„ç†æ–¹å¼\r\n\r\n#### ä½¿ç”¨ emptyï¼ˆç©ºçŠ¶æ€ï¼‰è¿›è¡Œå¡«å……\r\n\r\n![3.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1a378691e6c94997ad9cbf2578f3d310~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nä¸€èˆ¬ UI æ¡†æ¶ç°åœ¨éƒ½å†…ç½® empty ç»„ä»¶ï¼Œå¯ä»¥è·Ÿäº§å“å’Œè®¾è®¡æ²Ÿé€šæ— è¯¯åï¼Œå¯¹äºå¸¸è§çš„ table æˆ–è€… list æ— æ•°æ®çš„è¿›è¡Œé»˜è®¤çš„æç¤º\r\n\r\n```vue\r\n<template>\r\n  <template v-if=\"list.length\"> /* ... */ </template>\r\n  <template v-else>\r\n    <empty />\r\n  </template>\r\n</template>\r\n```\r\n\r\n#### éšè—æ•´ä½“åŒºåŸŸ\r\n\r\n![1.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2945ac9ba5ed4a8d83341bf1815157fe~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nå¯¹äºä¸Šé¢çš„ä½œè€…å¸®å½“ï¼Œå¦‚æœå½“å‰å­é¡¹ä¸å­˜åœ¨æ•°æ®ï¼Œåªå±•ç¤ºä¸€ä¸ªæ ‡é¢˜å’Œå®Œæ•´æ¦œå•çš„ä¿¡æ¯å¯èƒ½ä¼šå¾ˆå¥‡æ€ªé‚£ä¸å¦¨è€ƒè™‘åˆ é™¤æ•´ä½“åŒºåŸŸ\r\n\r\n### ä¼˜å…ˆä½¿ç”¨è¯­ä¹‰åŒ–æ ‡ç­¾\r\n\r\nå°½é‡é¿å…æ— è¯­ä¹‰çš„`divã€span`æ»¥ç”¨ï¼Œå› ä¸ºæœç´¢å¼•æ“æŠ“å½•ä¸å‹å¥½ï¼Œç»´æŠ¤èµ·æ¥ä¸å¤Ÿç›´è§‚ï¼Œè€Œä¸”ä½¿ç”¨è¯­ä¹‰åŒ–æ ‡ç­¾å¯ä»¥èŠ‚çœå¾ˆå¤šä»£ç æ€§å·¥ä½œï¼Œä¸‹é¢ä¸¾ä¸€ä¸ªä¾‹å­\r\n\r\n![5.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/942b4d168d254463801b2938ee7c8cbe~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nä¾‹å¦‚ä¸Šé¢çš„æŒ‰é’®ï¼Œå‡è®¾å®ƒçš„åŠŸèƒ½æ˜¯è·³è½¬åˆ°ä¸€ä¸ªæ–°çš„é¡µé¢ï¼Œå¦‚æœåœ¨ spa é¡µé¢ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨`vue-router`è‡ªå¸¦çš„`router-link`è·³è½¬å³å¯å®Œæˆï¼Œè€Œåœ¨ä¼ ç»Ÿå¼€å‘ä¸­å¯ä»¥åœ¨`button`å¤–éƒ¨åµŒå¥—ä¸€ä¸ª`a`æ ‡ç­¾å®Œæˆè·³è½¬\r\n\r\n```html\r\n<a href=\"xxx\">\r\n  <button>xxx</button>\r\n</a>\r\n<!-- æˆ–è€… -->\r\n<router-link to=\"xxx\">\r\n  <button>xxx</button>\r\n</router-link>\r\n```\r\n\r\nè€Œä¸”è¿™æ ·åšå¾ˆå®¹æ˜“é…åˆæµè§ˆå™¨çš„ä¸€äº›å…¶å®ƒè¡Œä¸ºï¼Œæ¯”å¦‚å³å‡»æ‰“å¼€åœ¨æ–°æ ‡ç­¾é¡µ\r\n\r\n### æ“ä½œåé¦ˆ\r\n\r\næ“ä½œåé¦ˆæ˜¯æå‡ç”¨æˆ·ä½“éªŒçš„ä¸€ä¸ªé‡è¦æŒ‡æ ‡ï¼Œå…·ä½“å¯ä»¥å±•å¼€ä¸ºä¸‰éƒ¨åˆ†æ¥è¯´\r\n\r\n#### Require åé¦ˆ\r\n\r\nåœ¨ä¸åç«¯è¿›è¡Œé€šä¿¡çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæˆåŠŸæˆ–è€…å¤±è´¥ï¼Œéƒ½è¯·å‘ŠçŸ¥ç”¨æˆ·ï¼Œè€Œä¸”æç¤ºçš„æ¶ˆæ¯å¿…é¡»å‹å¥½ã€‚\r\n\r\nè¿™é‡Œæœ‰ä¸€ä¸ªå‡†åˆ™\r\n\r\n- æˆåŠŸæ¶ˆæ¯å¯ä»¥ç”±å‰ç«¯æ¥å®šä¹‰ï¼Œå¯ä»¥ç»“åˆå„ç§æ“ä½œåœºæ™¯åšåˆ°æ›´ç»†è‡´çš„æç¤º\r\n- å¯¹äºé”™è¯¯æ¶ˆæ¯ï¼Œåˆ™è¿”å›åç«¯è¿”å›çš„ message ç­‰ä¿¡æ¯\r\n- å¯¹äº 500 ç­‰é”™è¯¯ï¼Œè¯·åœ¨æ‹¦æˆªå™¨ç»Ÿä¸€æ”¹æˆ`ç½‘ç»œè¿æ¥é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•`ï¼Œè€Œä¸æ˜¯æç¤ºä¸€ä¸²è¶…æ—¶ç­‰è‹±æ–‡ä¿¡æ¯\r\n\r\n#### å…ƒç´ åé¦ˆ\r\n\r\nåœ¨è¡¡é‡ä¸€ä¸ª ui æ¡†æ¶çš„æ—¶å€™å°±æœ‰ä¸¤ç‚¹å¾ˆé‡è¦ï¼š\r\n\r\n1. ç»„ä»¶æœ¬èº«çš„äº¤äº’æ˜¯å¦å‹å¥½ï¼Œæ¯”å¦‚åŠ¨ç”»æ˜¯å¦æµç•…ï¼Œæœ‰æ²¡æœ‰ hoverã€active ç­‰æ•ˆæœ\r\n2. å¯¹äºæ— éšœç¢é˜…è¯»æ˜¯å¦å‹å¥½\r\n\r\nå¯è§äº¤äº’çš„é‡è¦æ€§ï¼Œè¦è®©ç”¨æˆ·æ„Ÿè§‰è‡ªå·±åœ¨ç‚¹å‡»ä¸€ä¸ªçœŸå®å­˜åœ¨çš„å…ƒç´ ï¼Œè€Œä¸æ˜¯åƒå›¾ç‰‡ä¸€æ ·çš„é™æ­¢\r\n\r\n![6.gif](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f7548ccd492147eb989ca42b2057e0d6~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nä¾‹å¦‚ä¸Šå›¾ä¸­ï¼Œæœ€å°‘è¦å­˜åœ¨`hover`ã€`active`ç­‰æ•ˆæœ\r\n\r\n#### ç­‰å¾…åé¦ˆ\r\n\r\n![7.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6af4503f4f9c425583118b98b1f3b57e~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nå› ä¸ºä¸åç«¯çš„é€šä¿¡æ˜¯å¼‚æ­¥çš„ï¼Œè€Œä¸”ç”¨æˆ·çš„ç½‘ç»œå¥½åä¹Ÿä¸æ˜¯å›ºå®šä¸å˜çš„ï¼Œæ‰€ä»¥ç»™å…ƒç´ æ·»åŠ `loading`å°±å¾ˆæœ‰å¿…è¦ï¼Œè¿™é‡Œè¯´ä¸¤ä¸ªå¸¸è§çš„åœºæ™¯\r\n\r\n#### è¡¨å•æäº¤\r\n\r\n![7.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6af4503f4f9c425583118b98b1f3b57e~tplv-k3u1fbpfcp-watermark.image)\r\n\r\néœ€è¦æ“ä½œäº¤äº’çš„å¸¸è§éƒ½å¯ä»¥è€ƒè™‘ä½¿ç”¨`loading`ï¼Œè¿™æ ·å¯ä»¥é˜²æ­¢ç”¨æˆ·é‡å¤ç‚¹å‡»å’Œé¿å…ç”¨æˆ·ä¸çŸ¥é“æœ‰æ²¡æœ‰ç‚¹å‡»æˆåŠŸ\r\n\r\n#### é‡æ–°è·å–æ•°æ®\r\n\r\n![8.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/17d967b2947344f5815e114084df2ad8~tplv-k3u1fbpfcp-watermark.image)\r\n\r\n#### è·å–å‰ç½®ä¿¡æ¯\r\n\r\nåœ¨ pc ä¸Šï¼Œæ•´ä½“è¿›å…¥é¡µé¢çš„æ—¶å€™ä¸ºäº†æ©ç›–è·å–ä¸€äº›å‰ç½®çš„ä¿¡æ¯çš„åœºæ™¯ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨ loading å…ƒç´ å‡å°‘ç”¨æˆ·ç­‰å¾…çš„ç„¦è™‘æ„Ÿ\r\n\r\n### ç¼“å­˜\r\n\r\nç¼“å­˜æœ¬è´¨ä¸Šå°±æ˜¯æ‹¿ç©ºé—´æ¢æ—¶é—´ï¼Œå¯¹äºå®¢æˆ·ç«¯è€Œè¨€ï¼Œæ›´å¤šçš„ç“¶é¢ˆæ˜¯åœ¨æ—¶é—´ä¸Šï¼Œä¸‹é¢å°±è¯´ä¸¤ç§å¸¸è§çš„ç¼“å­˜åœºæ™¯\r\n\r\n#### ç»„ä»¶ä¿¡æ¯ç¼“å­˜\r\n\r\n![9.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2dbabc0b5fb8449297b174ca267ef2f2~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nä¾‹å¦‚ä¸Šé¢è¡¨å•ï¼Œå¦‚æœç”¨æˆ·è¯¯æ“ä½œå…³é—­ç½‘é¡µï¼Œä»å¤´å¼€å§‹å¡«å†™ä½“éªŒå°±ä¸æ˜¯ç‰¹åˆ«å¥½ï¼Œå¯ä»¥åœ¨æœªæäº¤æˆåŠŸçš„çŠ¶æ€ä¸‹ç»“åˆæœ¬åœ°åšæŒä¹…åŒ–ç¼“å­˜\r\n\r\nä¸‹é¢ç»™ä¸€ä¸ªç®€å•ç¤ºä¾‹ï¼ˆæ²¡æœ‰ç»™å‡ºå®Œæˆæ¸…é™¤æœ¬åœ°å‚¨å­˜ï¼‰\r\n\r\n```vue\r\n<script>\r\nimport { reactive, watchEffect } from 'vue';\r\n\r\nexport default {\r\n  setUp() {\r\n    const key = 'form';\r\n    const form = reactive({\r\n      name: '',\r\n      password: '',\r\n    });\r\n    const set = (key, value) => {\r\n      localStorage.setItem(key, JSON.stringify(value));\r\n    };\r\n    const get = () => {\r\n      const value = localStorage.getItem(key);\r\n      try {\r\n        return JSON.parse(value);\r\n      } catch {\r\n        return undefined;\r\n      }\r\n    };\r\n    watchEffect(() => {\r\n      set(key, form);\r\n    });\r\n    Object.assign(form, get('form'));\r\n  },\r\n};\r\n</script>\r\n```\r\n\r\n#### æ¥å£ç¼“å­˜\r\n\r\nå¦‚æœå­˜åœ¨é¢‘ç¹è¯·æ±‚ä¸”å¾ˆè€—æ—¶ï¼Œæ¥å£æœ¬èº«åŸºæœ¬ä¸ä¼šå˜æ›´çš„æƒ…å†µï¼Œå¯ä»¥è€ƒè™‘æ¥å£ç¼“å­˜ï¼Œä¸‹é¢ç»™å‡ºä¸€æ®µç®€å•çš„ä»£ç ç¤ºä¾‹\r\n\r\nç”Ÿäº§ç¯å¢ƒå¯ä»¥è€ƒè™‘ä½¿ç”¨ä¸€äº›åº“ [axios-request-cache](https://github.com/ZhengXiaowei/axios-request-cache)\r\n\r\n```js\r\nimport axios from 'axios';\r\nconst { toString } = Object.prototype;\r\n\r\n// æ•°æ®å­˜å‚¨\r\nexport const cache = {\r\n  data: {},\r\n  set(key, data) {\r\n    this.data[key] = data;\r\n  },\r\n  get(key) {\r\n    return this.data[key];\r\n  },\r\n  clear(key) {\r\n    delete this.data[key];\r\n  },\r\n};\r\n\r\n// å»ºç«‹å”¯ä¸€çš„keyå€¼\r\nexport const buildUniqueUrl = (url, method, params = {}, data = {}) => {\r\n  const paramStr = (obj) => {\r\n    if (toString.call(obj) === '[object Object]') {\r\n      return JSON.stringify(\r\n        Object.keys(obj)\r\n          .sort()\r\n          .reduce((result, key) => {\r\n            result[key] = obj[key];\r\n            return result;\r\n          }, {})\r\n      );\r\n    } else {\r\n      return JSON.stringify(obj);\r\n    }\r\n  };\r\n  url += `?${paramStr(params)}&${paramStr(data)}&${method}`;\r\n  return url;\r\n};\r\n\r\n// é˜²æ­¢é‡å¤è¯·æ±‚\r\nexport default (options = {}) =>\r\n  async (config) => {\r\n    const defaultOptions = {\r\n      // è®¾ç½®ä¸º0ï¼Œä¸æ¸…é™¤ç¼“å­˜\r\n      time: 0,\r\n      ...options,\r\n    };\r\n    const index = buildUniqueUrl(config.url, config.method, config.params, config.data);\r\n    let responsePromise = cache.get(index);\r\n    if (!responsePromise) {\r\n      responsePromise = (async () => {\r\n        try {\r\n          const response = await axios.defaults.adapter(config);\r\n          return Promise.resolve(response);\r\n        } catch (reason) {\r\n          cache.clear(index);\r\n          return Promise.reject(reason);\r\n        }\r\n      })();\r\n      cache.set(index, responsePromise);\r\n      if (defaultOptions.time !== 0) {\r\n        setTimeout(() => {\r\n          cache.clear(index);\r\n        }, defaultOptions.time);\r\n      }\r\n    }\r\n    // ä¸ºé˜²æ­¢æ•°æ®æºæ±¡æŸ“\r\n    return responsePromise.then((data) => JSON.parse(JSON.stringify(data)));\r\n  };\r\n```\r\n\r\n### é£æ ¼ä¸€è‡´æ€§\r\n\r\né£æ ¼ä¸€è‡´æ€§åŒ…å«å¾ˆå¤šéƒ¨åˆ†ï¼Œè¿™é‡Œä¸å¤ªå¥½å…¨éƒ¨åˆ—ä¸¾ï¼Œå°±è¯´ä¸¤ä¸ªå¸¸è§çš„\r\n\r\n#### è§†è§‰é¢œè‰²ä¸€è‡´\r\n\r\næ¯ä¸ªé¡µé¢éƒ½æœ‰ä¸€ä¸ªä¸»è‰²å·ï¼Œå¯¹äºè®¾è®¡å›¾æˆ–è€…åŸå‹å›¾æ²¡æœ‰ç»™åˆ°çš„éƒ¨åˆ†ï¼Œè‡ªå·±åŠ¨æ‰‹æˆ–è€…å¼•ç”¨ç»„ä»¶æ—¶éœ€è¦è€ƒè™‘æ˜¯å¦è·Ÿä¸»è‰²å·å­˜åœ¨å†²çªï¼Œè¿™é‡Œæ¨èé˜…è¯»ä¸€ä¸‹`è§†è§‰è§„èŒƒ`ï¼Œä¸‹é¢ç»™å‡ºä¸€ä¸ªç¤ºä¾‹\r\n\r\n![2.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2efab79f3bf4429c852e5f7e4182a8ae~tplv-k3u1fbpfcp-watermark.image)\r\n\r\n![3.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4f0aabbe895d42f0b18b0bdd5b9a7698~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nåœ¨é»˜è®¤çš„ vant ç»„ä»¶ä¸­ï¼Œtab é»˜è®¤çš„é¢œè‰²æ˜¯`#ee0a24`ï¼Œå¦‚æœç›´æ¥æ”¾ä¸Šå»å°±ä¼šå¯¼è‡´é¡µé¢é£æ ¼ä¸ç»Ÿä¸€ï¼Œå› ä¸ºé¡µé¢æ•´ä½“é£æ ¼æ˜¯è“è‰²\r\n\r\n#### ç»„ä»¶äº¤äº’ä¸€è‡´æ€§\r\n\r\nè¿™é‡Œåœ¨è‡ªå®šä¹‰æ‰©å±•æˆ–è€…äºŒæ¬¡å°è£…æ¯”è¾ƒå¸¸è§ï¼Œè¿˜æ˜¯ä»¥è¡¨å•ä¸ºä¾‹\r\n\r\n![9.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/56f9f210d65e4ae9b23516548a1056e1~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nå¦‚æœæˆ‘ä»¬æƒ³è‡ªå®šä¹‰æ ¹æ®ä¸šåŠ¡è¿›è¡Œä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„ç»„ä»¶ï¼Œé™¤äº†è€ƒè™‘åŠŸèƒ½æœ¬èº«çš„å®ç°ï¼Œè¿˜è¦è€ƒè™‘ä¸€è‡´æ€§çš„é—®é¢˜ï¼Œä¾‹å¦‚æ ¡éªŒçš„é—®é¢˜\r\n\r\nè¿™é‡Œ`Ant Design `åœ¨ä¸ç¬¦åˆæ¡ä»¶çš„`form-item`ä¸‹é¢å‡ºç°ä¸€ä¸ªçº¢å­—æç¤ºï¼Œè€Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨`message`æˆ–è€…å…¶ä»–æç¤ºå°±ä¼šé€ æˆæç¤ºä¿¡æ¯çš„ä¸ä¸€è‡´æ€§ï¼Œé‚£æ›´å¥½çš„åšæ³•å°±æ˜¯æ ¹æ®å®˜æ–¹æ–‡æ¡£æä¾›çš„è‡ªå®šä¹‰æ’ä»¶åšæ³•è¿›è¡Œç»„ä»¶å¼€å‘ã€‚\r\n\r\n## pc\r\n\r\n### è€ƒè™‘æœ€å°å¸ƒå±€\r\n\r\nè¯·è®¾ç½®`min-width`ï¼Œé˜²æ­¢å› ä¸ºå®½åº¦ä¸å¤Ÿå¯¼è‡´å…ƒç´ æŒ¤åœ¨ä¸€èµ·\r\n\r\n```css\r\nbody {\r\n  /* çœç•¥å…¶å®ƒ */\r\n  min-width: 1200px;\r\n  overflow: auto;\r\n}\r\n```\r\n\r\n### è¡¨æ ¼å®½åº¦\r\n\r\nå¯¹äºè¡¨æ ¼ï¼Œæ ¹æ®å­—æ®µçš„æƒå€¼ä¸åŒåˆ†é…çš„å®½åº¦ä¹Ÿåº”è¯¥ä¸åŒï¼Œå°½é‡ä¸è¦ä½¿ç”¨`auto`é¿å…äºŒæ¬¡è¡¨æ ¼å®½åº¦è®¡ç®—é€ æˆè§†è§‰ä¸Šçš„æµ®åŠ¨\r\n\r\n![13.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d295a4f0c4544388b1190c62b862bd3c~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nå¯¹äºä¸å¯çœç•¥çš„ä¿¡æ¯å¯ä»¥è®©å…¶æ¢è¡Œå±•ç¤ºï¼Œå¦åˆ™è¯·è€ƒè™‘`ellipsis`\r\n\r\n```css\r\n.ellipsis {\r\n  overflow: hidden;\r\n  white-space: nowrap;\r\n  text-overflow: ellipsis;\r\n}\r\n```\r\n\r\n### æŒ‡æ ‡å¡ç‰‡æ·»åŠ  tip\r\n\r\nåœ¨ä¸€äº›ä¸­å°äº§å“ä¸­ï¼Œå¾ˆå®¹æ˜“é‡åˆ°ä¸€äº›ä¸“ä¸šåè¯ï¼Œæ¯”å¦‚`pv`å’Œ`uv`ç­‰ï¼Œå¯¹äºè¿™ç§ä¸“ä¸šåè¯ï¼Œå»ºè®®æ·»åŠ ä¸€ä¸ªé—®å·çš„æç¤ºå›¾æ ‡ï¼Œé¼ æ ‡ç§»åŠ¨ä¸Šå»ç»™ä¸æç¤º\r\n\r\n![14.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fc35ab89bc294f45b7c0c070d527ec9e~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nä¸Šé¢æ•ˆæœä»…ä¾›å‚è€ƒ\r\n\r\n### æ”¯æŒé”®ç›˜å¿«æ·é”®\r\n\r\n![9.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6a0349131f50469e85f9efbeb0934b2f~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåœ¨æˆ‘ä»¬ä½¿ç”¨`form`æˆ–è€…`input`æ—¶ï¼Œå¦‚æœæŒ‰ä¸‹`enter`æ—¶è¯·ç¡®ä¿å¯ä»¥è¿›è¡Œæ­£å¸¸çš„æœç´¢æˆ–è€…æäº¤æ“ä½œï¼Œä¸ä»…å±€é™äºè¡¨å•æäº¤ï¼Œå¯¹äºä¸€äº›å¸¸è§çš„æœç´¢åœºæ™¯éƒ½éœ€è¦è€ƒè™‘\r\n\r\nä¸€ä¸ªå¥½çš„å»ºè®®ï¼Œå¯¹äºéœ€è¦ submit çš„å­å…ƒç´ ï¼Œéƒ½ç»‘å®š`.enter`ä¿®é¥°ç¬¦\r\n\r\n```vue\r\n<input @keyup.enter=\"submit\" />\r\n```\r\n\r\n### SPA è·¯ç”±å¯¼èˆª\r\n\r\nå¯¹äºå•é¡µé¢å¯¼èˆªè¯·è€ƒè™‘ä½¿ç”¨[nprogress](https://github.com/rstacruz/nprogress)è¿™æ ·çš„è¿›åº¦æ¡ï¼Œä¸ºä½ çš„é¡µé¢æ·»åŠ è¿›åº¦é€šçŸ¥\r\n\r\n![15.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7b2a1bf70cab4c279339f2e11ef5e5e0~tplv-k3u1fbpfcp-watermark.image)\r\n\r\n## ç§»åŠ¨ç«¯\r\n\r\n### å·¦å³æ»‘åŠ¨ç›‘å¬\r\n\r\næµè§ˆäº†è®¸å¤š H5 çš„é¡µé¢ï¼Œå¯¹äºæ‰‹åŠ¿å·¦å³æ»‘åŠ¨åŸºæœ¬ä¸Šéƒ½æ²¡åšæ”¯æŒï¼Œè€Œåœ¨å¾ˆå¤š App ä¸Šï¼Œä¾‹å¦‚çŸ¥ä¹ï¼Œä»é¦–é¡µè¿›å»é—®é¢˜å·¦æ»‘å°±å¯ä»¥è¿”å›\r\n\r\n![å¾®ä¿¡å›¾ç‰‡_20210608100923.jpg](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5e1ef02488054521999304fe663d9867~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nè¿™é‡Œç¨å¾®å»ºè®®ä¸€ä¸‹ï¼Œå¯¹äºä¸‹é¢ä¸¤ç§æƒ…å†µå¯ä»¥è€ƒè™‘å¼•å…¥å·¦æ»‘è¿”å›\r\n\r\n- è·Ÿä¸Šé¢å›¾ç‰‡ä¸€è‡´çš„ tab é¡µæ¯”è¾ƒå¤šï¼Œå¯ä»¥è€ƒè™‘åšæˆ tab ä¸‹çš„å…ƒç´ æ»‘åŠ¨ç›‘å¬\r\n- å¯¹äºä¸€äº›åˆ—è¡¨å’Œè¯¦æƒ…é¡µ\r\n\r\næ¨èä¸€ä¸ªåº“æºç ä¹Ÿå¾ˆç®€æ´å¯ä»¥åŸºäºè¿™ä¸ªåº“è¿›è¡ŒäºŒæ¬¡å°è£…ï¼Œæé«˜ç”¨æˆ·çš„ä½“éªŒ [swipy](https://github.com/whitecube/swipy)\r\n\r\n### å°½é‡ä½¿ç”¨ SVG\r\n\r\nSVG æ˜¯ä¸€ç§å›¾åƒæ–‡ä»¶æ ¼å¼ï¼Œå®ƒçš„è‹±æ–‡å…¨ç§°ä¸º Scalable Vector Graphicsï¼Œæ„æ€ä¸ºå¯ç¼©æ”¾çš„çŸ¢é‡å›¾å½¢ã€‚åŸºäº XML çš„æ ‡è®°è¯­è¨€\r\n\r\nSVG æ˜¯çŸ¢é‡å›¾ï¼Œå®ƒæœ‰å¾ˆå¤šä¼˜ç‚¹\r\n\r\n- SVG æ˜¯å¯ä¼¸ç¼©çš„ï¼Œåœ¨ä»»ä½•çš„åˆ†è¾¨ç‡ä¸‹è¢«é«˜è´¨é‡åœ°æ‰“å°\r\n- SVG å¯åœ¨å›¾åƒè´¨é‡ä¸ä¸‹é™çš„æƒ…å†µä¸‹è¢«æ”¾å¤§\r\n- ä¿®æ”¹æ–¹ä¾¿ï¼Œå¯ä»¥åœ¨è®°äº‹æœ¬ä¹‹ç±»çš„è½¯ä»¶ä¸­è¢«æ‰“å¼€\r\n\r\nè€Œåœ¨å¼€å‘ç§»åŠ¨ç«¯ï¼Œé¢å¯¹çš„ç”¨æˆ·æ‰‹æœºçš„å±å¹•ä¹Ÿå„ä¸ç›¸åŒï¼Œä¹‹å‰çš„åšæ³•æ˜¯å¯¹ä¸åŒ ratio çš„æ‰‹æœºé€‰æ‹©ä¸åŒçš„å›¾ç‰‡ï¼Œä½†æ˜¯æ ¹æ®ä¸Šé¢ SVG çš„ä¼˜ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€‰ç”¨ SVG å½“åšå›¾ç‰‡\r\n\r\nè€Œåœ¨ SVG ä¸é€‚ç”¨çš„åœºæ™¯ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨åª’ä½“æŸ¥è¯¢ï¼Œé€‰æ‹©åˆé€‚çš„é«˜å€å›¾\r\n\r\n```js\r\nexport const getMultipleImg = (img1, img2) => {\r\n  const mql = window.matchMedia('@media only screen and (-webkit-min-device-pixel-ratio:3)');\r\n  if (mql.matches) {\r\n    return img2;\r\n  }\r\n  return img1;\r\n};\r\n```\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/72/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/72/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/73",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/73/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/73/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/73/events",
      "html_url": "https://github.com/bosens-China/blog/issues/73",
      "id": 914211223,
      "node_id": "MDU6SXNzdWU5MTQyMTEyMjM=",
      "number": 73,
      "title": "å›¢é˜Ÿè§„èŒƒç³»åˆ—ä¹‹å‘½åè§„èŒƒ",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 3661376441,
          "node_id": "LA_kwDOCzPAy87aPCu5",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83",
          "name": "ä»£ç è§„èŒƒ",
          "color": "5319e7",
          "default": false,
          "description": "å›¢é˜Ÿè§„èŒƒã€ä»£ç è§„èŒƒã€æŠ€æœ¯é€‰å‹ç­‰ç›¸å…³å†…å®¹"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2021-06-08T02:53:40Z",
      "updated_at": "2021-12-21T10:00:13Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "![bg](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4b7b48b9a67c44eab564bf46e99f1ee0~tplv-k3u1fbpfcp-zoom-1.image)\r\n\r\næœ€è¿‘ä¸€å‘¨çš„å·¥ä½œé‡å¿ƒå°±æ˜¯åœ¨æ¢³ç†å›¢é˜Ÿè§„èŒƒï¼Œåœ¨å†™çš„è¿‡ç¨‹ä¹ŸæŸ¥ç¼ºè¡¥æ¼äº†ä¸å°‘çŸ¥è¯†ï¼Œå‰”é™¤æ‰å…³äºå…¬å¸åœºæ™¯çš„éƒ¨åˆ†å°±æœ‰äº†è¿™ä¸€ç³»åˆ—çš„æ–‡ç« ï¼Œé¢„è®¡å†™å››éƒ¨åˆ†ï¼š\r\n\r\n1. [git è§„èŒƒ](https://github.com/bosens-China/blog/issues/70)\r\n2. [å·¥ç¨‹è§„èŒƒ](https://github.com/bosens-China/blog/issues/71)\r\n3. [ç”¨æˆ·ä½“éªŒè§„èŒƒ](https://github.com/bosens-China/blog/issues/72)\r\n4. å‘½åè§„èŒƒ\r\n\r\n# å‘½åè§„èŒƒ\r\n\r\nå‘½åè§„èŒƒè¯·ç»“åˆå›¢é˜Ÿæƒ…å†µæ¥è¿›è¡Œåˆ¶å®šï¼Œå¦‚æœæƒ³æ›´è¿›é˜¶ä¸€äº›å¯ä»¥é…åˆ git é’©å­å†™æ ¡éªŒå·¥å…·ï¼Œé…åˆè§„èŒƒé£Ÿç”¨\r\n\r\n## ä»£ç å‘½åè§„èŒƒ\r\n\r\n### é¿å…ç”¨ä¸€ä¸ªå­—æ¯å‘½å\r\n\r\n```js\r\n// bad\r\nfunction q() {\r\n  // ...\r\n}\r\n\r\n// good\r\nfunction query() {\r\n  // ...\r\n}\r\n```\r\n\r\n### ç”¨å°é©¼å³°å‘½åæ³•æ¥å‘½åä½ çš„å¯¹è±¡ã€å‡½æ•°ã€å®ä¾‹\r\n\r\n```js\r\n// bad\r\nconst OBJEcttsssss = {};\r\nconst this_is_my_object = {};\r\nfunction c() {}\r\n\r\n// good\r\nconst thisIsMyObject = {};\r\nfunction thisIsMyFunction() {}\r\n```\r\n\r\n### ç”¨å¤§é©¼å³°å‘½åæ³•æ¥å‘½åç±»\r\n\r\n```js\r\n// bad\r\nfunction user(options) {\r\n  this.name = options.name;\r\n}\r\n\r\nconst bad = new user({\r\n  name: 'nope',\r\n});\r\n\r\n// good\r\nclass User {\r\n  constructor(options) {\r\n    this.name = options.name;\r\n  }\r\n}\r\n\r\nconst good = new User({\r\n  name: 'yup',\r\n});\r\n```\r\n\r\n### ä¸è¦ç”¨å‰ç½®æˆ–åç½®ä¸‹åˆ’çº¿\r\n\r\nJavaScript æ²¡æœ‰ç§æœ‰å±æ€§æˆ–ç§æœ‰æ–¹æ³•çš„æ¦‚å¿µã€‚å°½ç®¡å‰ç½®ä¸‹åˆ’çº¿é€šå¸¸çš„æ¦‚å¿µä¸Šæ„å‘³ç€ç§æœ‰ï¼Œäº‹å®ä¸Šï¼Œè¿™äº›å±æ€§æ˜¯å®Œå…¨å…¬æœ‰çš„ï¼Œå› æ­¤è¿™éƒ¨åˆ†ä¹Ÿæ˜¯ä½ çš„ API çš„å†…å®¹ã€‚è¿™ä¸€æ¦‚å¿µå¯èƒ½ä¼šå¯¼è‡´å¼€å‘è€…è¯¯ä»¥ä¸ºæ›´æ”¹è¿™ä¸ªä¸ä¼šå¯¼è‡´å´©æºƒæˆ–è€…ä¸éœ€è¦æµ‹è¯•ã€‚å¦‚æœä½ æƒ³è¦ä»€ä¹ˆä¸œè¥¿å˜æˆç§æœ‰ï¼Œé‚£å°±ä¸è¦è®©å®ƒåœ¨è¿™é‡Œå‡ºç°ã€‚\r\n\r\n```js\r\n// bad\r\nthis.__firstName__ = 'Panda';\r\nthis.firstName_ = 'Panda';\r\nthis._firstName = 'Panda';\r\n\r\n// good\r\nthis.firstName = 'Panda';\r\n```\r\n\r\n### export\r\n\r\n#### export-default å¯¼å‡ºåç§°ä¸ import å¼•ç”¨åç§°ä¿æŒä¸€è‡´\r\n\r\nä¾‹å¦‚ï¼š`export-default æ¨¡å— A`ï¼Œåˆ™è¿™ä¸ªæ–‡ä»¶åä¹Ÿå« `A`ï¼Œ import æ—¶å€™çš„å‚æ•°ä¹Ÿå« `A`ã€‚ å¤§å°å†™å®Œå…¨ä¸€è‡´ã€‚\r\n\r\n```js\r\n// file 1 contents\r\nclass CheckBox {\r\n  // ...\r\n}\r\nexport default CheckBox;\r\n\r\n// file 2 contents\r\nexport default function fortyTwo() { return 42; }\r\n\r\n// file 3 contents\r\nexport default function insideDirectory() {}\r\n\r\n// in some other file\r\n// bad\r\nimport CheckBox from './checkBox'; // PascalCase import/export, camelCase filename\r\nimport FortyTwo from './FortyTwo'; // PascalCase import/filename, camelCase export\r\nimport InsideDirectory from './InsideDirectory'; // PascalCase import/filename, camelCase export\r\n\r\n// bad\r\nimport CheckBox from './check_box'; // PascalCase import/export, snake_case filename\r\nimport forty_two from './forty_two'; // snake_case import/filename, camelCase export\r\nimport inside_directory from './inside_directory'; // snake_case import, camelCase export\r\nimport index from './inside_directory/index'; // requiring the index file explicitly\r\nimport insideDirectory from './insideDirectory/index'; // requiring the index file explicitly\r\n\r\n// good\r\nimport CheckBox from './CheckBox'; // PascalCase export/import/filename\r\nimport fortyTwo from './fortyTwo'; // camelCase export/import/filename\r\nimport insideDirectory from './insideDirectory'; // camelCase export/import/directory name/implicit \"index\"\r\n// ^ supports both insideDirectory.js and insideDirectory/index.js\r\n```\r\n\r\n#### export-default ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œå‡½æ•°åç”¨å°é©¼å³°ï¼Œæ–‡ä»¶åéœ€è¦å’Œå‡½æ•°åä¸€è‡´\r\n\r\n```js\r\nfunction makeStyleGuide() {\r\n  // ...\r\n}\r\n\r\nexport default makeStyleGuide;\r\n```\r\n\r\n#### export ä¸€ä¸ªç»“æ„ä½“/ç±»/å•ä¾‹/å‡½æ•°åº“/å¯¹è±¡ æ—¶ç”¨å¤§é©¼å³°\r\n\r\n```js\r\nconst AirbnbStyleGuide = {\r\n  es6: {},\r\n};\r\n\r\nexport default AirbnbStyleGuide;\r\n```\r\n\r\n### ç®€ç§°å’Œç¼©å†™åº”è¯¥å…¨éƒ¨å¤§å†™æˆ–å…¨éƒ¨å°å†™\r\n\r\n```js\r\n// bad\r\nimport SmsContainer from './containers/SmsContainer';\r\n\r\n// bad\r\nconst HttpRequests = [\r\n  // ...\r\n];\r\n\r\n// good\r\nimport SMSContainer from './containers/SMSContainer';\r\n\r\n// good\r\nconst HTTPRequests = [\r\n  // ...\r\n];\r\n\r\n// also good\r\nconst httpRequests = [\r\n  // ...\r\n];\r\n\r\n// best\r\nimport TextMessageContainer from './containers/TextMessageContainer';\r\n\r\n// best\r\nconst requests = [\r\n  // ...\r\n];\r\n```\r\n\r\n### å¯¼å‡ºé™æ€å˜é‡\r\n\r\nå¦‚æœå¯¼å‡ºé™æ€å˜é‡ï¼Œå®ƒéœ€è¦ä»¥ä¸‹æ¡ä»¶ï¼š\r\n\r\n- ç¡®ä¿è¢«å¯¼å‡º\r\n- å°½é‡å…¨éƒ¨å¤§å†™\r\n- const å®šä¹‰çš„ï¼Œä¿è¯ä¸èƒ½è¢«æ”¹å˜\r\n- å¦‚æœå¯¼å‡ºå¯¹è±¡ï¼Œè¿™ä¸ªå˜é‡æ˜¯å¯ä¿¡çš„ï¼Œä»–çš„å­å±æ€§éƒ½æ˜¯ä¸èƒ½è¢«æ”¹å˜çš„\r\n\r\n```js\r\n// bad\r\nconst PRIVATE_VARIABLE = 'should not be unnecessarily uppercased within a file';\r\n// bad\r\nexport const THING_TO_BE_CHANGED = 'should obviously not be uppercased';\r\n// bad\r\nexport let REASSIGNABLE_VARIABLE = 'do not use let with uppercase variables';\r\n// å…è®¸ä½†ä¸å¤Ÿè¯­ä¹‰åŒ–\r\nexport const apiKey = 'SOMEKEY';\r\n// æ›´å¥½çš„\r\nexport const API_KEY = 'SOMEKEY';\r\n\r\n// bad ä¸å¿…è¦çš„å¤§å†™é”®ï¼Œæ²¡æœ‰å¢åŠ ä»»ä½•è¯­ä¹‰\r\nexport const MAPPING = {\r\n  KEY: 'value',\r\n};\r\n// good\r\nexport const MAPPING = {\r\n  key: 'value',\r\n};\r\n```\r\n\r\n## CSS å‘½åè§„èŒƒ\r\n\r\ncss å‘½åè§„èŒƒæœ‰å¾ˆå¤šæ–¹æ¡ˆï¼Œè¿™é‡Œé‡‡ç”¨`BEM`ä½œä¸ºè§„èŒƒï¼Œä¹‹æ‰€ä»¥é‡‡ç”¨ `BEM` æ˜¯å› ä¸ºå®ƒè®©ä½ çš„å‰ç«¯ä»£ç æ›´å®¹æ˜“é˜…è¯»å’Œç†è§£ï¼Œæ›´å®¹æ˜“åä½œï¼Œæ›´å®¹æ˜“æ§åˆ¶ï¼Œæ›´åŠ å¥å£®å’Œæ˜ç¡®ï¼Œè€Œä¸”æ›´åŠ ä¸¥å¯†ã€‚\r\n\r\nä¸‹é¢ä»‹ç»ä¸€äº›ç›¸å…³çš„æ¦‚å¿µï¼Œä»¥åŠå¦‚ä½•ä¹¦å†™\r\n\r\n### ä»€ä¹ˆæ˜¯ BEM å‘½åè§„èŒƒ\r\n\r\nBem æ˜¯å—ï¼ˆblockï¼‰ã€å…ƒç´ ï¼ˆelementï¼‰ã€ä¿®é¥°ç¬¦ï¼ˆmodifierï¼‰çš„ç®€å†™ï¼Œç”± Yandex å›¢é˜Ÿæå‡ºçš„ä¸€ç§å‰ç«¯ CSS å‘½åæ–¹æ³•è®ºã€‚\r\n\r\n- ä¸­åˆ’çº¿ ï¼šä»…ä½œä¸ºè¿å­—ç¬¦ä½¿ç”¨ï¼Œè¡¨ç¤ºæŸä¸ªå—æˆ–è€…æŸä¸ªå­å…ƒç´ çš„å¤šå•è¯ä¹‹é—´çš„è¿æ¥è®°å·ã€‚\r\n\r\n- åŒä¸‹åˆ’çº¿ï¼šåŒä¸‹åˆ’çº¿ç”¨æ¥è¿æ¥å—å’Œå—çš„å­å…ƒç´ \r\n\r\n- å•ä¸‹åˆ’çº¿ï¼šå•ä¸‹åˆ’çº¿ç”¨æ¥æè¿°ä¸€ä¸ªå—æˆ–è€…å—çš„å­å…ƒç´ çš„ä¸€ç§çŠ¶æ€\r\n\r\n### BEM å‘½åæ¨¡å¼\r\n\r\næ ¹æ®ä¸Šé¢æ¡ä»¶ï¼Œä¸‹é¢å†™ä¸€ä¸ªç¤ºä¾‹\r\n\r\n```css\r\n.block {\r\n}\r\n\r\n.block__element {\r\n}\r\n\r\n.block--modifier {\r\n}\r\n```\r\n\r\nä»”ç»†è§‚å¯Ÿä¸Šé¢ç»“æ„å¯ä»¥å¾—åˆ°ä¸‰ä¸ªä¿¡æ¯ï¼š\r\n\r\n- æ¯ä¸€ä¸ªå—(block)ååº”è¯¥æœ‰ä¸€ä¸ªå‘½åç©ºé—´ï¼ˆå‰ç¼€ï¼‰\r\n- `block__element` ä»£è¡¨ `.block` çš„åä»£ï¼Œç”¨äºå½¢æˆä¸€ä¸ªå®Œæ•´çš„ `.block` çš„æ•´ä½“\r\n- `block--modifier` ä»£è¡¨ `.block` çš„ä¸åŒçŠ¶æ€æˆ–ä¸åŒç‰ˆæœ¬\r\n\r\nä½¿ç”¨ä¸¤ä¸ªè¿å­—ç¬¦å’Œä¸‹åˆ’çº¿è€Œä¸æ˜¯ä¸€ä¸ªï¼Œæ˜¯ä¸ºäº†è®©ä½ è‡ªå·±çš„å—å¯ä»¥ç”¨å•ä¸ªè¿å­—ç¬¦æ¥ç•Œå®šã€‚å¦‚ï¼š\r\n\r\n```css\r\n.sub-block__element {\r\n}\r\n\r\n.sub-block--modifier {\r\n}\r\n```\r\n\r\n### ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ BEM å‘½å\r\n\r\n- ä½ è¦çŸ¥é“ä»€ä¹ˆæ—¶å€™å“ªäº›ä¸œè¥¿æ˜¯åº”è¯¥å†™æˆ BEM æ ¼å¼çš„\r\n\r\næˆ–è€…è¯´ä½ è¦äº‹å…ˆçŸ¥é“æ•ˆæœå›¾æˆ–è€… dom ç»“æ„åº”å½“æ˜¯ä¸€ä¸ªä»€ä¹ˆæ ·å­çš„\r\n\r\n- åªæœ‰æ¨¡å—æˆ–è€…ç»„ä»¶æœ‰å…³è”çš„æ—¶å€™æ‰ä½¿ç”¨ BEM æ ¼å¼\r\n\r\n- å•ç‹¬çš„æ ·å¼ï¼Œæ²¡æœ‰å¿…è¦ä½¿ç”¨ BEM å‘½å\r\n\r\n```css\r\n.hide {\r\n  display: none !important;\r\n}\r\n```\r\n\r\n### ä¸é¢„å¤„ç†å™¨ç»“åˆ\r\n\r\nBEM å†™èµ·æ¥å¯èƒ½ä¼šå­˜åœ¨å‘½åå¾ˆé•¿ï¼Œä½†æ˜¯å¦‚æœæœ‰ less ä¹‹ç±»çš„é¢„å¤„ç†å™¨å°±èƒ½èŠ‚çœæˆ‘ä»¬å¾ˆå¤šæ—¶é—´ï¼Œä¸‹é¢ä»¥ less ä¸ºä¾‹\r\n\r\n```less\r\n.article {\r\n  max-width: 1200px;\r\n  &__body {\r\n    padding: 20px;\r\n  }\r\n  &__button {\r\n    padding: 5px 8px;\r\n    &--primary {\r\n      background: blue;\r\n    }\r\n    &--success {\r\n      background: green;\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n### åœ¨ Vue ä¸­ä½¿ç”¨\r\n\r\nVue ä¸ºäº†ç®€ä¾¿å¼€å‘æä¾›äº† `scope` çš„ css è¯­æ³•ç³–ï¼Œä½†æ˜¯åœ¨ BEM ä¸­å¹¶ä¸æ¨èï¼Œå› ä¸ºä½¿ç”¨`scope`çš„ç›®çš„å°±æ˜¯é¿å…æ ·å¼å†²çªï¼Œè€Œ BEM æœ¬èº«å°±å·²ç»å¯ä»¥åšåˆ°äº†ã€‚\r\n\r\n```vue\r\n<template>\r\n  <form class=\"form form--theme-xmas form--simple\">\r\n    <input class=\"form__input\" type=\"text\" />\r\n    <input class=\"form__submit form__submit--disabled\" type=\"submit\" />\r\n  </form>\r\n</template>\r\n\r\n<script lang=\"css\">\r\n.form { }\r\n.form--theme-xmas { }\r\n.form--simple { }\r\n.form__input { }\r\n.form__submit { }\r\n.form__submit--disabled { }\r\n</script>\r\n```\r\n\r\n## ç»„ä»¶å‘½åè§„èŒƒ\r\n\r\n### æ–‡ä»¶ååº”å§‹ç»ˆå•è¯å¤§å†™å¼€å¤´æˆ–æ¨ªçº¿è¿æ¥\r\n\r\nå•è¯å¤§å†™å¼€å¤´å¯¹äºä»£ç ç¼–è¾‘å™¨çš„è‡ªåŠ¨è¡¥å…¨æœ€ä¸ºå‹å¥½ï¼Œå› ä¸ºè¿™ä½¿å¾—æˆ‘ä»¬åœ¨ `JS(X)` å’Œæ¨¡æ¿ä¸­å¼•ç”¨ç»„ä»¶çš„æ–¹å¼å°½å¯èƒ½çš„ä¸€è‡´ã€‚ç„¶è€Œï¼Œæ··ç”¨æ–‡ä»¶å‘½åæ–¹å¼æœ‰çš„æ—¶å€™ä¼šå¯¼è‡´å¤§å°å†™ä¸æ•æ„Ÿçš„æ–‡ä»¶ç³»ç»Ÿçš„é—®é¢˜ï¼Œè¿™ä¹Ÿæ˜¯æ¨ªçº¿è¿æ¥å‘½ååŒæ ·å®Œå…¨å¯å–çš„åŸå› ã€‚\r\n\r\n```sh\r\n# bad\r\ncomponents/\r\n|- mycomponent.vue\r\n```\r\n\r\n```sh\r\ncomponents/\r\n|- myComponent.vue\r\n```\r\n\r\n```sh\r\n# good\r\ncomponents/\r\n|- TodoList.js\r\n|- TodoItem.js\r\n```\r\n\r\n```sh\r\n# good\r\ncomponents/\r\n|- TodoList.vue\r\n|- TodoItem.vue\r\n```\r\n\r\n### åŸºç¡€ç»„ä»¶ä»¥ä¸€ä¸ªç‰¹å®šçš„å‰ç¼€å¼€å¤´\r\n\r\nåº”ç”¨ç‰¹å®šæ ·å¼å’Œçº¦å®šçš„åŸºç¡€ç»„ä»¶ (ä¹Ÿå°±æ˜¯å±•ç¤ºç±»çš„ã€æ— é€»è¾‘çš„æˆ–æ— çŠ¶æ€çš„ç»„ä»¶) åº”è¯¥å…¨éƒ¨ä»¥ä¸€ä¸ªç‰¹å®šçš„å‰ç¼€å¼€å¤´ï¼Œæ¯”å¦‚ `Base`ã€`App` æˆ– `V`ã€‚\r\n\r\n```sh\r\n# bad\r\ncomponents/\r\n|- MyButton.vue\r\n|- VueTable.vue\r\n|- Icon.vue\r\n```\r\n\r\n```sh\r\n# good\r\ncomponents/\r\n|- BaseButton.vue\r\n|- BaseTable.vue\r\n|- BaseIcon.vue\r\n# or\r\ncomponents/\r\n|- AppButton.vue\r\n|- AppTable.vue\r\n|- AppIcon.vue\r\n# or\r\ncomponents/\r\n|- VButton.vue\r\n|- VTable.vue\r\n|- VIcon.vue\r\n```\r\n\r\n### ä¸€æ¬¡æ€§ç»„ä»¶å‘½å\r\n\r\nå•ä¸ªæ´»è·ƒå®ä¾‹çš„ç»„ä»¶åº”è¯¥ä»¥ `The` å‰ç¼€å‘½åï¼Œä»¥ç¤ºå…¶å”¯ä¸€æ€§ã€‚\r\n\r\nè¿™ä¸æ„å‘³ç€ç»„ä»¶åªå¯ç”¨äºä¸€ä¸ªå•é¡µé¢ï¼Œè€Œæ˜¯æ¯ä¸ªé¡µé¢åªä½¿ç”¨ä¸€æ¬¡ã€‚è¿™äº›ç»„ä»¶æ°¸è¿œä¸æ¥å—ä»»ä½• `prop`ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ä¸ºä½ çš„åº”ç”¨å®šåˆ¶çš„ï¼Œè€Œä¸æ˜¯å®ƒä»¬åœ¨ä½ çš„åº”ç”¨ä¸­çš„ä¸Šä¸‹æ–‡ã€‚å¦‚æœä½ å‘ç°æœ‰å¿…è¦æ·»åŠ  `prop`ï¼Œé‚£å°±è¡¨æ˜è¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ªå¯å¤ç”¨çš„ç»„ä»¶ï¼Œåªæ˜¯ç›®å‰åœ¨æ¯ä¸ªé¡µé¢é‡Œåªä½¿ç”¨ä¸€æ¬¡ã€‚\r\n\r\n```sh\r\n# bad\r\ncomponents/\r\n|- Heading.vue\r\n|- MySidebar.vue\r\n```\r\n\r\n```sh\r\n# good\r\ncomponents/\r\n|- TheHeading.vue\r\n|- TheSidebar.vue\r\n```\r\n\r\n### ç»„ä»¶å‘½åè¯·ä¿æŒå…³è”\r\n\r\nå’Œçˆ¶ç»„ä»¶ç´§å¯†è€¦åˆçš„å­ç»„ä»¶åº”è¯¥ä»¥çˆ¶ç»„ä»¶åä½œä¸ºå‰ç¼€å‘½åã€‚\r\n\r\nå¦‚æœä¸€ä¸ªç»„ä»¶åªåœ¨æŸä¸ªçˆ¶ç»„ä»¶çš„åœºæ™¯ä¸‹æœ‰æ„ä¹‰ï¼Œè¿™å±‚å…³ç³»åº”è¯¥ä½“ç°åœ¨å…¶åå­—ä¸Šã€‚å› ä¸ºç¼–è¾‘å™¨é€šå¸¸ä¼šæŒ‰å­—æ¯é¡ºåºç»„ç»‡æ–‡ä»¶ï¼Œæ‰€ä»¥è¿™æ ·åšå¯ä»¥æŠŠç›¸å…³è”çš„æ–‡ä»¶æ’åœ¨ä¸€èµ·ã€‚\r\n\r\n```sh\r\n# bad\r\ncomponents/\r\n|- TodoList.vue\r\n|- TodoItem.vue\r\n|- TodoButton.vue\r\n```\r\n\r\n```sh\r\n# good\r\ncomponents/\r\n|- TodoList.vue\r\n|- TodoListItem.vue\r\n|- TodoListItemButton.vue\r\n```\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/73/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/73/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/77",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/77/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/77/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/77/events",
      "html_url": "https://github.com/bosens-China/blog/issues/77",
      "id": 1041025871,
      "node_id": "I_kwDOCzPAy84-DMtP",
      "number": 77,
      "title": "åˆ¤æ–­å¯¹è±¡å…¨ç­‰",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1602397157,
          "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
          "name": "æ·±å…¥ç³»åˆ—",
          "color": "719192",
          "default": false,
          "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2021-11-01T10:38:09Z",
      "updated_at": "2021-12-21T09:58:45Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "JavaScript è‡ªå¸¦äº†`==`å’Œ`===`ä¸¤ç§åˆ¤æ–­æ–¹å¼ï¼Œå‰è€…ä¼šéšå¼è½¬æ¢ç±»å‹å¯¼è‡´ä»£ç å‡ºç°é—®é¢˜ï¼Œè€Œåè€…åˆ™æ˜¯æ ¹æ®æŒ‡é’ˆåœ°å€è¿›è¡Œåˆ¤æ–­ã€‚\r\n\r\nåœ¨ç»å¤§å¤šæ•°æƒ…å†µè¿™ä¸¤ç§å·²ç»è¶³å¤Ÿä½¿ç”¨äº†ï¼Œä¸è¿‡å»¶ä¼¸ä¸‹æƒ³åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æˆ–æ•°ç»„å…ƒç´ æ˜¯å¦ç›¸åŒï¼Œåˆ™ä¼šæ˜¾å¾—ä¸å¤ªå‹å¥½ï¼Œè€Œä¸”åœ¨ JavaScript ä¸­æœ‰ä¸€äº›ç‰¹æ®Šçš„è§„åˆ™ï¼š`NaN`å’Œ`NaN`ä¸ç›¸åŒã€`+0`å’Œ`-0`ç›¸åŒï¼Œè¿™å°±å¯¼è‡´æœ‰çš„åœºæ™¯ä½¿ç”¨èµ·æ¥ä¸ä¾¿ï¼Œä¸‹é¢åŠ¨æ‰‹å®ç°ä¸€ä¸ª`equal`å‡½æ•°ï¼Œå®ƒå…·å¤‡ä»¥ä¸‹åŠŸèƒ½ï¼š\r\n\r\n- `+0`å’Œ`-0`ä¸ç›¸åŒ\r\n- `NaN`å’Œ`NaN`ç›¸åŒ\r\n- `{}`å’Œ`{}`ç›¸åŒ\r\n- `[]`å’Œ`[]`ç›¸åŒ\r\n- `new Set()`å’Œ`new Set()`ç›¸åŒ\r\n- `new Map()`å’Œ`new Map()`ç›¸åŒ\r\n- `new Date(111)`å’Œ`new Date(111)`ç›¸åŒ\r\n- `new String(1)`å’Œ`new String(1)`ä¹‹ç±»çš„åŒ…è£…å¯¹è±¡ç›¸åŒ\r\n- `/a/`å’Œ`/a/`ç›¸åŒ -`() => {}`å’Œ`() => {}`ä¸ç›¸åŒ\r\n- å…¶ä»–æƒ…å†µä¸€å¾‹`===`åˆ¤æ–­\r\n\r\n## ç¬¬ä¸€ç‰ˆ\r\n\r\nåœ¨è¿™ä¸€ç‰ˆä¸­ï¼Œæˆ‘ä»¬å…ˆå®ç°`+0`å’Œ`-0`ã€`NaN`çš„åˆ¤æ–­\r\n\r\n```js\r\nfunction equal(a, b) {\r\n  // åˆ¤æ–­NaN\r\n  if (a === b) {\r\n    return 1 / a === 1 / b;\r\n  }\r\n  // åˆ¤æ–­å¯¹è±¡\r\n  if (a && b && typeof a === 'object' && typeof b === 'object') {\r\n    //... ç•™ç©º\r\n  }\r\n  // åˆ¤æ–­NaN\r\n  return a !== a && b !== b;\r\n}\r\n```\r\n\r\nä¸Šé¢åˆ¤æ–­`NaN`çš„æ€è·¯ä¸º`1 / 0`ä¸º`Infinity`ï¼Œè€Œ`1/-0`ä¸º`-Infinity`\r\n\r\n## ç¬¬äºŒç‰ˆ\r\n\r\nç¬¬ä¸€ç‰ˆä¸­æˆ‘ä»¬å·²ç»å®ç°äº†åŸºç¡€çš„åŠŸèƒ½ï¼Œä¸‹é¢å°±æ¥å®ç°ä¸€ä¸‹æ€ä¹ˆæ·±å±‚æ¬¡åˆ¤æ–­å¯¹è±¡å’Œæ•°ç»„æ˜¯å¦ç›¸åŒ\r\n\r\n```js\r\nfunction equal(a, b) {\r\n  // åˆ¤æ–­NaN\r\n  if (a === b) {\r\n    return 1 / a === 1 / b;\r\n  }\r\n  // åˆ¤æ–­å¯¹è±¡\r\n  if (a && b && typeof a === 'object' && typeof b === 'object') {\r\n    if (a.constructor !== b.constructor) {\r\n      return false;\r\n    }\r\n    // åˆ¤æ–­array\r\n    if (Array.isArray(a) && Array.isArray(b)) {\r\n      const len = a.length;\r\n      if (len !== b.length) {\r\n        return false;\r\n      }\r\n      for (let i = 0; i < len; i++) {\r\n        if (!equal(a[i], b[i])) {\r\n          return false;\r\n        }\r\n      }\r\n      return true;\r\n    }\r\n    // é»˜è®¤ä¸ºå¯¹è±¡ï¼Œè¿›è¡Œkeyå’Œé•¿åº¦å¯¹æ¯”\r\n    const keys = Object.keys(a);\r\n    const len = keys.length;\r\n    if (Object.keys(b).length !== len) {\r\n      return false;\r\n    }\r\n    for (let i = 0; i < len; i++) {\r\n      const key = keys[i];\r\n      if (!Object.prototype.hasOwnProperty.call(b, key)) {\r\n        return false;\r\n      }\r\n      if (!equal(a[key], b[key])) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n}\r\n```\r\n\r\nä¸Šé¢ä»£ç ä¸­é¦–å…ˆåˆ¤æ–­`constructor`æ˜¯å¦ç›¸åŒï¼Œ`constructor`å¯ä»¥ä»å®ä¾‹æŒ‡å‘åŸå‹çš„æ„é€ å‡½æ•°ï¼Œä¸Šé¢ä»£ç é¦–å…ˆçš„æ„æ€æ˜¯é¦–å…ˆåˆ¤æ–­æ„é€ å‡½æ•°æ˜¯å¦ç›¸åŒï¼Œå¦‚æœä¸ç›¸åŒç›´æ¥è¿”å›ã€‚\r\n\r\nåé¢çš„è¯åˆ¤æ–­æ•°ç»„çš„æˆå‘˜æ•°é‡ã€æ¯ä¸ªå­å±æ€§æ˜¯å¦ç›¸åŒï¼Œè€Œåˆ¤æ–­å¯¹è±¡ä¹Ÿæ˜¯åˆ¤æ–­`length`ä¹‹ååˆ¤æ–­`b`ä¸‹æ˜¯å¦å­˜åœ¨`name`ï¼Œä¹‹åç»Ÿä¸€å¯¹æ¯”å€¼æ˜¯å¦ç›¸åŒã€‚\r\n\r\nè‡³äºæ‰§è¡Œ`Object.prototype.hasOwnProperty`çš„åŸå› åˆ™æ˜¯`hasOwnProperty`æœ‰å¯èƒ½è¢«æ”¹å†™ï¼Œä¾‹å¦‚ï¼š\r\n\r\n```js\r\nvar foo = {\r\n  hasOwnProperty: function () {\r\n    return false;\r\n  },\r\n  bar: 'Here be dragons',\r\n};\r\n\r\nfoo.hasOwnProperty('bar'); // å§‹ç»ˆè¿”å› false\r\n```\r\n\r\n## ç¬¬ä¸‰ç‰ˆ\r\n\r\nä¸Šé¢çš„ä»£ç åŸºæœ¬å®ç°äº†ä¸€ä¸ªé›å½¢ï¼Œä¸‹é¢åŠ å…¥`Set`ã€`Map`çš„å¯¹æ¯”ï¼Œ`Set`å’Œ`Map`æ˜¯ es6 æ˜¯å¼•å…¥çš„æ–°çš„æ•°æ®ç»“æ„ï¼Œ`Set`æ˜¯ä¸€ç»„ä¸é‡å¤çš„æˆå‘˜ï¼Œ`Map`åˆ™æ˜¯`object`çš„å‡çº§ç‰ˆï¼šé‡ç‚¹è§£å†³äº†é”®åå¾ªç¯ä¸ç¨³å®šä»¥åŠåªèƒ½æ’å…¥ string é”®åçš„é—®é¢˜ã€‚\r\n\r\nå®ƒä»¬ä¸¤è€…éƒ½æ˜¯æœ‰åºçš„ï¼Œä¸”éƒ½éµå¾ª`Symbol.iterator`ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸ä»…è¦å¯¹æ¯”`name`ã€`value`ä¹Ÿè¦å¯¹æ¯”æ‰€åœ¨çš„ä½ç½®æ˜¯å¦ç›¸åŒï¼Œè¿™é‡Œä¸ºäº†ç®€åŒ–åé¢çš„å·¥ä½œæå‰å†™äº†ä¸€ä¸ªå‡½æ•°\r\n\r\n```js\r\nconst iteration = (value, j) => {\r\n  let i = 0;\r\n  for (const iterator of value) {\r\n    if (j === i++) {\r\n      return iterator;\r\n    }\r\n  }\r\n  return undefined;\r\n};\r\n```\r\n\r\nå®ƒçš„ä½œç”¨å°±æ˜¯æ ¹æ®`j`æŒ‡å®šä¸‹æ ‡æ¥è¿è¡Œè¿­ä»£å™¨çš„`next`æ–¹æ³•ï¼Œä¾‹å¦‚ï¼š\r\n\r\n```js\r\niteration(new Set([1, 2, 3]), 1); // 2\r\n```\r\n\r\n```js\r\n// åˆ¤æ–­set\r\nif (a instanceof Set && b instanceof Set) {\r\n  const len = a.size;\r\n  if (len !== b.size) {\r\n    return false;\r\n  }\r\n  for (let i = 0; i < len; i++) {\r\n    if (!equal(iteration(a, i), iteration(b, i))) {\r\n      return false;\r\n    }\r\n  }\r\n  return true;\r\n}\r\n// åˆ¤æ–­Map\r\nif (a instanceof Map && b instanceof Map) {\r\n  const len = a.size;\r\n  if (len !== b.size) {\r\n    return false;\r\n  }\r\n  for (let i = 0; i < len; i++) {\r\n    const [nameA, valueA] = iteration(a.entries(), i);\r\n    const [nameB, valueB] = iteration(b.entries(), i);\r\n    if (!equal(nameA, nameB) || !equal(valueA, valueB)) {\r\n      return false;\r\n    }\r\n  }\r\n  return true;\r\n}\r\n```\r\n\r\nå¯ä»¥å‘ç°`Set`å’Œ`Map`åˆ¤æ–­æ˜¯å¦ç›¸ä¼¼ï¼Œé¦–å…ˆå¯¹æ¯”æˆå‘˜æ•°é‡ï¼Œå…¶æ¬¡å¯¹æ¯”æ¯ä¸€æ¬¡å½“å‰ä½ç½®çš„é”®åå’Œé”®å€¼ã€‚\r\n\r\n## ç¬¬å››ç‰ˆ\r\n\r\nå†™åˆ°è¿™é‡Œæˆ‘ä»¬å·²ç»å®ç°äº† 80%çš„åŠŸèƒ½ï¼Œå‰©ä¸‹çš„ä¸€äº›åˆ¤æ–­è¿˜æœ‰\r\n\r\n- `new Date(111)`å’Œ`new Date(111)`ç›¸åŒ\r\n- `new String(1)`å’Œ`new String(1)`ä¹‹ç±»çš„åŒ…è£…å¯¹è±¡ç›¸åŒ\r\n- `/a/`å’Œ`/a/`ç›¸åŒ\r\n\r\n```js\r\n// åˆ¤æ–­regexp\r\nif (a.constructor === RegExp) {\r\n  return a.source === b.source && a.flags === b.flags;\r\n}\r\nif (a.toString !== Object.prototype.toString) {\r\n  return a.toString() === b.toString();\r\n}\r\nif (a.valueOf !== Object.prototype.valueOf) {\r\n  return a.valueOf() === b.valueOf();\r\n}\r\n```\r\n\r\nåˆ¤æ–­åŒ…è£…ç±»å‹å’Œ`Date`å¯ä»¥`valueOf`å’Œ`toString`æ–¹æ³•å®ç°ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½ä¼šä»`Object.prototype`ç»§æ‰¿`vlaueOf`å’Œ`toString`æ–¹æ³•ã€‚\r\n\r\né€šå¸¸æƒ…å†µä¸‹`valueOf`è¿”å›åŒ…è£…å¯¹è±¡ä¼ é€’çš„å‚æ•°ï¼Œè€Œæœ‰çš„å¯¹è±¡ä¼šæ›´æ”¹`valueOf`æ–¹æ³•ï¼Œä¾‹å¦‚`Date`è¿”å›`number`ç±»å‹ï¼Œæ‰€ä»¥ä¸Šé¢åˆ¤æ–­`valueOf`ä¸€åˆ™æ˜¯ä¸ºäº†`Date`å¦å¤–ä¸€æ–¹åˆ™æ˜¯åˆå§‹è¿‡æ»¤ä¼ é€’çš„å‚æ•°ã€‚\r\n\r\nè‡³äºä¸ºä»€ä¹ˆä¹Ÿåˆ¤æ–­`toString`åˆ™æ˜¯ä¸ºäº†è€ƒè™‘è¾¹ç•Œæƒ…å†µï¼Œä¾‹å¦‚ï¼š\r\n\r\n```js\r\nvar a = new Boolean(true);\r\nvar b = new Boolean(1);\r\na === b ?\r\n```\r\n\r\nå¦‚æœæ²¡æœ‰`toString`è¿™ä¸ªå°±ç›¸åŒäº†\r\n\r\n## æœ€å\r\n\r\nå®Œæ•´çš„æŠŠä»£ç è´´ä¸€ä¸‹ï¼Œå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ä¹Ÿå¯ä»¥`star`æ”¯æŒä¸€ä¸‹ï¼Œæœ‰ä»€ä¹ˆé”™è¯¯ä¹Ÿæ¬¢è¿æŒ‡å‡ºã€‚\r\n\r\n```js\r\nconst iteration = (value, j) => {\r\n  let i = 0;\r\n  for (const iterator of value) {\r\n    if (j === i++) {\r\n      return iterator;\r\n    }\r\n  }\r\n  return undefined;\r\n};\r\nfunction equal(a, b) {\r\n  // åˆ¤æ–­NaN\r\n  if (a === b) {\r\n    return 1 / a === 1 / b;\r\n  }\r\n  // åˆ¤æ–­å¯¹è±¡\r\n  if (a && b && typeof a === 'object' && typeof b === 'object') {\r\n    // åˆ¤æ–­å¯¹è±¡\r\n    if (a && b && typeof a === 'object' && typeof b === 'object') {\r\n      if (a.constructor !== b.constructor) {\r\n        return false;\r\n      }\r\n      // åˆ¤æ–­array\r\n      if (Array.isArray(a) && Array.isArray(b)) {\r\n        const len = a.length;\r\n        if (len !== b.length) {\r\n          return false;\r\n        }\r\n        for (let i = 0; i < len; i++) {\r\n          if (!equal(a[i], b[i])) {\r\n            return false;\r\n          }\r\n        }\r\n        return true;\r\n      }\r\n      // åˆ¤æ–­set\r\n      if (a instanceof Set && b instanceof Set) {\r\n        const len = a.size;\r\n        if (len !== b.size) {\r\n          return false;\r\n        }\r\n        for (let i = 0; i < len; i++) {\r\n          if (!equal(iteration(a, i), iteration(b, i))) {\r\n            return false;\r\n          }\r\n        }\r\n        return true;\r\n      }\r\n      // åˆ¤æ–­Map\r\n      if (a instanceof Map && b instanceof Map) {\r\n        const len = a.size;\r\n        if (len !== b.size) {\r\n          return false;\r\n        }\r\n        for (let i = 0; i < len; i++) {\r\n          const [nameA, valueA] = iteration(a.entries(), i);\r\n          const [nameB, valueB] = iteration(b.entries(), i);\r\n          if (!equal(nameA, nameB) || !equal(valueA, valueB)) {\r\n            return false;\r\n          }\r\n        }\r\n        return true;\r\n      }\r\n      // åˆ¤æ–­regexp\r\n      if (a.constructor === RegExp) {\r\n        return a.source === b.source && a.flags === b.flags;\r\n      }\r\n      if (a.toString !== Object.prototype.toString) {\r\n        return a.toString() === b.toString();\r\n      }\r\n      if (a.valueOf !== Object.prototype.valueOf) {\r\n        return a.valueOf() === b.valueOf();\r\n      }\r\n      // é»˜è®¤ä¸ºå¯¹è±¡ï¼Œè¿›è¡Œkeyå’Œé•¿åº¦å¯¹æ¯”\r\n      const keys = Object.keys(a);\r\n      const len = keys.length;\r\n      if (Object.keys(b).length !== len) {\r\n        return false;\r\n      }\r\n      for (let i = 0; i < len; i++) {\r\n        const key = keys[i];\r\n        if (!Object.prototype.hasOwnProperty.call(b, key)) {\r\n          return false;\r\n        }\r\n        if (!equal(a[key], b[key])) {\r\n          return false;\r\n        }\r\n      }\r\n      return true;\r\n    }\r\n  }\r\n  // åˆ¤æ–­NaN\r\n  return a !== a && b !== b;\r\n}\r\n```\r\n\r\n## å‚è€ƒ\r\n\r\n- [fast-deep-equal](https://github.com/epoberezkin/fast-deep-equal)\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/77/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/77/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/76",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/76/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/76/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/76/events",
      "html_url": "https://github.com/bosens-China/blog/issues/76",
      "id": 1029841361,
      "node_id": "I_kwDOCzPAy849YiHR",
      "number": 76,
      "title": "å‡½æ•°è®°å¿†",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1602397157,
          "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
          "name": "æ·±å…¥ç³»åˆ—",
          "color": "719192",
          "default": false,
          "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2021-10-19T04:16:45Z",
      "updated_at": "2021-12-21T09:58:43Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "> **è®°å¿†åŒ–**ï¼ˆè‹±è¯­ï¼šmemoizationï¼‰æ˜¯ä¸€ç§æé«˜[è®¡ç®—æœºç¨‹åº](https://zh.wikipedia.org/wiki/è®¡ç®—æœºç¨‹åº)æ‰§è¡Œé€Ÿåº¦çš„ä¼˜åŒ–æŠ€æœ¯ã€‚é€šè¿‡å‚¨å­˜å¤§è®¡ç®—é‡[å‡½æ•°](https://zh.wikipedia.org/wiki/å­ç¨‹åº)çš„è¿”å›å€¼ï¼Œå½“è¿™ä¸ªç»“æœå†æ¬¡è¢«éœ€è¦æ—¶å°†å…¶ä»[ç¼“å­˜](https://zh.wikipedia.org/wiki/ç¼“å­˜)æå–ï¼Œè€Œä¸ç”¨å†æ¬¡è®¡ç®—æ¥èŠ‚çœè®¡ç®—æ—¶é—´ã€‚\r\n>\r\n> è®°å¿†åŒ–æ˜¯ä¸€ç§å…¸å‹çš„åœ¨è®¡ç®—æ—¶é—´ä¸[ç”µè„‘å­˜å‚¨å™¨](https://zh.wikipedia.org/wiki/é›»è…¦è¨˜æ†¶é«”)ç©ºé—´ä¹‹ä¸­è·å–å¹³è¡¡çš„æ–¹æ¡ˆã€‚\r\n>\r\n> æ¥æºï¼š[ç»´åŸºç™¾ç§‘](https://zh.wikipedia.org/wiki/%E8%AE%B0%E5%BF%86%E5%8C%96)\r\n\r\nä»ä¸Šé¢çš„å®šä¹‰å¯ä»¥çœ‹å‡ºç¼“å­˜æ˜¯ä¸€ç§éå¸¸æœ‰ç”¨çš„æŠ€å·§ï¼Œå®ƒå¯ä»¥æŠŠä¸€äº›å‡½æ•°ç»“æœå‚¨å­˜èµ·æ¥åœ¨ä¸‹æ¬¡è°ƒç”¨çš„æ—¶å€™è¿”å›ã€‚\r\nè¿™é‡Œä¸è®¨è®ºä»€ä¹ˆæ ·åœºæ™¯ä½¿ç”¨ç¼“å­˜è€Œæ˜¯æŠ›ç –å¼•ç‰å¦‚ä½•ç¼–å†™ä¸€ä¸ªå¯å¤ç”¨çš„ Memoization å‡½æ•°\r\n\r\n## MemoizationSync\r\n\r\nMemoizationSync ä»å­—é¢å°±å¯ä»¥çœ‹å‡ºå®ƒæ˜¯ä¸€ä¸ªåŒæ­¥ç‰ˆæœ¬çš„ Memoizationï¼Œä¸‹é¢çš„ä»¥ `add` å‡½æ•°ä¸ºä¾‹ä»‹ç»å¦‚ä½•ç¼–å†™ä¸€ä¸ªé€šç”¨çš„ memoization æ¥å¯¹ç»“æœè¿›è¡Œç¼“å­˜\r\n\r\n```js\r\nconst memo = {};\r\n\r\nconst add = (...args) => {\r\n  const key = args.join();\r\n  if (Object.prototype.hasOwnProperty.call(memo, key)) {\r\n    return memo[key];\r\n  }\r\n  const result = args.reduce((a, b) => a + b, 0);\r\n  memo[key] = result;\r\n  return result;\r\n};\r\n\r\nadd(1, 2, 3);\r\nadd(1, 2, 3);\r\n```\r\n\r\nå¦‚æœè¦ç»™ `add` å‡½æ•°æ˜¾ç¤ºçš„æ·»åŠ ä¸€ä¸ªç¼“å­˜åŠŸèƒ½å¯èƒ½ä¼šæŒ‰ç…§ä¸Šé¢çš„æƒ…å†µæ¥ç¼–å†™ï¼Œä½†æ˜¯å®ƒå­˜åœ¨é—®é¢˜ã€‚\r\n\r\nè¿™ä¸ªå‡½æ•°åŒæ—¶åšäº†ä¸¤ä»¶äº‹æƒ…\r\n\r\n- è®¡ç®— args\r\n- è¯»å– memo çš„ç¼“å­˜\r\n  ä½†æ˜¯è¿™æ ·æ˜¾ç¤ºè¿èƒŒäº†è®¾è®¡æ¨¡å¼çš„å•ä¸€åŸåˆ™ï¼Œè€Œä¸”ä¼šç»™åç»­çš„ç»´æŠ¤å¸¦æ¥éº»çƒ¦ï¼Œä»¥åŠå¦‚æœæˆ‘ä»¬éœ€è¦æ–°çš„å‡½æ•°ç¼“å­˜æ˜¯ä¸æ˜¯è¿˜è¦é‡æ–°å¤åˆ¶ä¸€ä»½è¿‡å»ï¼Œæ˜¾ç„¶ä¸ç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚ï¼Œæˆ‘ä»¬å°è¯•å°†å®ƒè¿›è¡Œä¸€æ¬¡æŠ½ç¦»\r\n\r\n```js\r\nconst add = (...args) => {\r\n  return args.reduce((a, b) => a + b, 0);\r\n};\r\n\r\nconst memoizationSync = (fn, key) => {\r\n  const memo = {};\r\n  return function callback(...args) {\r\n    if (memo.hasOwnProperty(key)) {\r\n      return memo[key];\r\n    }\r\n    const result = fn.apply(this, args);\r\n    memo[key] = result;\r\n    return result;\r\n  };\r\n};\r\n\r\nconst argumentsArr = [1, 2, 3];\r\nconst memoizationAdd = memoizationSync(add, argumentsArr);\r\nmemoizationAdd(...argumentsArr);\r\nmemoizationAdd(...argumentsArr);\r\n```\r\n\r\nè¿™æ ·å°±å¾—åˆ°äº†ä¸€ä¸ªé€šç”¨çš„ memoizationSync å‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ª `key` ï¼Œé€šè¿‡ `key` æ¥è¿›è¡ŒåŒºåˆ†ç¼“å­˜ã€‚\r\n\r\nä¸è¿‡ä¸ºäº†å®ƒçš„çµæ´»æ€§å’Œç¬¦åˆæ›´å¤šçš„åœºæ™¯çš„è¦æ±‚æˆ‘ä»¬è¿˜æ˜¯éœ€è¦å¯¹å®ƒè¿›è¡Œä¸€æ¬¡æ”¹é€ ï¼Œæ¥æ”¹é€ å‰æˆ‘ä»¬çœ‹ä¸‹è¿™ä¸ªå‡½æ•°åšäº†å•¥\r\n\r\n- æ ¹æ® key æ¥è¯»å–ç¼“å­˜\r\n- æ— ç¼“å­˜æ¥æ‰§è¡Œå‡½æ•°è®¾ç½®ç¼“å­˜\r\n  æ˜¾ç„¶è¿™ä¸¤æ­¥æ˜¯ä¸ä¼šæ”¹å˜çš„ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å¯¹ `key` ä¸‹æ‰‹æé«˜ `key` çš„å”¯ä¸€æ€§ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒå¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°å¹¶ä¸”å­˜åœ¨é»˜è®¤å€¼ï¼Œè¿™æ ·åœ¨å¤æ‚åœºæ™¯ä¸‹å¯ä»¥ç”±ç”¨æˆ·æ ¹æ®å‚æ•°æ¥æŒ‡å®šç¼“å­˜ä»€ä¹ˆå­—æ®µ\r\n\r\n```js\r\nconst memoizationSync = (fn, getKey = (...args) => args.join('')) => {\r\n  const memo = {};\r\n  return function callback(...args) {\r\n    const key = typeof getKey === 'function' ? getKey.apply(this, args) : getKey;\r\n    if (memo.hasOwnProperty(key)) {\r\n      return memo[key];\r\n    }\r\n    const result = fn.apply(this, args);\r\n    memo[key] = result;\r\n    return result;\r\n  };\r\n};\r\n```\r\n\r\n## MemoizationAsync\r\n\r\nåœ¨ JavaScript ä¸­å¼‚æ­¥åœºæ™¯ç²—ç•¥å¯ä»¥åˆ†ä¸ºä¸¤éƒ¨åˆ†\r\n\r\n- å›è°ƒå‡½æ•°\r\n- Promiseï¼ˆasync ã€Generator éƒ½æ˜¯åŸºäº Promiseï¼‰\r\n\r\nä¸‹é¢å°±æ¥è®¨è®ºè¿™ä¸¤éƒ¨åˆ†æˆ‘ä»¬å¦‚ä½•å®ç°ç¼“å­˜\r\n\r\n### Callback\r\n\r\næˆ‘ç°åœ¨æœ‰ä¸€ä¸ª getImgSize çš„å‡½æ•°ï¼Œå®ƒä¼šæ ¹æ® `img` çš„ `src` æ¥è¿”å›å›¾ç‰‡çš„çœŸå®å®½åº¦å’Œé«˜åº¦ï¼Œå¦‚æœæˆåŠŸå°±ä¼šè°ƒç”¨ `callback` æ¥ä¼ é€’å‚æ•°ï¼ˆnode å›è°ƒé£æ ¼ï¼‰ï¼Œä½†æ˜¯æˆ‘å¸Œæœ›å¦‚æœ url ç›¸åŒçš„æ—¶å€™å°±ç›´æ¥è¿”å›è€Œä¸æ˜¯ç»§ç»­è°ƒç”¨ä¸€æ¬¡ getImgSize\r\n\r\n```js\r\nconst getImgSize = (src, callback) => {\r\n  const img = new Image();\r\n  img.src = src;\r\n  img.addEventListener('load', () => {\r\n    callback(null, {\r\n      width: img.naturalWidth,\r\n      height: img.naturalHeight,\r\n    });\r\n  });\r\n\r\n  img.addEventListener('error', (e) => {\r\n    callback(new Error(e), null);\r\n  });\r\n};\r\n\r\nconst url = 'https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png';\r\n\r\ngetImgSize(url, (error, size) => {\r\n  if (error) {\r\n    return;\r\n  }\r\n  console.log(size);\r\n});\r\n```\r\n\r\nåœ¨ç¼–å†™ memoizationAsync å‡½æ•°ä¹‹å‰æˆ‘ä»¬å…ˆæƒ³ä¸€ä¸‹ä»¥ä»€ä¹ˆæ ·çš„æ–¹å¼æ¥ç¼–å†™è¿™ä¸ªå‡½æ•°ï¼ŒæŒ‰ç…§æƒ¯ä¾‹æˆ‘ä»¬å¸Œæœ›ä¸è¦å¯¹ç”¨æˆ·çš„ä½¿ç”¨æ–¹å¼æœ‰å¤ªå¤šå½±å“ï¼Œæ‰€ä»¥æœŸå¾…çš„è°ƒç”¨æ–¹å¼å¦‚ä¸‹\r\n\r\n```js\r\nconst getImgSizeMemoization = memoizationAsync(getImgSize);\r\ngetImgSizeMemoization(url, (error, size) => {\r\n  if (error) {\r\n    return;\r\n  }\r\n  console.log(size);\r\n});\r\n// ç›¸åŒå‚æ•°ä½¿ç”¨ç¼“å­˜\r\ngetImgSizeMemoization(url, (error, size) => {\r\n  if (error) {\r\n    return;\r\n  }\r\n  console.log(size);\r\n});\r\n```\r\n\r\nåé¢å°±æ˜¯æ¥ç¼–å†™è¿™ä¸ªå‡½æ•°\r\n\r\n```js\r\nconst memoizationAsync = (fn, getKey = (...args) => args.join()) => {\r\n  const memo = {};\r\n  const queue = {};\r\n  return function (...rest) {\r\n    const callback = Array.prototype.pop.call(rest);\r\n    const key = getKey.apply(this, rest);\r\n    const cb = (...args) => {\r\n      memo[key] = args;\r\n      queue[key].forEach((item) => {\r\n        item.apply(this, args);\r\n      });\r\n      delete queue[key];\r\n    };\r\n    if (memo.hasOwnProperty(key)) {\r\n      return memo[key];\r\n    }\r\n    if (!queue.hasOwnProperty(key)) {\r\n      queue[key] = [callback];\r\n    } else {\r\n      queue[key].push(callback);\r\n      // åç»­åŠ å…¥ç­‰å¾…ç¬¬ä¸€ä¸ªæ‰§è¡Œç»“æŸ\r\n      return;\r\n    }\r\n    fn.apply(this, [...rest, cb]);\r\n  };\r\n};\r\n```\r\n\r\nè¯´ä¸€ä¸‹è¿™ä¸ªå‡½æ•°ç¼–å†™çš„æ€è·¯ï¼Œé€šè¿‡è‡ªå®šä¹‰åˆ›å»º cb å›è°ƒå‡½æ•°æ¥å®Œæˆè®°å½•ç¼“å­˜å’Œè°ƒç”¨ç”¨æˆ·ä¼ é€’çš„å›è°ƒï¼Œå…¶ä»–çš„è¯»å–å’Œè®¾ç½®ç¼“å­˜ä¸ä¸Šé¢ä¸€è‡´ã€‚\r\n\r\nè€Œå­˜åœ¨ `queue` å˜é‡çš„åŸå› æ˜¯å› ä¸ºå¼‚æ­¥ä»»åŠ¡æ·»åŠ è¿›æ¥çš„æ—¶å€™å¯èƒ½æ­£åœ¨è¯·æ±‚ï¼Œä½†æ˜¯ `memo` è¿˜æ²¡æœ‰è¢«å†™å…¥ç»“æœï¼Œæ‰€ä»¥é€šè¿‡é˜Ÿåˆ—æ¥ç®¡ç†è¿™ä¸ªè¯·æ±‚ï¼Œç­‰å¾…ç¬¬ä¸€ä¸ªè¯·æ±‚ç»“æŸä¹‹åæ‰¹é‡æ¥æ‰§è¡Œé˜Ÿåˆ—çš„ä»»åŠ¡ï¼Œæœ€ååˆ é™¤ã€‚\r\n\r\n### Promise\r\n\r\nå›å¿†ä¸€ä¸‹[Promise å‡½æ•°çš„ç‰¹æ€§](https://es6.ruanyifeng.com/#docs/promise#Promise-%E7%9A%84%E5%90%AB%E4%B9%89)\r\n\r\n- å¯¹è±¡çš„çŠ¶æ€ä¸å—å¤–ç•Œå½±å“\r\n- ä¸€æ—¦çŠ¶æ€æ”¹å˜ï¼Œå°±ä¸ä¼šå†å˜ï¼Œä»»ä½•æ—¶å€™éƒ½å¯ä»¥å¾—åˆ°è¿™ä¸ªç»“æœ\r\n\r\né‡ç‚¹æ˜¯ç¬¬äºŒç‚¹ï¼Œå®ƒä¸åŒäºå›è°ƒå‡½æ•°ï¼Œåªè¦ç»“æœå‡ºæ¥äº†ä»»ä½•æ—¶å€™éƒ½å¯ä»¥è°ƒç”¨ï¼Œæˆ‘ä»¬åœ¨ click ç›‘å¬ä¸€ä¸ªäº‹ä»¶å¦‚æœé”™è¿‡äº†è¿™ä¸ªç›‘å¬æƒ³è¦å›æº¯æ˜¯ä¸å¯èƒ½çš„ï¼Œä½†æ˜¯ promise ä½ é‡å¤æ— æ•°æ¬¡çš„`.then` è°ƒç”¨ï¼ŒåŸºäºè¿™ä¸ªç‰¹æ€§æˆ‘ä»¬æ¥ç¼–å†™ MemoizationAsync\r\n\r\n```js\r\nconst getImgSize = (src) => {\r\n  return new Promise((resolve, reject) => {\r\n    const img = new Image();\r\n    img.src = src;\r\n    img.addEventListener('load', () => {\r\n      return resolve({\r\n        width: img.naturalWidth,\r\n        height: img.naturalHeight,\r\n      });\r\n    });\r\n\r\n    img.addEventListener('error', (e) => {\r\n      return reject(e);\r\n    });\r\n  });\r\n};\r\n\r\nconst url = 'https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png';\r\n\r\nconst memoizationAsync = (fn, getKey = (...args) => args.join()) => {\r\n  const memo = {};\r\n  return async function (...args) {\r\n    const key = getKey.apply(this, args);\r\n    if (memo.hasOwnProperty(key)) {\r\n      return memo[key];\r\n    }\r\n    const result = fn.apply(this, args);\r\n    memo[key] = result;\r\n    return result;\r\n  };\r\n};\r\n\r\nconst getImgSizeMemoization = memoizationAsync(getImgSize);\r\n\r\n(async () => {\r\n  const result = await Promise.all([getImgSizeMemoization(url), getImgSizeMemoization(url)]);\r\n  console.log(result);\r\n})();\r\n```\r\n\r\nmemoizationAsync å‡½æ•°ç¼–å†™çš„ååˆ†ç²¾ç®€è·ŸåŒæ­¥ç‰ˆæœ¬åŸºæœ¬æ²¡åŒºåˆ«ï¼Œä¸åŒç‚¹åœ¨äºæˆ‘ä»¬åªæ˜¯è¿”å›äº† **Promise çš„çŠ¶æ€**ï¼Œè€Œå¾—ç›Šäº Promise çš„ç‰¹æ€§åœ¨ä»»ä½•æ—¶å€™è¿™ä¸ªå‡½æ•°éƒ½ä¼šè¿”å›æ­£ç¡®çš„ç»“æœ\r\n\r\n## æœ€å\r\n\r\nå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©å¯ä»¥`å…³æ³¨`ã€ `star` ä¸€ä¸‹ï¼Œæœ‰ä»€ä¹ˆé”™è¯¯æ¬¢è¿æŒ‡å‡º\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/76/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/76/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/49",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/49/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/49/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/49/events",
      "html_url": "https://github.com/bosens-China/blog/issues/49",
      "id": 548743305,
      "node_id": "MDU6SXNzdWU1NDg3NDMzMDU=",
      "number": 49,
      "title": "GitHubActionsæ„å»ºå®šæ—¶ä»»åŠ¡",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1740577858,
          "node_id": "MDU6TGFiZWwxNzQwNTc3ODU4",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3",
          "name": "å·¥å…·ç›¸å…³",
          "color": "f73d62",
          "default": false,
          "description": "å·¥ç¨‹åŒ–ç›¸å…³çš„ä¸œè¥¿"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2020-01-13T07:07:52Z",
      "updated_at": "2021-12-21T09:53:13Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "å†™è¿™ç¯‡æ–‡ç« æ˜¯æ— æ„ä¹‹é—´çœ‹åˆ°é˜®ä¸€å³°è€å¸ˆå‘å¸ƒçš„[GitHub Actions å…¥é—¨æ•™ç¨‹](http://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html)é‡Œé¢ä»‹ç»äº† GitHub Actions çš„ä¸€äº›æ¦‚å¿µï¼Œç¢°å·§æˆ‘ä¹‹å‰ç”¨çˆ¬è™« + vuePress æ„ä»¶äº†ä¸€ä¸ª[typescript çš„ä¸­æ–‡æ‰‹å†Œ](https://bosens-china.github.io/Typescript-manual/)ï¼Œä¸‹é¢å°±ä»¥æ¯å¤©å®šæ—¶æ„å»ºè¿™ä¸ªåº”ç”¨ä¸ºèƒŒæ™¯ä»‹ç»å¦‚ä½•ä½¿ç”¨ GitHub Actions å®Œæˆä¸‹é¢å·¥ä½œã€‚\r\n\r\nä¸‹é¢å†…å®¹ä¸»è¦ä»¥å®è·µä¸ºä¸»ã€‚\r\n\r\n## æ€è·¯\r\n\r\n1. ç¼–å†™ bash ä¸Šä¼ è„šæœ¬\r\n2. æ‰§è¡Œçˆ¬è™«å‘½ä»¤æ„å»ºåº”ç”¨ï¼›\r\n3. å®šæ—¶æ‰§è¡Œè„šæœ¬ï¼Œå®Œæˆä¸Šä¼ \r\n4. å‡ºç°é”™è¯¯å‘é€é‚®ä»¶é€šçŸ¥æˆ‘ï¼›\r\n\r\n### deploy.sh\r\n\r\n```sh\r\n#!/usr/bin/env sh\r\n\r\n# ç¡®ä¿è„šæœ¬æŠ›å‡ºé‡åˆ°çš„é”™è¯¯\r\nset -e\r\n# ä¸‹é¢æ˜¯è„šæœ¬å‘½ä»¤ï¼Œæ ¹æ®ä½ çš„éœ€æ±‚æ¥é€‰å–ã€‚\r\nnpm run xxxx\r\n# è¿›å…¥ç”Ÿæˆçš„æ–‡ä»¶å¤¹\r\ncd docs/.vuepress/dist\r\ngit init\r\ngit add -A\r\ngit commit -m 'deploy'\r\n# å¼ºåˆ¶æ¨é€åˆ°æŒ‡å®šåˆ†æ”¯\r\ngit push -f git@github.com:bosens-China/Typescript-manual.git master:gh-pages\r\ncd -\r\n```\r\n\r\nè„šæœ¬æ‰§è¡Œçš„åŠŸèƒ½å¾ˆç®€å•ï¼Œæ‰§è¡Œæ„å»ºå‘½ä»¤ï¼Œä¹‹åè¿›å…¥æ„å»ºçš„æ–‡ä»¶å¤¹åˆ›å»º git ä»“åº“ä¹‹åæ¨é€ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„ä¸€ç‚¹çš„å°±æ˜¯æˆ‘ä»¬ä¼šå°†ä»»åŠ¡æ”¾ç½®åœ¨`GitHub Actions`ä¸Šï¼Œ**è€Œ git æ¨é€æ˜¯éœ€è¦æƒé™çš„**ï¼Œä¸‹é¢å°±æ¥è§£å†³å’Œè¿™ä¸ªé—®é¢˜ã€‚\r\n\r\n###  ssh-keygen\r\n\r\nè¿è¡Œ\r\n\r\n```sh\r\nssh-keygen\r\n```\r\n\r\nåˆ›å»º`id_rsa`å’Œ`id_rsa.pub`ä¸¤ä¸ªæ–‡ä»¶ï¼Œåˆ†åˆ«å¯¹åº”ç§é’¥æ–‡ä»¶å’Œå…¬é’¥æ–‡ä»¶ã€‚\r\n\r\nä¹‹åå°†`id_rsa.pub`ä¸­çš„å…¬é’¥æ·»åŠ åˆ° Github å¯¹åº”ä»“åº“çš„ Deploye keys ä¸­\r\n![xx](https://user-gold-cdn.xitu.io/2020/1/13/16f9deb5aa175f0f?w=800&h=439&f=png&s=121430)\r\nå†å°†`id_rsa`çš„ç§é’¥æ–‡ä»¶æ·»åŠ åˆ° Github å¯¹åº”ä»“åº“çš„ Secrets ä¸­ï¼Œè¿™é‡Œå°†åç§°å®šä¹‰ä¸º`ACTION_DEPLOY_KEY`ï¼Œä½ å¯ä»¥è‡ªè¡Œå®šä¹‰ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†è®©è™šæ‹Ÿæœºæ‹¥æœ‰ git ä»“åº“çš„æƒé™\r\n![xx](https://user-gold-cdn.xitu.io/2020/1/13/16f9deb52f7e5467?w=800&h=389&f=png&s=121131)\r\n\r\nOKï¼Œåˆ°è¿™ä¸€æ­¥æˆ‘ä»¬å¾—å‡†å¤‡å·¥ä½œå°±åŸºæœ¬ä¸Šå®Œæˆäº†ï¼Œä¸‹é¢å°±æ˜¯å¯¹ yml é…ç½®æ–‡ä»¶çš„ç¼–å†™äº†ã€‚\r\n\r\n### deploy.yml\r\n\r\næˆ‘ä»¬åœ¨æ ¹ç›®å½•æ–°å»ºä¸€ä¸ª`.github`çš„æ–‡ä»¶å¤¹åœ¨æ–‡ä»¶å¤¹å†…æ–°å»ºä¸€ä¸ªæ–‡ä»¶`deploy.yml`\r\n\r\n```sh\r\n# è§¦å‘çš„äº‹ä»¶\r\non:\r\n  push:\r\n    branches:\r\n      - master\r\n# å®šæ—¶ä»»åŠ¡åœ¨utcçš„9ç‚¹æ‰§è¡Œï¼Œæ¢ç®—åŒ—äº¬æ—¶é—´éœ€è¦ + 8ä¹Ÿå°±æ˜¯å‡Œæ™¨äº”ç‚¹\r\n  schedule:\r\n    - cron: \"0 21 * * *\"\r\n\r\njobs:\r\n  build:\r\n    runs-on: ubuntu-18.04\r\n\r\n    strategy:\r\n      matrix:\r\n        node-version: [12.x]\r\n\r\n    steps:\r\n      - uses: actions/checkout@v1\r\n      - name: Use Node.js ${{ matrix.node-version }}\r\n        uses: actions/setup-node@v1\r\n        with:\r\n          node-version: ${{ matrix.node-version }}\r\n      - name: git Actions\r\n        uses: srt32/git-actions@v0.0.3\r\n      - name: Setup\r\n        env:\r\n          ACTION_DEPLOY_KEY: ${{ secrets.ACTION_DEPLOY_KEY }}\r\n        run: |\r\n          mkdir -p ~/.ssh/\r\n          echo \"$ACTION_DEPLOY_KEY\" > ~/.ssh/id_rsa\r\n          chmod 600 ~/.ssh/id_rsa\r\n          ssh-keyscan github.com >> ~/.ssh/known_hosts\r\n          git config --global user.email \"ä½ çš„é‚®ç®±\"\r\n          git config --global user.name \"ä½ çš„åå­—\"\r\n          npm install\r\n          npm run updata\r\n```\r\n\r\nç®€å•è¯´ä¸‹ä¸Šé¢è„šæœ¬å¹²äº†ä»€ä¹ˆäº‹æƒ…ã€‚\r\n\r\n1. æ‹‰å–æºç ï¼ˆactions/checkout@v1ï¼‰\r\n2. å®‰è£… node å’Œ gitï¼ˆactions/setup-node@v1 å’Œ srt32/git-actions@v0.0.3ï¼‰\r\n3. å°†æˆ‘ä»¬çš„ç§åŒ™æ”¾ç½®åœ¨.ssh ç›®å½•ä¸‹ï¼ˆSetupï¼‰\r\n4. æ‰§è¡Œ`deploy.sh`è„šæœ¬ï¼Œä¸Šè¿°çš„æœ€åæŒ‡å®šçš„ npm run updata å€¼å°±æ˜¯`bash deploy.sh`\r\n\r\nåœ¨ä¸Šé¢æˆ‘æŒ‡å®šäº† on å®ƒæ˜¯è§¦å‘çš„äº‹ä»¶ï¼Œæˆ‘åœ¨è¿™é‡ŒæŒ‡å®šäº†æ¯å¤©å®šæ—¶å’Œ`master`åˆ†æ”¯æäº¤çš„æ—¶å€™æ‰§è¡Œè¿™æ®µè„šæœ¬ï¼›\r\n\r\n`jobs`åˆ™æ˜¯åŠ¨ä½œï¼ŒåŠ¨ä½œå¯ä»¥æœ‰å¾ˆå¤š build å°±æ˜¯ä¸€ä¸ªåŠ¨ä½œï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„ä¸€ç‚¹**runs-on: ubuntu-18.04**çš„å€¼æ˜¯æŒ‡å®šè™šæ‹Ÿæœºè¿™ä¸ªå­—æ®µæ˜¯å¿…å¡«çš„ï¼Œä¸å»ºè®®ä½¿ç”¨`windows`è™šæ‹Ÿæœºã€‚\r\n\r\nè‡³äºä¸Šé¢çš„`uses`å­—æ®µï¼Œè¿™ä¸ªæ˜¯å®˜æ–¹æä¾›çš„æ¨¡å—ï¼Œä½ å¯ä»¥è¿™æ ·ç†è§£ï¼Œå®ƒå¯ä»¥æ–¹ä¾¿æˆ‘ä»¬çš„æ“ä½œï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå·±ç¼–å†™è„šæœ¬ä¹‹åä¸Šä¼ åˆ° github çš„å¸‚åœºä¸Šï¼Œæ›´å¤šçš„å†…å®¹æˆ‘æ¨èåˆ°[å®˜æ–¹æ–‡æ¡£ä¸ŠæŸ¥é˜…](https://github.com/features/actions)\r\n\r\n### æ‰§è¡Œé”™è¯¯é‚®ä»¶é€šçŸ¥\r\n\r\nå› ä¸ºä¸Šé¢è¯´è¿™ä¸ªæ˜¯çˆ¬è™«çš„åº”ç”¨ï¼Œä¸ºäº†çŸ¥é“é”™è¯¯æˆ‘éœ€è¦é‚®ä»¶åŠæ—¶é€šçŸ¥æˆ‘ï¼Œè¿™é‡Œå°±ä½¿ç”¨ç¬¬ä¸‰æ–¹`nodemailer`çš„æ¨¡å—ä¸ºä¾‹ã€‚\r\n\r\n```js\r\nfunction sendMail(e) {\r\n  const mailTransport = nodemailer.createTransport({\r\n    host: \"smtp.qq.com\",\r\n    secureConnection: true,\r\n    auth: {\r\n      user: \"xxx@qq.com\",\r\n      pass: \"vbwjzecplhehibed\"\r\n    }\r\n  });\r\n  const options = {\r\n    from: \"xxxx@qq.com\",\r\n    to: \"xxx@qq.com\",\r\n    subject: \"typescript-bookå‡ºç°é”™è¯¯\",\r\n    text: e instanceof Error ? e.message : e\r\n  };\r\n  mailTransport.sendMail(options);\r\n}\r\n```\r\n\r\nç¨å¾®æ³¨æ„ä¸€ä¸‹`auth`å­—æ®µï¼Œæœ‰ä¸€ä¸ª pass è¿™ä¸ªæœ¬æ¥æ˜¯å¯†ç ä¸è¿‡å¦‚æœç›´æ¥æŠŠå¯†ç æš´éœ²å‡ºæ¥å¯èƒ½ä¼šé€ æˆä¸å®‰å…¨ï¼Œæ‰€ä»¥ä¹Ÿæ”¯æŒæˆæƒç ï¼Œå¦‚æœä½ æƒ³äº†è§£æ›´å¤šå¯ä»¥[ä»€ä¹ˆæ˜¯æˆæƒç ï¼Œå®ƒåˆæ˜¯å¦‚ä½•è®¾ç½®ï¼Ÿ](https://link.jianshu.com/?t=http%3A%2F%2Fservice.mail.qq.com%2Fcgi-bin%2Fhelp%3Fsubtype%3D1%26%26no%3D1001256%26%26id%3D28)ç‚¹å‡»äº†è§£ã€‚\r\n\r\næœ€åä½ éœ€è¦ä¸ºé‚®ç®±å¼€é€š`SMTPæœåŠ¡`ï¼Œqq é‚®ç®±ç›´æ¥ç‚¹å¼€è®¾ç½®æŸ¥æ‰¾å°±è¡Œäº†ï¼Œå…¶ä»–é‚®ç®±ä¹Ÿç±»ä¼¼ã€‚\r\nä¹‹åå†è°ƒç”¨è¿™ä¸ªå‡½æ•°å°± OK äº†ã€‚\r\n\r\n### æŸ¥çœ‹æ•ˆæœ\r\n\r\nä¸Šé¢å†™å®Œåæˆ‘ä»¬çš„å®šæ—¶å‘å¸ƒè„šæœ¬å°±å®Œæˆäº†ï¼Œå‰©ä¸‹çš„å°±æ˜¯æäº¤ä»£ç è§¦å‘é’©å­æ¥æ‰§è¡Œæˆ‘ä»¬çš„ä»»åŠ¡ï¼Œè¿™é‡Œæˆ‘ push`master`åˆ†æ”¯ä»£ç ï¼Œæ‰“å¼€ actions\r\n![xx](https://user-gold-cdn.xitu.io/2020/1/13/16f9ded560ff8454?w=1920&h=937&f=png&s=62950)\r\n\r\nå³ä¾§å°±æ˜¯æˆ‘ä»¬è„šæœ¬çš„æ‰§è¡Œæ¬¡æ•°å’ŒçŠ¶æ€äº†ï¼Œâˆš è¡¨ç¤ºæˆåŠŸï¼Œä½ å¯ä»¥è¯¦ç»†ç‚¹å¼€æŸ¥çœ‹æ›´å¤šçš„ç»†èŠ‚ï¼Œä¾‹å¦‚ä¸‹é¢çš„é”™è¯¯ï¼Œä½ å¯ä»¥å±•å¼€æŸ¥çœ‹æŠ¥é”™çš„åŸå› æ˜¯ä»€ä¹ˆï¼Œæ–¹ä¾¿å¯¹é”™è¯¯å®šä½å’Œè°ƒè¯•ï¼Œè¿™é‡Œä¸åšå±•å¼€äº†ã€‚\r\n\r\n## æœ€å\r\n\r\nè¿™ç¯‡æ–‡ç« å†™å®Œå‘ç°æ›´å¤šæ˜¯åˆ†äº«æˆ‘æ€ä¹ˆå®Œæˆçš„ï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œå¦‚æœå–œæ¬¢è¯·ç»™ä¸€ä¸‹ Star\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/49/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/49/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/64",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/64/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/64/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/64/events",
      "html_url": "https://github.com/bosens-China/blog/issues/64",
      "id": 767600367,
      "node_id": "MDU6SXNzdWU3Njc2MDAzNjc=",
      "number": 64,
      "title": "ioså±å¹•é€‚é…",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1371686610,
          "node_id": "MDU6TGFiZWwxMzcxNjg2NjEw",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/css%20%E7%9B%B8%E5%85%B3",
          "name": "css ç›¸å…³",
          "color": "42b883",
          "default": false,
          "description": "css æŠ€å·§å’ŒåŸºç¡€ä¸ºä¸»"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2020-12-15T13:34:49Z",
      "updated_at": "2021-12-21T09:51:42Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "è¿™ç¯‡æ–‡ç« ç®—æ˜¯è¿Ÿæ¥çš„æ€»ç»“ï¼Œæœ€è¿‘åšäº†ä¸€ä¸ª h5 é¡¹ç›®å†…åµŒåˆ° app é¡µé¢å†…è”ï¼Œé»˜è®¤æƒ…å†µä¸‹ app é‚£è¾¹ä¸ä¼šåšä»»ä½•å¤„ç†ï¼Œä¹Ÿå°±æ˜¯é¡¶éƒ¨å’Œåº•éƒ¨éœ€è¦é¢å¤–å¤„ç†ä¸€ä¸‹\r\n![bg](https://user-images.githubusercontent.com/39508895/102221576-4211db00-3f1d-11eb-981c-885c51309964.png)\r\n\r\n\r\n## åšæ³•\r\n\r\né»˜è®¤æƒ…å†µä¸‹ ios çš„é¡¶éƒ¨çŠ¶æ€æ æ˜¯`20px`ï¼Œå¦‚æœå­˜åœ¨åˆ˜æµ·åˆ™æ˜¯`44px`ï¼Œå½“ç„¶å®é™…å¼€å‘ä¸­ä¹Ÿä¸éœ€è¦ä½¿ç”¨ js æ¥è¿›è¡Œåˆ¤æ–­ï¼Œå› ä¸º ios11 ä¹‹åæ–°å¢äº†ä¸€ä¸ªå®‰å…¨åŒºåŸŸï¼Œç”¨æ¥å®šä¹‰å¯è§†çª—å£çš„èŒƒå›´ï¼Œå®ƒä¸€å…±æœ‰å››ä¸ªå±æ€§\r\n\r\n- safe-area-inset-leftï¼šå®‰å…¨åŒºåŸŸè·ç¦»å·¦è¾¹è¾¹ç•Œè·ç¦»\r\n- safe-area-inset-rightï¼šå®‰å…¨åŒºåŸŸè·ç¦»å³è¾¹è¾¹ç•Œè·ç¦»\r\n- safe-area-inset-topï¼šå®‰å…¨åŒºåŸŸè·ç¦»é¡¶éƒ¨è¾¹ç•Œè·ç¦»\r\n- safe-area-inset-bottomï¼šå®‰å…¨åŒºåŸŸè·ç¦»åº•éƒ¨è¾¹ç•Œè·ç¦»\r\n\r\nä½¿ç”¨æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼š\r\n\r\n```css\r\npadding-bottom: env(safe-area-inset-bottom);\r\n```\r\n\r\nåœ¨`html`æ–‡ä»¶çš„`meta`ä¸­æ·»åŠ \r\n\r\n```html\r\n   <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0,user-scalable=no, viewport-fit=cover\">\r\n```\r\n\r\n> åªæœ‰è®¾ç½®äº†viewport-fit=coverï¼Œæ‰èƒ½ä½¿ç”¨`env`ï¼Œæ³¨æ„ä¸Šé¢è¯´çš„éƒ½æ˜¯ç«–å±æƒ…å†µ\r\n\r\n\r\n\r\n#### env ç¬¬äºŒä¸ªå‚æ•°\r\n\r\nä¸Šé¢å†™æ³•çš„`env`å’Œ`constant`å…¶å®éƒ½æ”¯æŒç¬¬äºŒä¸ªå‚æ•°ï¼Œä½œä¸ºä¸æ”¯æŒç¯å¢ƒçš„åé€€ï¼Œå¯ä»¥ä½œä¸ºäº†è§£\r\nä¾‹å¦‚ï¼š\r\n``` css\r\n/* ä¸æ”¯æŒå°±å›é€€åˆ°ç¬¬äºŒä¸ªå‚æ•° */\r\npadding-bottom: env(safe-area-inset-bottom, 20px);\r\n```\r\n\r\n#### @supports é¢å¤–åˆ¤æ–­\r\n\r\nä¸ºäº†é˜²æ­¢éƒ¨åˆ†å®‰å“ä¹Ÿä½¿ç”¨`safe-area-inset-top`ä¹‹ç±»çš„å±æ€§ï¼Œå¯ä»¥æ·»åŠ `-webkit-overflow-scrolling: touch`æ¥è¿›è¡ŒåŒé‡åˆ¤æ–­\r\n\r\n> [-webkit-overflow-scrolling](https://caniuse.com/?search=-webkit-overflow-scrolling) åªæœ‰ iOS Safari æ”¯æŒ\r\n\r\n```css\r\n@supports (\r\n    (height: constant(safe-area-inset-top)) or\r\n      (height: env(safe-area-inset-top))\r\n  )\r\n  and (-webkit-overflow-scrolling: touch) {\r\n  /* ä»£ç  */\r\n}\r\n```\r\n\r\n## fixed å†™æ³•\r\n\r\n- calcï¼Œç›´æ¥æŠŠåŸæ¥å†™çš„å€¼åŠ ä¸Šå®‰å…¨åŒºåŸŸèŒƒå›´\r\n\r\n```css\r\nbottom: calc(50px (å‡è®¾å€¼) + env(safe-area-inset-bottom));\r\n```\r\n\r\n- padding: æ·»åŠ  padding çš„å†…è¾¹è·è¿›è¡Œå¡«å……\r\n\r\n```css\r\npadding-bottom: env(safe-area-inset-bottom);\r\n```\r\n\r\n## é¢å¤–æ³¨æ„ç‚¹\r\n\r\næ˜¯ä¸æ˜¯å› ä¸ºä¸Šé¢å°±è¯´å®Œäº†ï¼Œå…¶å®è¿˜æœ‰è¿˜æœ‰ä¸€ç‚¹å…¼å®¹çš„åœ°æ–¹éœ€è¦é¢å¤–å…³æ³¨\r\n\r\n> The env() function shipped in iOS 11 with the name constant(). Beginning with Safari Technology Preview 41 and the iOS 11.2 beta, constant() has been removed and replaced with env(). You can use the CSS fallback mechanism to support both versions, if necessary, but should prefer env() going forward.\r\n\r\nç¿»è¯‘è¿‡æ¥å°±æ˜¯`ios`11.2 ä¹‹åä¸å†æ”¯æŒ`constant`è€Œæ˜¯ä½¿ç”¨`env`ï¼Œæ‰€ä»¥ç”Ÿäº§è¿‡ç¨‹ä¸­å¯ä»¥ä½¿ç”¨ä¸‹é¢å†™æ³•åšå…¼å®¹\r\n\r\n```css\r\npadding-bottom: constant(safe-area-inset-bottom);\r\n/* å…¼å®¹ iOS < 11.2 */\r\npadding-bottom: env(safe-area-inset-bottom);\r\n/* å…¼å®¹ iOS >= 11.2 */\r\n```\r\n\r\n## æœ€å\r\n\r\nå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©å¯ä»¥ç‚¹ä¸€ä¸‹`star`\r\n\r\nå‚è€ƒæ–‡ç« \r\n\r\n- [ç½‘é¡µé€‚é… iPhoneXï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•](https://aotu.io/notes/2017/11/27/iphonex/index.html)\r\n\r\n- [IOSåˆ˜æµ·å±H5 CSSé€‚é…](https://juejin.cn/post/6844903974491930637#heading-4)\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/64/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/64/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/36",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/36/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/36/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/36/events",
      "html_url": "https://github.com/bosens-China/blog/issues/36",
      "id": 522570348,
      "node_id": "MDU6SXNzdWU1MjI1NzAzNDg=",
      "number": 36,
      "title": "æ¼«è°ˆç³»ç»Ÿæƒé™è®¾è®¡",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1371686608,
          "node_id": "MDU6TGFiZWwxMzcxNjg2NjA4",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%BC%AB%E8%B0%88%E7%B3%BB%E5%88%97",
          "name": "æ¼«è°ˆç³»åˆ—",
          "color": "e7f3ee",
          "default": false,
          "description": "æµ…è°ˆç±»æ–‡ç« "
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2019-11-14T01:35:53Z",
      "updated_at": "2021-12-21T09:48:35Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "> è¿™é‡Œä¸ä¼šä»‹ç»å…·ä½“å®ç°çš„æ–¹å¼ï¼Œè¦æ ¹æ®å…¬å¸çš„ä¸šåŠ¡æ¥è¿›è¡Œè°ƒæ•´ï¼Œä¸‹é¢å°±èŠä¸€èŠåŸºæœ¬è®¾è®¡çš„æ€è·¯ã€‚\r\n\r\næƒé™çš„è®¾è®¡å¯¹äºä¸€ä¸ªåå°æ¥è¯´è‡³å…³é‡è¦ï¼Œä¸è¿‡ä¹Ÿè¦æ ¹æ®æƒ…å†µæ¥é€‰æ‹©ï¼Œæ¯”å¦‚æˆ‘ä»¬ä¸ä¼šåœ¨ä¸€ä¸ªåšå®¢æˆ–è€…ä¸ªäººç½‘ç«™çš„åå°ä¸­å†™ä¸Šæƒé™æ§åˆ¶ï¼Œå› ä¸ºè¿™æ˜¯æ²¡æœ‰å¿…è¦çš„ï¼Œä½†æ˜¯å¯¹äºé¢å‘ä¸åŒç”¨æˆ·çš„äº§å“æ¥è¯´å°±å¾ˆæœ‰å¿…è¦äº†ï¼Œä¸¾ä¸ªä¾‹å­æ¥è¯´ï¼Œæ»´æ»´æ‰“è½¦çš„ä¹˜å®¢å’Œè½¦ä¸»è‚¯å®šæ˜¯ä¸¤ä¸ªä¸åŒçš„ç”¨æˆ·äº§å“ï¼Œå¦‚ä½•ç®¡ç†é‡Œé¢çš„æ•°æ®å°±éœ€è¦å¼•ç”¨æƒé™è®¾è®¡çš„åŠŸèƒ½äº†ã€‚\r\n\r\næƒé™è®¾è®¡å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¢åŠ ä¿¡æ¯å®‰å…¨ã€ä¿è¯é¡µé¢çš„ç®€æ´ä¸è‡³äºå‡ºç°è¯¯æ“ä½œçš„äº‹æƒ…ï¼Œä¸‹é¢å°±æ¥è¯´ä¸‹åŸºæœ¬çš„ç»„æˆ\r\n\r\n## ç»„æˆ\r\n\r\n- æƒé™\r\n  ![](https://user-gold-cdn.xitu.io/2019/11/14/16e6786c0af135b6?w=1080&h=638&f=webp&s=9744)\r\n  æƒé™è¿™å—å¯ä»¥åˆ†ä¸ºé¡µé¢æƒé™ã€åŠŸèƒ½æƒé™å’Œæ•°æ®æƒé™ï¼Œé¡µé¢æƒé™å°±æ˜¯æŒ‡æ˜¯å¦èƒ½è®¿é—®å½“å‰é¡µé¢ï¼ŒåŠŸèƒ½æƒé™å¯¹åº”çš„åˆ™æ˜¯ï¼ˆå¢åŠ ã€åˆ é™¤ã€ä¿®æ”¹ç­‰ï¼‰ï¼Œè€Œæ•°æ®æƒé™åˆ™æ˜¯å¯ä»¥è®¿é—®çš„æ•°æ®èŒƒå›´ã€‚\r\n\r\n- è§’è‰²\r\n\r\n  åœ¨ä¸€ä¸ªæˆç†Ÿçš„åå°è®¾è®¡ä¸­å¿…ç„¶è¦å‡ºç°è§’è‰²ï¼Œè¿™æ˜¯ä¸ºäº†é¿å…æ¯æ–°å¢ä¸€ä¸ªç”¨æˆ·å°±è¿˜è¦é‡æ–°ä¸ºä»–å‹¾é€‰ä¸€éæƒé™ï¼Œç”±è§’è‰²èµ‹å€¼ç»™ç”¨æˆ·æƒé™ï¼Œè§’è‰²è¿™å±‚å°±ç›¸å½“äºä¸€ä¸ªä¸­é—´å±‚ï¼ŒåŒæ—¶ä¹Ÿæ–¹ä¾¿ç»´æŠ¤ã€‚\r\n\r\n- ç”¨æˆ·\r\n\r\n  æ¯ä¸ªç”¨æˆ·å¯¹åº”ä¸€ä¸ªè´¦å·ï¼Œåœ¨é»˜è®¤çŠ¶æ€ä¸‹ä¼šç»™äºˆç”¨æˆ·ä¸€ä¸ªæœ€å°çš„æ“ä½œæƒé™ï¼Œæƒé™çš„èµ‹å€¼ç”±è§’è‰²ç»™äºˆï¼Œå¤šä¸ªè§’è‰²çš„æƒé™æ˜¯å¯ä»¥å åŠ çš„ã€‚\r\n\r\n## å»¶ä¼¸\r\n\r\nä¸Šé¢ä»‹ç»çš„å…¶å®å°±æ˜¯`RBAC`æ¨¡å‹çš„ç®€å•æ¦‚å¿µï¼Œåœ¨å®é™…å¼€å‘ä¸­è§‰å¾—è‡³å°‘æœ‰ä»¥ä¸‹å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š\r\n\r\n- admin\r\n\r\nåœ¨å¼€å‘å®Œæˆåéœ€è¦åœ¨è§’è‰²é¢„ç•™ä¸€ä¸ª admin æˆ–è€…è¶…çº§ç®¡ç†å‘˜ï¼Œæ–¹ä¾¿å¼€å‘äººå‘˜çš„ç»´æŠ¤\r\n\r\n- æƒé™çš„ä¼˜å…ˆçº§\r\n\r\nä¸Šé¢ä»‹ç»äº†æƒé™çš„ç»„æˆï¼Œä½†æ˜¯é¡µé¢çš„æƒé™åº”å½“æ˜¯å¤§äºæ“ä½œçš„æƒé™ï¼Œåªæœ‰é¡µé¢çš„æƒé™å¯è§ï¼ŒåŠŸèƒ½çš„æƒé™æ‰æ˜¯æœ‰æ„ä¹‰çš„\r\n\r\n- tips\r\n\r\næ— æƒé™è®¿é—®é¡µé¢ã€é¡µé¢ä¸å­˜åœ¨ã€æœåŠ¡å™¨å‘ç”Ÿé”™è¯¯ç­‰æ–¹é¢çš„æç¤º\r\n\r\n## æœ€å\r\n\r\næœ€åè¯´ä¸€ä¸‹å‰ç«¯å¯¹`tips`è¿™å—çš„å¤„ç†\r\n403ã€404ã€500 çš„å¤„ç†æ€è·¯\r\n\r\n##### 500\r\n\r\n500 çš„å¤„ç†å¯ä»¥é€šè¿‡`axions`çš„æ‹¦æˆªå™¨æ¥å®ç°ï¼Œç°åœ¨åç«¯é»˜è®¤è¿”å›çš„åŸºæœ¬æ ¼å¼éƒ½æ˜¯\r\n\r\n```js\r\n{\r\n  // çŠ¶æ€ç \r\n  status: 200,\r\n  data: {},\r\n  // ...\r\n  }\r\n```\r\n\r\næ‰€ä»¥åˆ¤æ–­æœåŠ¡å™¨å‘ç”Ÿé”™è¯¯ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡\r\n\r\n```js\r\n// æ·»åŠ è¯·æ±‚æ‹¦æˆªå™¨\r\naxios.interceptors.request.use(\r\n  function(config) {\r\n    // åœ¨å‘é€è¯·æ±‚ä¹‹å‰åšäº›ä»€ä¹ˆ\r\n    return config;\r\n  },\r\n  function(error) {\r\n    // å¯¹è¯·æ±‚é”™è¯¯åšäº›ä»€ä¹ˆï¼Œè¿™ä¸€æ­¥å¯ä»¥ç›´æ¥è¿”å›æœåŠ¡å™¨å‘ç”Ÿé”™è¯¯ï¼Œæ–¹ä¾¿æç¤ºä¿¡æ¯çš„å®šåˆ¶\r\n    return Promise.reject(`æœåŠ¡å™¨å‘ç”Ÿé”™è¯¯`);\r\n  }\r\n);\r\n```\r\n\r\n##### 404\r\n\r\n404 çš„å®ç°å¯ä»¥é€šè¿‡`router`æ¥å®ç°ï¼Œè¿™é‡Œæˆ‘ç”¨çš„æ˜¯`vue router`å°±ä»¥è¿™ä¸ªä¸¾ä¾‹ï¼Œå‡è®¾æœ‰ä¸€ç»„è·¯ç”±ä¸º\r\n\r\n```js\r\nconst router = new VueRouter({\r\n  routes: [\r\n    {\r\n      path: \"/user\",\r\n      component: User,\r\n      children: [\r\n        {\r\n          path: \"profile\",\r\n          component: UserProfile\r\n        },\r\n        {\r\n          path: \"posts\",\r\n          component: UserPosts\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      path: \"/sign\",\r\n      component: sign\r\n    }\r\n  ]\r\n});\r\n```\r\n\r\né‚£æˆ‘ä»¬å°±é€šè¿‡é€’å½’å°†æ‰€æœ‰è·¯ç”±æ‹¼æˆä¸€ç»´æ•°ç»„ï¼ˆæ³¨æ„å¯¹æ¯”çš„æ¡ä»¶ï¼Œè¿™é‡Œæˆ‘å¯¹æ¯”çš„æ˜¯ path æ‰€ä»¥åœ¨é€’å½’è¿‡ç¨‹ä¸­è¦å°†çˆ¶ path ç›¸åŠ ï¼‰ï¼Œå…·ä½“çš„é€’å½’å®ç°å–å†³äºä½ çš„å¸¸è§ï¼Œè¿™é‡Œä¸åšæ¼”ç¤ºï¼Œä¹‹åå¯¹æ¯”è®¿é—®çš„è·¯å¾„å­˜ä¸å­˜åœ¨è·¯ç”±ä¿¡æ¯ä¸­ï¼Œä¸å­˜åœ¨åˆ™è¯´æ˜é¡µé¢ä¸å­˜åœ¨è¿”å›`404`\r\n\r\n##### 403\r\n\r\n403 çš„å®ç°éœ€è¦é…åˆåç«¯æ¥å®ç°ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¼šè¯·æ±‚ç”¨æˆ·çš„æ“ä½œæƒé™ä¼šè¿”å›å½“å‰ç”¨æˆ·æƒé™æ‰€èƒ½æ“ä½œçš„èœå•ï¼Œä¹‹åå°†èƒ½è®¿é—®çš„èœå•å’Œè·¯ç”±ä¿¡æ¯å¯¹æ¯”ï¼Œå¦‚æœè®¿é—®çš„è·¯å¾„åœ¨è·¯ç”±ä¿¡æ¯ä¸­ä½†æ˜¯ä¸åœ¨ç”¨æˆ·è¿”å›çš„èœå•è¯´æ˜æ²¡æœ‰é¡µé¢è®¿é—®çš„æƒé™ã€‚\r\n\r\næœ€åè¯´ä¸‹ä¸ºä»€ä¹ˆæ²¡æœ‰ç”¨`*`çš„åŸå› ï¼Œå› ä¸ºä¸å¤ªå¥½å®šåˆ¶ï¼Œåœ¨é»˜è®¤çŠ¶æ€ä¸‹ä»¥`'/'`çš„å½¢å¼è®¿é—®æˆ‘ä»¬è¦ç»™äºˆä¸€ä¸ªç”¨æˆ·èœå•çš„ç¬¬ä¸€é¡¹ï¼Œä½†æ˜¯å¦‚æœ`'/'`ä¸å­˜åœ¨è·¯ç”±ä¸­æˆ‘ä»¬è¿˜è¦å†™é¢å¤–çš„åˆ¤æ–­ï¼Œä¸å¦‚å…¨éƒ¨è‡ªå·±æ¥è‡ªè¡Œå¤„ç†äº†ã€‚\r\n\r\n## å‚è€ƒ\r\n\r\n1. [è§’è‰²æƒé™è®¾è®¡çš„ 100 ç§è§£æ³•](<https://mp.weixin.qq.com/s?__biz=MzI1ODY0NTg0MA==&mid=2247484799&idx=1&sn=5467e1452356e36607d938752805eb7d&chksm=ea044f40dd73c6563e72b1f34d0c27a23d06d5bcd80255568a9caa359ef2d03cd89713f0449b&scene=0&key=7fa4b6bcf3a05ff6a03f1d892329a3a1fcb4a9dd572857d0b82f72ec1386dfb5bd66a733158b657f4524063e1b5b4ade5442b1f23c89adbc9cfa818a68f64fbb4e725cc4baa55d048efe25d963e9e391&ascene=0&uin=MTAyMzI5NDA0Mw%3D%3D&devicetype=iMac+MacBookPro11%2C4+OSX+OSX+10.11.6+build(15G22010)&version=12020010&nettype=WIFI&lang=en&fontScale=100&pass_ticket=GR%2BJaO%2FEpgB4z%2BZuVHJsrM8QYhyiZAEBCQll6nnnN5CpbcQ%2FhZ5WoCr%2Fxr5QWiOL>)\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/36/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/36/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/42",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/42/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/42/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/42/events",
      "html_url": "https://github.com/bosens-China/blog/issues/42",
      "id": 542405907,
      "node_id": "MDU6SXNzdWU1NDI0MDU5MDc=",
      "number": 42,
      "title": "IntersectionObserverå®ç°å›¾ç‰‡æ‡’åŠ è½½",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1580833992,
          "node_id": "MDU6TGFiZWwxNTgwODMzOTky",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%AE%9E%E9%AA%8C%E6%80%A7%20API",
          "name": "å®éªŒæ€§ API",
          "color": "7aa9d6",
          "default": false,
          "description": "è¿˜æœªå®šç¨¿çš„API"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2019-12-26T01:53:33Z",
      "updated_at": "2021-12-21T09:48:12Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "> ä¼ ç»Ÿçš„å›¾ç‰‡æ‡’åŠ è½½å®ç°æ€è·¯æ˜¯åˆ¤æ–­å›¾ç‰‡çš„ top åŒºåŸŸæ˜¯å¦å°äºçˆ¶çº§åŒºåŸŸï¼Œä¸”è‡ªèº«é«˜åº¦åŠ ä¸Š top å¤§äº 0ï¼Œ\r\n> ä¾‹å¦‚\r\n\r\n```js\r\n// å…ƒç´ æ˜¯å¦å¯è§†\r\nconst viewVisible = el => {\r\n  const { top, width, height, left } = el.getBoundingClientRect();\r\n  const w = window.innerWidth || document.documentElement.clientWidth;\r\n  const h = window.innerHeight || document.documentElement.clientHeight;\r\n  return top < h && top + height >= 0 && left < w && left + width >= 0;\r\n};\r\n```\r\n\r\n> ä¸è¿‡è¿™æ ·å†™çš„è¯æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯æˆ‘ä»¬ç›‘å¬çš„äº‹ä»¶ä¼šé‡å¤å¤šæ¬¡è§¦å‘ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦å†™ä¸€ä¸ªèŠ‚æµæˆ–è€…é˜²æŠ–å‡½æ•°ï¼Œä¸è¿‡ä½¿ç”¨`IntersectionObserver`æˆ‘ä»¬å¯ä»¥è½»æ¾å®ç°ï¼Œé¦–å…ˆçœ‹ä¸‹å…¼å®¹æ€§\r\n\r\n>![IntersectionObserverå…¼å®¹æ€§](https://user-images.githubusercontent.com/39508895/146864557-35c7c4d6-600c-4379-a433-1d38225500f5.png)å¯ä»¥çœ‹åˆ°å·®å¼ºäººæ„ï¼Œä¸è¿‡å¥½åœ¨å¯ä»¥[polyfill](https://github.com/w3c/IntersectionObserver/tree/master/polyfill)ï¼Œä¸‹é¢å°±ä»‹ç»ä½¿ç”¨\r\n\r\n## ä½¿ç”¨æ–¹æ³•\r\n\r\n`IntersectionObserver`ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•\r\n\r\n```js\r\nvar observer = new IntersectionObserver(callback[, options]);\r\n```\r\n\r\n`callback`æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ª IntersectionObserverEntry å¯¹è±¡åˆ—è¡¨(list)ï¼Œä»¥åŠè§¦å‘ IntersectionObserverEntry çš„å®ä¾‹\r\n\r\n| æ–¹æ³•         | è¯´æ˜                                           |\r\n| ------------ | ---------------------------------------------- |\r\n| disconnect() | ä½¿ IntersectionObserver å¯¹è±¡åœæ­¢ç›‘å¬å·¥ä½œã€‚     |\r\n| observe()    | ä½¿ IntersectionObserver å¼€å§‹ç›‘å¬ä¸€ä¸ªç›®æ ‡å…ƒç´ ã€‚ |\r\n| unobserve()  | ä½¿ IntersectionObserver åœæ­¢ç›‘å¬ç‰¹å®šç›®æ ‡å…ƒç´ ã€‚ |\r\n\r\n**æ³¨æ„**\r\n`callback`çš„å›è°ƒå‡½æ•°ä¼šè§¦å‘ä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡æ˜¯å…ƒç´ å¼€å§‹å¯è§ï¼Œç¬¬äºŒæ¬¡æ˜¯å…ƒç´ ä¸å¯è§çš„æ—¶å€™ã€‚\r\n\r\n## é€‰é¡¹(options)\r\n\r\næ³¨æ„å¯é€‰å±æ€§\r\n\r\n| å±æ€§       | è¯´æ˜                                                                                                                                                                                           |\r\n| ---------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\r\n| root       | ç›‘å¬å…ƒç´ çš„ç¥–å…ˆå…ƒç´  Element å¯¹è±¡                                                                                                                                                                |\r\n| rootMargin | ä¸€ä¸ªåœ¨è®¡ç®—äº¤å‰å€¼æ—¶æ·»åŠ è‡³æ ¹çš„è¾¹ç•Œç›’(bounding_box)ä¸­çš„ä¸€ç»„åç§»é‡ï¼Œç±»å‹ä¸ºå­—ç¬¦ä¸²ï¼Œå¯ä»¥æœ‰æ•ˆçš„ç¼©å°æˆ–æ‰©å¤§æ ¹çš„åˆ¤å®šèŒƒå›´ä»è€Œæ»¡è¶³è®¡ç®—éœ€è¦ã€‚è¯­æ³•å¤§è‡´å’Œ CSS ä¸­çš„ margin å±æ€§ç­‰åŒï¼Œé»˜è®¤å€¼æ˜¯\"0px 0px 0px 0px\" |\r\n| threshold  | è§„å®šäº†ä¸€ä¸ªç›‘å¬ç›®æ ‡ä¸è¾¹ç•Œç›’äº¤å‰åŒºåŸŸçš„æ¯”ä¾‹å€¼ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå…·ä½“çš„æ•°å€¼æˆ–æ˜¯ä¸€ç»„ 0.0 åˆ° 1.0 ä¹‹é—´çš„æ•°ç»„ã€‚è‹¥æŒ‡å®šå€¼ä¸º 0.0ï¼Œåˆ™æ„å‘³ç€ç›‘å¬å…ƒç´ å³ä½¿ä¸æ ¹æœ‰ 1 åƒç´ äº¤å‰ï¼Œæ­¤å…ƒç´ ä¹Ÿä¼šè¢«è§†ä¸ºå¯è§.                   |\r\n\r\n## å®ä¾‹\r\n\r\n```js\r\nconst dom = new IntersectionObserver(a => {\r\n  console.log(a);\r\n});\r\nArray.from(document.querySelectorAll(\"img\")).forEach(f => {\r\n  dom.observe(f);\r\n});\r\n```\r\n\r\nè¿”å›çš„ a æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‡Œé¢å­˜æ”¾ç€ä¸€äº›å…ƒç´ ä¿¡æ¯ï¼Œä¸‹é¢æ‰€æœ‰å±æ€§éƒ½æ˜¯åªè¯»\r\n\r\n| å±æ€§               | è¯´æ˜                                                                                                                                                                                                                                |\r\n| ------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\r\n| boundingClientRect | è¿”å›åŒ…å«ç›®æ ‡å…ƒç´ çš„è¾¹ç•Œä¿¡æ¯çš„ DOMRectReadOnly. è¾¹ç•Œçš„è®¡ç®—æ–¹å¼ä¸ Element.getBoundingClientRect() ç›¸åŒ.                                                                                                                                |\r\n| intersectionRatio  | è¿”å› intersectionRect ä¸ boundingClientRect çš„æ¯”ä¾‹å€¼,**å¦‚æœå¤§äº 0 åˆ™è¡¨ç¤ºå¯è§ï¼Œå®Œå…¨å¯è§ä¸º 1**.                                                                                                                                       |\r\n| intersectionRect   | è¿”å›ä¸€ä¸ª DOMRectReadOnly ç”¨æ¥æè¿°æ ¹å’Œç›®æ ‡å…ƒç´ çš„ç›¸äº¤åŒºåŸŸ.                                                                                                                                                                            |\r\n| isIntersecting     | è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼, å¦‚æœç›®æ ‡å…ƒç´ ä¸äº¤å‰åŒºåŸŸè§‚å¯Ÿè€…å¯¹è±¡(intersection observer) çš„æ ¹ç›¸äº¤ï¼Œåˆ™è¿”å› true .å¦‚æœè¿”å› true, åˆ™ IntersectionObserverEntry æè¿°äº†å˜æ¢åˆ°äº¤å‰æ—¶çš„çŠ¶æ€; å¦‚æœè¿”å› false, é‚£ä¹ˆå¯ä»¥ç”±æ­¤åˆ¤æ–­,å˜æ¢æ˜¯ä»äº¤å‰çŠ¶æ€åˆ°éäº¤å‰çŠ¶æ€. |\r\n| rootBounds         | è¿”å›ä¸€ä¸ª DOMRectReadOnly ç”¨æ¥æè¿°äº¤å‰åŒºåŸŸè§‚å¯Ÿè€…(intersection observer)ä¸­çš„æ ¹.                                                                                                                                                       |\r\n| target             | ä¸æ ¹å‡ºç°ç›¸äº¤åŒºåŸŸæ”¹å˜çš„å…ƒç´  (Element).                                                                                                                                                                                               |\r\n| time               | è¿”å›ä¸€ä¸ªè®°å½•ä» IntersectionObserver çš„æ—¶é—´åŸç‚¹(time origin)åˆ°äº¤å‰è¢«è§¦å‘çš„æ—¶é—´çš„æ—¶é—´æˆ³(DOMHighResTimeStamp).                                                                                                                         |\r\n\r\n## å®ç°\r\n\r\nä¸Šé¢å·²ç»å®ç°åˆ¤æ–­å…ƒç´ æ˜¯å¦å¯è§ï¼Œä¸‹é¢æˆ‘ä»¬åªéœ€è¦æ ¹æ®ä¸Šé¢æ€è·¯å®Œå–„ä¸€ä¸‹å³å¯å¼€å‘ä¸€ä¸ªå›¾ç‰‡æ‡’åŠ è½½çš„ç±»ï¼Œé¦–å…ˆå…ˆè¯´æ˜ä¸€ä¸‹å›¾ç‰‡æ‡’åŠ è½½ä¸€èˆ¬æƒ…å†µä¸‹ä¸ºäº†é˜²æ­¢å›¾ç‰‡`src`ä¸ºç©ºæ ·å¼ä¸ç»Ÿä¸€å’ŒåŠ è½½å›¾ç‰‡çªç„¶æ‹‰ä¼¸ç©ºé—´ï¼Œä¼šç»™é»˜è®¤çš„å›¾ç‰‡è®¾ç½®ä¸€ä¸ªå ä½å›¾ç‰‡ï¼Œæˆ–è€…ç»™å®šä¸€ä¸ªæ ·å¼\r\n\r\n```css\r\nimg {\r\n  width: 400px;\r\n  height: 400px;\r\n  display: inline-block;\r\n}\r\n```\r\n\r\n```html\r\n<img />\r\n```\r\n\r\nä¸Šé¢ç»™äº†ä¸€ä¸ªç®€å•çš„æ¼”ç¤ºï¼Œæ³¨æ„ `src` å±æ€§ä¸è¦å†™ï¼Œå› ä¸ºå³ä½¿ä¸ºç©ºä¹Ÿè¿˜ä¼šåŠ è½½ã€‚ é¡ºä¾¿è¯´ä¸‹ç«ç‹æµè§ˆå™¨å¦‚æœ img æ ‡ç­¾æ²¡æœ‰å…¶ä»–å±æ€§çš„è¯ä¼šç†è§£æˆå†…è”å…ƒç´ ï¼Œå°±æ˜¯ span æ ‡ç­¾ä¸€æ ·çš„å†…è”å…ƒç´ ï¼Œæ‰€ä»¥å¦‚æœä¸æ”¾ç½®å ä½å›¾ç‰‡çš„è¯æ¨èé‡ç½® img ä¸º `inline-block` ç„¶åè®¾ç½®å›ºå®šå®½é«˜ã€‚\r\n\r\nä¹‹åå°±æ˜¯ç»™å›¾ç‰‡åŠ¨æ€æ·»åŠ  src å±æ€§ï¼Œæ¯”è¾ƒæ¨èçš„æ˜¯`data-`çš„è‡ªå®šä¹‰å±æ€§ï¼Œè®¸å¤šåº“ç”¨çš„ä¹Ÿæ˜¯è¿™ä¸ªæ–¹æ³•ï¼Œæ›¿æ¢å®Œæˆä¹‹åå°†å›¾ç‰‡å…ƒç´ ä»`IntersectionObserver`ç§»é™¤ã€‚\r\n\r\n## æœ€å\r\n\r\n`IntersectionObserver`ä½¿ç”¨çš„æ˜¯å¼‚æ­¥çš„æ–¹å¼ï¼Œå¯ä»¥ä¸ç”¨æ‹…å¿ƒæ€§èƒ½é—®é¢˜\r\n\r\n- å‚è€ƒ\r\n  [IntersectionObserver MDN](https://developer.mozilla.org/zh-CN/docs/Web/API/IntersectionObserver/IntersectionObserver)\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/42/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/42/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/43",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/43/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/43/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/43/events",
      "html_url": "https://github.com/bosens-China/blog/issues/43",
      "id": 544505720,
      "node_id": "MDU6SXNzdWU1NDQ1MDU3MjA=",
      "number": 43,
      "title": "ä»formè¡¨å•æ¥çœ‹ç­–ç•¥æ¨¡å¼",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1740561541,
          "node_id": "MDU6TGFiZWwxNzQwNTYxNTQx",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F",
          "name": "è®¾è®¡æ¨¡å¼",
          "color": "d1a540",
          "default": false,
          "description": "è®¾è®¡æ¨¡å¼åœ¨JavaScriptçš„å®ç°"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2020-01-02T09:36:08Z",
      "updated_at": "2021-12-21T09:47:57Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "### å‰è¨€\r\n\r\nä¹‹å‰å†™ç¨‹åºçš„æ—¶å€™ä¸ºäº†å¿«é€Ÿå¼€å‘å†™äº†è®¸å¤š`if`ã€`else if`çš„è¯­å¥ï¼Œå½“æ—¶å¼€å‘å€’æ˜¯æŒºçˆ½çš„ï¼Œäº‹åç»´æŠ¤çš„æ—¶å€™æƒ³éª‚äººï¼Œä¸ºäº†ä¸å‘è‡ªå·±å’Œå…¶ä»–å°ä¼™ä¼´ï¼Œä¸‹é¢ä»é›¶å¼€å§‹ç”¨ä¸€ä¸ªåŸºç¡€è¡¨å• + ç­–ç•¥æ¨¡å¼æ¸…é™¤`if`åˆ†æ”¯è¯­å¥\r\n\r\n```html\r\n<form class=\"cs-form\">\r\n  <label>\r\n    <span>è´¦å·ï¼š</span>\r\n    <input name=\"account\" type=\"text\" />\r\n  </label>\r\n  <label>\r\n    <span>å¯†ç ï¼š</span>\r\n    <input name=\"password\" type=\"password\" />\r\n  </label>\r\n  <label>\r\n    <span>æ‰‹æœºå·ï¼š</span>\r\n    <input name=\"mobile\" type=\"number\" />\r\n  </label>\r\n  <button class=\"submit\" type=\"submit\">ç™»å½•</button>\r\n</form>\r\n```\r\n\r\nä¸Šé¢æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„è¡¨å•å…ƒç´ ï¼Œé‡Œé¢æœ‰è´¦å·å’Œå¯†ç ä»¥åŠæ‰‹æœºå·ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æäº¤ä¹‹å‰å¯¹ä»–è¿›è¡Œä¸€äº›æ ¡éªŒï¼Œè¿™é‡Œé»˜è®¤çš„è§„åˆ™æ˜¯è´¦å·å’Œå¯†ç ä¸èƒ½ä¸ºç©ºï¼Œæ‰‹æœºå·çš„é•¿åº¦å¿…é¡»æ˜¯ 11 çš„çº¯æ•°å­—ã€‚\r\n\r\n### ç¬¬ä¸€ç‰ˆ\r\n\r\n```ts\r\ninterface Iform {\r\n  [k: string]: any;\r\n  account: HTMLInputElement;\r\n  password: HTMLInputElement;\r\n  mobile: HTMLInputElement;\r\n}\r\nconst form = document.querySelector(\".cs-form\") as HTMLFormElement;\r\n\r\nform.addEventListener(\"submit\", function(e) {\r\n  e.preventDefault();\r\n  const { account, password, mobile } = (form as unknown) as Iform;\r\n  if (!account.value) {\r\n    // æç¤º\r\n    alert(\"è¯·è¾“å…¥è´¦å·\");\r\n    return false;\r\n  }\r\n  if (!password.value) {\r\n    // æç¤º\r\n    alert(\"è¯·è¾“å…¥å¯†ç \");\r\n    return false;\r\n  }\r\n  if (!/\\d{11}/.test(mobile.value)) {\r\n    // æç¤º\r\n    alert(\"è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·\");\r\n    return false;\r\n  }\r\n  return false;\r\n});\r\n```\r\n\r\næ ¹æ®ä¸Šé¢çš„è¦æ±‚ï¼Œæˆ‘ä»¬å®ç°äº†ç¬¬ä¸€ç‰ˆä»£ç ï¼Œä»ä»£ç çš„å®ç°çœ‹æ¯«æ— ç–‘é—®æ˜¯æ­£ç¡®çš„ï¼Œä¸ºäº†å¯¹æ¯”ä¸‹é¢å†ç”¨ç­–ç•¥æ¨¡å¼å®ç°ä»¥ä¸‹ä¸Šè¿°çš„åŠŸèƒ½\r\n\r\n### ç¬¬äºŒç‰ˆ\r\n\r\n```ts\r\ninterface Iform {\r\n  [k: string]: any;\r\n  account: HTMLInputElement;\r\n  password: HTMLInputElement;\r\n  mobile: HTMLInputElement;\r\n}\r\n\r\ninterface Ilist {\r\n  value: string;\r\n  type: name;\r\n  msg: string;\r\n}\r\n\r\ntype name = keyof typeof rule;\r\nconst rule = {\r\n  account(value: string, msg: string) {\r\n    if (!value) {\r\n      return msg;\r\n    }\r\n  },\r\n  password(value: string, msg: string) {\r\n    if (!value) {\r\n      return msg;\r\n    }\r\n  },\r\n  mobile(value: string, msg: string) {\r\n    if (!/\\d{11}/.test(value)) {\r\n      return msg;\r\n    }\r\n  }\r\n};\r\nclass Verification {\r\n  private list: Ilist[] = [];\r\n  public message: string;\r\n  add<T extends { value: string }>(dom: T, type: name, msg: string) {\r\n    this.list.push({\r\n      value: dom.value,\r\n      type: type,\r\n      msg: msg\r\n    });\r\n  }\r\n  start(): boolean {\r\n    for (let i = 0; i < this.list.length; i++) {\r\n      const { value, type, msg } = this.list[i];\r\n      const fn = rule[type](value, msg);\r\n      if (fn) {\r\n        this.message = msg;\r\n        return false;\r\n      }\r\n    }\r\n    this.message = \"\";\r\n    return true;\r\n  }\r\n}\r\n\r\nconst form = document.querySelector(\".cs-form\") as HTMLFormElement;\r\n\r\nform.addEventListener(\"submit\", function(e) {\r\n  e.preventDefault();\r\n  const { account, password, mobile } = (form as unknown) as Iform;\r\n\r\n  const ruleSet = new Verification();\r\n  ruleSet.add(account, \"account\", \"è¯·è¾“å…¥è´¦å·\");\r\n  ruleSet.add(password, \"password\", \"è¯·è¾“å…¥å¯†ç \");\r\n  ruleSet.add(mobile, \"mobile\", \"è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·\");\r\n\r\n  if (!ruleSet.start()) {\r\n    // æç¤º\r\n    alert(ruleSet.message);\r\n    return false;\r\n  }\r\n  return false;\r\n});\r\n```\r\n\r\nä»ä»£ç é‡çœ‹æ¯”ç¬¬ä¸€ç‰ˆå¤šå‡ºäº†å¾ˆå¤šè¯­å¥ï¼Œè¿™é‡Œåšæ³•æ˜¯æŠŠä»£ç çš„è§„åˆ™æ”¾ç½®åœ¨ rule å¯¹è±¡ä¸­ï¼Œå› ä¸º javascript æœ¬èº«å°±æ˜¯è¿™ä¹ˆçµæ´»ä¸éœ€è¦åœ¨ä½¿ç”¨ä¼ ç»Ÿè¯­è¨€çš„ class æ¥å®ç°äº†ï¼Œå‰©ä¸‹çš„å°±æ˜¯æ–°å»ºä¸€ä¸ªæ ¡éªŒç±»ï¼Œæ–°å¢æ ¡éªŒè§„åˆ™æœ€åæ ¡éªŒï¼Œå½“ç„¶ç°åœ¨éªŒè¯è§„åˆ™è¿˜æ˜¯æ¯”è¾ƒå°‘ï¼Œçœ‹ä¸å‡ºç­–ç•¥æ¨¡å¼çš„ä¼˜ç‚¹ã€‚\r\n\r\nä¸‹é¢å†æ¥æ–°å¢ä¸€ä¸ªè¦æ±‚ï¼Œå¯†ç é•¿åº¦ä¸èƒ½å°äº 6 ä½ï¼Œåœ¨ç¬¬ä¸€ç‰ˆä¸­æˆ‘ä»¬è¦ç´§æ¥åœ¨å¯†ç ä¸èƒ½ä¸ºç©ºçš„æ ¡éªŒä¹‹åå†™ï¼Œå†æ¥çœ‹ä¸‹ç­–ç•¥æ¨¡å¼æ–°å¢è¿™ä¸ªéªŒè¯ä¼šæ–°å¢å“ªäº›ä»£ç ã€‚\r\n\r\n```ts\r\ninterface Iform {\r\n  [k: string]: any;\r\n  account: HTMLInputElement;\r\n  password: HTMLInputElement;\r\n  mobile: HTMLInputElement;\r\n}\r\n\r\ninterface Ilist {\r\n  value: string;\r\n  type: name;\r\n  msg: string;\r\n}\r\n\r\ntype name = keyof typeof rule;\r\nconst rule = {\r\n  account(value: string, msg: string) {\r\n    if (!value) {\r\n      return msg;\r\n    }\r\n  },\r\n  password(value: string, msg: string) {\r\n    if (!value) {\r\n      return msg;\r\n    }\r\n  },\r\n  // å¯†ç é•¿åº¦å°äº6çš„æ—¶å€™æç¤º\r\n  passwordMinLength(value: string, msg: string) {\r\n    if (value.length < 6) {\r\n      return msg;\r\n    }\r\n  },\r\n  mobile(value: string, msg: string) {\r\n    if (!/\\d{11}/.test(value)) {\r\n      return msg;\r\n    }\r\n  }\r\n};\r\nclass Verification {\r\n  private list: Ilist[] = [];\r\n  public message: string;\r\n  add<T extends { value: string }>(dom: T, type: name, msg: string) {\r\n    this.list.push({\r\n      value: dom.value,\r\n      type: type,\r\n      msg: msg\r\n    });\r\n  }\r\n  start(): boolean {\r\n    for (let i = 0; i < this.list.length; i++) {\r\n      const { value, type, msg } = this.list[i];\r\n      const fn = rule[type](value, msg);\r\n      if (fn) {\r\n        this.message = msg;\r\n        return false;\r\n      }\r\n    }\r\n    this.message = \"\";\r\n    return true;\r\n  }\r\n}\r\n\r\nconst form = document.querySelector(\".cs-form\") as HTMLFormElement;\r\n\r\nform.addEventListener(\"submit\", function(e) {\r\n  e.preventDefault();\r\n  const { account, password, mobile } = (form as unknown) as Iform;\r\n\r\n  const ruleSet = new Verification();\r\n  ruleSet.add(account, \"account\", \"è¯·è¾“å…¥è´¦å·\");\r\n  ruleSet.add(password, \"password\", \"è¯·è¾“å…¥å¯†ç \");\r\n  ruleSet.add(password, \"passwordMinLength\", \"å¯†ç é•¿åº¦ä¸ç¬¦åˆè¦æ±‚\");\r\n  ruleSet.add(mobile, \"mobile\", \"è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·\");\r\n\r\n  if (!ruleSet.start()) {\r\n    // æç¤º\r\n    alert(ruleSet.message);\r\n    return false;\r\n  }\r\n  return false;\r\n});\r\n```\r\n\r\næŠŠå¯†ç ä¸èƒ½å°äºå…­ä½çš„è§„åˆ™æ·»åŠ åˆ°`rule`ä¸­ï¼Œä¹‹å add çš„æ—¶å€™æ·»åŠ å®ƒï¼Œè¿™é‡ŒåŸºæœ¬çš„æ ¡éªŒå…¶å®å°±å®Œæˆäº†ï¼Œä¸è¿‡ä»ä¸Šé¢çœ‹ï¼Œæˆ‘ä»¬çš„æ ¡éªŒè‚¯å®šä¸æ˜¯ä¸€ä¸ª input å°±å¯¹åº”ä¸€æ¡ï¼Œå®é™…ä¸Šä¼šå­˜åœ¨å¤šç§æ ¡éªŒï¼Œæ¯”å¦‚æœ€å°é•¿åº¦æœ€å¤§é•¿åº¦ï¼Œä¸èƒ½åŒ…å«æ•æ„Ÿè¯ç­‰ï¼Œæ·»åŠ å¤šæ¡è§„åˆ™ä¹Ÿæ˜¯å¾ˆåˆç†çš„è¦æ±‚ï¼Œä¸‹é¢å°±æ˜¯æœ€ç»ˆç‰ˆçš„å®ç°ã€‚\r\n\r\n### æœ€ç»ˆç‰ˆ\r\n\r\n```ts\r\ninterface Iform {\r\n  [k: string]: any;\r\n  account: HTMLInputElement;\r\n  password: HTMLInputElement;\r\n  mobile: HTMLInputElement;\r\n}\r\n\r\ninterface Ilist {\r\n  value: string;\r\n  type: name;\r\n  msg: string;\r\n}\r\ninterface Iadd {\r\n  type: name;\r\n  msg: string;\r\n}\r\n\r\ntype name = keyof typeof rule;\r\nconst rule = {\r\n  require(value: string, msg: string) {\r\n    if (!value) {\r\n      return msg;\r\n    }\r\n  },\r\n  minLength(value: string, msg: string) {\r\n    if (value.length < 6) {\r\n      return msg;\r\n    }\r\n  },\r\n  mobile(value: string, msg: string) {\r\n    if (!/\\d{11}/.test(value)) {\r\n      return msg;\r\n    }\r\n  }\r\n};\r\nclass Verification {\r\n  private list: Ilist[] = [];\r\n  public message: string;\r\n  // ç”¨å‡½æ•°é‡è½½çš„å½¢å¼å®ç°\r\n  add<T extends { value: string }>(dom: T, type: name, msg: string): void;\r\n  add<T extends { value: string }>(dom: T, ruleArr: Array<Iadd>): void;\r\n  add<T extends { value: string }>(\r\n    dom: T,\r\n    ruleArr: Array<Iadd> | name,\r\n    msg?: string\r\n  ): void {\r\n    if (Array.isArray(ruleArr)) {\r\n      this.list.push(\r\n        ...ruleArr.map(f => {\r\n          return {\r\n            value: dom.value,\r\n            type: f.type,\r\n            msg: f.msg\r\n          };\r\n        })\r\n      );\r\n    } else {\r\n      this.list.push({\r\n        value: dom.value,\r\n        type: ruleArr,\r\n        msg: msg\r\n      });\r\n    }\r\n  }\r\n  start(): boolean {\r\n    for (let i = 0; i < this.list.length; i++) {\r\n      const { value, type, msg } = this.list[i];\r\n      const fn = rule[type](value, msg);\r\n      if (fn) {\r\n        this.message = msg;\r\n        return false;\r\n      }\r\n    }\r\n    this.message = \"\";\r\n    return true;\r\n  }\r\n}\r\n\r\nconst form = document.querySelector(\".cs-form\") as HTMLFormElement;\r\n\r\nform.addEventListener(\"submit\", function(e) {\r\n  e.preventDefault();\r\n  const { account, password, mobile } = (form as unknown) as Iform;\r\n\r\n  const ruleSet = new Verification();\r\n  ruleSet.add(account, \"require\", \"è¯·è¾“å…¥è´¦å·\");\r\n  ruleSet.add(password, [\r\n    {\r\n      type: \"require\",\r\n      msg: \"è¯·è¾“å…¥å¯†ç \"\r\n    },\r\n    {\r\n      type: \"minLength\",\r\n      msg: \"å¯†ç é•¿åº¦ä¸ç¬¦åˆè¦æ±‚\"\r\n    }\r\n  ]);\r\n  ruleSet.add(mobile, [\r\n    {\r\n      type: \"require\",\r\n      msg: \"è¯·è¾“å…¥æ‰‹æœºå·\"\r\n    },\r\n    {\r\n      type: \"mobile\",\r\n      msg: \"è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·\"\r\n    }\r\n  ]);\r\n\r\n  if (!ruleSet.start()) {\r\n    // æç¤º\r\n    alert(ruleSet.message);\r\n    return false;\r\n  }\r\n  return false;\r\n});\r\n```\r\n\r\næ’’èŠ±ï¼Œè¿™é‡Œå°±å·²ç»å†™å®Œäº†ï¼Œæ•´ä½“æ¥çœ‹ä»£ç é‡è¿˜æ˜¯è›®å¤šçš„ï¼Œä¸»è¦æ˜¯ç”¨ ts å†™éœ€è¦å®šä¹‰å„ç§æ¥å£å’Œç±»å‹ï¼Œæœ€ç»ˆç‰ˆæœ¬çš„æ—¶å€™æˆ‘å°†ä¸Šè¿°çš„æ‰‹æœºå’Œè´¦å·çš„éªŒè¯æŠ½ç¦»æˆ require å‡½æ•°ï¼Œåç»­å¦‚æœæœ‰ç”¨åˆ°åªéœ€è¦åœ¨ `rule` è§„åˆ™ä¸­æ–°å¢å³å¯ã€‚\r\n\r\nå½“ç„¶å› ä¸ºåªæ˜¯è®²è§£ç­–ç•¥æ¨¡å¼çš„ä½¿ç”¨æ‰€ä»¥è¿™é‡Œå¹¶æ²¡æœ‰å¯¹è¿™ä¸ªæ ¡éªŒæ›´å®Œæ•´çš„å®šä¹‰ï¼Œå¦‚æœæœ‰è¿›ä¸€æ­¥éœ€è¦å¯ä»¥å°† min å’Œ max å±æ€§ä»¥åŠ regexp å±æ€§æ–°å¢ä¸Šï¼Œè¿›ä¸€æ­¥æé«˜æ ¡éªŒçš„è§„åˆ™\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/43/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/43/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/48",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/48/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/48/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/48/events",
      "html_url": "https://github.com/bosens-China/blog/issues/48",
      "id": 548738832,
      "node_id": "MDU6SXNzdWU1NDg3Mzg4MzI=",
      "number": 48,
      "title": "ä¼˜é›…å¤„ç†å›¾ç‰‡å¼‚å¸¸",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1371686609,
          "node_id": "MDU6TGFiZWwxMzcxNjg2NjA5",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/JavaScript",
          "name": "JavaScript",
          "color": "F7DF1E",
          "default": false,
          "description": "JavaScriptç³»åˆ—çš„æ–‡ç« "
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2020-01-13T06:54:18Z",
      "updated_at": "2021-12-21T09:47:37Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "## å‰è¨€\r\n\r\nä¸åŒæµè§ˆå™¨å¯¹åŠ è½½å¤±è´¥å›¾ç‰‡çš„å›¾æ ‡å±•ç¤ºä¸ç»Ÿä¸€ï¼Œæ‰€ä»¥ç»™å®šä¸€ä¸ªé»˜è®¤çš„å¤±è´¥å›¾ç‰‡å°±å°¤ä¸ºé‡è¦ã€‚\r\n\r\næ­£å¥½å‰å‡ å¤©å¤„ç†äº†ä¸€ä¸‹å…¬å¸é¦–é¡µå›¾ç‰‡ error é»˜è®¤å›¾ç‰‡çš„é—®é¢˜ï¼Œå°±è¶ç€è®°å¿†æ²¡æœ‰æ¶ˆå¤±åˆ†äº«ä¸€ä¸‹è¿™ç¯‡æ–‡ç« ã€‚\r\n\r\n## error\r\n\r\nimg æ ‡ç­¾æœ‰ä¸€ä¸ª error äº‹ä»¶ï¼Œé€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥æ•æ‰åˆ°å¼‚å¸¸ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿå¾ˆç®€å•\r\n\r\n```html\r\n<img src=\"abc.xxx\" alt=\"xxx\" class=\"cs-img\" />\r\n```\r\n\r\n```js\r\n<img src=\"abc.xxx\" alt=\"xxx\" class=\"cs-img\" onerror=\"this.src = 'xxxx.png'\" />;\r\n// æˆ–è€…\r\nvar img = document.querySelector(\".cs-img\");\r\nimg.addEventListener(\"error\", function(e) {\r\n  e.target.src = \"xxxx.png\";\r\n});\r\n```\r\n\r\n## å…¨å±€\r\n\r\nä¸Šé¢çš„æ–¹æ³•æ²¡æœ‰é—®é¢˜ï¼Œä¸è¿‡éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨ç®¡ç†å›¾ç‰‡è¿™æ ·å†™çš„è¯ç»´æŠ¤æˆæœ¬å¯èƒ½å¾ˆé«˜ï¼Œæœ‰å¯èƒ½ä½ åªæ˜¯æƒ³ä¸ºå›¾ç‰‡å¤±è´¥ç»Ÿä¸€å¤„ç†ã€‚\r\n\r\næˆ‘ä»¬å¸Œæœ›å¯ä»¥ç»Ÿä¸€ç›‘å¬åˆ°`error`çš„äº‹ä»¶æ¥å®Œæˆï¼Œä¸è¿‡å›¾ç‰‡çš„`error`å¤„äºäº‹ä»¶æ¨¡å‹çš„ç¬¬äºŒé˜¶æ®µä¹Ÿå°±æ˜¯ç›®æ ‡é˜¶æ®µï¼Œæ˜¯ä¸ä¼šå‘ä¸Šå†’æ³¡çš„ï¼Œä½†æ˜¯ä¹Ÿæ˜¯å¯ä»¥é€šè¿‡`window.addEventListener.error`æ¥å®Œæˆç›‘å¬ã€‚\r\n\r\n> é¡ºä¾¿è¯´ä¸‹`window.addEventListener.error`ä¸ä»…å¯ä»¥ç›‘å¬åˆ°å›¾ç‰‡çš„å¤±è´¥ä¹Ÿå¯ä»¥ç›‘å¬åˆ° `css,js` ä¹‹ç±»åŠ è½½é”™è¯¯ï¼Œæ³¨æ„åŒºåˆ†`window.onerror`å’Œ`window.addEventListener.error`ä¹‹é—´çš„åŒºåˆ«ï¼Œå‰è€…æ˜¯ js è¿è¡Œé”™è¯¯ï¼Œåè€…æ˜¯èµ„æºé”™è¯¯ï¼Œå¯¹äºäº‹ä»¶æ¨¡å‹ç½‘ä¸Šçš„ä¾‹å­å¾ˆå¤šï¼Œè¿™é‡Œä¸åšå±•å¼€æ¥è¯´äº†ã€‚\r\n\r\næ¥çœ‹ä¸‹å¦‚ä½•ç”¨\r\n\r\n```js\r\nwindow.addEventListener(\r\n  \"error\",\r\n  function(event) {\r\n    var dom = event.target;\r\n    if (/img/i.test(dom.nodeName)) {\r\n      dom.src = \"xxxx.png\";\r\n    }\r\n  },\r\n  true\r\n);\r\n```\r\n\r\næ³¨æ„ `addEventListener` ç¬¬äºŒä¸ªå‚æ•°å¿…é¡»æ˜¯ `true`ï¼Œé»˜è®¤ä¸º `false`ï¼Œè¡¨ç¤ºåªåœ¨å†’æ³¡é˜¶æ®µå‡ºå‘ï¼Œä½†æ˜¯ä¸Šé¢æˆ‘ä»¬è¯´è¿‡å›¾ç‰‡çš„ error äº‹ä»¶å¹¶ä¸ä¼šå‘ä¸Šå†’æ³¡æ‰€ä»¥æ˜¯ä¸ä¼šæ•æ‰åˆ°çš„ã€‚\r\n\r\n## é‡è¯•æ¬¡æ•°\r\n\r\nä¸Šé¢çš„ä»£ç æ²¡æœ‰è€ƒè™‘åˆ°å¤‡é€‰`src`ä¹Ÿä¼šå¤±æ•ˆçš„é—®é¢˜ï¼Œå¦‚æœå¤‡é€‰`src`å¤±æ•ˆå°±ä¼šå¯¼è‡´å›¾ç‰‡æ— é™é‡è¯•ï¼Œä¸‹é¢å°±æŠ›ç –å¼•ç‰å†™ä¸€ç§æ–¹æ³•ã€‚\r\n\r\n```js\r\nwindow.addEventListener(\r\n  \"error\",\r\n  function(event) {\r\n    var dom = event.target;\r\n    if (!/img/i.test(dom.nodeName)) {\r\n      return;\r\n    }\r\n    // ä¸å­˜åœ¨è¿”å›null\r\n    var retry = +dom.getAttribute(\"data-retry\");\r\n    if (retry >= 3) {\r\n      // ç»å¯¹å®‰å…¨çš„å›¾ç‰‡\r\n      dom.src =\r\n        \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\";\r\n    } else {\r\n      dom.src = \"xxxx.png\";\r\n      dom.setAttribute(\"data-retry\", (retry += 1));\r\n    }\r\n  },\r\n  true\r\n);\r\n```\r\n\r\n## åŠ¨æ€å¡«å……\r\n\r\næœ€ååˆ†äº«ä¸€ä¸ªåŠ¨æ€æ¨¡æ¿æ¸²æŸ“å‡ºæ¥çš„ç½‘é¡µ(ä¾‹å¦‚ï¼Œç½‘é¡µçš„å†…å®¹æ˜¯ä»åå°çš„ç¼–è¾‘å™¨ html ç›´æ¥æ’å…¥çš„)å¦‚ä½•ç›‘å¬`error`ï¼Œå¦‚æœä¸è€ƒè™‘å…¼å®¹é—®é¢˜å¯ä»¥åœ¨`head`ä½¿ç”¨`window.addEventListener.error`æ–¹æ³•ï¼Œä½†æ˜¯å¦‚æœéœ€è¦å…¼å®¹æ€§å¾ˆé«˜ä¸å¦¨è¯•è¯•ä¸‹é¢è¿™ç§ã€‚\r\n\r\n```js\r\nconst img = Array.prototype.slice.call(document.images);\r\nfor (let i = 0; i < img.length; i++) {\r\n  var dom = img[i];\r\n  const image = document.createElement(\"img\");\r\n  image.src = dom.src;\r\n  image.style.display = \"none\";\r\n  document.body.appendChild(image);\r\n  image.onerror = function(event) {\r\n    dom.src = \"xxxx.png\";\r\n    document.body.removeChild(image);\r\n  };\r\n  image.onload = function() {\r\n    document.body.removeChild(image);\r\n  };\r\n}\r\n```\r\n\r\nä¸Šé¢æˆ‘ä»¬è¯´äº†å‡è®¾å†…å®¹æ˜¯ç›´æ¥é€šè¿‡ html ä»£ç æ’å…¥çš„ï¼Œæˆ‘ä»¬å¯èƒ½ç›‘å¬ä¸åˆ°å›¾ç‰‡çš„é»˜è®¤é”™è¯¯äº‹ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨ç½‘é¡µåŠ è½½å®Œæˆä¹‹åé‡è¯•ä¸€éæ‰€æœ‰çš„ imgï¼Œåœ¨ä¸º img æŒ‡å®šä¸€æ¬¡é”™è¯¯äº‹ä»¶å°± OK äº†ã€‚\r\n\r\n## æœ€å\r\n\r\nä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºï¼Œä¸Šé¢çš„ä»£ç æˆ‘éƒ½æ²¡æœ‰åšå…¼å®¹æ€§çš„è¡¥å……ï¼Œä½†æ˜¯åœ¨å®é™…ç”Ÿäº§ä¸­ä¸Šé¢ä»£ç éœ€è¦`polyfill`å°¤å…¶æ˜¯ dom çš„ä¸€äº›è¯­æ³•ï¼Œæ¨èç®€å•ä¸€äº›çš„åšæ³•å¯ä»¥æŠŠä¸Šé¢çš„ä¾‹å­è½¬åŒ–ä¸º jquery çš„è¯­æ³•ã€‚\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/48/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/48/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/41",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/41/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/41/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/41/events",
      "html_url": "https://github.com/bosens-China/blog/issues/41",
      "id": 539716296,
      "node_id": "MDU6SXNzdWU1Mzk3MTYyOTY=",
      "number": 41,
      "title": "VuePressæ’ä»¶å¼€å‘ä¸å®Œå…¨æŒ‡å—",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1473940161,
          "node_id": "MDU6TGFiZWwxNDczOTQwMTYx",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3",
          "name": "æ¡†æ¶ç›¸å…³",
          "color": "42b883",
          "default": false,
          "description": "ç›®å‰Vueå’ŒReactä¸ºä¸»"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2019-12-18T14:30:58Z",
      "updated_at": "2021-12-21T09:47:25Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "æœ€è¿‘ç”¨ `vuepress` æŠŠç¤¾åŒºçš„ typeScript ç¿»è¯‘æ–‡ç« æ‰“åŒ…æˆäº†ä¸€ä¸ª[åœ¨çº¿æ–‡æ¡£](https://bosens-china.github.io/Typescript-manual/dist/)ï¼Œä¸è¿‡æœ‰ä¸€äº›æ’ä»¶ç¤¾åŒºæ²¡æœ‰æˆ–è€…å®ç°çš„ä¸ç¬¦åˆè‡ªå·±å®šåˆ¶éœ€æ±‚ï¼Œæ‰€ä»¥å†³å®šè‡ªå®šä¹‰å®ç°ä¸€ä¸ªï¼Œè¿™ç¯‡æ–‡åŒ–ä»¥æ˜é‡‘`å¤åˆ¶ä»£ç `åŠŸèƒ½ä¸ºä¾‹å­ã€‚\r\nå…ˆçœ‹ä¸€ä¸‹å¼€å‘å®Œæˆçš„ç•Œé¢\r\n\r\n![1](https://user-images.githubusercontent.com/39508895/71094442-f3384500-21e5-11ea-91b5-a0de07c72903.png)\r\n\r\n\r\nå…ˆçœ‹ä¸€ä¸‹å®˜æ–¹ç»™å‡ºçš„æ¶æ„å›¾\r\n![](https://user-gold-cdn.xitu.io/2019/12/18/16f195bad0aeb2f4?w=1774&h=2334&f=png&s=65238)\r\næ˜¯ä¸æ˜¯æ„Ÿè§‰æœ‰ç‚¹å¤´ç–¼ï¼Œè¿™é‡Œè®°ä¸ä½æ²¡æœ‰å…³ç³»ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“**æ’ä»¶æ˜¯åœ¨ node ç¯å¢ƒä¸‹è¿è¡Œ**ï¼Œæ‰€ä»¥æˆ‘ä»¬æ’ä»¶çš„è¿”å›å½¢å¼å¿…é¡»æ˜¯`CommonJS`å½¢å¼ã€‚\r\n\r\nä¸ vue ç±»ä¼¼ï¼Œ`vuepress`ä¹Ÿæœ‰ç”Ÿå‘½å‘¨æœŸ\r\n\r\n- ready\r\n\r\nå¯ä»¥ç®€å•ç†è§£ä¸ºåˆå§‹åŒ–å®Œæˆè°ƒç”¨\r\n\r\n- updated\r\n\r\né¡µé¢æ›´æ–°è°ƒç”¨\r\n\r\n- generated\r\n\r\nç”Ÿäº§ç¯å¢ƒæ„å»ºå®Œæˆè°ƒç”¨\r\n\r\n### å®ç°æ€è·¯\r\n\r\nå› ä¸º`vuepress`ä¼šå°† md æ–‡ä»¶æ‰“åŒ…æˆå¤šä»½ html æ–‡ä»¶ï¼Œæ‰€ä»¥åœ¨æ¯æ¬¡æ–‡ä»¶åœ°å€å˜æ›´çš„æ—¶å€™æˆ‘ä»¬éƒ½éœ€è¦çŸ¥é“è¿™ä¸ªå˜æ›´ä¹‹åæ›´æ–°æˆ‘ä»¬çš„ç»„ä»¶ï¼Œæ ¹æ®ä¸Šé¢çš„ç”Ÿå‘½å‘¨æœŸå¯ä»¥åœ¨`updated`å®ç°æˆ‘ä»¬çš„éœ€æ±‚\r\n\r\nè‡³äºå¦‚ä½•å°†å¤åˆ¶ç²˜è´´çš„ç»„ä»¶æ’å…¥åˆ°æŒ‡å®šçš„`code`ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é¡µé¢åŠ è½½å®Œæˆåï¼Œæœç´¢æ‰€æœ‰çš„æŒ‡å®šèŠ‚ç‚¹ï¼Œä¹‹åé€šè¿‡`appendChild`å°†ç»„ä»¶æ’å…¥\r\n\r\n### é¡¹ç›®ç»“æ„\r\n\r\n```sh\r\ncopy\r\nâ”œâ”€ clientRootMixin.js\r\nâ”œâ”€ clipboard.js\r\nâ”œâ”€ copy.vue\r\nâ””â”€ index.js\r\n```\r\n\r\n- index.js\r\n\r\næš´éœ²çš„å‡ºå£æ–‡ä»¶\r\n\r\n- copy.vue\r\n\r\nå…·ä½“å®ç°å¤åˆ¶ä»£ç ç»„ä»¶\r\n\r\n- clipboard.js\r\n\r\nè´Ÿè´£å®ç°ç½®å‰ªåˆ‡æ¿æ–‡æœ¬\r\n\r\n- clientRootMixin.js\r\n\r\nè´Ÿè´£å®ç°å°†ç»„ä»¶æ’å…¥åˆ°ä¸åŒçš„é¡µé¢ä¹‹ä¸­\r\n\r\n### index.js\r\n\r\nä¸Šé¢è¯´äº†æˆ‘ä»¬è¦å¼€å‘ä¸€ä¸ªå¤åˆ¶ä»£ç çš„æ’ä»¶ï¼Œæˆ‘ä»¬å°±å…ˆæŒ‰ç…§ç®€å•çš„åšæ³•å®šä¹‰ä¸‰ä¸ªå‚æ•°\r\n\r\n- ç¬¬ä¸€ä¸ªæ˜¯é€‰æ‹©å™¨çš„èŒƒå›´\r\n- ç¬¬äºŒä¸ªæ˜¯å¤åˆ¶ä»£ç æ˜¾ç¤ºçš„æ–‡æœ¬\r\n- ç¬¬ä¸‰ä¸ªåˆ™æ˜¯å›è°ƒå‡½æ•°ï¼Œè´Ÿè´£æ¥æ”¶å˜æ›´æ¶ˆæ¯ï¼Œå®ç°è‡ªå®šä¹‰çš„åŠ¨ç”»æ•ˆæœ\r\n\r\nåœ¨å®˜æ–¹ç»™å‡ºçš„ä¾‹å­ï¼Œæœ‰ä¸¤ç§æ–¹å¼ä½¿ç”¨æ’ä»¶\r\n\r\n```js\r\n// ä¾‹1\r\nmodule.exports = {\r\n  plugins: [\r\n    [\r\n      \"vuepress-plugin-xxx\",\r\n      {\r\n        /* options */\r\n      }\r\n    ]\r\n  ]\r\n};\r\n// ä¾‹2\r\nmodule.exports = {\r\n  plugins: {\r\n    xxx: {\r\n      /* options */\r\n    }\r\n  }\r\n};\r\n```\r\n\r\nå¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæœ‰å‚æ•°çš„è¯å¯ä»¥è¿™æ ·ä¼ é€’ï¼Œé‚£ä¹ˆæˆ‘ä»¬å®šä¹‰çš„æ’ä»¶ç¬¬ä¸€æ­¥å°±æ˜¯è¦å¤„ç†è¿™ä¸ªå‚æ•°ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä¸æ¥å—ï¼Œå¦‚æœä¸æ¥å—ç›´æ¥è¿”å›ä¸€ä¸ªå¯¹è±¡å°±å¯ä»¥äº†\r\n\r\n```js\r\nmodule.exports = {\r\n  // ...\r\n};\r\n```\r\n\r\nä¸‹é¢æ¥å®šä¹‰ä¸€ä¸ªç®€å•æ¥å—`options`çš„å‡½æ•°\r\n\r\n```js\r\n// å¯¹è±¡å¼\r\n\r\nmodule.exports = {\r\n  define: {\r\n    selector: options.selector || 'div[class*=\"language-\"] pre',\r\n    copyText: options.copyText || \"å¤åˆ¶ä»£ç \",\r\n    change: options.change\r\n  }\r\n};\r\n// å‡½æ•°å¼:\r\nmodule.exports = (options, context) => ({\r\n  define() {\r\n    return {\r\n      selector: options.selector || 'div[class*=\"language-\"] pre',\r\n      copyText: options.copyText || \"å¤åˆ¶ä»£ç \",\r\n      change: options.change\r\n    };\r\n  }\r\n});\r\n```\r\n\r\næ³¨æ„å¿…é¡»è¿”å›æ˜¯`CommonJS`å½¢å¼ï¼Œä¸Šé¢æˆ‘ä»¬é€šè¿‡`define`å±æ€§æ¥å®šä¹‰ä¾›æˆ‘ä»¬æ’ä»¶å†…éƒ¨ä½¿ç”¨çš„å…¨å±€å˜é‡ï¼Œä»–æ”¯æŒå‡½æ•°å’Œå¯¹è±¡ä¸¤ç§å½¢å¼ï¼Œå¯ä»¥ç†è§£ä¸º vue çš„ data å±æ€§\r\n\r\nè¿™ä¸€æ­¥æ¯”è¾ƒç®€å•ï¼Œå°±ä¸åšå…¶ä»–è¿‡å¤šè¯´æ˜äº†ï¼Œä¸Šé¢æˆ‘ä»¬æåˆ°äº†éœ€è¦å°†ç»„ä»¶æ³¨å…¥åˆ°æ‰€æœ‰é¡µé¢ä¸­ï¼Œè¿™ä¸€æ­¥æ˜¯`clientRootMixin.js`æ‰€éœ€è¦è´Ÿè´£çš„äº‹æƒ…ï¼Œä¸‹é¢å°±æ˜¯å®ç°å®ƒï¼Œæˆ‘ä»¬éœ€è¦åœ¨`index.js`å¼•å…¥å®ƒï¼Œä¸€ä¸ªå®Œæ•´çš„`index.js`çœ‹èµ·æ¥åº”è¯¥æ˜¯è¿™æ ·\r\n\r\n```js\r\nconst path = require(\"path\");\r\n\r\nmodule.exports = (options = {}, ctx) => ({\r\n  define: {\r\n    // ...\r\n  },\r\n  clientRootMixin: path.resolve(__dirname, \"clientRootMixin.js\")\r\n});\r\n```\r\n\r\n### clientRootMixin.js\r\n\r\n`clientRootMixin` å¯ä»¥è®©æˆ‘ä»¬æ§åˆ¶æ ¹æ–‡ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Œè¿™é‡Œæˆ‘ä»¬åªéœ€è¦ç›‘å¬`updated`äº‹ä»¶ï¼Œä¹‹åæŠŠ`copy.vue`æ’å…¥åˆ°å½“å‰é¡µé¢å†…å³å¯\r\n\r\n```js\r\nimport CodeCopy from \"./copy.vue\";\r\nimport Vue from \"vue\";\r\n\r\nexport default {\r\n  updated() {\r\n    // ç­‰å¾…domåŠ è½½å®Œæˆä¹‹åæ‰§è¡Œ\r\n    this.$nextTick(() => {\r\n      this.update();\r\n    });\r\n  },\r\n  methods: {\r\n    update() {\r\n      // è·å–æ‰€æœ‰çš„domï¼Œä¹‹ååœ¨æ‰€æœ‰çš„ä»£ç å—ä¸Šæ’å…¥vueçš„ç»„ä»¶\r\n      const dom = Array.from(document.querySelectorAll(selector));\r\n      dom.forEach(el => {\r\n        // åˆ¤æ–­ä¸€ä¸‹ï¼Œå½“å‰èŠ‚ç‚¹æ˜¯ä¸æ˜¯å·²ç»æ’å…¥äº†\r\n        if (/v-copy/.test(el.className)) {\r\n          return;\r\n        }\r\n        // åˆ›å»ºcopyç»„ä»¶\r\n        const C = Vue.extend(CodeCopy);\r\n        const copy = new C();\r\n        // ä¸‹é¢è¿™äº›æ˜¯ç»„ä»¶çš„propsä»¥åŠä¸€äº›ç§æœ‰å±æ€§\r\n        copy.copyText = copyText;\r\n        copy.code = el.textContent;\r\n        copy._parent = el;\r\n        copy.$mount();\r\n        el.className += ` v- copy`;\r\n        el.appendChild(copy.$el);\r\n      });\r\n    }\r\n  }\r\n};\r\n```\r\n\r\nOKï¼Œåˆ°è¿™ä¸€æ­¥ä¹Ÿå®Œæˆäº†ï¼Œä¸‹é¢å°±æ˜¯æ€ä¹ˆæŠŠä»£ç ç½®å…¥å‰ªåˆ‡æ¿äº†\r\n\r\n### clipboard.js\r\n\r\n- navigator.clipboard\r\n  æ”¯æŒå¼‚æ­¥å‰ªè´´æ¿\r\n- document.execCommand()\r\n  å…¼å®¹æ€§æ¯”è¾ƒå¥½ä¸€äº›ï¼Œä½†æ˜¯åªèƒ½åŒæ­¥å‰ªè´´æ¿\r\n\r\nä¸Šé¢æ˜¯ä¸¤ç§åŸç”Ÿçš„æ–¹å¼ï¼Œä¸è¿‡è¿™é‡Œå› ä¸ºæ˜¯ä½œä¸ºåº“ä½¿ç”¨ï¼Œéœ€è¦è€ƒè™‘å…¼å®¹æ€§é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©äº†å·²ç»å°è£…å¥½çš„`clipboard.js`ä½œä¸ºå®ç°å¤åˆ¶ç²˜è´´ï¼Œä¸‹é¢æ˜¯å…·ä½“çš„å°è£…æ–¹æ³•ï¼Œè¿™ä¸€æ­¥å¯ä»¥è·³è¿‡\r\n\r\n```js\r\nimport ClipboardJS from \"clipboard\";\r\n// å°è£…çš„å‰ªåˆ‡æ¿äº‹ä»¶\r\nconst btn = document.createElement(\"div\");\r\nbtn.style.display = \"none\";\r\ndocument.body.appendChild(btn);\r\n\r\nfunction setUpText(text = \"\") {\r\n  return new Promise((resolve, reject) => {\r\n    const cli = new ClipboardJS(btn, {\r\n      text() {\r\n        return text;\r\n      }\r\n    });\r\n    // è§¦å‘ç‚¹å‡»äº‹ä»¶\\\r\n    const click = new Event(\"click\");\r\n    cli.on(\"success\", function() {\r\n      resolve(text);\r\n      // æ— è®ºæˆåŠŸä¸å¦éƒ½åˆ é™¤\r\n      cli.destroy();\r\n    });\r\n\r\n    cli.on(\"error\", function(e) {\r\n      reject(e.action);\r\n      // æ— è®ºæˆåŠŸä¸å¦éƒ½åˆ é™¤\r\n      cli.destroy();\r\n    });\r\n    btn.dispatchEvent(click);\r\n  });\r\n}\r\n\r\nexport default setUpText;\r\n```\r\n\r\nOKï¼Œåˆ°è¿™ä¸€æ­¥åŸºæœ¬ä¸Šå°±å®Œæˆäº†å‡†å¤‡å·¥ä½œï¼Œä¸‹é¢å°±å›å½’æˆ‘ä»¬ç†Ÿæ‚‰çš„ vue ç»„ä»¶å¼€å‘äº†\r\n\r\n### copy.vue\r\n\r\nè¿™ä¸€æ­¥æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯å®šä¹‰ä¸€äº› css å±æ€§ç‚¹å‡»æŒ‰é’®çš„æ—¶å€™æ‰§è¡Œ`clipboard.js`å°±è¡Œäº†\r\n\r\n```vue\r\n<template>\r\n  <span>\r\n    <span ref=\"btn\" class=\"v-copy-code-btn\" @click=\"copyClick\">{{\r\n      copyText\r\n    }}</span>\r\n  </span>\r\n</template>\r\n\r\n<script>\r\nimport clipboard from \"./clipboard\";\r\nexport default {\r\n  props: {\r\n    copyText: {\r\n      type: String,\r\n      default: \"å¤åˆ¶ä»£ç \"\r\n    },\r\n    code: String\r\n  },\r\n  methods: {\r\n    copyClick() {\r\n      clipboard(this.code);\r\n      // æ‰§è¡Œå¤åˆ¶å…·ä½“å®ç°çœç•¥\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style>\r\n<!-- çœç•¥ -->\r\n</style>\r\n```\r\n\r\n### æœ€å\r\n\r\næ’’èŠ±ï¼Œå®Œæˆè¿™ä¸€æ­¥ä¹‹åå°±æ˜¯å°†ä»£ç å‘å¸ƒåˆ° npm ä¸Šä¾›å¤§å®¶ä½¿ç”¨ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±ä¸å†æè¿°äº†ã€‚\r\n\r\næœ€åæœ¬äººç›®å‰å‡†å¤‡æ‰¾å·¥ä½œï¼Œæœ‰å°ä¼™ä¼´å†…æ¨ä¸€ä¸‹ä¹ˆï¼Œä¸èƒœæ„Ÿæ¿€\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/41/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/41/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/34",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/34/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/34/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/34/events",
      "html_url": "https://github.com/bosens-China/blog/issues/34",
      "id": 512000452,
      "node_id": "MDU6SXNzdWU1MTIwMDA0NTI=",
      "number": 34,
      "title": "é€‰æ‹©å™¨é‚£äº›äº‹",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1371686610,
          "node_id": "MDU6TGFiZWwxMzcxNjg2NjEw",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/css%20%E7%9B%B8%E5%85%B3",
          "name": "css ç›¸å…³",
          "color": "42b883",
          "default": false,
          "description": "css æŠ€å·§å’ŒåŸºç¡€ä¸ºä¸»"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2019-10-24T14:56:12Z",
      "updated_at": "2021-12-21T09:47:07Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "> å¤±è¸ªäººå£å†’ä¸ªæ³¡\r\n\r\n## ä¼˜å…ˆçº§\r\n\r\nå…¥é—¨å­¦ä¹ çš„æ—¶å€™ä¸€å®šå°±å¬è¯´è¿‡è¿™äº›æ¦‚å¿µï¼Œåœ¨èœé¸Ÿæ•™ç¨‹ä¹‹ç±»çš„ç½‘ç«™ä¸Šä¹Ÿè‚¯å®šå­¦ä¹ è¿‡ï¼Œæ¯”å¦‚ç±»çš„ä¼˜å…ˆçº§ä¸º 10ã€æ ‡ç­¾çš„ä¼˜å…ˆçº§ä¸º 1ï¼Œè¿™äº›éƒ½æ˜¯è¾…åŠ©æˆ‘ä»¬è®°å¿†çš„ï¼Œä¸‹é¢å°±æ¥è¯´ä¸€è¯´å®¹æ˜“å‡ºé”™çš„ç‚¹ã€‚\r\n\r\n```css\r\n.top {\r\n  margin: 10px;\r\n}\r\n[class] {\r\n  margin: 20px;\r\n}\r\n```\r\n\r\nè¿™é‡Œè¾“å‡ºçš„`margin`ä¸ºå¤šå°‘ï¼Ÿ\r\n\r\nç­”æ¡ˆæ˜¯`20px`ï¼Œå¯¹äºç±»å’Œå±æ€§é€‰æ‹©å™¨ä»¥åŠä¼ªç±»ä¼˜å…ˆçº§æ˜¯ä¸€è‡´çš„ï¼Œå½“ç„¶è¿™ä¸ªä¾‹å­åªæ˜¯å¸®ä½ æ¸©ä¹ çš„ï¼Œå†æ¥çœ‹ä¸€ä¸ª\r\n\r\n```css\r\n/*ç¬¬ä¸€æ¡*/\r\nbody [class] {\r\n  color: #666;\r\n}\r\n/*ç¬¬äºŒæ¡*/\r\nhtml:not([dir]) {\r\n  color: red;\r\n}\r\n```\r\n\r\nè¿™é‡Œä¸¤æ¡å±æ€§çš„ä¼˜å…ˆçº§ç›¸ç­‰ä¹ˆï¼Ÿ\r\n\r\nç­”æ¡ˆæ˜¯ç›¸ç­‰çš„ï¼Œå¯¹äº`:not`è¿™æ ·çš„é€»è¾‘ç»„åˆä¼ªç±»å½±å“ä¼˜å…ˆçº§çš„æ˜¯é‡Œé¢çš„å…ƒç´ ï¼Œä¸Šé¢ç¬¬ä¸€æ¡æ˜¯ä¸€ä¸ªæ ‡ç­¾åŠ ä¸Šå±æ€§é€‰æ‹©å™¨ä¼˜å…ˆçº§ä¸º 11ï¼Œç¬¬äºŒæ¡ html æ ‡ç­¾åŠ ä¸Šå±æ€§é€‰æ‹©å™¨ä¼˜å…ˆçº§ä¹Ÿæ˜¯ 11ã€‚\r\n\r\n## æ¸²æŸ“é¡ºåº\r\n\r\nä¸Šé¢ä¸¾äº†ä¸€ä¸ªä¾‹å­æœ€ç»ˆé¢œè‰²ç”Ÿæ•ˆä¸º`red`ï¼Œè¿™æ˜¯å› ä¸ºåæ¥å±…ä¸Šçš„åŸåˆ™ï¼Œä¸è¿‡æ³¨æ„è¿™ä¸ªåæ¥å±…ä¸Šè¯´çš„æ˜¯æ•´ä½“æ–‡æ¡£è€Œè¨€ã€‚\r\n\r\n```html\r\n<link rel=\"stylesheet\" href=\"a.css\" /> <link rel=\"stylesheet\" href=\"b.css\" />\r\n```\r\n\r\na.css\r\n\r\n```css\r\nbody .foo {\r\n  color: red;\r\n}\r\n```\r\n\r\nb.css\r\n\r\n```css\r\nhtml .foo {\r\n  color: #666;\r\n}\r\n```\r\n\r\næœ€ç»ˆ`color`çš„å€¼ä¸º`#666`ï¼ŒåŒæ—¶è¿˜æé†’ä¸€ä¸‹ css æœ€ç»ˆç”Ÿæ•ˆå¹¶ä¸æ˜¯çœ‹å…ƒç´ çš„è·ç¦»çš„è¿œè¿‘ï¼Œè€Œæ˜¯æ ¹æ®ä¼˜å…ˆçº§å’Œä½ç½®ï¼Œæ¯”å¦‚ä¸Šé¢çš„ body è‚¯å®šæ¯” html ç¦»å¾—è¿‘ï¼Œä½†æ˜¯å› ä¸ºåæ¥å±…ä¸Šæ‰€ä»¥å¹¶æ²¡æœ‰ç”Ÿæ•ˆã€‚\r\n\r\n## é€‰æ‹©å™¨æ˜¯å¦èƒ½è·¨çº§ï¼Ÿ\r\n\r\nåœ¨å¼€å¤´è¯´äº†æ–¹ä¾¿è®°å¿†æˆ‘ä»¬ä¼šç»™ç±»å’Œæ ‡ç­¾ä¹‹ç±»çš„ä¼˜å…ˆçº§æ·»åŠ ä¸Šæ•°å­—ï¼Œä½†æ˜¯å¦‚æœä½ æƒ³ç”¨æ•°é‡å¤šå°±è¦†ç›–é«˜ä¸€å±‚çº§çš„æ˜¯ä¸å¯èƒ½çš„\r\n\r\n```css\r\n.a {\r\n  color: red;\r\n}\r\na,\r\na,\r\na,\r\na,\r\na,\r\na,\r\na,\r\na,\r\na,\r\na,\r\na,\r\na,\r\na,\r\na,\r\na,\r\na,\r\na,\r\na {\r\n  color: #666;\r\n}\r\n```\r\n\r\nè¾“å‡ºç»“æœè¿˜æ˜¯çº¢è‰²ã€‚\r\n\r\n## å¢åŠ ä¼˜å…ˆçº§\r\n\r\nä¼ ç»Ÿæ·»åŠ ä¼˜å…ˆçº§æˆ‘ä»¬å¯èƒ½ä¼šé€šè¿‡ç»™æ ‡ç­¾æ·»åŠ  id æˆ–è€…ç»§ç»­åµŒå¥—æ¥å®ç°ï¼Œä¸è¿‡è¿™æ ·åšè‚¯å®šä¸åˆé€‚å› ä¸ºåé¢åœ¨æƒ³ä¿®æ”¹å¯èƒ½å°±éœ€è¦ä½¿ç”¨`style`æˆ–è€…`important`äº†ï¼Œä¸‹é¢å°±è¯´ä¸‹ä¸¤ä¸ªå°æŠ€å·§\r\n\r\n1. ä½¿ç”¨å±æ€§é€‰æ‹©å™¨\r\n\r\n```css\r\n.a[class] {\r\n  color: red;\r\n}\r\n.a {\r\n  color: #666;\r\n}\r\n```\r\n\r\n2. åµŒå¥—é€‰æ‹©è‡ªå·±\r\n\r\n```css\r\n.a.a {\r\n  color: red;\r\n}\r\n.a {\r\n  color: #666;\r\n}\r\n```\r\n\r\n## åŒ¹é…é¡ºåº\r\n\r\nè¯´ä¸€ç‚¹æ–°æ‰‹å™©æ¢¦ï¼Œcss çš„åŒ¹é…é¡ºåºæ˜¯ä»å³å¾€å·¦ï¼Œæ‰€ä»¥åµŒå¥—å¤ªå¤šå±‚çš„ css è¯­å¥å°±ä¸è¦åœ¨å†™äº†ï¼Œä¸€èˆ¬è€Œè¨€ id é€‰æ‹©å™¨å’Œç±»é€‰æ‹©å™¨çš„è§£ææœ€å¿«ï¼Œæ ‡ç­¾é€‰æ‹©å™¨çš„é€Ÿåº¦å¾ˆæ…¢ï¼Œæ‰€ä»¥åœ¨é¡¹ç›®ä¸­ä¸è¦åµŒå…¥å¤ªå¤šçš„æ ‡ç­¾é€‰æ‹©å™¨æœ‰åˆ©äºé¡¹ç›®çš„ä¼˜åŒ–ã€‚\r\n\r\n## æ˜¯å¦åŒºåˆ†å¤§å°å†™\r\n\r\nè¯´è¿™ä¸ªé¦–å…ˆè¦è¯´ä¸€ä¸‹ html æ˜¯å¦åŒºåˆ†å¤§å°å†™ï¼Œhtml å¯¹äºæ ‡ç­¾å’Œå±æ€§æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼Œè€Œå¯¹å±æ€§å€¼åˆ™æ˜¯åŒºåˆ†çš„ï¼Œcss ä¸ html ä¿æŒä¸€è‡´\r\n\r\n```html\r\n<style>\r\n  p {\r\n    color: #666;\r\n  }\r\n  [CLASS] {\r\n    color: red;\r\n  }\r\n  .foo {\r\n    color: white;\r\n  }\r\n</style>\r\n<p class=\"FOO\">hello wrold</p>\r\n```\r\n\r\nè¿™é‡Œ p çš„ `color` ä¸º `red`ï¼Œè¯´æ˜äº†æ ‡ç­¾å’Œå±æ€§é€‰æ‹©å™¨ä¸åŒºåˆ†å¤§å°å†™ï¼Œè€Œå¯¹äº class åˆ™æ˜¯åŒºåˆ†çš„ã€‚\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/34/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/34/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/29",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/29/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/29/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/29/events",
      "html_url": "https://github.com/bosens-China/blog/issues/29",
      "id": 499886565,
      "node_id": "MDU6SXNzdWU0OTk4ODY1NjU=",
      "number": 29,
      "title": "jsonpå®ç°åŸç†",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1371686609,
          "node_id": "MDU6TGFiZWwxMzcxNjg2NjA5",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/JavaScript",
          "name": "JavaScript",
          "color": "F7DF1E",
          "default": false,
          "description": "JavaScriptç³»åˆ—çš„æ–‡ç« "
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2019-09-29T09:16:55Z",
      "updated_at": "2021-12-21T09:46:25Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "ç®€å•è¯´ä¸€ä¸‹å­˜åœ¨çš„å†å²ï¼Œæµè§ˆå™¨å­˜åœ¨åŒæºæ”¿ç­–ï¼Œå³åŸŸå+ç«¯å£+åè®®å¿…é¡»ä¸€è‡´ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬éœ€è¦è·¨åŸŸè®¿é—®ï¼Œå½“ç„¶åœ¨ç°åœ¨æˆ‘ä»¬å¯ä»¥å€ŸåŠ© webpack çš„åå‘ä»£ç†é…åˆæœåŠ¡å™¨è®¾ç½® cors å®ç°è®¿é—®ï¼Œä½†æ˜¯åœ¨ä¹‹å‰å·¥ç¨‹åŒ–è¿˜æ²¡å‡ºç°çš„æ—¶å€™å°±éœ€è¦æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥è®¿é—®æ‰€ä»¥ jsonp å°±å‡ºç°äº†ã€‚\r\njsonp çš„åŸç†å°±æ˜¯æµè§ˆå™¨çš„ `script` æ ‡ç­¾å¯ä»¥åŠ è½½ä¸åŒæºçš„èµ„æºï¼Œé…åˆåç«¯é€šè¿‡æ‰§è¡Œå‡½æ•°ä¼ é€’å‚æ•°ï¼Œè¿™ä¹Ÿæ˜¯ **jsonp åªæ”¯æŒ get** çš„åŸå› ï¼ŒåŒç†çš„æ ‡ç­¾è¿˜æœ‰`img`ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥å®ç°è®¿é—®ç«™ç‚¹æ¬¡æ•°çš„ç»Ÿè®¡ï¼Œæ ¹æ®ä¸Šé¢çš„åŸç†æˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªæ¨¡æ‹Ÿçš„ç‰ˆæœ¬\r\n\r\n## ç¬¬ä¸€ç‰ˆ\r\n\r\n```html\r\n<script>\r\n  function callback(v) {\r\n    console.log(\"å‚æ•°æ˜¯ï¼š\");\r\n    console.log(v);\r\n  }\r\n</script>\r\n<script>\r\n  callback({\r\n    name: \"zhangsan\",\r\n    age: 18\r\n  });\r\n</script>\r\n```\r\n\r\nå¯ä»¥çœ‹åˆ°å°±æ˜¯è¿™ä¸ªæ€è·¯ï¼Œåé¢çš„è„šæœ¬è°ƒç”¨è¿™ä¸ªå‚æ•°å³å¯ã€‚\r\n\r\n## ç®€å•å®ç°ä¸€ä¸ª jsonp çš„å‡½æ•°\r\n\r\n```js\r\ninterface Iparams {\r\n  [propName: string]: any;\r\n}\r\ninterface Ioptions {\r\n  params?: Iparams;\r\n  timeout?: number;\r\n  name?: string;\r\n}\r\nlet uid = 0;\r\nconst jsonp = function jsonp(this: any, url: string, option: Ioptions = {}) {\r\n  return new Promise((resolve, reject) => {\r\n    // æ³¨æ„ï¼Œè¿™ä¸ªidä¸èƒ½é‡å¤\r\n    const id = `__uid${uid++}`;\r\n    Reflect.set(window, id, (...rest: any[]) => {\r\n      clear();\r\n      return resolve.call(this, ...rest);\r\n    });\r\n    const { name = \"callback\", params = {}, timeout = 6000 } = option;\r\n    // æ¸…ç†\r\n    const clear = () => {\r\n      Reflect.set(window, id, () => {});\r\n      script.parentNode.removeChild(script);\r\n      if (timer) {\r\n        clearTimeout(timer);\r\n      }\r\n    };\r\n    // åˆ›å»ºè¶…æ—¶ä»»åŠ¡\r\n    let timer: NodeJS.Timeout;\r\n    if (typeof timeout === \"number\") {\r\n      timer = setTimeout(() => {\r\n        clear();\r\n        return reject(new Error(`Task timeout`));\r\n      }, timeout);\r\n    }\r\n    const script: HTMLScriptElement = document.createElement(\"script\");\r\n    // å¤„ç†ä¸€ä¸‹å‚æ•°æœ€ç»ˆåˆå¹¶\r\n    const par = new URLSearchParams(params);\r\n    par.append(name, id);\r\n    const href = `${url}?${par}`;\r\n    // ç¼–ç ä¸€ä¸‹é˜²æ­¢å‡ºç°ä¸­æ–‡ä¹‹ç±»çš„\r\n    script.src = encodeURI(href);\r\n    document.body.appendChild(script);\r\n    script.addEventListener(\"error\", () => {\r\n      clear();\r\n      return reject(\r\n        new Error(`Failed to create jsonp, request target address is:${url}`)\r\n      );\r\n    });\r\n  });\r\n};\r\nexport default jsonp;\r\n```\r\n\r\nè¿™é‡Œä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºä½¿ç”¨äº†`URLSearchParams`å¯¹è±¡ï¼Œå®ƒæ˜¯æµè§ˆå™¨çš„åŸç”Ÿå¯¹è±¡ï¼Œç”¨æ¥æ„é€ ã€è§£æå’Œå¤„ç† URL çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œå½“ç„¶åœ¨ç”Ÿäº§ä¸­è¿˜éœ€è¦`polyfill`ï¼Œå¦‚æœä¸æ»¡è¶³å…¼å®¹æ€§å»ºè®®æ‰‹å†™ä¸€ä¸ªå·¥å…·å¤„ç†ã€‚\r\n\r\n## æœ€å\r\n\r\nä»£ç æˆ‘å·²ç»æ”¾ç½®åˆ°äº†ä»“åº“ï¼Œæ¬¢è¿æ¥ [Star](https://github.com/bosens-China/promise-jsonp)\r\n\r\nå‚è€ƒï¼š\r\n\r\n- https://github.com/webmodules/jsonp\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/29/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/29/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/23",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/23/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/23/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/23/events",
      "html_url": "https://github.com/bosens-China/blog/issues/23",
      "id": 489595663,
      "node_id": "MDU6SXNzdWU0ODk1OTU2NjM=",
      "number": 23,
      "title": "é•¿åˆ—è¡¨ä¼˜åŒ–",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1371686609,
          "node_id": "MDU6TGFiZWwxMzcxNjg2NjA5",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/JavaScript",
          "name": "JavaScript",
          "color": "F7DF1E",
          "default": false,
          "description": "JavaScriptç³»åˆ—çš„æ–‡ç« "
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2019-09-05T08:10:06Z",
      "updated_at": "2021-12-21T09:45:48Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "## å‰è¨€\r\n\r\nåœ¨é¡¹ç›®ä¸­å¦‚æœèƒ½åˆ†é¡µå®ç°é‚£æœ€å¥½ä¸è¿‡äº†ï¼Œä¸è¿‡å¾ˆå¤šæ—¶å€™é•¿åˆ—è¡¨ä¸å¯é¿å…ï¼Œè¿™é‡Œåˆåˆ†ä¸¤ç§æƒ…å†µ\r\n\r\n1. ç¬¬ä¸€æ¬¡ä¸ç”¨å…¨éƒ¨åŠ è½½å®Œæˆï¼Œè¿™ç§å¯ä»¥ä½¿ç”¨æ‡’åŠ è½½æˆ–è€…è¯´æ— é™æ»šåŠ¨çš„æ–¹å¼æ¥å®ç°\r\n2. å¦å¤–ä¸€ç§åˆ™æ˜¯ä¸€æ¬¡è¦æ¸²æŸ“å…¨éƒ¨æ•°æ®å‡ºç°\r\n\r\nä¸‹é¢å°±æ¥è®¨è®ºè¿™ä¸¤ç§æƒ…å†µå¦‚ä½•è¿›è¡Œä¼˜åŒ–ï¼Œå¯ä»¥å¯¹æ¯”[åˆ—è¡¨ä¼˜åŒ–å…·ä½“å®ç°](https://github.com/bosens-China/VirtualList)çš„æºç æ¥çœ‹\r\n(æ³¨ï¼šä¸‹é¢æ˜¯ç”¨ Vue å®ç°çš„ï¼Œä½¿ç”¨å…¶ä»–æ¡†æ¶å¹¶ä¸å½±å“)\r\n\r\n## æ— é™æ»šåŠ¨\r\n\r\nå®ç°çš„æ€è·¯å¾ˆç®€å•å°±æ˜¯æ ¹æ®æ»šåŠ¨æ¡æ˜¯å¦æ»šåŠ¨åˆ°åº•éƒ¨ï¼ˆæ€»é«˜åº¦ - å¯è§é«˜åº¦ - æ»šåŠ¨æ¡é«˜åº¦ï¼‰ï¼Œæ»šåŠ¨åˆ°åº•éƒ¨å°±æ·»åŠ æ–°çš„æ•°æ®\r\n\r\n```js\r\nfunction scroll({ target }) {\r\n  const DISTANCE = 40;\r\n  const h = target.scrollHeight - (target.clientHeight + target.scrollTop);\r\n  if (h < DISTANCE) {\r\n    for (let i = 0, j = this.list.length, l = this.list.length; i < l; i++) {\r\n      this.list.push(j + i);\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n## è™šæ‹Ÿåˆ—è¡¨\r\n\r\n![v2-f00bb3f5d9815d660d7bcbd87236af86_hd](https://user-images.githubusercontent.com/39508895/64329195-6cc67180-d001-11e9-8104-1256738a1cc2.jpg)\r\n\r\nå¼•ç”¨ä¸€å¼ å›¾ï¼Œå¯ä»¥çœ‹è§æˆ‘ä»¬å®ç°çš„æ€è·¯å°±æ˜¯åªæ¸²æŸ“å¯è§éƒ¨åˆ†çš„åˆ—è¡¨ï¼Œæ¯æ¬¡æ»šåŠ¨æ¡å˜åŒ–çš„æ—¶å€™æ›´æ”¹å±•ç¤ºçš„åˆ—è¡¨ï¼Œåœ¨ä¸‹é¢çš„æ¼”ç¤ºä¸­ï¼Œæˆ‘ä»¬éƒ½ä¼šç”¨åˆ°ä¸€ä¸ªåŸºç¡€çš„ html ç»“æ„ï¼Œè¿™é‡Œå…ˆè´´ä¸€ä¸‹\r\n\r\n```html\r\n<div class=\"root\">\r\n  <div class=\"container\"></div>\r\n  <ul class=\"content\">\r\n    <li class=\"item\" v-for=\"item of nowList\" :key=\"item.value\">\r\n      {{ item.value }}\r\n    </li>\r\n  </ul>\r\n</div>\r\n```\r\n\r\n```less\r\n.root {\r\n  border: 1px solid #999;\r\n  list-style: none;\r\n  overflow: auto;\r\n  height: 400px;\r\n  position: relative;\r\n  .container {\r\n    position: absolute;\r\n    left: 0;\r\n    top: 0;\r\n    right: 0;\r\n    z-index: -1;\r\n  }\r\n  .content {\r\n    .container();\r\n    z-index: 1;\r\n    margin: 0;\r\n    padding: 0;\r\n    list-style: none;\r\n  }\r\n  .item {\r\n    border-bottom: 1px solid #ccc;\r\n    padding-left: 40px;\r\n  }\r\n}\r\n```\r\n\r\nä¸Šé¢ç»“æ„åšäº†ä¸¤ä»¶äº‹æƒ…\r\n\r\n1. å›ºå®šæ€»åˆ—è¡¨çš„é«˜åº¦ï¼Œè®©å…¶å‡ºç°æ»šåŠ¨æ¡\r\n2. ç”¨ä¸€ä¸ªé®ç½© div æ’‘èµ·æ•´ä¸ªåˆ—è¡¨çš„é«˜åº¦\r\n\r\n### å›ºå®š\r\n\r\nè¿™é‡Œå‡è®¾æ¯ä¸ªåˆ—è¡¨çš„é«˜åº¦ä¸º 30pxï¼Œå‰©ä¸‹çš„éƒ¨åˆ†å°±æ˜¯è®¡ç®—å‡ºåˆ—è¡¨çš„`æ€»ä½“é«˜åº¦`ä»¥åŠ`å¼€å§‹ç´¢å¼•`å’Œ`ç»“æŸç´¢å¼•`ï¼Œæ ¸å¿ƒä»£ç åªæœ‰ä¸åˆ° 10 è¡Œ\r\n\r\n```js\r\nscroll() {\r\n  const dom = this.$refs.root;\r\n  const total = Math.ceil(dom.clientHeight / this.height);\r\n  const start = Math.floor(dom.scrollTop / this.height);\r\n  const end = start + total;\r\n  this.start = start;\r\n  this.end = end;\r\n}\r\n```\r\n\r\næ€»ç´¢å¼•: å½“å‰è§†å›¾çš„é«˜åº¦ / å­é¡¹çš„é«˜åº¦ï¼Œä¸è¿‡æ³¨æ„éœ€è¦å‘ä¸Šå–æ•´ï¼›\r\nå¼€å§‹ç´¢å¼•: æ»šåŠ¨çš„è·ç¦» / å­é¡¹çš„é«˜åº¦\r\nç»“æŸç´¢: æ€»ç´¢å¼• + å¼€å§‹ç´¢å¼•\r\nä¸‹é¢æ˜¯å®Œæ•´çš„ä»£ç \r\n\r\n```html\r\n<template>\r\n  <div>\r\n    <div class=\"root\" ref=\"root\" @scroll=\"scroll\">\r\n      <div class=\"container\" :style=\"{ height: totalHeight }\"></div>\r\n      <ul class=\"content\" :style=\"{ transform: getTransform }\">\r\n        <li\r\n          class=\"item\"\r\n          :style=\"{ height: height + 'px', lineHeight: height + 'px' }\"\r\n          v-for=\"(item, i) of nowList\"\r\n          :key=\"i\"\r\n        >\r\n          {{ item }}\r\n        </li>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  export default {\r\n    data() {\r\n      return {\r\n        list: Array(10000)\r\n          .fill(1)\r\n          .map((f, i) => i),\r\n        height: 30,\r\n        start: 0,\r\n        end: 0\r\n      };\r\n    },\r\n    computed: {\r\n      totalHeight() {\r\n        return this.height * this.list.length + \"px\";\r\n      },\r\n      nowList() {\r\n        return this.list.slice(this.start, this.end);\r\n      },\r\n      getTransform() {\r\n        return `translate3d(0,${this.start * this.height}px,0)`;\r\n      }\r\n    },\r\n    mounted() {\r\n      this.scroll();\r\n    },\r\n    methods: {\r\n      scroll() {\r\n        const dom = this.$refs.root;\r\n        const total = Math.ceil(dom.clientHeight / this.height);\r\n        const start = Math.floor(dom.scrollTop / this.height);\r\n        const end = start + total;\r\n        this.start = start;\r\n        this.end = end;\r\n      }\r\n    }\r\n  };\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n  .root {\r\n    border: 1px solid #999;\r\n    list-style: none;\r\n    overflow: auto;\r\n    height: 400px;\r\n    position: relative;\r\n    .container {\r\n      position: absolute;\r\n      left: 0;\r\n      top: 0;\r\n      right: 0;\r\n      z-index: -1;\r\n    }\r\n    .content {\r\n      .container();\r\n      z-index: 1;\r\n      margin: 0;\r\n      padding: 0;\r\n      list-style: none;\r\n    }\r\n    .item {\r\n      border-bottom: 1px solid #ccc;\r\n      padding-left: 40px;\r\n    }\r\n  }\r\n</style>\r\n```\r\n\r\n### éå›ºå®š\r\n\r\néå›ºå®šéœ€è¦è€ƒè™‘çš„æ›´å¤šåˆ™æ˜¯æ€§èƒ½çš„é—®é¢˜ï¼Œä¸‹é¢å…ˆè´´ä¸€ä¸ªå®Œæ•´çš„ä»£ç ï¼Œåœ¨éœ€è¦è¯´æ˜éƒ¨åˆ†å·²ç»æ³¨é‡Šäº†\r\n\r\n```html\r\n<template>\r\n  <div>\r\n    <div class=\"root\" ref=\"root\" @scroll=\"scroll\">\r\n      <div class=\"container\" :style=\"{ height: totalHeight }\"></div>\r\n      <ul class=\"content\" :style=\"{ transform: getTransform }\">\r\n        <li\r\n          class=\"item\"\r\n          v-for=\"item of nowList\"\r\n          :style=\"{\r\n            height: item.height + 'px',\r\n            lineHeight: item.height + 'px'\r\n          }\"\r\n          :key=\"item.value\"\r\n        >\r\n          {{ item.value }}\r\n        </li>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  export default {\r\n    data() {\r\n      return {\r\n        list: Array(10000)\r\n          .fill(1)\r\n          .map((f, i) => {\r\n            return {\r\n              value: i,\r\n              height: this.getRandom(10, 100)\r\n            };\r\n          }),\r\n        start: 0,\r\n        end: 0,\r\n        // æŒ‡é’ˆ\r\n        pointer: -1,\r\n        // ç¼“å­˜\r\n        cache: {},\r\n        // åˆå§‹æ€»æ•°\r\n        initialHeight: 50\r\n      };\r\n    },\r\n    computed: {\r\n      totalHeight() {\r\n        // è¿™é‡Œæ˜¯è·å–æ€»ä½“é«˜åº¦ï¼Œåˆ¤æ–­äº†ä¸¤ç§æƒ…å†µï¼Œç¬¬ä¸€ç§æ˜¯ç»™å®šåˆå§‹æ€»æ•°ï¼Œå¦å¤–ä¸€ç§åˆ™æ˜¯æ²¡æœ‰ï¼Œå¦‚æœæ²¡æœ‰çš„è¯ï¼Œé«˜åº¦å°±æ˜¯å·²ç¼“å­˜çš„ + æœªç¼“å­˜çš„éƒ¨åˆ†\r\n        if (this.initialtotal >= 0) {\r\n          const { top, height } =\r\n            this.pointer >= 0\r\n              ? this.getIndexOffset(this.pointer)\r\n              : { top: 0, height: 0 };\r\n          return `${top +\r\n            height +\r\n            (this.list.length - 1 - this.pointer) * this.initialHeight}px`;\r\n        }\r\n        const { height } = this.list.reduce(function(x, y) {\r\n          return {\r\n            height: x.height + y.height\r\n          };\r\n        });\r\n        return height + \"px\";\r\n      },\r\n      // å¯è§†æ•°æ®\r\n      nowList() {\r\n        return this.list.slice(\r\n          this.start,\r\n          Math.min(this.end + 1, this.list.length)\r\n        );\r\n      },\r\n      getTransform() {\r\n        return `translate3d(0,${this.getIndexOffset(this.start).top}px,0)`;\r\n      }\r\n    },\r\n    mounted() {\r\n      this.scroll();\r\n    },\r\n    methods: {\r\n      // æ»šåŠ¨äº‹ä»¶\r\n      scroll() {\r\n        const dom = this.$refs.root;\r\n        // è·å–ç´¢å¼•\r\n        const start = this.getIndex(dom.scrollTop);\r\n        // æŠŠå½“å‰å¯è§†çš„é«˜åº¦ + æ»šåŠ¨æ¡çš„é«˜åº¦ï¼Œå†å»å–ç´¢å¼•\r\n        const end = this.getIndex(dom.scrollTop + dom.clientHeight);\r\n        this.start = start;\r\n        this.end = end;\r\n      },\r\n      // å–å‡ºæŒ‡å®šèŒƒå›´éšæœºæ•°\r\n      getRandom(min, max) {\r\n        return Math.floor(Math.random() * (max - min + 1)) + min;\r\n      },\r\n      // æ ¹æ®æ»šåŠ¨æ¡yè·å–æŒ‡å®šåæ ‡\r\n      getIndex(scrollTop) {\r\n        // åˆ¤æ–­æ€è·¯å¾ˆç®€å•ï¼Œå¦‚æœé«˜åº¦å¤§äºæ»šåŠ¨æ¡è‚¯å®šå°±å‡ºç°äº†ï¼Œå¦å¤–ä¸€ç§åˆ™æ˜¯åˆ¤æ–­äº†è¾¹ç•Œé—®é¢˜\r\n        let total = 0;\r\n        for (let i = 0, j = this.list.length; i < j; i++) {\r\n          if (total >= scrollTop || j - 1 === i) {\r\n            return i;\r\n          }\r\n          // è¿™é‡Œä¸»è¦æ˜¯èµ·ç¼“å­˜ä½œç”¨çš„\r\n          total += this.getIndexOffset(i).height;\r\n        }\r\n        return 0;\r\n      },\r\n      // è·å–æŒ‡å®šåæ ‡çš„ä½ç½®å’Œé«˜åº¦\r\n      getIndexOffset(index) {\r\n        // å¦‚æœå­˜åœ¨ç¼“å­˜ä¸­ç›´æ¥è¿”å›\r\n        if (this.pointer >= index) {\r\n          return this.cache[index];\r\n        }\r\n        let total = 0;\r\n        // è¿™é‡Œæ˜¯ä¸ºäº†æ¯”è¾ƒæ²¡æœ‰å–åˆ°çš„æƒ…å†µ\r\n        if (this.pointer >= 0) {\r\n          const li = this.cache[this.pointer];\r\n          total = li.top + li.height;\r\n        }\r\n        // æ³¨æ„ä¸Šé¢å› ä¸ºå–çš„å€¼æ˜¯li.top + li.heightï¼Œæ‰€ä»¥iä» + 1å¼€å§‹\r\n        for (let i = this.pointer + 1; i <= index; i++) {\r\n          const size = this.list[i].height;\r\n          this.cache[i] = {\r\n            top: total,\r\n            height: size\r\n          };\r\n          total += size;\r\n        }\r\n        if (index > this.pointer) {\r\n          this.pointer = index;\r\n        }\r\n\r\n        return this.cache[index];\r\n      }\r\n    }\r\n  };\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n  .root {\r\n    border: 1px solid #999;\r\n    list-style: none;\r\n    overflow: auto;\r\n    height: 400px;\r\n    position: relative;\r\n    .container {\r\n      position: absolute;\r\n      left: 0;\r\n      top: 0;\r\n      right: 0;\r\n      z-index: -1;\r\n    }\r\n    .content {\r\n      .container();\r\n      z-index: 1;\r\n      margin: 0;\r\n      padding: 0;\r\n      list-style: none;\r\n    }\r\n    .item {\r\n      border-bottom: 1px solid #ccc;\r\n      padding-left: 40px;\r\n    }\r\n  }\r\n</style>\r\n```\r\n\r\nä¸Šé¢åªæœ€ç»ˆçš„å®ç°ï¼Œå®é™…ä¸Šè·Ÿå›ºå®šé«˜åº¦ç›¸æ¯”å°±æ˜¯å¢åŠ äº†è·å–ç´¢å¼•çš„æ–¹æ³•ï¼Œå›ºå®šé«˜åº¦æˆ‘ä»¬æ˜¯çŸ¥é“å¯¹åº”å­é¡¹çš„é«˜åº¦ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡å¯è§†é«˜åº¦æ¥è®¡ç®—ï¼Œè€Œè¿™é‡Œæˆ‘ç”¨äº†éšæœºæ•°æ¥è®¾ç½®é«˜åº¦ï¼Œæ‰€ä»¥éœ€è¦è·å–åˆ°å¯¹åº”çš„ç´¢å¼•ã€‚\r\nä¸Šé¢ä»£ç åŒæ—¶ä¹Ÿåšäº†ä¸¤ç‚¹ä¼˜åŒ–ï¼Œä¸€æ˜¯ç¼“å­˜ï¼ŒäºŒæ˜¯æ€»é«˜åº¦ä¼˜åŒ–\r\n\r\næ€»é«˜åº¦çš„å®ç°æœ‰ä¸¤ç§æ€è·¯ï¼š\r\n\r\n1. è®¡ç®—æ‰€æœ‰çš„é«˜åº¦ï¼Œè¿™ç§å®é™…ä¸Šæœ‰ç‚¹æµªè´¹æ€§èƒ½ï¼›\r\n2. ç»™å®šä¸€ä¸ªå¤§æ¦‚çš„å€¼ï¼Œæ‹¿ç¼“å­˜çš„å€¼ + æ²¡æœ‰ç¼“å­˜çš„å€¼ï¼Œæ²¡æœ‰ç¼“å­˜çš„å€¼å°±æ˜¯å¯¹åº”æ•°æ®çš„é•¿åº¦ - å·²ç¼“å­˜çš„åæ ‡ï¼Œä¹‹åæ¯æ¬¡ç¼“å­˜å˜åŒ–çš„æ—¶å€™å†è®¡ç®—ï¼›\r\n\r\nç¼“å­˜åˆ™æ¯”è¾ƒç®€å•äº†ï¼Œæ¯æ¬¡è®¡ç®—çš„æ—¶å€™æŠŠæŒ‡é’ˆç§»åŠ¨åˆ°è®¡ç®—çš„ä½ç½®ï¼ŒåŒæ—¶å°†å€¼æ·»åŠ ä¸Š\r\n\r\n## å‚è€ƒæ–‡ç« \r\n\r\n1. https://zhuanlan.zhihu.com/p/34585166\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/23/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/23/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/22",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/22/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/22/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/22/events",
      "html_url": "https://github.com/bosens-China/blog/issues/22",
      "id": 485122259,
      "node_id": "MDU6SXNzdWU0ODUxMjIyNTk=",
      "number": 22,
      "title": "é€šç”¨è¿­ä»£å™¨å®ç°",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1602397157,
          "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
          "name": "æ·±å…¥ç³»åˆ—",
          "color": "719192",
          "default": false,
          "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2019-08-26T08:47:04Z",
      "updated_at": "2021-12-21T09:45:27Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "> è¿­ä»£å™¨åœ¨å¾ˆå¤šè¯­è¨€éƒ½å¾ˆå¸¸è§ï¼Œjs çš„ forEach å°±æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼Œä¸‹é¢å°±æ¥ä»‹ç»å®ç°ä¸€ä¸ªæ”¯æŒæ•°ç»„ã€å¯¹è±¡ã€ç±»æ•°ç»„çš„çš„ each å‡½æ•°ã€‚\r\n\r\n## å‰è¨€\r\n\r\nå†™ä¹‹å‰å…ˆæ•´ç†ä¸€ä¸‹æ€è·¯\r\n\r\n1. æˆ‘ä»¬é¦–å…ˆéœ€è¦åˆ¤æ–­æ˜¯ä¸æ˜¯ç±»æ•°ç»„ï¼Œå¦‚æœæ˜¯æ•°ç»„å’Œç±»æ•°ç»„å°±ä½¿ç”¨ for å¾ªç¯ï¼Œå¦‚æœæ˜¯å¯¹è±¡æˆ‘ä»¬å°±ç”¨ for...in å¾ªç¯ã€‚\r\n2. å›è°ƒå‡½æ•°çš„ this å¤„ç†ï¼Œè¿”å› false ç»ˆæ­¢å¾ªç¯\r\n\r\n## åˆ¤æ–­ç±»å‹\r\n\r\nåˆ¤æ–­åŸºæœ¬ç±»å‹æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `typeof`ï¼Œä¸è¿‡å¯¹äºå¼•ç”¨ç±»å‹ï¼Œæ¯”å¦‚æ•°ç»„å’Œå‡½æ•°éƒ½ä¼šè¿”å›`object`ï¼Œé‚£ä¹ˆè¿˜æœ‰æ›´å¥½çš„åˆ¤æ–­æ–¹æ³•ä¹ˆï¼Ÿ\r\né‚£å°±æ˜¯`Object.prototype.toString`\r\n\r\n```js\r\nObject.prototype.toString.call({}); // \"[object Object]\"\r\nObject.prototype.toString.call([]); // \"[object Array]\"\r\n```\r\n\r\nè¿™é‡Œä½¿ç”¨`Object.prototype.toString`çš„åŸå› æ˜¯ä¸€äº›å¼•ç”¨ç±»å‹çš„`toString`æœ‰è‡ªå·±çš„å®ç°æ–¹å¼ï¼Œæ¯”å¦‚æ•°ç»„çš„ `toString` è¿”å›çš„å°±æ˜¯ä»¥`\",\"`åˆ†éš”çš„æ–‡æœ¬ã€‚\r\næ•°ç»„çš„åˆ¤æ–­å¯ä»¥åŸºäºä¸Šé¢æ–¹æ³•ï¼Œä¸‹é¢å°±æ˜¯å°è£…æˆä¸€ä¸ªå‡½æ•°\r\n\r\n```js\r\nfunction isArray(arr) {\r\n  return Object.prototype.toString.call(arr) === \"[object Array]\";\r\n}\r\n```\r\n\r\nä¸‹é¢å°±æ¥å®ç°åˆ¤æ–­ç±»æ•°ç»„çš„çš„æ€è·¯ï¼Œç±»æ•°ç»„å°±æ˜¯æŒ‡ç±»ä¼¼äº\r\n\r\n```js\r\n{1: 123, 2ï¼š45, 6: 789, length: 7}\r\n// or\r\n// nodelist[]\r\n// arguments\r\n// ...\r\n```\r\n\r\nä¸Šé¢åˆ—ä¸¾çš„å‡ ç§å¯¹è±¡ï¼Œéƒ½å­˜åœ¨`length`ï¼Œè€Œä¸”éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»¥è¿™ä¸ªä¸ºåˆ¤æ–­å‡†åˆ™ï¼Œä¸‹é¢å°±æ˜¯å®ç°\r\n\r\n```js\r\nfunction isClassArray(arr) {\r\n  var length = !!arr && length in arr && arr.length;\r\n  return (\r\n    isArray(arr) ||\r\n    length === 0 ||\r\n    (typeof arr === \"number\" && length - 1 in arr)\r\n  );\r\n}\r\n```\r\n\r\nåˆ¤æ–­è¿˜æ˜¯æ¯”è¾ƒç®€æ´çš„ï¼Œåˆ¤æ–­äº†ä¸‰ç§æƒ…å†µ\r\n\r\n1. å¿…é¡»æœ‰ `length` å±æ€§\r\n2. `length` ä¸º 0 çš„æƒ…å†µ\r\n3. `length- 1`å¿…é¡»å­˜åœ¨\r\n\r\nç¬¬ä¸€ç§å°±ä¸è¯´äº†ï¼Œç¬¬äºŒç§ä¸ºä»€ä¹ˆè¦åˆ¤æ–­ length ä¸º `0` çš„æƒ…å†µå‘¢ï¼Ÿ\r\nå‡è®¾æœ‰ä¸€ä¸ªå¯¹è±¡`{a: 1, b: 2, length: 0}`ï¼Œè®¤ä¸ºå®ƒæ˜¯ç±»æ•°ç»„æ˜¯ä¸æ˜¯ä¸å¤ªåˆé€‚ï¼Œè¿˜æœ‰`arguments`æ˜¯ä¸æ˜¯ç±»æ•°ç»„å¯¹è±¡æ ¹æ®å‡½æ•°çš„ä¼ é€’å‚æ•°æ¥å˜åŒ–ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰å‚æ•°`length`ä¸º 0 å°±è¿”å› falseï¼Œæ˜¯ä¸æ˜¯ä¹Ÿä¸å¤ªåˆé€‚ï¼Œå…¶å®è¿™é‡Œä¸»è¦å°±æ˜¯ä¸ºäº†åˆ¤æ–­ä¸€äº›è¾¹ç•Œçš„å¯¹è±¡\r\n\r\n```js\r\nfunction foo() {\r\n  arguments.length; // 0\r\n}\r\nfoo();\r\n```\r\n\r\nç¬¬ä¸‰ç‚¹ï¼Œä¸ºä»€ä¹ˆè¦æ±‚ `length - 1` å­˜åœ¨ï¼Ÿ\r\næ•°ç»„çš„ length æ°¸è¿œæ˜¯æˆå‘˜æ•°+1ï¼Œè¦æ±‚`length - 1` å­˜åœ¨å®é™…ä¸Šè¿™æ˜¯ä¸ºäº†æ•°ç»„å’Œç±»æ•°ç»„çš„å½¢å¼æƒ³å¯¹åº”ï¼Œä¾‹å¦‚ï¼š\r\n\r\n```js\r\nvar a = [, , 2]; // length: 3\r\n// å¯¹åº”ç±»æ•°ç»„\r\nvar obj = {\r\n  2: 2,\r\n  length: 3\r\n};\r\n```\r\n\r\nä¸Šé¢æ•°ç»„å­˜åœ¨`,`æˆ‘ä»¬è®¤ä¸ºå‰é¢ä¸¤ä½å°±æ˜¯ç©ºï¼Œä½†æ˜¯å¦‚æœå–æ¶ˆäº†`length - 1`å¿…é¡»å­˜åœ¨ï¼Œé‚£ä¹ˆä¸‹é¢è¿™ç§å†™æ³•ä¼šå‡ºç°ä¸‹é¢æƒ…å†µ\r\n\r\n```js\r\n// length: 2\r\nvar a = [1, ,];\r\nvar obj = {\r\n  0: 1ï¼Œ\r\n  length: 1\r\n};\r\n```\r\n\r\n## each\r\n\r\nä¸Šé¢æŠŠæ‰€éœ€è¦ç”¨çš„è®²è§£å®Œæ¯•äº†ï¼Œä¸‹é¢å°±æ¥å®ç°ä¸€ä¸ªæœ€ç»ˆç‰ˆçš„ each\r\n\r\n```js\r\nfunction isArray(arr) {\r\n  return Object.prototype.toString.call(arr) === \"[object Array]\";\r\n}\r\nfunction isClassArray(arr) {\r\n  var length = !!arr && length in arr && arr.length;\r\n  return (\r\n    isArray(arr) ||\r\n    length === 0 ||\r\n    (typeof arr === \"number\" && length - 1 in arr)\r\n  );\r\n}\r\nfunction each(obj, callback) {\r\n  if (typeof obj !== \"object\") {\r\n    return obj;\r\n  }\r\n  // æ•°ç»„å’Œç±»æ•°ç»„\r\n  if (isClassArray(obj)) {\r\n    for (let i = 0; i < obj.length; i++) {\r\n      let v = callback.call(obj, i, obj[i]);\r\n      if (v === false) {\r\n        break;\r\n      }\r\n    }\r\n  } else {\r\n    for (let item in obj) {\r\n      let v = callback.call(obj, item, obj[item]);\r\n      if (v === false) {\r\n        break;\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n## å‚è€ƒ\r\n\r\n[JavaScript ä¸“é¢˜ä¹‹ç±»å‹åˆ¤æ–­(ä¸‹) #30](https://github.com/mqyqingfeng/Blog/issues/30)\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/22/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/22/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/19",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/19/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/19/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/19/events",
      "html_url": "https://github.com/bosens-China/blog/issues/19",
      "id": 479944938,
      "node_id": "MDU6SXNzdWU0Nzk5NDQ5Mzg=",
      "number": 19,
      "title": "å•ä¾‹æ¨¡å¼",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1740561541,
          "node_id": "MDU6TGFiZWwxNzQwNTYxNTQx",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F",
          "name": "è®¾è®¡æ¨¡å¼",
          "color": "d1a540",
          "default": false,
          "description": "è®¾è®¡æ¨¡å¼åœ¨JavaScriptçš„å®ç°"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2019-08-13T03:44:23Z",
      "updated_at": "2021-12-21T09:43:21Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "å•ä¾‹æ¨¡å¼æ˜¯å¾ˆå¸¸è§çš„ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹ã€‚\r\n\r\n## å•ä¾‹å®ç°\r\n\r\næ ¹æ®ä¸Šé¢å®šä¹‰å¾ˆå®¹æ˜“æƒ³åˆ°ç”¨é—­åŒ…æ¥å®ç°\r\n\r\n```js\r\nvar dom = (function() {\r\n  var d;\r\n  function createdDiv(html) {\r\n    if (d) {\r\n      return d;\r\n    }\r\n    this.html = html;\r\n    this.init();\r\n    return (d = this);\r\n  }\r\n  createdDiv.prototype.init = function() {\r\n    var dom = document.createElement(\"div\");\r\n    dom.innerHTML = this.html;\r\n    document.body.append(dom);\r\n  };\r\n  return createdDiv;\r\n})();\r\nvar d1 = new dom(\"hello wrold\");\r\nvar d2 = new dom(\"ä½ å¥½ä¸–ç•Œ\");\r\nconsole.log(d1 === d2); // true\r\n```\r\n\r\nä¸Šé¢é€šè¿‡å˜é‡`d`æ¥åˆ¤æ–­ï¼Œæ²¡æœ‰å°±ç”Ÿæˆä¸€ä¸ª`div`ï¼Œæœ‰çš„è¯å°±è¿”å›`d`ï¼Œä¸è¿‡ä¸Šé¢ä»£ç ç”Ÿæˆå’Œä¿è¯å•ä¸€ç»„åˆåœ¨ä¸€èµ·å®é™…ä¸Šè¿åäº†é¢å‘å¯¹è±¡çš„å•ä¸€èŒè´£ï¼Œä¸‹é¢å°±ç”¨ä»£ç†çš„æ–¹å¼æ¥æ¸…é™¤è¿™ç§è€¦åˆã€‚\r\n\r\n## ä»£ç†\r\n\r\nè¿˜æ˜¯é€šè¿‡ä¸Šé¢ä»£ç ä¸ºä¾‹ï¼Œæˆ‘ä»¬é€šè¿‡è§‚å¯Ÿå‘ç°`createdDiv`å‡½æ•°è´Ÿè´£`div`çš„åˆ›å»ºå’Œç”Ÿæˆï¼Œå¦‚ä½•ä¿è¯ç±»çš„å•ä¸€ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦å¤–ä¸€ä¸ªå‡½æ•°æ¥æ£€æµ‹å’Œè¿”å›ã€‚\r\n\r\n```js\r\nvar dom = (function() {\r\n  var d;\r\n  function createdDiv(html) {\r\n    this.html = html;\r\n    this.init();\r\n  }\r\n  createdDiv.prototype.init = function() {\r\n    var dom = document.createElement(\"div\");\r\n    dom.innerHTML = this.html;\r\n    document.body.append(dom);\r\n  };\r\n  return function(h) {\r\n    if (!d) {\r\n      d = new createdDiv(h);\r\n    }\r\n    return d;\r\n  };\r\n})();\r\nvar d1 = new dom(\"hello wrold\");\r\nvar d2 = new dom(\"ä½ å¥½ä¸–ç•Œ\");\r\nconsole.log(d1 === d2); // true\r\n```\r\n\r\n## æƒ°æ€§\r\n\r\nä»¥å…¼å®¹ dom äº‹ä»¶ä¸ºä¾‹ï¼Œie æœ‰è‡ªå·±çš„ dom äº‹ä»¶æ·»åŠ æ–¹æ³•ï¼Œå¦‚æœæˆ‘ä»¬è¦å†™ä¸€ä¸ªå…¼å®¹çš„å‡½æ•°å¯èƒ½ä¼šè¿™æ ·å†™\r\n\r\n```js\r\nfunction addEvent(type, el, fn) {\r\n  if (window.addEventListener) {\r\n    el.addEventListener(type, fn, false);\r\n  } else if (window.attachEvent) {\r\n    el.attachEvent(\"on\" + type, fn);\r\n  }\r\n}\r\n```\r\n\r\nä¸è¿‡è¿™é‡Œæ¯æ¬¡è¿è¡Œå‡½æ•°éƒ½ä¼šåˆ¤æ–­ä¸€æ¬¡ï¼Œå®é™…ä¸Šæ²¡æœ‰å¿…è¦ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é—­åŒ…çš„å½¢å¼åªåˆ¤æ–­ä¸€æ¬¡\r\n\r\n```js\r\nfunction addEvent(type, el, fn) {\r\n  if (window.addEventListener) {\r\n    return function() {\r\n      el.addEventListener(type, fn, false);\r\n    };\r\n  } else if (window.attachEvent) {\r\n    return function() {\r\n      el.attachEvent(\"on\" + type, fn);\r\n    };\r\n  }\r\n}\r\n```\r\n\r\næƒ°æ€§çš„åº”ç”¨å¾ˆå¹¿æ³›ï¼Œè®¸å¤šä¼˜åŒ–ä¹Ÿç‰µæ‰¯å…¶ä¸­ï¼Œæ¯”å¦‚ webpack å¯¹`import()`å¯ä»¥åšåˆ°ä»£ç åˆ†å‰²ï¼Œå‡å°‘é¦–å±åŠ è½½æ—¶é—´ã€‚\r\n\r\n## ä¿¡ä»»å‡½æ•°\r\n\r\nè¿˜æ˜¯é€šè¿‡æƒ°æ€§çš„ä¾‹å­ä¸ºä¾‹ï¼Œæˆ‘ä»¬ç”¨äº†ä¸€ä¸ªé—­åŒ…æ¥å®ç°ï¼Œä¸è¿‡ä¹Ÿå¯ä»¥é€šè¿‡æ”¹å†™è¿™ä¸ªå‡½æ•°æ¥å®ç°\r\n\r\n```js\r\nfunction addEvent(type, el, fn) {\r\n  if (window.addEventListener) {\r\n    addEvent = function(type, el, fn) {\r\n      el.addEventListener(type, fn, false);\r\n    };\r\n  } else if (window.attachEvent) {\r\n    addEvent = function(type, el, fn) {\r\n      el.attachEvent(\"on\" + type, fn);\r\n    };\r\n  }\r\n}\r\n```\r\n\r\n## es6 ä¹‹åçš„å•ä¾‹\r\n\r\nåœ¨ javascript ä¸­å•ä¾‹å®é™…ä¸Šæœ‰äº›ç‰¹æ®Šï¼Œå› ä¸ºå¹¶æ²¡æœ‰ç±»ï¼Œè€Œä¸”å•ä¾‹çš„ä½œç”¨åªæ˜¯ä¸ºäº†ä¿è¯ç±»çš„å•ä¸€æ€§ï¼Œé‚£æˆ‘ä»¬å¯ä»¥ç›´æ¥å®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡å°±å¯ä»¥åšåˆ°äº†\r\n\r\n```js\r\nvar a = {};\r\n```\r\n\r\nè¿™é‡Œ`a`åœ¨å…¨å±€åªä¼šå­˜åœ¨ä¸€æ¬¡ï¼Œä¸è¿‡ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯ä¼šè¢«è¦†ç›–å’Œä¿®æ”¹ä»¥åŠæ±¡æŸ“äº†å…¨å±€å˜é‡ï¼Œè€Œä» es6 å¼€å§‹å¼•ç”¨äº†æ¨¡å—çš„æœºåˆ¶ï¼Œå®ƒæœ‰äº›ç‰¹æ®Šï¼Œå®ƒæ˜¯è¿è¡Œå‰åŠ è½½ï¼Œè€Œä¸”ä¼šå°†æ¨¡å—çš„å€¼åŠ¨æ€åŒæ­¥ï¼Œæ€ä¹ˆç†è§£è¿™å¥è¯å‘¢ï¼Ÿ\r\n\r\n```js\r\nlet d = 5;\r\nsetTimeout(() => {\r\n  d = 10;\r\n}, 1000);\r\nexport { d };\r\n// å¼•ç”¨\r\n\r\nimport { d } from \"./demo.js\";\r\nconsole.log(d);\r\nsetTimeout(() => {\r\n  console.log(d);\r\n}, 1000);\r\n```\r\n\r\nä¸Šé¢ä¼šè¾“å‡º 5 å’Œ 10,æ‰€ä»¥æ ¹æ®æ¨¡å—è¿™ä¸€ç‰¹æ€§å¯ä»¥å¾ˆè½»æ¾å®ç°å•ä¾‹æ¨¡å¼\r\n\r\n```js\r\nlet event;\r\nif (!event) {\r\n  if (window.addEventListener) {\r\n    event = function(type, el, fn) {\r\n      el.addEventListener(type, fn, false);\r\n    };\r\n  } else if (window.attachEvent) {\r\n    event = function(type, el, fn) {\r\n      el.attachEvent(\"on\" + type, fn);\r\n    };\r\n  }\r\n}\r\nexport default event;\r\n```\r\n\r\n## æœ€å\r\n\r\nä¸Šé¢ç®€å•ä»‹ç»äº†å•ä¾‹çš„ä¼ ç»Ÿå®ç°ï¼Œä»¥åŠåœ¨ javascript ä¸­çš„å®ç°ï¼Œæœ€åé¢å¤–æä¸€ä¸‹ï¼Œes6 æ–°å¢çš„`symbol`ä¹Ÿå¯ä»¥è·Ÿå•ä¾‹æƒ³ç»“åˆä½¿ç”¨ï¼Œå®ƒç¡®ä¿äº†è¿™ä¸ªå±æ€§åæ˜¯å”¯ä¸€çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡`symbol.for`æ¥åˆ¤æ–­æœ‰æ²¡æœ‰è¿™ä¸ª`symbol`\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/19/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/19/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/20",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/20/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/20/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/20/events",
      "html_url": "https://github.com/bosens-China/blog/issues/20",
      "id": 480491465,
      "node_id": "MDU6SXNzdWU0ODA0OTE0NjU=",
      "number": 20,
      "title": "å‘å¸ƒè®¢é˜…æ¨¡å¼",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1740561541,
          "node_id": "MDU6TGFiZWwxNzQwNTYxNTQx",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F",
          "name": "è®¾è®¡æ¨¡å¼",
          "color": "d1a540",
          "default": false,
          "description": "è®¾è®¡æ¨¡å¼åœ¨JavaScriptçš„å®ç°"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2019-08-14T05:44:57Z",
      "updated_at": "2021-12-21T09:42:53Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "å‘å¸ƒè®¢é˜…æ¨¡å¼ä¹Ÿæˆä¸ºè§‚å¯Ÿè€…æ¨¡å¼ï¼Œä»¥ä¸‹é¢ä¸‰éƒ¨åˆ†ç»„æˆ\r\n\r\n1. å‘å¸ƒè€…\r\n2. è®¢é˜…è€…\r\n3. æ¶ˆæ¯é˜Ÿåˆ—\r\n\r\nä¸Šé¢ä»‹ç»äº†ç»„æˆå¯èƒ½ä½ è¿˜æœ‰ç–‘æƒ‘ï¼Œä¸‹é¢å°±ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå°æ˜æ‰“ç®—å»å”®æ¥¼å¤„å»ä¹°ä¸€å¥—æˆ¿å­ï¼Œé”€å”®å°å§å‘Šè¯‰ä»–è¿™å¥—ä½å®…æš‚æ—¶æ²¡æœ‰æˆ¿æºï¼Œå°æ˜äºæ˜¯ç•™äº†æ‰‹æœºå·ç ç»™ä»–ï¼ŒæŸä¸€å¤©æœ‰æˆ¿æºçš„æ—¶å€™é€šçŸ¥ä»–ã€‚\r\nä¸Šé¢ä¾‹å­ä¸­ï¼Œå‘å¸ƒè€…å°±æ˜¯å”®æ¥¼ä¸­å¿ƒï¼Œè®¢é˜…è€…å°±æ˜¯å°æ˜ï¼Œæ¶ˆæ¯é˜Ÿåˆ—å°±æ˜¯å°æ˜ç•™çš„æ‰‹æœºå·ç ï¼Œè§‚å¯Ÿè€…æ¨¡å¼å¯ä»¥è®©å¯¹è±¡æ¾è€¦åˆåœ¨ä¸€èµ·ã€‚\r\n\r\n## å®ç°\r\n\r\n> ä¸‹é¢ä½¿ç”¨ ES6 çš„è¯­æ³•æ¥å†™ï¼Œå¦‚æœæ²¡æœ‰åŸºç¡€ï¼Œæ¨èçœ‹ä¸€é es6 å…¥é—¨å†æ¥\r\n\r\nä¸Šé¢ä»‹ç»äº†å®šä¹‰ï¼Œå°±æ ¹æ®ä¸Šé¢çš„å®šä¹‰ç¼–å†™ä¸€ä¸ªå¯ä»¥å–æ¶ˆä»¥åŠæ”¯æŒä¼ é€’å‚æ•°çš„è§‚å¯Ÿè€…å®ä¾‹\r\n\r\n```js\r\nconst Event = new (class Watch {\r\n  constructor() {\r\n    // æ¶ˆæ¯é˜Ÿåˆ—\r\n    this.list = {};\r\n  }\r\n  // è®¢é˜…\r\n  subscribe(key, fn) {\r\n    if (!this.list[key]) {\r\n      // é¿å…é‡å¤\r\n      this.list[key] = new Set();\r\n    }\r\n    this.list[key].add(fn);\r\n  }\r\n  // è§¦å‘\r\n  trigger(key, ...args) {\r\n    const v = this.list[key];\r\n    if (!v) {\r\n      return;\r\n    }\r\n    v.forEach((f) => f.apply(this, args), this);\r\n  }\r\n  // åˆ é™¤ï¼Œkeyæ˜¯å¿…é¡»çš„\r\n  remove(key, fn) {\r\n    const v = this.list[key];\r\n    if (!v) {\r\n      return false;\r\n    }\r\n    if (v.has(fn)) {\r\n      return v.delete(fn);\r\n    }\r\n    // clearæ²¡æœ‰è¿”å›å€¼ï¼Œè¿™é‡Œè¿”å›ä¸€ä¸ªtrue\r\n    return v.clear() || true;\r\n  }\r\n})();\r\nEvent.subscribe('abc', function (a) {\r\n  console.log(a); // x\r\n});\r\nEvent.trigger('abc', 'x');\r\n```\r\n\r\nä¸Šé¢å°±å®ç°äº†ç®€å•çš„è§‚å¯Ÿè€…æ¨¡å¼ï¼Œä¸è¿‡å¯ä»¥è§‚å¯Ÿä¸Šé¢ä»£ç å¯ä»¥å‘ç°è§‚å¯Ÿè€…è¿è¡Œçš„æœºåˆ¶æ˜¯*å…ˆè®¢é˜…åå‘å¸ƒ*ï¼Œæœ‰æ²¡æœ‰åŠæ³•ç±»ä¼¼äº QQ æ¶ˆæ¯ä¸€æ ·ï¼Œå¯ä»¥æ¥æ”¶åˆ°ç¦»çº¿æ¶ˆæ¯ï¼Œå½“ç„¶è¿™ä¸ªç¦»çº¿æ¶ˆæ¯åªèƒ½æ¥æ”¶ä¸€æ¬¡ã€‚\r\n\r\n## æ”¯æŒå…ˆå‘å¸ƒåè®¢é˜…\r\n\r\nå®ç°çš„æ€è·¯å¾ˆç®€å•ï¼Œå°±æ˜¯é€šè¿‡ä¸€ä¸ªç¦»çº¿æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå‘å¸ƒçš„æ—¶å€™åˆ¤æ–­è¿™ä¸ªç¦»çº¿æ¶ˆæ¯é˜Ÿåˆ—å­˜åœ¨ä¹ˆï¼Œå¦‚æœå­˜åœ¨ï¼Œå°†æ¶ˆæ¯å­˜æ”¾åœ¨ç¦»çº¿æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå½“è®¢é˜…çš„æ—¶å€™å¦‚æœå‘ç°æœ‰ç¦»çº¿æ¶ˆæ¯é˜Ÿåˆ—å°±æ‰§è¡Œä¸€æ¬¡ï¼Œä¹‹åæ¸…ç©º\r\n\r\n```js\r\nconst Event = new (class Watch {\r\n  constructor() {\r\n    // æ¶ˆæ¯é˜Ÿåˆ—\r\n    this.list = {};\r\n    this.offLine = new Set();\r\n  }\r\n  // è®¢é˜…\r\n  subscribe(key, fn) {\r\n    if (!this.list[key]) {\r\n      // é¿å…é‡å¤\r\n      this.list[key] = new Set();\r\n    }\r\n    this.list[key].add(fn);\r\n    if (this.offLine) {\r\n      this.offLine.forEach((f) => f(), this);\r\n    }\r\n    this.offLine = null;\r\n  }\r\n  // è§¦å‘\r\n  trigger(key, ...args) {\r\n    // å…³é”®ä»£ç \r\n    const fn = () => {\r\n      const v = this.list[key];\r\n      if (!v) {\r\n        return;\r\n      }\r\n      v.forEach((f) => f.apply(this, args), this);\r\n    };\r\n    if (this.offLine) {\r\n      this.offLine.add(fn);\r\n    }\r\n    fn();\r\n  }\r\n  // åˆ é™¤ï¼Œkeyæ˜¯å¿…é¡»çš„\r\n  remove(key, fn) {\r\n    const v = this.list[key];\r\n    if (!v) {\r\n      return false;\r\n    }\r\n    if (v.has(fn)) {\r\n      return v.delete(fn);\r\n    }\r\n    // clearæ²¡æœ‰è¿”å›å€¼ï¼Œè¿™é‡Œè¿”å›ä¸€ä¸ªtrue\r\n    return v.clear() || true;\r\n  }\r\n})();\r\nEvent.trigger('abc', 'x');\r\nEvent.subscribe('abc', function (a) {\r\n  console.log(a); // x\r\n});\r\n```\r\n\r\næ’’èŠ±ï¼Œä¸€ä¸ªæ”¯æŒå–æ¶ˆå’Œå…ˆå‘å¸ƒåè®¢é˜…çš„è§‚å¯Ÿè€…æ¨¡å¼å·²ç»å®ç°äº†ï¼Œä¸è¿‡è¿˜æ˜¯æœ‰å¾…ä¼˜åŒ–çš„åœ°æ–¹ï¼Œæ¯”å¦‚å‘½åï¼Œæˆ‘ä»¬èƒ½ä¸èƒ½é€šè¿‡`Event.created('zhangsan').trigger`çš„å½¢å¼æ¥è°ƒç”¨å‘¢ï¼Ÿ\r\n\r\n## å‘½å\r\n\r\nåŠ¨æ‰‹å†™ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆç¼•æ¸…ä¸€ä¸‹å¤´ç»ª\r\n\r\n- å‘½åæ˜¯å¦å¿…é¡»ï¼Œèƒ½ä¸èƒ½ä¸é€šè¿‡`created`å…ˆè°ƒç”¨ï¼Œæ¯”å¦‚ç›´æ¥å°±æ˜¯`Event.trigger`å‘å¸ƒä¹‹åå†è®¢é˜…\r\n\r\nokï¼Œä¸‹é¢å°±æ˜¯é’ˆå¯¹ä¸Šé¢é—®é¢˜å®ç°\r\n\r\n```js\r\n// å®šä¹‰ä¸€ä¸ªåŸºç¡€ç±»ï¼Œè¿™ä¸ªç±»æ˜¯å®ç°çš„æ ¸å¿ƒå±‚\r\nclass Basics {\r\n  _obj = {};\r\n  _default = 'default';\r\n  _created(name = this._default) {\r\n    // å®šä¹‰æ¶ˆæ¯é˜Ÿåˆ—å’Œç¦»çº¿æ¶ˆæ¯é˜Ÿåˆ—\r\n    const list = {};\r\n    let offLine = new Set();\r\n    const then = this;\r\n    const obj = {\r\n      // è§¦å‘ï¼Œå¦‚æœç¬¬ä¸€æ¬¡è§¦å‘å°±æ·»åŠ åˆ°ç¦»çº¿é˜Ÿåˆ—ä¸­\r\n      trigger(key, ...rest) {\r\n        const fn = () => {\r\n          const arr = [list, key, ...rest];\r\n          return then._trigger.apply(then, arr);\r\n        };\r\n        if (offLine) {\r\n          offLine.add(fn);\r\n        }\r\n        return fn();\r\n      },\r\n      // æ·»åŠ è®¢é˜…è€…åŒæ—¶æ‰§è¡Œç¦»çº¿é˜Ÿåˆ—\r\n      subscribe(key, fn) {\r\n        then._subscribe(...[list, key, fn]);\r\n        if (offLine) {\r\n          offLine.forEach((f) => f());\r\n        }\r\n        offLine = null;\r\n      },\r\n      // åˆ é™¤ï¼Œkeyæ˜¯å¿…é¡»çš„\r\n      remove(key, fn) {\r\n        const v = this.list[key];\r\n        if (!v) {\r\n          return false;\r\n        }\r\n        if (v.has(fn)) {\r\n          return v.delete(fn);\r\n        }\r\n        // clearæ²¡æœ‰è¿”å›å€¼ï¼Œè¿™é‡Œè¿”å›ä¸€ä¸ªtrue\r\n        return v.clear() || true;\r\n      },\r\n    };\r\n    // åˆ¤æ–­å‘½åæ¥å†³å®šè¿”å›\r\n    return name ? (this._obj[name] ? this._obj[name] : (this._obj[name] = obj)) : obj;\r\n  }\r\n  // è§¦å‘\r\n  _trigger(l, k, ...args) {\r\n    const v = l[k];\r\n    if (!v || !v.size) {\r\n      return;\r\n    }\r\n    return Array.from(v, (f) => f.apply(this, args), this);\r\n  }\r\n  _subscribe(list, key, fn) {\r\n    if (!list[key]) {\r\n      list[key] = new Set();\r\n    }\r\n    list[key].add(fn);\r\n  }\r\n}\r\n// è¿™ä¸ªæ˜¯å®ç°ç±»\r\nclass Watch extends Basics {\r\n  constructor() {\r\n    // å¿…é¡»ï¼Œes6è§„å®š\r\n    super();\r\n    this.created = super._created;\r\n  }\r\n  trigger(key, ...rest) {\r\n    const v = this.created();\r\n    v.trigger(key, ...rest);\r\n  }\r\n  subscribe(key, fn) {\r\n    const v = this.created();\r\n    v.subscribe(key, fn);\r\n  }\r\n  remove(key, fn) {\r\n    const v = this.created();\r\n    v.remove(key, fn);\r\n  }\r\n}\r\nconst Event = new Watch();\r\nEvent.trigger('abc');\r\nEvent.subscribe('abc', function () {\r\n  console.log(123);\r\n});\r\nEvent.created('zhangsan').subscribe('abc', function (c) {\r\n  console.log(c);\r\n});\r\nEvent.created('zhangsan').trigger('abc', 456);\r\n```\r\n\r\nåœ¨å®é™…ä¸­æˆ‘ä»¬ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼çš„ä¾‹å­ä¹Ÿæœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ä¸€ä¸ªç½‘ç«™ï¼Œåˆ†ä¸ºå¯¼èˆªå’Œä¾§è¾¹ï¼Œå½“ç”¨æˆ·ä¿¡æ¯æ›´æ–°çš„æ—¶å€™å±•ç¤ºéƒ¨åˆ†éœ€è¦æ›´æ¢å°±å¯ä»¥ç”¨åˆ°ï¼Œè¿˜æœ‰æˆ‘ä»¬ç”¨çš„æ¡†æ¶ï¼Œæ¯”å¦‚`vueã€React`ç­‰\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/20/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/20/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/21",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/21/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/21/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/21/events",
      "html_url": "https://github.com/bosens-China/blog/issues/21",
      "id": 482752452,
      "node_id": "MDU6SXNzdWU0ODI3NTI0NTI=",
      "number": 21,
      "title": "ä»£ç†æ¨¡å¼",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1740561541,
          "node_id": "MDU6TGFiZWwxNzQwNTYxNTQx",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F",
          "name": "è®¾è®¡æ¨¡å¼",
          "color": "d1a540",
          "default": false,
          "description": "è®¾è®¡æ¨¡å¼åœ¨JavaScriptçš„å®ç°"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2019-08-20T09:37:17Z",
      "updated_at": "2021-12-21T09:41:37Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "## å‰è¨€\r\n\r\nä»£ç†æ¨¡å¼æ˜¯ä¸ºä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ä¸ªä»£ç”¨å“æˆ–å ä½ç¬¦ï¼Œä»¥ä¾¿æ§åˆ¶å¯¹å®ƒçš„è®¿é—®ã€‚\r\nä¾‹å¦‚ï¼š\r\n![1](https://user-images.githubusercontent.com/39508895/63336089-23272700-c371-11e9-8bf0-f31c74e016b6.jpg)\r\n\r\nä¸‹é¢å°±ä»‹ç»æœ€å¸¸ç”¨çš„å‡ ç§åœºæ™¯\r\n\r\n## ä¿æŠ¤ä»£ç†\r\n\r\nä¾‹å¦‚ä½œä¸ºå­©å­æˆ‘ä»¬æ€»å¸Œæœ›ä»–å¥åº·æˆé•¿ï¼Œåœ¨æˆé•¿è·¯ä¸Šé‡åˆ°çš„çƒ¦æ¼ä¼šè¢«å®¶é•¿è§£å†³ï¼Œè¿™æ ·æ¥çœ‹å…¶å®å°±æ˜¯ä¿æŠ¤ä»£ç†ï¼Œä¸‹é¢ç”¨ä¸€æ®µä¼ªä»£ç æ¥å®ç°ã€‚\r\n\r\n```js\r\nfunction Children() {\r\n  this.knowledge = [];\r\n}\r\nChildren.prototype.Study = function(content) {\r\n  // ...å­¦ä¹ ï¼Œå¢åŠ çŸ¥è¯†\r\n  this.knowledge.push(content);\r\n};\r\nvar Parent = (function() {\r\n  var small = new Children();\r\n  return {\r\n    knowledge: function(content) {\r\n      if (content === \"bad\") {\r\n        // åçš„ï¼Œè¿‡æ»¤æ‰\r\n      } else {\r\n        small.Study(content);\r\n      }\r\n    }\r\n  };\r\n})();\r\n```\r\n\r\nä¸Šé¢ç”¨ä¼ªä»£ç çš„å½¢å¼æ¥å®ç°äº†ä¸€ä¸ªä¿æŠ¤ä¾‹å­ï¼Œä¸è¿‡ä½ å¯èƒ½ä¼šå›°æƒ‘ï¼Œè¿™æ ·ä¸æ˜¯å¤šæ­¤ä¸€ä¸¾ä¹ˆï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥åœ¨`Children`å†…éƒ¨å®ç°ï¼Œä¸è¿‡è¿™æ ·åš\r\n\r\n1. å¢åŠ äº†ç¨‹åºè€¦åˆåº¦ï¼Œå¦‚æœæƒ³è¦è¿‡æ»¤æ›´å¤šï¼Œæˆ–è€…æŸä¸€å¤©ä¸è¿‡æ»¤äº†ï¼Œè¿˜è¦æ›´æ”¹ä»£ç \r\n2. è¿èƒŒäº†å•ä¸€åŸåˆ™ï¼Œå¯¹äºä»£ç çš„é˜…è¯»å’Œç»´æŠ¤ï¼Œé€ æˆäº†æ›´å¤šçš„æˆæœ¬\r\n\r\n## ç¼“å­˜ä»£ç†\r\n\r\nç¼“å­˜ä»£ç†æ˜¯å¾ˆå®ç”¨çš„ä¸€ä¸ªä¾‹å­ï¼Œä¾‹å¦‚ä¸€ä¸ª`é˜¶ä¹˜å‡½æ•°`ï¼Œè®¡ç®— n çš„é˜¶ä¹˜ï¼Œæœ€å¤šéœ€è¦ä¿å­˜ n ä¸ªè°ƒç”¨è®°å½•ï¼Œæˆ‘ä»¬å¯èƒ½è¿™æ ·å†™\r\n\r\n```js\r\nfunction factorial(n) {\r\n  if (n === 1) return 1;\r\n  return n * factorial(n - 1);\r\n}\r\nfactorial(5); // 120\r\n```\r\n\r\nä¸è¿‡å¦‚æœé‡å¤è®¡ç®— 5 æˆ–è€… 10ï¼Œå¾ˆæ˜æ˜¾é€ æˆäº†å¤šæ¬¡æµªè´¹ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨ä»£ç†ï¼ŒæŠŠç»“æœç¼“å­˜ä¸‹æ¥ï¼Œå¦‚æœå­˜åœ¨å°±ç›´æ¥è¿”å›ã€‚\r\n\r\n```js\r\nfunction next(n, total) {\r\n  if (n === 1) return 1;\r\n  return n * factorial(n - 1);\r\n}\r\nvar factorial = (function() {\r\n  var obj = {};\r\n  return function(v) {\r\n    if (obj[v]) {\r\n      return obj[v];\r\n    }\r\n    obj[v] = next(v);\r\n    return obj[v];\r\n  };\r\n})();\r\nfactorial(5); // 120\r\nfactorial(5); // 120\r\n```\r\n\r\nä¸Šé¢å°±å°†ç»“æœç¼“å­˜äº†ä¸‹æ¥ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥å¼•ç”¨åœ¨å¼‚æ­¥è¯·æ±‚ä¸­å¯ä»¥èŠ‚çœåŠ è½½çš„æ—¶é—´ã€‚\r\n\r\n## åº”ç”¨åœºæ™¯\r\n\r\nä¸Šé¢ç®€å•ä»‹ç»äº†ä¸¤ç§æ¨¡å¼ï¼Œå®é™…ä¸Šè¿˜æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚è™šæ‹Ÿä»£ç†ã€è¿œç¨‹ä»£ç†ã€é˜²ç«å¢™ä»£ç†ç­‰ï¼Œä¸è¿‡è¿™é‡Œä¸åšä»‹ç»äº†ï¼Œä¸‹é¢çœ‹çœ‹ä½¿ç”¨åœºæ™¯ã€‚\r\n\r\n### jquery\r\n\r\n`jquery`åŸºäºé“¾å¼è°ƒç”¨ï¼Œæ¯”å¦‚`$('.a').html('').text('')`ï¼Œä¸è¿‡ä½ ä¼šä¸ä¼šå¾ˆå¥½å¥‡ï¼Œ`$()`è°ƒç”¨çš„æ—¶å€™å®ƒæ˜¯æ€ä¹ˆè®°å½•è¿™ä¸ªå€¼çš„å‘¢ï¼Œæ¯æ¬¡è°ƒç”¨`$()`å­˜å‚¨çš„ dom éƒ½ä¸ç›¸åŒï¼Œå®é™…ä¸Šå®ƒå°±æ˜¯å€Ÿç”¨äº†ä»£ç†æ¨¡å¼ï¼Œè¿™é‡Œç›´æ¥è´´ä»£ç äº†\r\n\r\n```js\r\nfunction Jquery(dom) {\r\n  this.dom = dom;\r\n}\r\n// ä»£ç†è€…\r\nfunction $(dom) {\r\n  return new Jquery(dom);\r\n}\r\n$.prototype = Jquery.prototype = {\r\n  // åªåšæ¼”ç¤ºï¼Œä¸æ¶‰åŠå…·ä½“ä»£ç \r\n  html() {\r\n    return this;\r\n  },\r\n  text() {\r\n    return this;\r\n  }\r\n};\r\n$(\".a\")\r\n  .html(\"\")\r\n  .text(\"\");\r\n```\r\n\r\n### vue\r\n\r\næˆ‘ä»¬åœ¨ä½¿ç”¨ vue çš„æ—¶å€™ç»™å®šäº†é…ç½®é¡¹`data`ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œé¢çš„å±æ€§ä¼šè¢« vue å“åº”å¼å¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡`this.`çš„æ–¹å¼æ¥ç®€å•è®¿é—®ï¼Œä¹Ÿæ˜¯ç”¨äº†ä»£ç†æ¨¡å¼ï¼Œä¸‹é¢å°±ç”¨ä¸€æ®µä¼ª vue ä»£ç æ¥è¯´æ˜\r\n\r\n```js\r\nclass Mvvm {\r\n  constructor(option = {}) {\r\n    this.$option = option;\r\n    this._data = option.data || {};\r\n    // ä»£ç†æ•°æ®\r\n    for (const name in this._data) {\r\n      Object.defineProperty(this, name, {\r\n        configurable: true,\r\n        enumerable: true,\r\n        get() {\r\n          return this._data[name];\r\n        },\r\n        set(v) {\r\n          return (this._data[name] = v);\r\n        }\r\n      });\r\n    }\r\n  }\r\n}\r\nexport default Mvvm;\r\n```\r\n\r\nå¯ä»¥å¤åˆ¶ä¸Šé¢ä»£ç ï¼Œè‡ªå·±ç®€å•è¯•ä¸‹ã€‚\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/21/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/21/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/13",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/13/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/13/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/13/events",
      "html_url": "https://github.com/bosens-China/blog/issues/13",
      "id": 479666633,
      "node_id": "MDU6SXNzdWU0Nzk2NjY2MzM=",
      "number": 13,
      "title": "ç›¸ç­‰è¿ç®—ç¬¦æ¯”è¾ƒ",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1602397157,
          "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
          "name": "æ·±å…¥ç³»åˆ—",
          "color": "719192",
          "default": false,
          "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2019-08-12T14:08:20Z",
      "updated_at": "2021-12-21T09:40:08Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "> çœ‹ã€Šä½ æ‰€ä¸çŸ¥é“çš„JavaScriptã€‹ä¸€ä¹¦ï¼Œå‘ç°å¯¹ç›¸ç­‰è¿ç®—ç¬¦çš„æè¿°æ¨ç¿»äº†è®¸å¤šäººçš„å›ºæœ‰å½±å“ï¼Œå¦‚æœç†Ÿæ‚‰å…¶æœºåˆ¶ï¼Œå¯ä»¥æ–¹ä¾¿æˆ‘ä»¬å¿«é€Ÿå¼€å‘\r\n``` js\r\nfunction foo(s) {\r\n  s = s == null ?  true: s;\r\n  // ...\r\n};\r\n```\r\nä¸Šé¢è¿™æ®µä»£ç æˆ‘ä»¬ä¼°è®¡ç»å¸¸ä½¿ç”¨ï¼Œå…¶å®å°±æ˜¯ä½¿ç”¨äº†éšå¼è½¬æ¢ï¼Œä¸‹é¢å°±æ¥èŠèŠç›¸ç­‰è¿ç®—ç¬¦\r\n\r\n## è§„åˆ™\r\n1. æ•°å€¼ä¸å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œè½¬åŒ–ä¸ºæ•°å€¼æ¯”è¾ƒ\r\n``` js\r\n42 == \"42\";\r\n// ç­‰äº\r\n42 == Number(\"42\");\r\n```\r\n2. å¸ƒå°”å‹ä¸å…¶ä»–ç±»å‹æ¯”è¾ƒï¼Œè½¬åŒ–ä¸ºæ•°å€¼ï¼Œä¹‹åæ¯”è¾ƒ\r\n``` js\r\n\"42\" == true;\r\n// ç­‰äº\r\n\"42\" == Number(true);\r\n\"42\" == 1;\r\nNumber(\"42\") == 1;\r\n```\r\n3. undefined åªä¸ null ç›¸ç­‰ï¼Œå…¶ä»–è¿”å› false\r\n``` js\r\n// å…¨éƒ¨false\r\nnull == false;\r\nnull == true;\r\nnull == \"\";\r\nnull == 0;\r\nundefined == true;\r\nundefined == false;\r\nundefined == \"\";\r\nundefined == 0;\r\n```\r\n4. å¯¹è±¡\r\nå¯¹è±¡ä¸åŸºæœ¬ç±»å‹æ¯”è¾ƒï¼Œä¼šå°†å¯¹è±¡è½¬åŒ–ä¸ºåŸºæœ¬ç±»å‹ä¹‹åå†è¿›è¡Œæ¯”è¾ƒï¼›\r\nè½¬åŒ–è§„åˆ™å¾ˆç®€å•ï¼Œé»˜è®¤è°ƒç”¨ `valueOf`ï¼Œå¦‚æœè¿”å›ä¸æ˜¯åŸºæœ¬ç±»å‹ç»§ç»­è°ƒç”¨ `toStirng`ï¼Œå¦‚æœè¿”å›è¿˜ä¸æ˜¯åŸºæœ¬ç±»å‹ä¼šæŠ¥é”™ã€‚\r\n``` js\r\n[42] == 42;\r\n// ç­‰äº\r\n\"42\" == 42;\r\nNumber(\"42\") == 42;\r\n\r\n\"abc\" == new String(\"abc\");\r\n// ç­‰äº\r\n\"abc\" == \"abc\";\r\n```\r\næ ¹æ®å¯¹è±¡è½¬åŒ–è§„åˆ™ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰è¿”å›çš„å€¼ï¼Œæ¯”å¦‚ï¼š\r\n``` js\r\nvar a = [];\r\na.valueOf = function() {\r\n  return 42;\r\n};\r\na.toString = function() {\r\n  return \"123\";\r\n};\r\na == 42; //true\r\n```\r\n\r\n## å®æˆ˜\r\nä¸Šé¢ç®€å•ä»‹ç»äº†ä¸€ä¸‹è§„åˆ™ï¼Œå†æ¥çœ‹ä¸€ä¸‹éšå½¢çš„é—®é¢˜\r\n1. [] = ![]\r\nè¿™é‡Œä¼šè¿”å› true åŸå› å¾ˆç®€å•ï¼Œæ ¹æ®ä¸Šè¿°è§„åˆ™å…¶å®ä¹Ÿå°±æ˜¯\"\" == 0æ¯”è¾ƒ\r\n2. 0 == '\\n' \r\nè¿™é‡Œä¼šè¿”å› trueï¼Œå› ä¸ºç©ºæ ¼å’Œä¸€äº›å…¶ä»–åˆ¶è¡¨ç¬¦ä¼šè¢«å¿½ç•¥æ‰ã€‚ å†æ¥çœ‹ä¸€äº›å¸¸è§çš„é™·é˜±\r\n``` js\r\n\"0\" == false; // true\r\nfalse == 0; // true\r\nfalse == \"\"; // true\r\nfalse == []; // true\r\n\"\" == []; // true\r\n0 == []; // true\r\n\"\" == 0; // true\r\n```\r\n3. [null] == \"\"\r\nè¿™é‡Œä¸ºtrueï¼Œå¯èƒ½ä½ åœ¨æƒ³[null]è¿”å›çš„ä¸å°±æ˜¯å­—ç¬¦ä¸² null ä¹ˆï¼Œä¸è¿‡å¾ˆé—æ†¾ï¼Œ**null å’Œ undefinedï¼Œåœ¨æ•°ç»„ä¸­è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ä¸º\"\"**ï¼Œè¿™æ˜¯ JavaScript æ‰€è§„å®šçš„ã€‚\r\n``` js\r\n[null] == \"\";\r\n// è½¬åŒ–ä¸º\r\n\"\" == \"\";\r\n```\r\n\r\n## æœ€å\r\n``` js\r\n// aå¯èƒ½ä¸ºtrueæ‰§è¡Œä¸‹å»ä¹ˆ\r\nif (a == 2 && a == 3) {\r\n  // æ‰§è¡Œé‡Œé¢çš„ä»£ç \r\n}\r\n```",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/13/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/13/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/3",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/3/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/3/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/3/events",
      "html_url": "https://github.com/bosens-China/blog/issues/3",
      "id": 475021768,
      "node_id": "MDU6SXNzdWU0NzUwMjE3Njg=",
      "number": 3,
      "title": "å‡½æ•°é˜²æŠ–",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1602397157,
          "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
          "name": "æ·±å…¥ç³»åˆ—",
          "color": "719192",
          "default": false,
          "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2019-07-31T09:01:16Z",
      "updated_at": "2021-12-21T09:39:39Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "## å‰è¨€\r\n\r\n1. ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨é˜²æŠ–å‡½æ•°\r\n   å½“ä¸€ä¸ªäº‹ä»¶è§¦å‘å¤ªå¤šçš„æ—¶å€™ä¼šå‡ºç°æ€§èƒ½é—®é¢˜ï¼Œæ¯”å¦‚`mousemove`ã€`resize`ã€`scroll`ç­‰ï¼Œçœ‹ä¸€ä¸ªæ²¡æœ‰ä»»ä½•é˜²æŠ–çš„`mousemove`äº‹ä»¶\r\n\r\n![1](https://user-images.githubusercontent.com/39508895/62198507-526ef780-b3b4-11e9-8019-21e510329930.gif)\r\n\r\n2. ä»€ä¹ˆæ˜¯é˜²æŠ–?\r\n   ç®€å•å°±æ˜¯ä½ ä»»æ„è§¦å‘æˆ‘åªæ‰§è¡Œæœ€åä¸€æ¬¡æ“ä½œ\r\n\r\næ ¹æ®ä¸Šé¢çš„å®šä¹‰å¯ä»¥å¾ˆè½»æ¾ç¼–å†™å‡ºä¸€ä¸ªç®€å•çš„é˜²æŠ–å‡½æ•°\r\n\r\n### å®ç°\r\n\r\n```js\r\n// ç¬¬ä¸€ç‰ˆ\r\nfunction antiShake(call, time) {\r\n  var i = null;\r\n  return function() {\r\n    clearTimeout(i);\r\n    i = setTimeout(call, time);\r\n  };\r\n}\r\n```\r\n\r\n![2](https://user-images.githubusercontent.com/39508895/62198572-77fc0100-b3b4-11e9-8ad5-a46ac6a5a2e1.gif)\r\n\r\n### this ä»¥åŠå‚æ•°\r\n\r\nä¸è¿‡è¿™æ ·æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ this æŒ‡å‘ä¸æ­£ç¡®ä»¥åŠå‚æ•°ä¸¢å¤±ï¼Œè¿™é‡Œä»¥`mousemove`ä¸ºä¾‹ï¼Œè§¦å‘å‡½æ•°çš„æ—¶å€™ä¼šæœ‰ä¸€ä¸ª`MouseEvent`å¯¹è±¡ï¼Œå¦‚æœæ‰“å°å‡½æ•°å‚æ•°ä¼šå‘ç°ä¸º`undefined`ï¼Œä¸‹é¢å°±æ¥ä¿®å¤ä¸€ä¸‹\r\n\r\n```js\r\n//  ç¬¬äºŒç‰ˆ\r\nfunction antiShake(call, time) {\r\n  var i = null;\r\n  return function() {\r\n    var that = this;\r\n    var rest = arguments;\r\n    clearTimeout(i);\r\n    i = setTimeout(function() {\r\n      call.apply(that, rest);\r\n    }, time);\r\n  };\r\n}\r\n```\r\n\r\n### ç«‹å³æ‰§è¡Œ\r\n\r\næœ‰æ—¶å€™æˆ‘ä¸æƒ³è®©ä»–ç­‰å¾…æ—¶é—´ç»“æŸåœ¨æ‰§è¡Œï¼Œè€Œæ˜¯ä¸€å¼€å§‹å°±è§¦å‘\r\n![4](https://user-images.githubusercontent.com/39508895/62198651-99f58380-b3b4-11e9-9fbc-78e805b13910.gif)\r\n\r\n```js\r\n// ç¬¬ä¸‰ç‰ˆ\r\nfunction antiShake(call, time, immediately) {\r\n  var i = null;\r\n  return function() {\r\n    var that = this;\r\n    var rest = arguments;\r\n    clearTimeout(i);\r\n    if (immediately) {\r\n      var reversal = !i;\r\n      i = setTimeout(function() {\r\n        i = null;\r\n      }, time);\r\n\r\n      if (reversal) {\r\n        call.apply(that, rest);\r\n      }\r\n    } else {\r\n      i = setTimeout(function() {\r\n        call.apply(that, rest);\r\n      }, time);\r\n    }\r\n  };\r\n}\r\n```\r\n\r\n### è¿”å›å€¼\r\n\r\nå¼‚æ­¥æ‰§è¡Œçš„å‡½æ•°æˆ‘ä»¬æ²¡åŠæ³•åŒæ­¥è¿”å›ä»–çš„å€¼ï¼Œä½†æ˜¯å¯¹äºç«‹å³æ‰§è¡Œçš„å‡½æ•°ï¼Œæˆ‘ä»¬åº”å½“æŠŠå€¼è¿”å›\r\n\r\n```js\r\n// ç¬¬å››ç‰ˆ\r\nfunction antiShake(call, time, immediately) {\r\n  var i = null;\r\n  return function() {\r\n    var that = this;\r\n    var rest = arguments;\r\n    clearTimeout(i);\r\n    if (immediately) {\r\n      var reversal = !i;\r\n      i = setTimeout(function() {\r\n        i = null;\r\n      }, time);\r\n\r\n      if (reversal) {\r\n        return call.apply(that, rest);\r\n      }\r\n    } else {\r\n      i = setTimeout(function() {\r\n        call.apply(that, rest);\r\n      }, time);\r\n    }\r\n  };\r\n}\r\n```\r\n\r\n### å–æ¶ˆ\r\n\r\nåˆ°è¿™é‡ŒåŸºæœ¬ä¸Šé˜²æŠ–å‡½æ•°å°±åŸºæœ¬å†™å®Œäº†ï¼Œä¸Šè¿°æˆ‘ä»¬ç”¨`mousemove`äº‹ä»¶ä¸¾ä¾‹ï¼Œä½†æ˜¯æˆ‘æƒ³å½“é¼ æ ‡ç§»å¼€çš„æ—¶å€™æˆ‘æƒ³å–æ¶ˆè¿™ä¸ªäº‹ä»¶ï¼Œè¿™ä¹Ÿæ˜¯æ­£å¸¸çš„éœ€æ±‚ï¼Œä¸‹é¢å°±æ¥å®ç°å–æ¶ˆåŠŸèƒ½\r\n\r\n```js\r\nfunction antiShake(call, time, immediately) {\r\n  var i = null;\r\n  function _private() {\r\n    var that = this;\r\n    var rest = arguments;\r\n    clearTimeout(i);\r\n    if (immediately) {\r\n      var reversal = !i;\r\n      i = setTimeout(function() {\r\n        i = null;\r\n      }, time);\r\n\r\n      if (reversal) {\r\n        return call.apply(that, rest);\r\n      }\r\n    } else {\r\n      i = setTimeout(function() {\r\n        call.apply(that, rest);\r\n      }, time);\r\n    }\r\n  }\r\n  _private.cancel = function() {\r\n    clearTimeout(i);\r\n    i = null;\r\n  };\r\n  return _private;\r\n}\r\n```\r\n\r\n![5](https://user-images.githubusercontent.com/39508895/62198673-a5e14580-b3b4-11e9-9ced-acc7814031dc.gif)\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/3/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/3/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/5",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/5/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/5/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/5/events",
      "html_url": "https://github.com/bosens-China/blog/issues/5",
      "id": 479484473,
      "node_id": "MDU6SXNzdWU0Nzk0ODQ0NzM=",
      "number": 5,
      "title": "å‡½æ•°èŠ‚æµ",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1602397157,
          "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
          "name": "æ·±å…¥ç³»åˆ—",
          "color": "719192",
          "default": false,
          "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2019-08-12T06:23:18Z",
      "updated_at": "2021-12-21T09:39:31Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "æœ¬æ¥æ‰“ç®—ä»é›¶å†™ä¸€ä¸ªï¼Œä¸è¿‡æ„å¤–çœ‹åˆ°ä¸€ç¯‡å¥½æ–‡ï¼Œä¸‹é¢å°±æ ¹æ®ä»–çš„æ€è·¯æ¥å®ç°ä¸€ä¸ªèŠ‚æµï¼Œ[JavaScriptä¸“é¢˜ä¹‹è·Ÿç€ underscore å­¦èŠ‚æµ ](https://github.com/mqyqingfeng/Blog/issues/26)\r\n\r\n## å‰è¨€\r\nèŠ‚æµæœ‰ä¸¤ç§å®ç°ï¼Œç¬¬ä¸€ç§ä½¿ç”¨å®šæ—¶å™¨ï¼Œå¦å¤–ä¸€ç§åˆ™æ˜¯æ ¹æ®æ—¶é—´æˆ³ï¼Œåˆ¤æ–­ä¸¤æ¬¡æ‰§è¡Œçš„æ—¶é—´é—´éš”ï¼Œä¸‹é¢ç®€å•äº›ä¸€ä¸‹è¿™ä¸¤ç§çš„å®ç°ã€‚\r\n- å®šæ—¶å™¨\r\n``` js\r\nfunction throttle(fn, time) {\r\n  let timing = null;\r\n  return function(...rest) {\r\n    if(!timing) {\r\n      timing = setTimeout(() => {\r\n        timing = null;\r\n        fn.apply(this, rest);\r\n      }, time);\r\n    }\r\n  };\r\n};\r\n```\r\n- æ—¶é—´æˆ³\r\n``` js\r\nfunction throttle (fn, time) {\r\n  let times = 0;\r\n  return function (...rest) {\r\n    const s = time - (new Date().getTime() - times)\r\n    if (s <= 0) {\r\n      times = new Date().getTime();\r\n      fn.apply(this, rest);\r\n    }\r\n  };\r\n};\r\n```\r\nä¸‹é¢å°±æ˜¯å°†ä¸¤è€…ç»“åˆèµ·æ¥\r\n\r\n## èŠ‚æµ\r\n``` js\r\n// èŠ‚æµ\r\n// initialåˆå§‹ç«‹å³æ‰§è¡Œï¼Œfrontæœ€åæ‰§è¡Œä¸€æ¬¡\r\nfunction throttle (fn, time, { initial = true, front = false } = {}) {\r\n  // ä¸Šä¸€æ¬¡æ‰§è¡Œæ—¶é—´\r\n  let times = 0;\r\n  // å®šæ—¶å™¨\r\n  let timing = null;\r\n  function next (...args) {\r\n    // åˆ¤æ–­æ¡ä»¶ï¼Œå¦‚æœä¸æ˜¯åˆå§‹æ‰§è¡Œï¼Œæ”¹ç”¨å®šæ—¶å™¨æ–¹æ³•æ‰§è¡Œ\r\n    if (!initial && !times) {\r\n      times = new Date().getTime();\r\n    }\r\n    const now = time - (new Date().getTime() - times);\r\n    // now > timeæ˜¯åˆ¤æ–­æ›´æ”¹ç³»ç»Ÿæ—¶é—´çš„è¾¹ç•Œé—®é¢˜ï¼Œnowæ­£å¸¸æƒ…å†µä¸‹ï¼Œè‚¯å®šå°äºtime\r\n    if (now <= 0 || now > time) {\r\n      if (!timing) {\r\n        clearTimeout(timing);\r\n        timing = null;\r\n      }\r\n      times = new Date().getTime();\r\n      fn.apply(this, args);\r\n      // æ¸…ç†ä¸€ä¸‹å†…å­˜\r\n      if (!timing) {\r\n        args = null;\r\n      }\r\n    } else if (!timing && front) {\r\n      timing = setTimeout(() => {\r\n        timing = null;\r\n        times = initial ? 0 : new Date().getTime();\r\n        fn.apply(this, args);\r\n        if (!timing) {\r\n          args = null;\r\n        }\r\n      }, time);\r\n    }\r\n  }\r\n  // å–æ¶ˆ\r\n  next.cancel = function () {\r\n    clearTimeout(timing);\r\n    timing = null;\r\n    // ä¸º0å³å¯ï¼Œä¸Šé¢æœ‰åˆå§‹åˆ¤æ–­æ¡ä»¶\r\n    times = 0;\r\n  };\r\n  return next;\r\n};\r\n```\r\n## æ³¨æ„\r\nä¸Šé¢æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä½†æ˜¯ä¸èƒ½åŒæ—¶è®¾ç½®ä¸ºfalse",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/5/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/5/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/7",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/7/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/7/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/7/events",
      "html_url": "https://github.com/bosens-China/blog/issues/7",
      "id": 479646858,
      "node_id": "MDU6SXNzdWU0Nzk2NDY4NTg=",
      "number": 7,
      "title": "ä½¿ç”¨rollupç¼–å†™ç°ä»£åŒ–æ¨¡å—",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1740577858,
          "node_id": "MDU6TGFiZWwxNzQwNTc3ODU4",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3",
          "name": "å·¥å…·ç›¸å…³",
          "color": "f73d62",
          "default": false,
          "description": "å·¥ç¨‹åŒ–ç›¸å…³çš„ä¸œè¥¿"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2019-08-12T13:30:02Z",
      "updated_at": "2021-12-21T09:34:35Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "> ä¹‹æ‰€æœ‰é€‰ç”¨ rollup æ˜¯å› ä¸ºå®ƒå¯ä»¥å‡å°‘æ‰“åŒ…ä½“ç§¯å’Œæé«˜æ„å»ºé€Ÿåº¦ï¼Œä¸‹é¢ä»‹ç»ä¸ä¼šè¯¦ç»†è®²è§£é…ç½®ï¼Œä½ å¯ä»¥è‡ªè¡ŒæŸ¥é˜…å®˜æ–¹æ–‡æ¡£\r\n\r\nES6 å·²ç»å‡ºç°å¾ˆä¹…äº†ï¼Œä½†æ˜¯ä¸ºäº†å…¼å®¹ä»¥å‰çš„æµè§ˆå™¨ï¼Œæˆ‘ä»¬è¿˜æ˜¯éœ€è¦ä½¿ç”¨å„ç§æ„å»ºå·¥å…·ï¼Œä¾‹å¦‚ webpackï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™å¾ˆæ–¹ä¾¿ï¼Œå¯ä»¥é€šè¿‡ babel è½¬æ¢ es6 çš„è¯­æ³•ï¼Œæ¯”å¦‚ä¸‹é¢å¯¼å…¥ä¸€ä¸ªæ¨¡å—\r\n\r\n`import moduleName from 'module';`\r\n\r\nä¸è¿‡ç¼–å†™ä¸€ä¸ªç°ä»£åŒ–æ¨¡å—å‘¢ï¼Œé¢„å®šç›®æ ‡åº”è¯¥æœ‰ä¸‰ç‚¹\r\n\r\n1.  æ”¯æŒ typescriptï¼Œå°† ES6 ä»£ç è½¬åŒ–ä¸º ES5 ç¯å¢ƒä½¿ç”¨\r\n2.  æ”¯æŒæ„å»ºå·¥å…·å’Œ`script type=\"module\"`çš„å¯¼å…¥\r\n3.  æ”¯æŒ umd æ ¼å¼å¼•ç”¨\r\n\r\nå°±ä»¥ä¸‹é¢è¿™æ®µä»£ç ä¸ºæ¼”ç¤ºï¼Œå®ç°ä¸Šè¿°çš„ç›®æ ‡\r\n\r\n```js\r\nexport default (arr = []) => {\r\n  return Array.from(arr).length;\r\n};\r\n```\r\n\r\n## å‡†å¤‡\r\n\r\n```sh\r\nnpm init -y\r\nnpm i rollup -D\r\ncd.>rollup.config.js\r\nmd src\r\ncd.>src/index.js\r\n```\r\n\r\nè¿™æ ·å°±åˆ›å»ºå¥½æˆ‘ä»¬æƒ³è¦çš„åŸºæœ¬ç»“æ„äº†ï¼Œå°†ä¸Šé¢ä¾‹å­å¤åˆ¶åˆ° `index.js` æ–‡ä»¶ä¸‹ã€‚\r\n\r\n`rollup`å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œä¹Ÿå¯ä»¥é€šè¿‡è„šæœ¬æ¥è°ƒç”¨ï¼Œè¿™é‡Œåœ¨`package.json`çš„`scripts`å­—æ®µï¼Œé€šè¿‡è„šæœ¬è°ƒç”¨\r\n\r\n```json\r\n  \"scripts\": {\r\n    \"build\": \"rollup -c\"\r\n  }\r\n```\r\n\r\n`-c`æ˜¯æŒ‡é…ç½®æ–‡ä»¶ï¼Œé»˜è®¤å°±æ˜¯`rollup.config.js`æ‰€ä»¥ä¸éœ€è¦é¢å¤–é…ç½®äº†\r\n\r\n## ç¼–å†™ç¬¬ä¸€ä¸ªä¾‹å­\r\n\r\nrollup.config.js\r\n\r\n```js\r\nexport default {\r\n  input: \"./src/index.js\",\r\n  output: [\r\n    {\r\n      file: \"dist/index.esm.browser.js\",\r\n      format: \"es\",\r\n      sourcemap: true\r\n    }\r\n  ]\r\n};\r\n```\r\n\r\nä¸Šé¢é…ç½®ä¿¡æ¯`input`æŒ‡çš„æ˜¯å…¥å£æ–‡ä»¶ï¼Œ`output` æ˜¯å‡ºå£æ–‡ä»¶ï¼Œ`file`æ˜¯è¾“å‡ºçš„æ–‡ä»¶è·¯å¾„ï¼Œ`sourcemap`æ˜¯æ˜¯å¦è¾“å‡º map æ–‡ä»¶ï¼Œä»–å¯ä»¥æ–¹ä¾¿è°ƒè¯•é”™è¯¯ï¼Œåœ¨å¼€å‘æ¨¡å—ä¸­åº”è¯¥æ˜¯å¿…é¡»çš„ï¼Œ`format`æ˜¯æŒ‡è¾“å‡ºçš„æ ¼å¼\r\n\r\n- amd\r\n  å¼‚æ­¥æ¨¡å—å®šä¹‰ï¼Œç”¨äºåƒ RequireJS è¿™æ ·çš„æ¨¡å—åŠ è½½å™¨\r\n- cjs\r\n  CommonJSï¼Œé€‚ç”¨äº Node å’Œ Browserify/Webpack\r\n- es\r\n  å°†è½¯ä»¶åŒ…ä¿å­˜ä¸º ES æ¨¡å—æ–‡ä»¶\r\n- iife\r\n  ä¸€ä¸ªè‡ªåŠ¨æ‰§è¡Œçš„åŠŸèƒ½ï¼Œé€‚åˆä½œä¸º<\\script>æ ‡ç­¾ã€‚ï¼ˆå¦‚æœè¦ä¸ºåº”ç”¨ç¨‹åºåˆ›å»ºä¸€ä¸ªæ†ç»‘åŒ…ï¼Œæ‚¨å¯èƒ½æƒ³è¦ä½¿ç”¨å®ƒï¼Œå› ä¸ºå®ƒä¼šä½¿æ–‡ä»¶å¤§å°å˜å°ã€‚ï¼‰\r\n- umd\r\n  é€šç”¨æ¨¡å—å®šä¹‰ï¼Œä»¥ amdï¼Œcjs å’Œ iife ä¸ºä¸€ä½“\r\n\r\næ‰§è¡Œ`npm run build`\r\n\r\ndist/index.esm.browser.js\r\n\r\n```js\r\nvar index = (arr = []) => {\r\n  return Array.from(arr).length;\r\n};\r\n\r\nexport default index;\r\n//# sourceMappingURL=index.esm.browser.js.map\r\n```\r\n\r\nå¯ä»¥çœ‹åˆ°ç”Ÿæˆçš„ä¿¡æ¯ååˆ†ç®€æ´ï¼Œä¸Šé¢è¯´åˆ°è¦åŒæ—¶æ”¯æŒ`umd` æ ¼å¼å’Œ `import` å¯¼å…¥ï¼Œ`import`å¯ä»¥é€šè¿‡`es`çš„å½¢å¼æ¥ä¾›æ„å»ºå·¥å…·å’Œ`script type=\"module\"`ä½¿ç”¨ï¼Œä¸‹é¢å°±æ¥å®šä¹‰ä¸€ä¸‹ umd æ ¼å¼\r\n\r\n```js\r\nexport default {\r\n  input: \"./src/index.js\",\r\n  output: [\r\n    {\r\n      file: \"dist/index.esm.browser.js\",\r\n      format: \"es\",\r\n      sourcemap: true\r\n    },\r\n    {\r\n      file: \"dist/index.js\",\r\n      format: \"umd\",\r\n      sourcemap: true,\r\n      name: \"index\"\r\n    }\r\n  ]\r\n};\r\n```\r\n\r\n**æ³¨æ„**ä½¿ç”¨`umd`æˆ–è€…`iife`å¿…é¡»æŒ‡å®š name å­—æ®µï¼Œä»–å†³å®šäº†æš´éœ²åœ¨å…¨å±€ä½œç”¨ä¸‹çš„å˜é‡åï¼Œå†æ¬¡æ‰§è¡Œå¯ä»¥çœ‹åˆ°`index.js`çš„ä¿¡æ¯äº†ã€‚\r\n\r\n## babel\r\n\r\nä¸Šé¢å®Œæˆäº†éœ€æ±‚çš„ç¬¬ä¸€æ­¥ï¼Œä¸è¿‡å¯¹äº es6 çš„ä»£ç ï¼Œå¹¶æ²¡æœ‰è½¬åŒ–ä¸º es5 çš„å½¢å¼ï¼Œåªæ˜¯å°†è¯­æ³•è½¬æ¢äº†ï¼Œ`Array.from`ä¾æ—§å­˜åœ¨ï¼Œä¸‹é¢ä½¿ç”¨`babel`æ¥å®Œæˆéœ€æ±‚\r\n\r\n```sh\r\nnpm i @babel/core @babel/preset-env  core-js rollup-plugin-babel rollup-plugin-node-resolve rollup-plugin-commonjs -D\r\n```\r\n\r\nbabel.config.js\r\n\r\n```js\r\nmodule.exports = {\r\n  presets: [\r\n    [\r\n      \"@babel/preset-env\",\r\n      {\r\n        useBuiltIns: \"usage\",\r\n        corejs: 3,\r\n        modules: false\r\n      }\r\n    ]\r\n  ]\r\n};\r\n```\r\n\r\nä¸Šé¢ä»£ç çš„`useBuiltIns`çš„`usage`æ˜¯ babel7 çš„å®éªŒæ€§ç‰¹æ€§ï¼Œä»–æ”¯æŒæŒ‰éœ€åŠ è½½\r\n\r\nrollup.config.js\r\n\r\n```js\r\nimport babel from \"rollup-plugin-babel\";\r\nimport resolve from \"rollup-plugin-node-resolve\";\r\nimport commonjs from \"rollup-plugin-commonjs\";\r\nexport default {\r\n  input: \"./src/index.js\",\r\n  output: [\r\n    {\r\n      file: \"dist/index.esm.browser.js\",\r\n      format: \"es\",\r\n      sourcemap: true\r\n    },\r\n    {\r\n      file: \"dist/index.js\",\r\n      format: \"umd\",\r\n      sourcemap: true,\r\n      name: \"index\"\r\n    }\r\n  ],\r\n  plugins: [\r\n    commonjs(),\r\n    resolve(),\r\n    babel({\r\n      exclude: [/\\/core-js\\//],\r\n      runtimeHelpers: true,\r\n      sourceMap: true,\r\n      extensions: [\".js\", \".jsx\", \".es6\", \".es\", \".mjs\", \".ts\"]\r\n    })\r\n  ]\r\n};\r\n```\r\n\r\nå†æ¬¡æ‰§è¡Œå¯ä»¥çœ‹åˆ°`Arrar.from`å·²ç»è¢«`babel`è½¬æ¢ä¸º ES5 çš„ç¯å¢ƒäº†\r\n\r\n## typescript\r\n\r\nè¿™ä¸ªæˆ‘ä»¬ç”¨`babel`æä¾›ç»™æˆ‘ä»¬çš„`@babel/preset-typescript`å³å¯å®Œæˆï¼Œä¸è¿‡ä¸ºäº†æ”¯æŒ`typescript`ä¸€äº›å…¶ä»–æ‰©å±•è¯­æ³•ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å®‰è£…ä¸€äº›æ’ä»¶\r\n\r\n```sh\r\nnpm i @babel/preset-typescript @babel/plugin-transform-typescript @babel/plugin-syntax-dynamic-import @babel/plugin-proposal-class-properties -D\r\n```\r\n\r\nbabel.config.js\r\n\r\n```js\r\nmodule.exports = {\r\n  presets: [\r\n    [\r\n      \"@babel/preset-env\",\r\n      {\r\n        useBuiltIns: \"usage\",\r\n        corejs: 3,\r\n        modules: false\r\n      }\r\n    ],\r\n    [\"@babel/preset-typescript\"]\r\n  ],\r\n  plugins: [\r\n    \"@babel/plugin-transform-typescript\",\r\n    \"@babel/plugin-syntax-dynamic-import\",\r\n    \"@babel/plugin-proposal-class-properties\"\r\n  ]\r\n};\r\n```\r\n\r\nä¿®æ”¹ä¸€ä¸‹ `src/index.js` ä¸º `index.ts`ï¼Œ`rollup.config.js` ä¸‹`input`å­—æ®µ\r\n\r\n```js\r\nexport default (arr: Array<any> = []): number => {\r\n  return Array.from(arr).length;\r\n};\r\n```\r\n\r\nå†æ¬¡æ‰§è¡Œ`npm run build`ï¼ŒæˆåŠŸè¾“å‡º\r\n\r\n## ä¼˜åŒ–\r\n\r\n1. è¾“å‡ºä»£ç æ²¡æœ‰è¢«å‹ç¼©\r\n2. æ¯æ¬¡è¾“å‡ºçš„æ—¶å€™æ–‡ä»¶å¤¹æ²¡æœ‰è¢«åˆ é™¤\r\n\r\nä¸Šé¢ä¸¤ä¸ªé—®é¢˜ï¼Œå¯ä»¥é€šè¿‡æ’ä»¶æ¥è§£å†³\r\n\r\n```sh\r\nnpm i rollup-plugin-terser rollup-plugin-clear -D\r\n```\r\n\r\nrollup.config.js\r\n\r\n```js\r\nimport babel from \"rollup-plugin-babel\";\r\nimport clear from \"rollup-plugin-clear\";\r\nimport resolve from \"rollup-plugin-node-resolve\";\r\nimport commonjs from \"rollup-plugin-commonjs\";\r\nimport { terser } from \"rollup-plugin-terser\";\r\nexport default {\r\n  input: \"./src/index.ts\",\r\n  output: [\r\n    {\r\n      file: \"dist/index.esm.browser.js\",\r\n      format: \"es\",\r\n      sourcemap: true\r\n    },\r\n    {\r\n      file: \"dist/index.js\",\r\n      format: \"umd\",\r\n      sourcemap: true,\r\n      name: \"index\"\r\n    }\r\n  ],\r\n  plugins: [\r\n    clear({\r\n      targets: [\"dist\"]\r\n    }),\r\n    resolve(),\r\n    commonjs(),\r\n    terser(),\r\n    babel({\r\n      exclude: [/\\/core-js\\//],\r\n      runtimeHelpers: true,\r\n      sourceMap: true,\r\n      extensions: [\".js\", \".jsx\", \".es6\", \".es\", \".mjs\", \".ts\"]\r\n    })\r\n  ]\r\n};\r\n```\r\nè¿™æ ·åŸºæœ¬çš„æ¨¡å—çš„åŸºæœ¬åŠŸèƒ½å°±ç¼–å†™å®Œæˆäº†",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/7/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/7/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/2",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/2/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/2/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/2/events",
      "html_url": "https://github.com/bosens-China/blog/issues/2",
      "id": 473943664,
      "node_id": "MDU6SXNzdWU0NzM5NDM2NjQ=",
      "number": 2,
      "title": "æ¼«è°ˆECMAScriptæœ‰æ„æ€çš„è®¾è®¡",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1371686608,
          "node_id": "MDU6TGFiZWwxMzcxNjg2NjA4",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%BC%AB%E8%B0%88%E7%B3%BB%E5%88%97",
          "name": "æ¼«è°ˆç³»åˆ—",
          "color": "e7f3ee",
          "default": false,
          "description": "æµ…è°ˆç±»æ–‡ç« "
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2019-07-29T09:23:22Z",
      "updated_at": "2021-12-21T09:33:52Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "æœ€è¿‘é‡è¯»ã€Šä½ æ‰€ä¸çŸ¥é“çš„ JavaScriptã€‹å‘ç°ä¸€äº›æœ‰è¶£çš„ç‚¹ï¼Œæƒ³åˆ†äº«ä¸‹ã€‚\r\n\r\n## å—çº§ä½œç”¨åŸŸ\r\n\r\nES6 å¼•ç”¨äº† let å’Œ constï¼Œè¿™å®é™…ä¸Šå¸¦æ¥äº†å—çº§ä½œç”¨åŸŸï¼Œåœ¨ ES6 ä¹‹å‰åªå­˜åœ¨å…¨å±€ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸï¼Œç›¸ä¿¡å°ä¼™ä¼´å¯¹è¿™å¥è¯åº”å½“ä¸é™Œç”Ÿï¼Œä¸‹é¢å°±æ¥èŠèŠä¸€ä¸ª ES6 ä¹‹å‰å¦‚æœå®ç°å—çº§ä½œç”¨åŸŸã€‚\r\n\r\næ€è€ƒä¸‹é¢ä¸€ä¸ªä¾‹å­ä»£ç è¾“å‡ºå€¼ä¸ºå¤šå°‘\r\n\r\n```js\r\nfor (var i = 0; i < 10; i++) {\r\n  setTimeout(function () {\r\n    console.log(i);\r\n  }, 100);\r\n}\r\n```\r\n\r\nè¿™é‡Œä¼šè¾“å‡º 10 ä¸ª 10ï¼Œå› ä¸ºåªå­˜åœ¨ä¸€ä¸ªå…¨å±€å˜é‡`i`ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç«‹å³æ‰§è¡Œå‡½æ•°æ¥è§£å†³è¿™ä¸ªé—®é¢˜\r\n\r\n```js\r\nfor (var i = 0; i < 10; i++) {\r\n  (function (i) {\r\n    setTimeout(function () {\r\n      console.log(i);\r\n    }, 100);\r\n  })(i);\r\n}\r\n```\r\n\r\nå¦‚æœåœ¨ ES6 ç¯å¢ƒä¸‹è¿˜å¯ä»¥ä½¿ç”¨ let å‘½ä»¤è§£å†³ï¼Œå®ƒä¼šåœ¨æ¯æ¬¡å¾ªç¯çš„æ—¶å€™åˆ›å»ºä¸€ä¸ªä½œç”¨åŸŸï¼Œè‡³äºä¸ºä»€ä¹ˆèƒ½è®°ä½ä¸Šä¸€æ¬¡çš„å€¼ï¼Œé‚£æ˜¯å› ä¸º js å¼•æ“ä¼šè®°ä½ä¸Šä¸€æ¬¡å¾ªç¯çš„å€¼ã€‚\r\n\r\n```js\r\nfor (let i = 0; i < 10; i++) {\r\n  setTimeout(() => {\r\n    console.log(i);\r\n  }, 100);\r\n}\r\n```\r\n\r\nä¸Šé¢çš„ä¾‹å­å¸®æˆ‘ä»¬å›é¡¾ä¸€ä¸‹æ²¡æœ‰å—çº§ä½œç”¨åŸŸçš„ç—›è‹¦ä¹‹ä¸€ï¼Œå®é™…ä¸Šæˆ‘ä»¬å†™é¡¹ç›®çš„æ—¶å€™å¯èƒ½æ—©æ—©çš„å°±ä½¿ç”¨äº†`babel`ï¼Œå®ƒä¼šé€šè¿‡æ€ä¹ˆæ ·çš„å½¢å¼å°†`let`å’Œ`const`è½¬åŒ–ä¸ºæ”¯æŒ ES5 çš„ç¯å¢ƒå‘¢ï¼Ÿ\r\n\r\nå…ˆçœ‹ä¸‹é¢ä¸€ä¸ªä¾‹å­\r\n\r\n```js\r\ntry {\r\n  throw 5;\r\n} catch (e) {\r\n  console.log(e);\r\n}\r\nconsole.log(e); //error e is not defined\r\n```\r\n\r\nè¿™é‡Œ try ä¼šåˆ›å»ºä¸€ä¸ªå—çº§ä½œç”¨åŸŸï¼Œåœ¨å…¨å±€ç¯å¢ƒä¸‹ a ä¸å­˜åœ¨ï¼Œæ‰€ä»¥æŠ¥é”™äº†ã€‚\r\nèªæ˜çš„å°ä¼™ä¼´å¯èƒ½å·²ç»æƒ³åˆ°äº†ï¼Œå¯ä»¥ä½¿ç”¨ try æ¥åˆ›å»ºå—çº§ä½œç”¨åŸŸï¼Œç†è®ºä¸Šæ˜¯å¯è¡Œçš„ï¼Œä¸è¿‡å®é™…ä¸Šæœ‰ä¸¤ç‚¹é—®é¢˜\r\n\r\n1. æ€§èƒ½å¤ªæ…¢\r\n2. è¯­æ³•ä¸‘é™‹ï¼Œè¦æ˜¾ç¤ºçš„æŠ¥é”™\r\n\r\næˆ‘ä»¬æ¥çœ‹ä¸‹`babel`æ€ä¹ˆå¤„ç†ä¸Šé¢çš„ä¾‹å­\r\n\r\n```js\r\n'use strict';\r\n\r\nvar _loop = function _loop(i) {\r\n  setTimeout(function () {\r\n    console.log(i);\r\n  }, 100);\r\n};\r\n\r\nfor (var i = 0; i < 10; i++) {\r\n  _loop(i);\r\n}\r\n```\r\n\r\nå¯ä»¥çœ‹åˆ°ä¸ç«‹å³æ‰§è¡Œå‡½æ•°åŸºæœ¬ç›¸åŒï¼Œä¸è¿‡ä½¿ç”¨ç«‹å³æ‰§è¡Œå‡½æ•°åˆ›å»ºå—çº§ä½œç”¨åŸŸéœ€è¦æ³¨æ„ä¸€ç‚¹`this`çš„æŒ‡å‘ã€‚\r\n\r\nä¾‹å¦‚è¿™ä¸ªä¾‹å­\r\n\r\n```js\r\nconst obj = {\r\n  foo() {\r\n    for (let i = 0; i < 5; i += 1) {\r\n      setTimeout(() => {\r\n        console.log(this.arr[i]);\r\n      }, 1000);\r\n    }\r\n  },\r\n  arr: [1, 2, 3, 4, 5],\r\n};\r\n```\r\n\r\nç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ this å¯¹è±¡ï¼Œæ˜¯å®šä¹‰æ—¶çš„å¯¹è±¡è€Œä¸æ˜¯è¿è¡Œæ—¶çš„å¯¹è±¡ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­æŒ‡å‘çš„æ˜¯ objï¼›\r\nå¦‚æœè¦æŠŠä¸Šé¢çš„ä»£ç è½¬åŒ–ä¸º ES5 ç¯å¢ƒæ”¯æŒçš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½œç”¨åŸŸçš„è§„åˆ™æ¥å®ç°\r\n\r\n```js\r\n(function () {\r\n  var _this = this;\r\n  setTimeout(function () {\r\n    console.log(_this.arr[i]);\r\n  }, 1000);\r\n})();\r\n```\r\n\r\nä¸Šé¢å°±å®ç°äº†æ‰€éœ€çš„åŠŸèƒ½\r\n\r\n## éšè—çš„ global å¯¹è±¡\r\n\r\nä¸‹é¢ä»£ç å‡è®¾ç¯å¢ƒä¸ºæµè§ˆå™¨ç¯å¢ƒï¼ŒJavaScript æœ‰è®¸å¤šè®¾è®¡ç¼ºé™·ï¼Œå…¶ä¸­ä¸ä½¿ç”¨å£°æ˜å£°æ˜å˜é‡ï¼Œä¼šè‡ªåŠ¨å°†å˜é‡åˆ›å»ºåœ¨`global`ä¸Šå°±æ˜¯å…¶ä¸€ï¼Œä¸è¿‡ä¸‹é¢å°±æ¥æ¼«è°ˆç‰¹æ®Šçš„`global`å¯¹è±¡\r\n\r\n```js\r\nvar a = 10;\r\nb = 20;\r\nwindow.a; //10\r\nwindow.b; //20\r\n```\r\n\r\n### index.html\r\n\r\nåˆ›å»ºä¸€ä¸ªå¸¦æœ‰ id çš„ DOM å…ƒç´ ï¼Œhtml å†…çš„ id å…ƒç´ ä¹Ÿä¼šè‡ªåŠ¨åæ˜ åœ¨`global`å¯¹è±¡ä¸Šï¼Œä¾‹å¦‚ä¸‹é¢\r\n\r\n```html\r\n<div id=\"div\"></div>\r\n<script>\r\n  console.log(typeof div); //object\r\n</script>\r\n```\r\n\r\né€šè¿‡`id`çš„ DOM å…ƒç´ ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ DOM ä¸Šçš„ä¸€äº›æ–¹æ³•ï¼Œç®—æ˜¯ä¸€ä¸ªå¥‡æ·«å·§æŠ€\r\n\r\n```js\r\nconsole.log(div.nodeType); //1\r\nconsole.log(div.nodeName); //DIV\r\n//...\r\n```\r\n\r\nä¸è¿‡åº”è¯¥é¿å…ä½¿ç”¨ id çš„ DOM å…ƒç´ ï¼Œä¸æ˜“äºä»£ç çš„å¯è¯»æ€§ï¼Œæ›´æ¨èä½¿ç”¨æ ‡å‡†è·å– dom çš„æ–¹æ³•ã€‚\r\næœ€åæç¤ºä¸€ç‚¹ï¼Œå¦‚æœå­˜åœ¨ç›¸åŒçš„`id`domï¼Œcss ä»£ç ä¼šä½œç”¨ä¸¤ä¸ªç›¸åŒçš„å…ƒç´ \r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/2/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/2/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/14",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/14/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/14/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/14/events",
      "html_url": "https://github.com/bosens-China/blog/issues/14",
      "id": 479671441,
      "node_id": "MDU6SXNzdWU0Nzk2NzE0NDE=",
      "number": 14,
      "title": "ç†è§£åŸå‹å’ŒåŸå‹é“¾",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1602397157,
          "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
          "name": "æ·±å…¥ç³»åˆ—",
          "color": "719192",
          "default": false,
          "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2019-08-12T14:17:35Z",
      "updated_at": "2021-12-21T03:38:33Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "> å‚è€ƒï¼š [æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…ï¼ˆå®Œç»“ï¼‰](https://www.cnblogs.com/wangfupeng1988/p/3977924.html)\r\n\r\nJavaScriptæ˜¯å¼±ç±»å‹ï¼Œé™¤äº†åŸºæœ¬ç±»å‹éƒ½å¯ä»¥ç†è§£ä¸ºå¯¹è±¡ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¯´JavaScriptä¸­ä¸€åˆ‡çš†å¯¹è±¡çš„åŸå› ã€‚\r\n\r\nä¸è¿‡åœ¨å¯¹è±¡ä¸­å‡½æ•°æ¯”è¾ƒç‰¹æ®Šï¼Œå¯¹è±¡å°±æ˜¯ç”±å‡½æ•°åˆ›é€ å‡ºæ¥çš„ï¼Œè¿™å¬èµ·æ¥æ˜¯ä¸æ˜¯æœ‰ç‚¹å…ˆæœ‰é¸¡åæœ‰è›‹ï¼Œå…ˆæœ‰è›‹åæœ‰é¸¡çš„æ„Ÿè§‰ï¼Œè¿™ä¹Ÿè·Ÿåé¢è¦è¯´åˆ°çš„åŸå‹æœ‰å…³ã€‚\r\n\r\nå…ˆè¯´`prototype`å±æ€§ï¼Œè¿™ä¸ªå±æ€§æ˜¯`å‡½æ•°`æ‰€ç‹¬æœ‰çš„ï¼Œå‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ä¹Ÿå¯ä»¥åœ¨è‡ªèº«å®šä¹‰å±æ€§å’Œæ–¹æ³•ï¼Œé‚£è¿™ä¸ª`prototype`å±æ€§æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ\r\n``` js\r\nvar a = {};\r\na.toString();\r\n```\r\nè¿™é‡Œæˆ‘å¹¶æ²¡æœ‰ä¸ºaå®šä¹‰toStringçš„æ–¹æ³•ï¼Œä¸ºä»€ä¹ˆå¯ä»¥è°ƒç”¨å‘¢ï¼Ÿå°±è·Ÿprototypeå±æ€§æœ‰å…³ã€‚\r\n\r\nä¸Šé¢åªæ˜¯ç®€å†™ï¼Œå¦‚æœé€šè¿‡æ„é€ å‡½æ•°æ˜¯è¿™æ ·çš„\r\n``` js\r\nvar a = new Object();\r\na.toString();\r\n```\r\n![https://pic1.zhimg.com/80/v2-038c5818398efc6b4e990b3c2fb3b54c_hd.jpg](https://pic1.zhimg.com/80/v2-038c5818398efc6b4e990b3c2fb3b54c_hd.jpg)\r\nè¿™é‡Œå¯ä»¥çœ‹åˆ°toStringçš„æ–¹æ³•ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæ²¡æœ‰å®šä¹‰å´æ²¡æœ‰æŠ¥é”™çš„åŸå› ã€‚\r\n\r\nä¸€ä¸ªå¯¹è±¡é€šè¿‡æ„é€ å‡½æ•°ç”Ÿæˆä¼šæ‰§è¡Œä¸‹é¢å››ä¸ªæ­¥éª¤\r\n1. åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œä½œä¸ºè¦è¿”å›çš„å®ä¾‹\r\n2. å°†æ–°å¯¹è±¡çš„åŸå‹ï¼ˆ__proto__ï¼‰æŒ‡å‘æ„é€ å‡½æ•°çš„`prototype`å±æ€§\r\n3. å°†å†…éƒ¨çš„thisæŒ‡å‘æ–°å¯¹è±¡\r\n4. æ‰§è¡Œå†…éƒ¨ä»£ç ï¼Œå¦‚æœæ²¡æœ‰æ‰§è¡Œè¿”å›å¯¹è±¡ï¼Œåˆ™è¿”å›`this`ï¼ˆæ–°å¯¹è±¡ï¼‰\r\n\r\nä»ä¸Šé¢å¯ä»¥çœ‹åˆ°ï¼Œå¯¹è±¡çš„åŸå‹ä¼šæŒ‡å‘ç”Ÿæˆå¯¹è±¡å‡½æ•°çš„`prototype`å±æ€§ï¼Œå¯¹è±¡æœ¬èº«å¦‚æœæ²¡æœ‰å±æ€§æˆ–è€…æ–¹æ³•ï¼Œä¼šå‘åŸå‹é“¾æŸ¥æ‰¾ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ä¼šä¸€ç›´æ‰¾åˆ°`Object.prototype`å±æ€§ä¸Šï¼Œå¦‚æœè¿˜æ²¡æœ‰æ‰¾åˆ°å°±ä¼šè¿”å›`undefined`ã€‚\r\n`Object.prototype`å±æ€§ä¸Šè¿˜æœ‰åŸå‹é“¾ä¹ˆï¼Ÿç­”æ¡ˆæ˜¯æœ‰ï¼Œæ˜¯`Null`ã€‚\r\n\r\nä¸Šé¢ç®€çŸ­çš„è¯´äº†ä¸€ä¸‹ï¼Œä¸‹é¢é€šè¿‡ä¾‹å­çš„å½¢å¼æ¥ç»“åˆ\r\n\r\n## ç¤ºä¾‹\r\n``` js\r\nvar a = {};\r\n```\r\nè¿™é‡Œæˆ‘å®šä¹‰äº†ä¸€ä¸ªå¯¹è±¡aï¼Œæ ¹æ®ä¸Šé¢è¯´çš„æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªåŸå‹ï¼Œæ‰§è¡Œæ„é€ å‡½æ•°çš„`prototype`ä¸‹é¢å°±æ˜¯åŸå‹å›¾ã€‚\r\n![https://pic4.zhimg.com/80/v2-c93843e5905a3990c0b1147d0dad7f03_hd.jpg](https://pic4.zhimg.com/80/v2-c93843e5905a3990c0b1147d0dad7f03_hd.jpg)\r\nä¸Šé¢å°±æ˜¯ä¸€ä¸ªç®€å•çš„åŸå‹å›¾ï¼Œä¸‹é¢è¯´ä¸€ä¸‹`constructor`å±æ€§ï¼Œè¿™ä¸ªå±æ€§æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿ\r\n`constructor`æ˜¯`prototype`å¯¹è±¡ä¸‹çš„ä¸€ä¸ªå±æ€§ï¼Œä»–æŒ‡å‘ä¸€ä¸ªå‡½æ•°ï¼Œä¸å‡½æ•°çš„ç›¸äº’ä¾å­˜ï¼Œè¿˜æ˜¯é€šè¿‡ä¸Šé¢å˜é‡aæ¥è¯´æ˜å§ã€‚\r\n![https://pic1.zhimg.com/80/v2-94e4180728a52844d1204a830249c10c_hd.jpg](https://pic1.zhimg.com/80/v2-94e4180728a52844d1204a830249c10c_hd.jpg)\r\n\r\nå¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡`constructor`å¯ä»¥è®¿é—®åˆ°æ„é€ å‡½æ•°ï¼Œè¿™ä¸ªå±æ€§é€šå¸¸æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œä¸è¿‡å¯ä»¥é€šç”¨è¿™ä¸ªå±æ€§è°ƒç”¨ä¸€äº›æ„é€ å‡½æ•°æ‰€ç‹¬æœ‰çš„æ–¹æ³•ï¼Œæ¯”å¦‚`Date`å‡½æ•°çš„`now`æ–¹æ³•\r\n``` js\r\nvar a = new Date();\r\na.__proto__.constructor.now();\r\n```\r\nè¿™é‡Œä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºä½¿ç”¨äº†`_proto_`ï¼Œä¸è¿‡åœ¨å®é™…ä¸­ä¸è¦è¿™æ ·å†™ï¼Œå› ä¸ºè¿™ä¸ªå±æ€§åªæœ‰æµè§ˆå™¨æ‰éƒ¨ç½²ã€‚\r\n![https://pic3.zhimg.com/80/v2-3ee04ff512a68800c014b66de0f6b3f2_hd.jpg](https://pic3.zhimg.com/80/v2-3ee04ff512a68800c014b66de0f6b3f2_hd.jpg)\r\nè¯´äº†è¿™ä¹ˆå¤šï¼Œæœ€åæ ¹æ®ä¸€å¼ å›¾ï¼Œæ¥æ€»ç»“ä¸€ä¸‹ã€‚\r\n\r\né¦–å…ˆå¯¹è±¡æ˜¯ç”±æ„é€ å‡½æ•°åˆ›å»ºçš„ï¼ˆObjectï¼‰ï¼Œä½ å¯èƒ½æœ‰ç–‘é—®ï¼Œå‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ï¼Œé‚£ä¹ˆå‡½æ•°çš„`__proto__`æŒ‡å‘ä»€ä¹ˆï¼Ÿ\r\nç­”æ¡ˆæ˜¯`Function.prototype`ï¼Œæ‰€æœ‰å‡½æ•°éƒ½æ˜¯ç”±`Fcuntion`åˆ›å»ºçš„ï¼Œä¸¾ä¸ªä¾‹å­\r\n``` js\r\nvar a = new Function('a', 'b', 'return a + b');\r\na(1, 2);\r\n```\r\nè¿™é‡Œaçš„`__proto__`ç­‰äº`Function.prototype`ï¼Œä¹‹å‰è¯´è¿‡prototypeæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥`Function.prototype`æŒ‡å‘`Object.prototype`ã€‚\r\næœ€åè¯´ä¸€ç‚¹ï¼Œ`Function.__proto__`æŒ‡å‘çš„æ˜¯`Function`è‡ªèº«ï¼Œä»–æ˜¯å”¯ä¸€ä¸€ä¸ªé€šè¿‡è‡ªèº«ç”Ÿæˆå‡½æ•°çš„ä¾‹å­ï¼Œè¿™é‡Œåªéœ€è¦äº†è§£ä¸€ä¸‹ã€‚\r\n\r\n## æœ€å\r\nè¯´äº†è¿™ä¹ˆå¤šï¼ŒåŸå‹é“¾å¥½åƒè¿˜æ²¡æœ‰è¢«æèµ·ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰è‡ªå·±çš„åŸå‹ï¼ŒåŸå‹çš„å¯¹è±¡ä¹Ÿæ˜¯å¯¹è±¡ï¼Œä¸€æ–¹é¢å¯¹è±¡å¯ä»¥ä½œä¸ºå¦ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ï¼Œè¿™æ ·å±‚å±‚é“¾æ¥èµ·æ¥çš„åŸå‹å°±æˆä¸ºåŸå‹é“¾ã€‚\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/14/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/14/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/65",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/65/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/65/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/65/events",
      "html_url": "https://github.com/bosens-China/blog/issues/65",
      "id": 770754319,
      "node_id": "MDU6SXNzdWU3NzA3NTQzMTk=",
      "number": 65,
      "title": "åˆæ¢ node æ¥å£å¼€å‘",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1371686609,
          "node_id": "MDU6TGFiZWwxMzcxNjg2NjA5",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/JavaScript",
          "name": "JavaScript",
          "color": "F7DF1E",
          "default": false,
          "description": "JavaScriptç³»åˆ—çš„æ–‡ç« "
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2020-12-18T10:03:26Z",
      "updated_at": "2021-12-21T03:35:11Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "æ¥å£è¯·æ±‚ä¸å…¶å®ƒèµ„æºè¯·æ±‚æ²¡æœ‰ä»€ä¹ˆä¸åŒï¼Œéƒ½æ˜¯å€ŸåŠ© `http` åè®®è¿”å›å¯¹åº”çš„èµ„æºï¼Œè¿™ç¯‡æ–‡ç« ç®€å•ä»‹ç»ä¸€ä¸‹ `node` å¼€å‘æ¥å£ä»¥åŠå¦‚ä½•ç®¡ç†å¤šä¸ªæ¥å£æƒ…å†µå’Œæ¥å£é£æ ¼ã€‚\r\n\r\næ ‡é¢˜å…³è”äº† nodeï¼Œä¸»è¦å› ä¸º node å¼€å¯ä¸€ä¸ªæœåŠ¡å™¨æ˜¯å¾ˆç®€å•ï¼Œè€Œä¸”è¯­æ³•åŸºæœ¬ç›¸åŒæ²¡æœ‰å¤ªå¤šè´Ÿæ‹…ï¼Œè¿™ç¯‡æ–‡ç« ä¸»è¦è®²è§£æ€è·¯ï¼Œæ¢ç®—åˆ°å…¶å®ƒè¯­è¨€ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚\r\n\r\nå…ˆçœ‹ä¸€ä¸ªå®˜ç½‘çš„ä¾‹å­ï¼Œç¨å¾®æ”¹é€ ä¸€ä¸‹è®©å®ƒè¿”å›ä¸€ä¸ªå›ºå®šçš„`json`æ•°æ®\r\n\r\n```js\r\nconst http = require('http');\r\n\r\nconst hostname = '127.0.0.1';\r\nconst port = 3000;\r\n\r\nconst server = http.createServer((req, res) => {\r\n  res.statusCode = 200;\r\n  res.writeHead(200, { 'Content-Type': 'application/json' });\r\n  res.write(JSON.stringify({ name: 'hello wrold' }));\r\n  res.end();\r\n});\r\n\r\nserver.listen(port, hostname, () => {\r\n  console.log(`æœåŠ¡å™¨è¿è¡Œåœ¨ http://${hostname}:${port}/`);\r\n});\r\n```\r\n\r\nå°†ä¸Šé¢ä»£ç å¤åˆ¶åˆ°æ–‡ä»¶ä¸­ï¼Œä¹‹åå€ŸåŠ© `node xxx.js` çš„å½¢å¼å°±å¯ä»¥é¢„è§ˆåˆ°æ•ˆæœäº†ã€‚\r\n\r\n## koa\r\n\r\nä¸Šé¢æ˜¯å€ŸåŠ© node çš„ `http` åŸç”Ÿæ¨¡å—å®ç°çš„ï¼Œå½“ç„¶è¿™ç§å®ç°æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä¸è¿‡è¿½æ±‚å¯æ‰©å±•å’Œç®€åŒ–å¼€å‘çš„ç›®çš„ï¼Œè¿™é‡Œé€‰æ‹©äº† koa ä½œä¸ºä¸‹é¢ä½¿ç”¨çš„çš„æ¡†æ¶ã€‚\r\n\r\nkoa å·ç§°æ˜¯ä¸‹ä¸€ä»£çš„ web å¼€å‘æ¡†æ¶ï¼ŒåŒæ ·ä»¥ä¸Šé¢çš„ä¾‹å­å®‰è£…ä¸€ä¸‹ koa ï¼Œçœ‹å®ƒæ€ä¹ˆå®ç°ä¸Šé¢çš„åŠŸèƒ½\r\n\r\n```sh\r\nyarn add koa\r\n```\r\n\r\n```js\r\nconst Koa = require('koa');\r\n\r\nconst hostname = '127.0.0.1';\r\nconst port = 3000;\r\n\r\nconst app = new Koa();\r\n\r\napp.use(async (ctx) => {\r\n  ctx.type = 'application/json';\r\n  ctx.body = { name: 'hello wrold' };\r\n});\r\napp.listen(port, hostname, () => {\r\n  console.log(`æœåŠ¡å™¨è¿è¡Œåœ¨ http://${hostname}:${port}/`);\r\n});\r\n```\r\n\r\nä»£ç æ–¹é¢è¿˜æ˜¯ååˆ†ç®€æ´çš„ï¼Œè¿™é‡Œä¸»è¦ä»‹ç»å®ç°æ€è·¯ä¸è¿‡å¤šä»‹ç» koa çš„è¯­æ³•ï¼Œè€Œä¸”å®é™…ä¸Š koa åªæ˜¯å¯¹ http æ¨¡å—è¿›è¡Œäº†å°è£…ï¼Œæ–‡æ¡£ä¹Ÿæ²¡å¤šå°‘æ¨èçœ‹ä¸€ä¸‹å®˜ç½‘çš„ä»‹ç»å³å¯ã€‚\r\n\r\nè¯´åˆ°`koa`è¿™é‡Œè¿˜æ˜¯èŠä¸€ä¸‹ `koa` çš„ä¸­é—´ä»¶ï¼Œä¸‹é¢çš„ä»£ç ä¼šç»å¸¸ä½¿ç”¨åˆ°ï¼Œ`koa` å€ŸåŠ©ä¸­é—´ä»¶æ¥å®ç°å„ç§æ‹“å±•ï¼Œå°±æ˜¯ç±»ä¼¼äºæ’ä»¶çš„åŠŸèƒ½ï¼Œå®ƒæœ¬èº«éå¸¸åƒæ´‹è‘±ç»“æ„\r\n![æ´‹è‘±](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fada01c271eb43c19fa026d988e30642~tplv-k3u1fbpfcp-zoom-1.image)\r\n\r\nä¾‹å¦‚ä¸Šé¢çš„`app.use`å°±æ˜¯ä¸­é—´ä»¶ï¼Œä¸­é—´ä»¶çš„æ‰§è¡Œé¡ºåºä»¥`next`ä¸ºåˆ†å‰²ï¼Œå…ˆæ‰§è¡Œ`next`çš„å‰åŠéƒ¨åˆ†ï¼Œä¹‹åæŒ‰ç…§å€’å™çš„ç»“æ„æ‰§è¡ŒååŠéƒ¨åˆ†çš„`next`ä»£ç ï¼Œçœ‹ä¸€ä¸‹ä¾‹å­\r\n\r\n```js\r\napp.use(async (ctx, next) => {\r\n  console.log(1);\r\n  await next();\r\n  console.log(2);\r\n});\r\n\r\napp.use(async (ctx, next) => {\r\n  console.log(3);\r\n  await next();\r\n  console.log(4);\r\n});\r\n\r\napp.use(async (ctx, next) => {\r\n  console.log(5);\r\n  await next();\r\n  console.log(6);\r\n});\r\n```\r\n\r\nä¸Šé¢ä»£ç çš„æ‰“å°ç»“æœæ˜¯`1,3,5,6,4,2`ï¼Œè¿™å—æœ‰ç‚¹ç»•å¯ä»¥å¤šæƒ³ä¸€ä¸‹ã€‚\r\n\r\næ¥å£å¼€å‘ä¸­ä¸€èˆ¬éƒ½æ˜¯é€šè¿‡`json`æ¥ä¼ é€’æ¶ˆæ¯ï¼Œ`koa`æœ¬èº«çš„è¯­æ³•å·²ç»å¾ˆç®€æ´äº†ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½éœ€è¦è¿”å›æƒ³é‡å¤çš„éƒ¨åˆ†ï¼Œæ—¶é—´é•¿äº†è‚¯å®šä¹Ÿä¼šæœ‰å¤±è¯¯æˆ–è€…æ¼å†™æ‹¼é”™çš„æƒ…å†µï¼Œè¿˜æœ‰æŠ›å‡ºé”™è¯¯ä¹Ÿéœ€è¦æœ‰ä¸€ä¸ªå…¬å…±çš„æ–¹æ³•ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªè¿”å›ä¿¡æ¯å’ŒæŠ›å‡ºé”™è¯¯çš„è®¾æƒ³ã€‚\r\n\r\n```js\r\napp.use(async (ctx) => {\r\n  ctx.sendData({ name: 'hello wrold' });\r\n  // å¦‚æœå‘ç”Ÿé”™è¯¯\r\n  ctx.throwError('ä¸æ»¡è¶³xxx');\r\n});\r\n```\r\n\r\nå¦‚æœä»£ç éƒ½é€šè¿‡è¿™ç§å½¢å¼è¿”å›å°±ç®€å•å¤šäº†ï¼Œè€Œä¸”å®é™…å†™åœ¨ä¸­é—´ä»¶éƒ¨åˆ†çš„ä¹Ÿæ˜¯å¯èƒ½å‡ºç°é—®é¢˜çš„ï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡ `koa` è‡ªå¸¦çš„ç›‘å¬é”™è¯¯æ¥å¤„ç†ï¼Œæˆ–è€…é€šè¿‡ä¸€ä¸ª`try`æ¥åŒ…è£¹ï¼Œå¯ä»¥é¢„æ–™çš„æ˜¯ä¸€ä¸ªä¸ªæ‰‹åŠ¨ç®¡ç†`try`ä¸€å®šä¼šè®©äººæŠ“ç‹‚ã€‚\r\n\r\nå€ŸåŠ©ä¸­é—´ä»¶çš„æœºåˆ¶å¾ˆå®¹æ˜“ç¼–å†™å‡ºä¸€ä¸ªå¸¦æœ‰`sendData`å’Œ`throwError`çš„åŠŸèƒ½ï¼Œåªéœ€è¦åœ¨ ctx ä¸­è¿”å›ï¼Œä¹‹åè°ƒç”¨ next è®©åé¢çš„å®ä¾‹æ‰§è¡Œ\r\n\r\n```js\r\napp.use(async (ctx, next) => {\r\n  ctx.sendData = () => {};\r\n  ctx.throwError = () => {};\r\n  await next();\r\n});\r\n```\r\n\r\nä¸Šé¢çš„ä¾‹å­æ˜¯ç®€åŒ–è¿‡çš„ï¼Œè¿™é‡Œç¨å¾®é”™å¼€ä¸€ä¸‹å…·ä½“å®ç°ä¹‹åå†è¯¦ç»†è®²è§£\r\n\r\n> ä¸­é—´ä»¶çš„é¡ºåºéå¸¸é‡è¦\r\n\r\n## æ¥å£ç»“æ„\r\n\r\nä¸Šé¢è¯´äº†è¦æœ‰ä¸€ä¸ª`sendData`å’Œ`throwError`çš„æ–¹æ³•æ¥ç»Ÿä¸€è¿”å›ä¿¡æ¯å’ŒæŠ›å‡ºé”™è¯¯ï¼Œè¿™é‡Œå°±è¯´ä¸‹è¿™ä¸¤ä¸ªæ–¹æ³•çš„å…·ä½“å‚æ•°ä»¥åŠå®ç°ã€‚\r\n\r\né¦–å…ˆæ¥å£çš„è¿”å›ä¿¡æ¯ï¼ŒæœŸå¾…å®ƒæ˜¯å›ºå®šæˆä¸‹é¢è¿™ç§ç»“æ„\r\n\r\n```json\r\n{\r\n  \"data\": {},\r\n  \"message\": \"ok\",\r\n  \"code\": 200\r\n}\r\n```\r\n\r\nè¿™é‡Œ `data` éƒ¨åˆ†æ˜¯éœ€è¦æ‰‹åŠ¨è¿”å›çš„ï¼Œ`message` æ˜¯å¯é€‰çš„ï¼Œé»˜è®¤çš„æ—¶å€™å¯ä»¥ç»™ä¸€ä¸ª ok ä»¥åŠ 200 çš„ codeï¼Œè¿™é‡Œ`code`å€¼æ˜¯å›ºå®šæ­»çš„ï¼Œæ–¹æ³•ä¸å…è®¸ä¿®æ”¹ï¼Œè¿™æ ·åšæ˜¯å› ä¸ºæˆåŠŸè¿”å›ä¸€èˆ¬ä¸éœ€è¦é¢å¤–çš„ code å€¼\r\n\r\nè€Œé”™è¯¯ä¿¡æ¯ï¼ŒæœŸå¾…å®ƒæ˜¯è¿™ç§ç»“æ„\r\n\r\n```json\r\n{\r\n  \"message\": \"\",\r\n  \"code\": \"400\"\r\n}\r\n```\r\n\r\nè¿™é‡Œ message æ˜¯å¿…å¡«ï¼Œè€Œ code åˆ™æ˜¯å¯é€‰çš„ã€‚\r\n\r\nè¿™é‡Œç¨å¾®è¯´ä¸€ä¸‹é”™è¯¯åˆ°åº•ä½¿ç”¨ `code` æ¥åšåŒºåˆ†ï¼Ÿè¿˜æ˜¯é€šè¿‡`message`æ¥åšåŒºåˆ†ï¼Ÿ\r\nå¦‚æœé€šè¿‡`code`æ¥åšä¸åŒçŠ¶æ€çš„åŒºåˆ†ï¼Œé‚£ä¹ˆå¿…ç„¶è¦ç»´æŠ¤ä¸€ä¸ª code åˆ—è¡¨ï¼Œå…¶å®è¿™æ˜¯å¾ˆç¹ççš„è€Œä¸”å•çº¯çš„æ•°å­—è®°å¿†ä¹Ÿä¸ç¬¦åˆäººçš„è®°å¿†ï¼Œè€Œé€šè¿‡`message`æ¥åšæç¤ºåˆ™åŸºæœ¬ä¸Šå¯ä»¥åšåˆ°å¤§æ¦‚å¯ä»¥çŒœåˆ°é”™è¯¯æƒ…å†µï¼Œä¾‹å¦‚å¯ä»¥è¿™æ ·è¿”å›\r\n\r\n```json\r\n{\r\n  \"message\": \"error_ç”¨æˆ·åä¸èƒ½ä¸ºç©º\"\r\n}\r\n```\r\n\r\nå‰é¢ç±»å‹åé¢æç¤ºï¼Œæ˜¯ä¸æ˜¯ç®€æ´å¾ˆå¤šï¼Œè¿™ä¸¤ç§é”™è¯¯æç¤ºè‡ªå·±é€‰æ‹©ä¸€ç§å³å¯ã€‚\r\n\r\nè¯´äº†éœ€è¦å®ç°çš„åŠŸèƒ½ï¼Œæ–¹æ³•çš„å®ç°å°±å¾ˆç®€å•äº†ï¼Œä¸‹é¢ä»£ç æ˜¯`code`å€¼é£æ ¼çš„å®ç°\r\n\r\n```js\r\n// å¿½ç•¥é¡¶å±‚è¯­æ³•é—®é¢˜ï¼Œè¿™é‡Œæ˜¯æŠŠå®ç°æå–å‡ºæ¥äº†\r\nasync (ctx, next) => {\r\n  const content = {\r\n    ...ctx,\r\n    sendData: (data, message = 'ok') => {\r\n      ctx.body = {\r\n        data,\r\n        message,\r\n        code: 200,\r\n      };\r\n      ctx.type = 'application/json';\r\n    },\r\n    throwError: (message = 'é”™è¯¯', code = 400) => {\r\n      ctx.body = {\r\n        code,\r\n        message,\r\n      };\r\n      ctx.type = 'application/json';\r\n    },\r\n  };\r\n  try {\r\n    await callback(content);\r\n  } catch (e) {\r\n    ctx.body = {\r\n      code: 400,\r\n      message: (e instanceof Error ? e.message : e) || 'ç³»ç»Ÿå‡ºç°é”™è¯¯',\r\n    };\r\n    ctx.status = 400;\r\n  }\r\n  await next();\r\n};\r\n```\r\n\r\n## REST é£æ ¼\r\n\r\nrest æ˜¯ä¸€ç§æ¥å£é£æ ¼ï¼Œç®€å•å¯ä»¥æ¦‚æ‹¬æˆä»¥ä¸‹å‡ ç§\r\n\r\n- ä½¿ç”¨`get`æ¥è·å–èµ„æº\r\n- ä½¿ç”¨`post`æ¥å‘é€è¯·æ±‚\r\n- ä½¿ç”¨`put`æ¥æ›´æ–°èµ„æº\r\n- ä½¿ç”¨`delete`æ¥åˆ é™¤èµ„æº\r\n\r\nè¯´äº†è¿™ä¹ˆå¤šä½¿ç”¨`rest`çš„å¥½å¤„æœ‰å“ªäº›å‘¢ï¼Ÿ\r\n\r\né¦–å…ˆ rest åªæ˜¯ä¸€ç§è§„èŒƒï¼Œå®šä¹‰è¿™ç§è§„èŒƒæ›´æ–¹ä¾¿ç†è§£å’Œé˜…è¯»ï¼Œå’Œä»£ç è§„èŒƒæ˜¯ä¸€ä¸ªæ€§è´¨\r\n\r\n## è‡ªåŠ¨å¯¼å…¥\r\n\r\nåœ¨é¡¹ç›®å¼€å‘ä¸­å¿…ç„¶å­˜åœ¨ä¸åŒçš„æ¥å£ï¼Œå¦‚ä½•ç®¡ç†è¿™äº›æ¥å£å°±å¾ˆæœ‰å¿…è¦çš„ï¼Œä¸€ä¸ªä¸ªæ‰‹åŠ¨å¯¼å…¥ç®¡ç†å›ºç„¶å¯ä»¥ï¼Œä¸è¿‡å½“é¡¹ç›®è¶³å¤Ÿå¤§çš„æ—¶å€™ï¼Œä¸šåŠ¡å˜æ›´çš„æ—¶å€™ä¸€ä¸ªä¸ªè°ƒæ•´ä¸€å®šè®©äººæŠ“ç‹‚ã€‚\r\n\r\nä¸‹é¢å€ŸåŠ©`koa-router`å’Œä¸­é—´ä»¶å°±ç¼–å†™ä¸€ä¸ªè‡ªåŠ¨å¯¼å…¥æ¥å£çš„åŠŸèƒ½ï¼Œå…ˆçœ‹ä¸€ä¸‹`koar-router`çš„ç®€å•ä½¿ç”¨\r\n\r\n```sh\r\nyarn add @koa/router\r\n```\r\n\r\n```js\r\nconst Koa = require('koa');\r\nconst Router = require('@koa/router');\r\n\r\nconst hostname = '127.0.0.1';\r\nconst port = 3000;\r\nconst app = new Koa();\r\nconst router = new Router();\r\n\r\nrouter.get('/', (ctx, next) => {\r\n  ctx.type = 'application/json';\r\n  ctx.body = { name: 'hello wrold' };\r\n});\r\n\r\napp.use(router.routes()).use(router.allowedMethods());\r\n\r\napp.listen(port, hostname, () => {\r\n  console.log(`æœåŠ¡å™¨è¿è¡Œåœ¨ http://${hostname}:${port}/`);\r\n});\r\n```\r\n\r\nè¦å®ç°è¿™ä¸ªåŠŸèƒ½å…ˆå®šä¹‰ä¸€ä¸‹è§„åˆ™\r\n\r\n- åªå¯¼å…¥`src`ç›®å½•ä¸‹`index.js`ç»“å°¾çš„æ¥å£æ–‡ä»¶\r\n\r\n  æœç´¢æ‰€æœ‰ç¬¦åˆè¦æ±‚çš„`index.js`æ–‡ä»¶ï¼Œå¯ä»¥å€ŸåŠ©`glob`æ¨¡å—æ¥å®ç°ï¼Œå€ŸåŠ©é€šé…ç¬¦`'src/**/index.js'`å³å¯ã€‚\r\n\r\n- å¯¼å…¥æ–‡ä»¶ï¼ŒæŠŠå¯¹åº”æ¨¡æ¿è¿”å›çš„å­—æ®µæ·»åŠ åˆ°`router`ä¸Š\r\n\r\n  è¿™é‡Œå¯ä»¥é€šè¿‡ node åŸç”Ÿ`require`æ¥è¯»å–æ–‡ä»¶ï¼Œåœ¨å…·ä½“å®ç°çš„æ—¶å€™éœ€è¦ç¨å¾®æ³¨æ„ï¼Œå¿…é¡»æ»¡è¶³æ ¼å¼çš„æ¨¡å—æ‰èƒ½è¢«å¯¼å…¥ï¼Œè€Œä¸”è¦æ·»åŠ `try`æ¥æ•æ‰ä¸æ˜¯`modules`çš„æ–‡ä»¶\r\n\r\nåœ¨åŠ¨æ‰‹å®ç°è¿™ä¸ªå‡½æ•°ä¹‹å‰ï¼Œè¿˜è¦çº¦å®šä¸€ä¸‹`index.js`æ–‡ä»¶çš„å†…çš„æ¨¡å—æ ¼å¼æ˜¯ä»€ä¹ˆæ ·çš„\r\n\r\n```js\r\nconst api = {\r\n  url: '',\r\n  methods: 'get' || ['post'],\r\n  async callback(ctx) {},\r\n};\r\n```\r\n\r\nä¸Šé¢æ˜¯çº¦å®šçš„æ ¼å¼ï¼Œåªæœ‰æ»¡è¶³è¿™æ ·çš„ç»“æ„æ‰ä¼šè¢«å¯¼å…¥è¿›æ¥ï¼Œå› ä¸ºå¼€å‘ç”¨çš„æ˜¯`ts`è¿™é‡Œå°±ä¸åšè½¬æ¢`js`çš„æ“ä½œäº†ï¼Œå¦‚æœä¸æƒ³ä½¿ç”¨ ts ç›´æ¥å¿½ç•¥æ‰ç±»å‹æ ‡æ³¨çœ‹å¤§æ¦‚å®ç°å³å¯ã€‚\r\n\r\nutils.ts\r\n\r\n```js\r\nimport glob from 'glob';\r\nimport path from 'path';\r\nimport _ from 'lodash';\r\nimport { Iobj, Istructure } from '../../typings/structure';\r\n\r\nexport const globFile = (pattern: string): Promise<Array<string>> => {\r\n  return new Promise((resolve, reject) => {\r\n    glob(pattern, (err, files) => {\r\n      if (err) {\r\n        return reject(err);\r\n      }\r\n      return resolve(files);\r\n    });\r\n  });\r\n};\r\n\r\nexport const importModule = async () => {\r\n  const pattern = 'src/**/index.ts';\r\n  const list = await globFile(pattern);\r\n  const listMap = list.map((item) => {\r\n    const f = path.resolve(process.cwd(), item);\r\n    return import(f)\r\n      .then((res) => {\r\n        // è¿‡æ»¤æ‰defaultçš„å±æ€§ï¼Œå…¶å®ƒçš„è¿”å›\r\n        return _.omit(res, ['default']);\r\n      })\r\n      .catch(() => null);\r\n  });\r\n  return (await Promise.all(listMap)).filter((f) => f) as Array<Iobj<Istructure>>;\r\n};\r\n\r\n```\r\n\r\n> è¿™é‡Œæ³¨æ„ä¸€ä¸‹ï¼Œå› ä¸ºç”¨çš„ ts æ‰€ä»¥ç”¨äº† `import()`å¦‚æœåªæ˜¯ç”¨ node è¯­æ³•ç›´æ¥ `require` å³å¯\r\n\r\nindex.ts\r\n\r\n```js\r\nimport Router from '@koa/router';\r\nimport _ from 'lodash';\r\nimport { Ictx, Iobj } from '../../typings/structure';\r\n\r\nimport { importModule } from './utils';\r\nimport Koa from 'koa';\r\n\r\nconst route = async (koa: Koa) => {\r\n  const router = new Router();\r\n  const list = await importModule();\r\n\r\n  for (const fileAll of list) {\r\n    // å°†æ•°æ®è§£æ„ï¼Œè¿™é‡Œè¿”å›çš„æ˜¯{xxx: {url,methods,callback}}è¿™æ ·è§£æ„\r\n\r\n    // è¿‡æ»¤ä¸ç¬¦åˆæ¡ä»¶çš„æ¨¡å—\r\n    for (const file of Object.values(fileAll)) {\r\n      if (\r\n        !_.isObjectLike(file) ||\r\n        !['url', 'methods', 'callback'].every((f) =>\r\n          Object.keys(file).includes(f)\r\n        )\r\n      ) {\r\n        continue;\r\n      }\r\n      const { url, methods, callback } = file;\r\n      const methodsArr = _.isArray(methods) ? methods : [methods];\r\n      for (const met of methodsArr) {\r\n        router[met](url, async (ctx, next) => {\r\n          const content: Ictx = {\r\n            ...ctx,\r\n            sendData: (data: Iobj, message = 'ok') => {\r\n              ctx.body = {\r\n                data,\r\n                message,\r\n                code: 200,\r\n              };\r\n              ctx.type = 'application/json';\r\n            },\r\n            throwError: (message = 'é”™è¯¯', code = 400) => {\r\n              ctx.body = {\r\n                code,\r\n                message,\r\n              };\r\n              ctx.type = 'application/json';\r\n            },\r\n          };\r\n          try {\r\n            await callback(content);\r\n          } catch (e) {\r\n            ctx.body = {\r\n              code: 400,\r\n              message: (e instanceof Error ? e.message : e) || 'ç³»ç»Ÿå‡ºç°é”™è¯¯',\r\n            };\r\n            ctx.status = 400;\r\n          }\r\n          await next();\r\n        });\r\n      }\r\n    }\r\n  }\r\n  koa.use(router.routes()).use(router.allowedMethods());\r\n};\r\n\r\nexport default route;\r\n```\r\n\r\n## æ—¥å¿—\r\n\r\nå€ŸåŠ© koa çš„ä¸­é—´ä»¶ä¹Ÿå¾ˆå®¹æ˜“å®ç°æ—¥å¿—çš„åŠŸèƒ½ï¼Œè¿™é‡Œä»¥[winston](https://github.com/winstonjs/winston)ä¸ºä¾‹\r\n\r\næ—¥å¿—ä¸»è¦è®°å½•ç³»ç»Ÿè¿è¡Œæ—¶çš„é”™è¯¯ï¼Œè¿˜è®°çš„ä¸Šé¢é€šè¿‡`try`æ¥æ•æ‰é”™è¯¯çš„ä¾‹å­ä¹ˆï¼Œç°åœ¨è®©ä»–ç»§ç»­æŠ›å‡ºé”™è¯¯ï¼Œç›´æ¥é€šè¿‡ä¸­é—´ä»¶ try æ•æ‰é”™è¯¯å†™å…¥åˆ°æ–‡ä»¶ã€‚\r\n\r\n```js\r\nimport winston from 'winston';\r\nimport Koa from 'koa';\r\n\r\nimport 'winston-daily-rotate-file';\r\nconst transport = new winston.transports.DailyRotateFile({\r\n  filename: 'log/%DATE%.log',\r\n  datePattern: 'YYYY-MM-DD-HH',\r\n  zippedArchive: true,\r\n  maxSize: '20m',\r\n  maxFiles: '14d',\r\n});\r\n\r\nconst logger = winston.createLogger({\r\n  transports: [transport],\r\n});\r\n\r\nconst asyncwinston = async (\r\n  _ctx: Koa.ParameterizedContext<Koa.DefaultState, Koa.DefaultContext>,\r\n  next: Koa.Next\r\n) => {\r\n  try {\r\n    await next();\r\n  } catch (err) {\r\n    const data = {\r\n      data: err,\r\n      time: new Date().valueOf(),\r\n    };\r\n    if (err instanceof Error) {\r\n      data.data = {\r\n        content: err.message,\r\n        name: err.name,\r\n        stack: err.stack,\r\n      };\r\n    }\r\n    logger.error(JSON.stringify(data));\r\n  }\r\n};\r\n\r\nexport default asyncwinston;\r\n```\r\n\r\n## å¯åŠ¨\r\n\r\nå¯åŠ¨å°±å¾ˆç®€å•äº†ï¼ŒæŠŠä¸Šé¢æš´éœ²çš„ index.js é€šè¿‡`koa`çš„ use å¼•å…¥\r\n\r\nApp.js\r\n\r\n```js\r\nconst Koa = require('koa');\r\nconst bodyParser = require('koa-bodyparser');\r\nconst route = require('./middleware/route');\r\nconst winston = require('./middleware/winston');\r\n\r\nconst App = async () => {\r\n  const app = new Koa();\r\n  app.use(winston);\r\n  app.use(bodyParser());\r\n  await route(app);\r\n  return app;\r\n};\r\n\r\nmodule.exports = App;\r\n```\r\n\r\nstart.js\r\n\r\n```js\r\nconst Koa = require('koa');\r\nconst ip = require('ip');\r\nconst App = require('./App');\r\n\r\nconst start = async () => {\r\n  const app = await App();\r\n  notice(app);\r\n};\r\n\r\nconst notice = (koa: Koa) => {\r\n  const port = 3000;\r\n  const ipStr = ip.address();\r\n  const str = `http://${ipStr}:${port}`;\r\n  koa.listen(port, () => {\r\n    console.log(`æœåŠ¡å™¨è¿è¡Œåœ¨\\n${str}`);\r\n  });\r\n};\r\n\r\nstart();\r\n```\r\n\r\n**è¿™é‡Œç¨å¾®è¯´æ˜ä¸€ä¸‹ä¸ºä»€ä¹ˆåˆ†æˆä¸¤ä¸ªæ–‡ä»¶ï¼Œè¿™æ˜¯å› ä¸ºæ–¹ä¾¿æ¥å£æµ‹è¯•ç‰¹æ„åˆ†å±‚çš„ï¼Œ`start`åªåšå¯åŠ¨çš„ç”¨é€”**\r\n\r\næœ€åæ·»åŠ ä¸€ä¸ª`node-dev`çš„æ¨¡å—ï¼Œå°±å¤§åŠŸå‘Šæˆäº†\r\n\r\n10/21 è¡¥å……\r\n\r\n> ä¸Šé¢çš„ node-devï¼Œæ˜¯å¼€å‘ç¯å¢ƒä¸‹ä½¿ç”¨çš„ï¼Œæ–¹ä¾¿ä»£ç çš„å¿«é€Ÿé‡å¯ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹å¯ä»¥ä½¿ç”¨ [pm2](https://github.com/Unitech/pm2)\r\n\r\n```js\r\n// å®‰è£…\r\nyarn add node-dev\r\n// å¯åŠ¨\r\nnode-dev start.js\r\n```\r\n\r\né€šè¿‡`node-dev`å¯åŠ¨ä¸»è¦æ˜¯å¯ä»¥æ–¹ä¾¿ä¿®æ”¹æ¥å£å¯ä»¥ç›´æ¥é‡è½½ä»¥åŠé€šçŸ¥çš„æ–¹å¼æ›´æ˜æ˜¾\r\n\r\n## æ¥å£æµ‹è¯•\r\n\r\n12/21 è¡¥ä¸Š\r\n\r\né¦–å…ˆåœ¨ src ç›®å½•ä¸‹ æ–°å»ºä¸€ä¸ª `index.ts` æ–‡ä»¶ï¼Œç”¨äºæµ‹è¯•çš„æ¥å£\r\n\r\n```js\r\nimport { Istructure } from '../typings/structure';\r\n\r\nconst testGet: Istructure = {\r\n  url: '/api/:id',\r\n  methods: 'get',\r\n  async callback(ctx) {\r\n    const { id } = ctx?.params;\r\n    ctx?.sendData({ name: 'hello', id });\r\n  },\r\n};\r\nconst testPost: Istructure = {\r\n  url: '/api',\r\n  methods: 'post',\r\n  async callback(ctx) {\r\n    const body = ctx?.request.body;\r\n    ctx?.sendData(body || {});\r\n  },\r\n};\r\n\r\nexport { testGet, testPost };\r\n```\r\n\r\nä¸Šé¢æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„ post å’Œ get è¯·æ±‚ï¼Œä¹‹åæˆ‘ä»¬æ–°å»ºä¸€ä¸ª`__test__`ç›®å½•ï¼Œåœ¨é‡Œé¢æ–°å»ºä¸€ä¸ª`index.test.js`æ–‡ä»¶\r\n\r\n```sh\r\nyarn add @babel/core @babel/preset-env @babel/preset-typescript babel-jest jest supertest\r\n```\r\n\r\nåœ¨æ ¹ç›®å½•æ–°å»º`babel.config.js`æ–‡ä»¶\r\n\r\n```js\r\n// babel.config.js\r\nmodule.exports = {\r\n  presets: [\r\n    ['@babel/preset-env', { targets: { node: 'current' } }],\r\n    '@babel/preset-typescript',\r\n  ],\r\n};\r\n```\r\n\r\nç®€å•è¯´ä¸‹ï¼Œè¿™ä¸ª babel çš„ä½œç”¨æ˜¯è®©æˆ‘ä»¬å¯ä»¥åœ¨ js é‡Œé¢ä½¿ç”¨ `es6 module` çš„è¯­æ³•ï¼ŒåŒæ—¶å°† ts æ–‡ä»¶è½¬æˆ jsï¼Œå¦åˆ™æˆ‘ä»¬è¿™ä¸ªæµ‹è¯•ç”¨ä¾‹æ˜¯ ts çš„æ ¹æœ¬è·‘ä¸èµ·æ¥ï¼Œæµ‹è¯•æ¡†æ¶æ–¹é¢é€‰ç”¨äº†`jest`æµ‹è¯• http åº“ä½¿ç”¨äº†`supertest`ï¼Œå…¶å®è¿™å—éƒ½æ˜¯å¯ä»¥è°ƒæ•´çš„ï¼Œå•å…ƒæµ‹è¯•çš„ç›®çš„å°±æ˜¯å¯¹æ¯”æ•°æ®æ˜¯å¦ç¬¦åˆé¢„æœŸ\r\n\r\n`__test__ index.test.js`\r\n\r\n```js\r\nimport App from '../App';\r\n\r\nimport supertest from 'supertest';\r\n\r\ntest('getè¯·æ±‚æµ‹è¯•', async () => {\r\n  const app = await App();\r\n  const request = supertest(app.listen());\r\n  const id = 6;\r\n  const data = { name: 'hello', id: `${id}` };\r\n  const res = await request.get(`/api/${id}`).expect(200);\r\n  const body = res.body.data;\r\n  expect(body).toEqual(data);\r\n});\r\n\r\ntest('postè¯·æ±‚æµ‹è¯•', async () => {\r\n  const app = await App();\r\n  const request = supertest(app.listen());\r\n  const data = { name: 'hello', id: 8 };\r\n  const res = await request.post(`/api/`).send(data).expect(200);\r\n  const body = res.body.data;\r\n  expect(body).toEqual(data);\r\n});\r\n```\r\n\r\nè¿è¡Œ `npx jest `ï¼Œå‘½ä»¤è¡Œå¦‚æœæ²¡æœ‰æŠ›å‡ºå¼‚å¸¸è¯´æ˜æˆ‘ä»¬çš„ä»£ç ç¬¦åˆé¢„æœŸï¼Œå…³äºæ›´å¤šçš„ jest å†…å®¹å¯ä»¥æŸ¥çœ‹æ–‡æ¡£\r\n\r\n## æœ€å\r\n\r\nå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©æ¬¢è¿ `stat`ï¼Œå¦‚æœæœ‰ä»€ä¹ˆé”™è¯¯ä¹‹å¤„æ¬¢è¿æŒ‡å‡ºï¼Œå…³äºä»£ç æœ¬æ¥å…¨éƒ¨æƒ³ç”¨ ts ä¸¾ä¾‹çš„ï¼Œä½†æ˜¯ ts å¹¶ä¸æ˜¯ä¸€å®šè¦ä¸Šçš„ï¼Œæ‰€ä»¥æŸäº›åœºæ™¯æˆ‘å°±æ‰‹åŠ¨è½¬äº†ä¸€ä¸‹ï¼Œçœ‹èµ·æ¥æœ‰ç‚¹é£æ ¼ä¸ç»Ÿä¸€è¿˜æœ›è°…è§£\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/65/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/65/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/61",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/61/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/61/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/61/events",
      "html_url": "https://github.com/bosens-China/blog/issues/61",
      "id": 680636174,
      "node_id": "MDU6SXNzdWU2ODA2MzYxNzQ=",
      "number": 61,
      "title": "æ–‡å­—é«˜äº®",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1371686609,
          "node_id": "MDU6TGFiZWwxMzcxNjg2NjA5",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/JavaScript",
          "name": "JavaScript",
          "color": "F7DF1E",
          "default": false,
          "description": "JavaScriptç³»åˆ—çš„æ–‡ç« "
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2020-08-18T02:15:53Z",
      "updated_at": "2021-12-21T03:30:00Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "![bg](https://user-images.githubusercontent.com/39508895/90462493-935eb900-e13b-11ea-902c-dce1e576fbb4.png)\r\n\r\nå¦‚ä¸Šå›¾ï¼Œå¯èƒ½åœ¨æœç´¢ä¹‹ç±»çš„æ—¶å€™éœ€è¦å°†æœç´¢å†…å®¹è¿›è¡Œé«˜äº®ï¼Œä¸‹é¢èŠèŠå°ç¨‹åºå’Œ web ä¸Šå¦‚ä½•å®ç°ã€‚\r\n\r\n## web ä¸Šåšæ³•\r\n\r\nå¯ä»¥é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼`/(é«˜äº®çš„æ–‡å­—)/`æ¥å®ç°\r\n\r\n```js\r\nfunction highlight(str, sep, color) {\r\n  const reg = new RegExp(`\\(${sep}\\)`, 'g');\r\n  return str.replace(reg, `<i style=\"color:${color};\">$1</i>`);\r\n}\r\nhighlight('å®‰å¾½çœåˆè‚¥å¸‚', 'å®‰å¾½', 'reg');\r\n// <i style=\"color:reg;\">å®‰å¾½</i>çœåˆè‚¥å¸‚\r\n```\r\n\r\nè¿™é‡Œå®ç°æ¯”è¾ƒç®€å•ï¼Œç¨å¾®æ³¨æ„ä¸€ä¸‹`replace`api å³å¯ï¼Œå®ƒè¿˜å¯ä»¥æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå…·ä½“å†…å®¹è¿™é‡Œä¸åšè®²è§£äº†åªç®€å•å®ç°ä¸€ä¸‹ã€‚\r\n\r\n## å°ç¨‹åºåšæ³•\r\n\r\nä¸åŒäº webï¼Œå› ä¸ºå°ç¨‹åºæ— æ³•æ‰‹åŠ¨ç®¡ç† `dom` æ ·å¼ï¼Œæ‰€ä»¥æ€è·¯æ˜¯å°†`é«˜äº®æ–‡å­—`å’Œæ™®é€šæ–‡å­—åŒºåˆ†å¼€æ¥ï¼Œä¾‹å¦‚ï¼š\r\n\r\n```js\r\nvar str = 'å®‰å¾½çœåˆè‚¥å¸‚èœ€å±±åŒº';\r\n// å¦‚æœé«˜äº®åˆè‚¥å¸‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬æŠŠä»–è½¬åŒ–ä¸ºä¸‹é¢è¿™ç§å½¢å¼çš„æ•°ç»„\r\n['å®‰å¾½çœ', 'åˆè‚¥å¸‚', 'èœ€å±±åŒº'];\r\n```\r\n\r\nå°†æ™®é€šæ–‡å­—å’Œé«˜äº®æ–‡å­—é€šè¿‡æ•°ç»„çš„å½¢å¼åŒºåˆ†å¼€æ¥ï¼Œä¹‹åå†é€šè¿‡`<text>`æ ‡ç­¾å°†è½¬æ¢åçš„æ•°ç»„`for`å¾ªç¯ï¼Œæ¯æ¬¡å¾ªç¯çš„ç»“æœä¸é«˜äº®æ–‡å­—å¯¹æ¯”ï¼Œå¦‚æœç¬¦åˆå°±æ·»åŠ é«˜äº®æ ·å¼ã€‚\r\n\r\n```html\r\n<view>\r\n  <text\r\n    style=\"{{item === keyWord ? 'color:' + color + ';' : ''}}\"\r\n    wx:for=\"{{arr}}\"\r\n    wx:key=\"item\"\r\n  >\r\n    {{item}}\r\n  </text>\r\n</view>\r\n```\r\n\r\næ•´ä½“çš„æ€è·¯å°±æ˜¯è¿™æ ·ï¼Œä¸‹é¢è¯´ä¸€ä¸‹å®ç°çš„ç»†èŠ‚ã€‚\r\n\r\n- æ€ä¹ˆå°†ä¸€æ®µæ–‡å­—è½¬åŒ–ä¸ºä¸Šé¢æ•°ç»„çš„å½¢å¼\r\n  å…¶å®è¿™å—è¦åˆ†ä¸ºä¸¤æ­¥ï¼Œå°†æ–‡å­—è½¬åŒ–ä¸ºæ•°ç»„æˆ‘ä»¬å¯ä»¥ç”¨`split`çš„æ–¹æ³•ï¼Œä¹‹åé€šè¿‡ä¸€ä¸ªå˜å¼‚çš„`join`å°†ä»–ä»¬æ‹¼æˆæ•°ç»„ã€‚\r\n\r\n```js\r\nfunction join(array, str) {\r\n  const arr = [];\r\n  const len = array.length;\r\n  for (let i = 0; i < len - 1; i++) {\r\n    const value = array[i];\r\n    if (!value) {\r\n      arr.push(str);\r\n    } else {\r\n      arr.push(value, str);\r\n    }\r\n  }\r\n  if (array[len - 1]) {\r\n    arr.push(array[len - 1]);\r\n  }\r\n  return arr;\r\n}\r\n```\r\n\r\næŠŠä¸Šé¢çš„`wxml`ä»£ç ç‰‡æ®µå’Œ`join`ç›¸å…³ç»„åˆä¸€èµ·å°±å¯ä»¥å®ç°ä¸€ä¸ªæ–‡å­—é«˜äº®çš„æ•ˆæœäº†ã€‚\r\n\r\nä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œæˆ‘è¿™é‡Œå·²ç»å°è£…æˆä¸€ä¸ªåº“äº†[highlight](https://github.com/bosens-China/highlight)\r\n\r\n## æœ€å\r\n\r\nç›¸å…³ä»£ç æ•´åˆåˆ°äº†[Github](https://github.com/bosens-China/highlight)\r\n\r\nå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©å¯ä»¥`star`æ”¯æŒä½œè€…ä¸€ä¸‹ã€‚\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/61/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/61/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/30",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/30/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/30/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/30/events",
      "html_url": "https://github.com/bosens-China/blog/issues/30",
      "id": 503803775,
      "node_id": "MDU6SXNzdWU1MDM4MDM3NzU=",
      "number": 30,
      "title": "æ¨¡æ‹Ÿå®ç°callå’Œapply",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1602397157,
          "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
          "name": "æ·±å…¥ç³»åˆ—",
          "color": "719192",
          "default": false,
          "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2019-10-08T03:31:31Z",
      "updated_at": "2021-12-21T03:07:06Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "> call() æ–¹æ³•ä½¿ç”¨ä¸€ä¸ªæŒ‡å®šçš„ this å€¼å’Œå•ç‹¬ç»™å‡ºçš„ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°æ¥è°ƒç”¨ä¸€ä¸ªå‡½æ•°\r\n\r\nä¸Šé¢æ˜¯ call çš„å®šä¹‰ï¼Œapply ä¸ call ç±»ä¼¼åªæ˜¯ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„è€Œ call æ¥æ”¶çš„åˆ™æ˜¯ä¸€ä¸ªå‚æ•°åˆ—è¡¨ã€‚\r\n\r\nçœ‹ä¸€ä¸ªä¾‹å­\r\n\r\n```js\r\nvar obj = {\r\n  name: \"obj\"\r\n};\r\nfunction foo() {\r\n  return this.name;\r\n}\r\nfoo.call(obj); //obj\r\n```\r\n\r\nä¸Šé¢é€šè¿‡ call æ”¹å˜äº† this çš„æŒ‡å‘ï¼Œä¸‹é¢å°±æ˜¯æ¨¡æ‹Ÿå®ç°\r\n\r\n## å®ç°\r\n\r\ncall å’Œ apply æ˜¯ es5 çš„æ–¹æ³•ï¼Œæ—¢ç„¶æ˜¯æ¨¡æ‹Ÿå®ç°é‚£è‚¯å®šä¸èƒ½ç”¨ es5 æ–¹æ³•äº†ï¼Œæˆ‘ä»¬å…ˆåˆ†æä¸€ä¸‹æ€ä¹ˆæ¥æŒ‡å®š thisï¼Œthis è·ŸåŠ¨æ€ä½œç”¨åŸŸç±»ä¼¼æ˜¯åœ¨æ‰§è¡Œæ—¶ç¡®å®šï¼Œé‚£æˆ‘ä»¬åœ¨æŒ‡å®š this çš„å±æ€§ä¸Šæ·»åŠ ä¸€ä¸ªæ–¹æ³•å¹¶ä¸”æ‰§è¡Œï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•çš„ this å°±æ˜¯æŒ‡å®š this\r\n\r\n```js\r\nvar obj = {\r\n  name: \"obj\",\r\n  foo: function foo() {\r\n    return this.name;\r\n  }\r\n};\r\n\r\nobj.foo();\r\n```\r\n\r\nä¸Šé¢è§£å†³äº† thisï¼Œä¸‹é¢æ¥çœ‹ä¸‹æ€ä¹ˆå®ç°å‚æ•°çš„ä¼ é€’ï¼Œcall æ–¹æ³•å¯ä»¥ä¼ é€’ä»»æ„å‚æ•°åˆ—è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡`arguments`æ¥è·å–ï¼Œå®ƒæ˜¯ä¸€ä¸ªç±»æ•°ç»„ã€‚\r\n\r\n```js\r\nfunction getName() {\r\n  console.log(arguments); //Arguments(5) [1, 2, 3, 4, 5]\r\n}\r\nfunction foo() {\r\n  var args = [];\r\n  for (var i = 0; i < arguments.length; i++) {\r\n    args.push(\"arguments[\" + i + \"]\");\r\n  }\r\n  eval(\"getName(\" + args + \")\");\r\n}\r\nfoo(1, 2, 3, 4, 5);\r\n```\r\n\r\nOKï¼Œè¿™ä¸¤å—å·²ç»æå®šäº†ï¼Œä¸‹é¢å°±æ˜¯å®ç°\r\n\r\n### call\r\n\r\n```js\r\nFunction.prototype.calls = function(con) {\r\n  con.fn = this;\r\n  // è·å–å‚æ•°\r\n  var args = [];\r\n  for (var i = 1; i < arguments.length; i++) {\r\n    args.push(\"arguments[\" + i + \"]\");\r\n  }\r\n  var result = eval(\"con.fn(\" + args + \")\");\r\n  delete con.fn;\r\n  return result;\r\n};\r\n```\r\n\r\nä¸Šé¢åˆ é™¤å±æ€§æ˜¯ä¸ºäº†é¿å…æ±¡æŸ“ï¼Œè¿™é‡Œçš„`fn`å¯ä»¥æ˜¯ä»»æ„å±æ€§ååªè¦ä¿è¯ä¸é‡å¤å°±è¡Œäº†ï¼Œä¸è¿‡ä»”ç»†è§‚å¯Ÿä¸Šé¢å‡½æ•°è¿˜æ˜¯æœ‰é—®é¢˜\r\n\r\n1. call çš„ this å¯ä»¥æ˜¯ `null` æˆ–è€… `undefined`ï¼›\r\n2. å¯ä»¥æ˜¯å­—ç¬¦ä¸²æ•°å­—ä¹‹ç±»çš„ï¼Œä¼šè½¬åŒ–ä¸ºåŒ…è£…å¯¹è±¡ï¼›\r\n\r\n```js\r\nFunction.prototype.calls = function(con) {\r\n  if (con == null) {\r\n    con = typeof window === \"object\" ? window : global;\r\n  }\r\n  con = Object(con);\r\n  con.fn = this;\r\n  // è·å–å‚æ•°\r\n  var args = [];\r\n  for (var i = 1; i < arguments.length; i++) {\r\n    args.push(\"arguments[\" + i + \"]\");\r\n  }\r\n  var result = eval(\"con.fn(\" + args + \")\");\r\n  delete con.fn;\r\n  return result;\r\n};\r\n```\r\n\r\næµ‹è¯•ä¸€ä¸‹\r\n\r\n```js\r\nfunction foo() {\r\n  return this.length;\r\n}\r\nconsole.log(foo.calls(\"obj\")); // 3\r\n```\r\n\r\næ’’èŠ±ï¼Œè¿™æ ·å°±å®ç°äº† call\r\n\r\n### apply\r\n\r\nä¸ call ååˆ†ç±»ä¼¼ï¼Œè¿™é‡Œå°±ç›´æ¥è´´ä»£ç äº†\r\n\r\n```js\r\nFunction.prototype.applys = function(con, arr) {\r\n  if (con == null) {\r\n    con = typeof window === \"object\" ? window : global;\r\n  }\r\n  con = Object(con);\r\n  con.fn = this;\r\n  var result;\r\n  if (typeof arr === \"object\" && arr.length) {\r\n    var args = [];\r\n    for (var i = 0; i < arr.length; i++) {\r\n      args.push(\"arr[\" + i + \"]\");\r\n    }\r\n    result = eval(\"con.fn(\" + args + \")\");\r\n  } else {\r\n    result = eval(\"con.fn()\");\r\n  }\r\n  delete con.fn;\r\n  return result;\r\n};\r\n```\r\n\r\n## å‚è€ƒ\r\n\r\n1. https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/call\r\n2. https://github.com/mqyqingfeng/Blog/issues/11\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/30/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/30/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/31",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/31/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/31/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/31/events",
      "html_url": "https://github.com/bosens-China/blog/issues/31",
      "id": 503856924,
      "node_id": "MDU6SXNzdWU1MDM4NTY5MjQ=",
      "number": 31,
      "title": "æ¨¡æ‹Ÿå®ç°bind",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1602397157,
          "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
          "name": "æ·±å…¥ç³»åˆ—",
          "color": "719192",
          "default": false,
          "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2019-10-08T06:35:47Z",
      "updated_at": "2021-12-21T03:06:57Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "ä¹‹å‰è¯´äº†[æ¨¡æ‹Ÿå®ç° call å’Œ apply](https://github.com/bosens-China/blog/issues/30)ï¼Œä¸‹é¢å°±æ¥å®ç° bindï¼Œé¦–å…ˆå…ˆçœ‹ä¸€ä¸‹å®šä¹‰ bind å®šä¹‰\r\n\r\n> bind()æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œåœ¨ bind()è¢«è°ƒç”¨æ—¶ï¼Œè¿™ä¸ªæ–°å‡½æ•°çš„ this è¢« bind çš„ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šï¼Œå…¶ä½™çš„å‚æ•°å°†ä½œä¸ºæ–°å‡½æ•°çš„å‚æ•°ä¾›è°ƒç”¨æ—¶ä½¿ç”¨ã€‚\r\n\r\n## ç¬¬ä¸€ç‰ˆ\r\n\r\næ ¹æ®å®šä¹‰æˆ‘ä»¬å°è¯•å†™ä¸€ä¸‹\r\n\r\n```js\r\nFunction.prototype.binds = function(con) {\r\n  var fn = this;\r\n  var args = Array.prototype.slice.call(arguments, 1);\r\n  return function() {\r\n    return fn.apply(con, args);\r\n  };\r\n};\r\n```\r\n\r\næˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ä¸Šé¢çš„å‡½æ•°\r\n\r\n```js\r\nvar obj = {\r\n  value: \"zhangsan\"\r\n};\r\nfunction foo(name, age) {\r\n  console.log(this.value); //zhangsan\r\n  console.log(name); // name\r\n  console.log(age); // undefined\r\n}\r\nvar f = foo.binds(obj, \"name\");\r\nf(19);\r\n```\r\n\r\n`age` è¾“å‡ºçš„è·Ÿæˆ‘ä»¬é¢„æœŸçš„ä¸å¤ªä¸€è‡´ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ²¡æœ‰å¤„ç†è¿”å›å‡½æ•°çš„å‚æ•°ï¼Œç”¨ concat æŠŠå‚æ•°åˆå¹¶åœ¨ä¸€èµ·å°±å¯ä»¥äº†ã€‚\r\n\r\n```js\r\nFunction.prototype.binds = function(con) {\r\n  var fn = this;\r\n  var args = Array.prototype.slice.call(arguments, 1);\r\n  return function() {\r\n    return fn.apply(con, args.concat(Array.prototype.slice.call(arguments)));\r\n  };\r\n};\r\n```\r\n\r\n## ç¬¬äºŒç‰ˆ\r\n\r\nä¸Šé¢ç®€å•å®ç°äº†å‡½æ•°çš„ bindï¼Œä¸è¿‡æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ bind ä¸æ„é€ å‡½æ•°ç›¸é‡ä¼šæ€ä¹ˆæ ·\r\n\r\n```js\r\nvar obj = {\r\n  value: \"zhangsan\"\r\n};\r\nfunction Foo(name, age) {\r\n  console.log(this.value); //undefined\r\n  console.log(name);\r\n  console.log(age);\r\n}\r\nvar f = Foo.bind(obj, \"name\");\r\nnew f(19);\r\n```\r\n\r\nä¸Šé¢ `this.value` çš„è¾“å‡ºä¸º `undefined`ï¼Œè¿™æ˜¯å› ä¸º **è°ƒç”¨ç»‘å®šå‡½æ•°æ—¶ä½œä¸º this å‚æ•°ä¼ é€’ç»™ç›®æ ‡å‡½æ•°çš„å€¼ã€‚ å¦‚æœä½¿ç”¨ new è¿ç®—ç¬¦æ„é€ ç»‘å®šå‡½æ•°ï¼Œåˆ™å¿½ç•¥è¯¥å€¼**ã€‚\r\n\r\nå¦å¤–ä½œä¸ºæ„é€ å‡½æ•°æ˜¯å¯ä»¥è·å–åˆ°ç»‘å®š bind å‡½æ•°çš„ `prototype` çš„\r\n\r\n```js\r\nfunction Foo() {\r\n  console.log(this.gender); //male\r\n}\r\nFoo.prototype.gender = \"male\";\r\nvar f = Foo.bind(null, \"name\");\r\nnew f();\r\n```\r\n\r\nä¸‹é¢å°±æ˜¯æ¥å®ç°ä¸Šé¢ä¸¤ç‚¹ï¼š\r\n\r\n- æ€ä¹ˆæ¥åˆ¤æ–­æ˜¯å¦é€šè¿‡ new æ¥è°ƒç”¨å‘¢ï¼Ÿå¯ä»¥é€šè¿‡`instanceof`\r\n\r\n```js\r\nfunction Foo() {\r\n  if (!(this instanceof Foo)) {\r\n    throw Error(\"è¯·é€šè¿‡newè°ƒç”¨\");\r\n  }\r\n}\r\nFoo();\r\n```\r\n\r\n- ç»§æ‰¿çš„è¯æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿ï¼Œè¿™ç±»æ–‡ç« æ¯”è¾ƒå¤šï¼Œè¿™é‡Œå°±ç®€å•ä¸¾ä¸€ä¸ªä¾‹å­\r\n\r\n```js\r\nfunction create(con) {\r\n  var f = function() {};\r\n  f.prototype = con;\r\n  return new f();\r\n}\r\nfunction Par(name) {\r\n  this.name = name;\r\n}\r\nPar.prototype.getName = function() {\r\n  return this.name;\r\n};\r\nfunction Chi(name, age) {\r\n  Par.call(this, name);\r\n  this.age = age;\r\n}\r\nChi.prototype = create(Par.prototype);\r\nChi.prototype.constructor = Chi;\r\nChi.prototype.getDetails = function() {\r\n  var n = this.getName();\r\n  console.log(n, this.age);\r\n};\r\nvar d = new Chi(\"zhangsan\", 16);\r\nd.getDetails();\r\n```\r\n\r\nOKï¼Œä¸Šé¢ä¸¤ç‚¹è§£å†³åæˆ‘ä»¬å†æ¥å®ç°ä¸€ç‰ˆ\r\n\r\n```js\r\nFunction.prototype.binds = function(con) {\r\n  var fn = this;\r\n  var args = Array.prototype.slice.call(arguments, 1);\r\n  var f = function() {};\r\n  if (this.prototype) {\r\n    f.prototype = this.prototype;\r\n  }\r\n  var result = function() {\r\n    return fn.apply(\r\n      this instanceof result ? this : con,\r\n      args.concat(Array.prototype.slice.call(arguments))\r\n    );\r\n  };\r\n  result.prototype = new f();\r\n  return result;\r\n};\r\n```\r\n\r\n## ä¼˜åŒ–\r\n\r\nè§‚å¯Ÿä¸Šé¢çš„ä¸éš¾å‘ç° bind è°ƒç”¨çš„å¿…é¡»æ˜¯å‡½æ•°ï¼Œè€Œé€šè¿‡ç»§æ‰¿æˆ‘ä»¬å¯èƒ½ä¼šè°ƒç”¨åˆ° bind æ‰€ä»¥è¿™é‡Œæ˜¾ç¤ºæŠ¥é”™ä¸€ä¸‹\r\n\r\n```js\r\nvar obj = Object.create(Function.prototype);\r\nconsole.log(obj.bind);\r\n```\r\n\r\nå¦å¤–å¯¹äºæˆ‘ä»¬ä¸Šé¢å®šä¹‰çš„`binds`è‚¯å®šä¸å¤ªä¼˜é›…ï¼Œæ±¡æŸ“äº†å‘½åç©ºé—´ï¼Œè¿™é‡Œå¯ä»¥åˆ¤æ–­ä¸€ä¸‹å¦‚æœå­˜åœ¨ `bind` å°±ç”¨ `bind` å¦åˆ™åœ¨å®šä¹‰\r\n\r\n## æœ€ç»ˆ\r\n\r\n```js\r\nif (!Function.prototype.bind) {\r\n  Function.prototype.bind = function(con) {\r\n    if (typeof this !== \"function\") {\r\n      throw new TypeError(\r\n        \"Function.prototype.bind - what is trying to be bound is not callable\"\r\n      );\r\n    }\r\n    var fn = this;\r\n    var args = Array.prototype.slice.call(arguments, 1);\r\n    var f = function() {};\r\n    if (this.prototype) {\r\n      f.prototype = this.prototype;\r\n    }\r\n    var result = function() {\r\n      return fn.apply(\r\n        this instanceof result ? this : con,\r\n        args.concat(Array.prototype.slice.call(arguments))\r\n      );\r\n    };\r\n    result.prototype = new f();\r\n    return result;\r\n  };\r\n}\r\n```\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/31/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/31/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/11",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/11/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/11/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/11/events",
      "html_url": "https://github.com/bosens-China/blog/issues/11",
      "id": 479656673,
      "node_id": "MDU6SXNzdWU0Nzk2NTY2NzM=",
      "number": 11,
      "title": "å˜é‡æå‡",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1602397157,
          "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
          "name": "æ·±å…¥ç³»åˆ—",
          "color": "719192",
          "default": false,
          "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2019-08-12T13:49:40Z",
      "updated_at": "2021-12-21T03:06:32Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "> è¿™é‡Œåªæ˜¯ç”¨ä¼ªä»£ç çš„å½¢å¼æ¥è¯´æ˜ï¼Œå®é™…ä¸Šå˜é‡å£°æ˜åªæ˜¯æ‰§è¡Œä¸Šä¸‹æ–‡æœ‰å…³ï¼Œæ¨èé˜…è¯»[\r\nJavaScriptæ·±å…¥ä¹‹å˜é‡å¯¹è±¡](https://github.com/mqyqingfeng/Blog/issues/5)\r\n\r\n## å¤ªé•¿ä¸çœ‹ç¯‡\r\nå‡½æ•°å‚æ•° > å‡½æ•°å£°æ˜ > å˜é‡å£°æ˜\r\n\r\n## å˜é‡å£°æ˜\r\né¦–å…ˆæƒ³ç”¨ä¸€ä¸ªä¼ªç”Ÿå‘½å‘¨æœŸæ¥è¯´è¿™ä¸ªäº‹æƒ…ï¼Œå‡è®¾è¿™æ®µä»£ç åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼Œåˆå§‹åŒ–é˜¶æ®µå’Œèµ‹å€¼é˜¶æ®µï¼› çœ‹ä¸‹é¢ä¸€æ®µä»£ç ï¼Œç”¨ä¼ªç³»ç»Ÿçš„è¯æ¥é˜è¿°\r\n``` js\r\nconsole.log(a);\r\nvar a = 10;\r\n```\r\nå¦‚æœæŒ‰ç…§ä¸Šé¢çš„å£°æ˜å‘¨æœŸæ¥è¯´ï¼Œé¦–å…ˆå˜é‡ a ä¼šåœ¨ä½œç”¨åŸŸæ³¨å†Œä¸€ä¸ªå˜é‡(å¦‚æœæ²¡æœ‰)é»˜è®¤èµ‹å€¼ä¸º `undefined`\r\n\r\nåˆå§‹åŒ–å®Œæˆåï¼Œå¼€å§‹æ‰§è¡Œä»£ç ï¼Œç¬¬ä¸€è¡Œè¯­å¥çš„æ—¶å€™å› ä¸ºå˜é‡ a æœªç»è¿‡èµ‹å€¼é˜¶æ®µï¼Œè¿™ä¸€é˜¶æ®µçš„å€¼æ˜¯ `ndefined`ï¼Œæ‰€ä»¥æ‰“å°çš„ç»“æœè‡ªç„¶ä¹Ÿå°±æ˜¯ `undefined`;\r\n\r\nåœ¨ç¬¬äºŒè¡Œçš„æ—¶å€™å˜é‡ a ä¼šç»è¿‡èµ‹å€¼é˜¶æ®µï¼Œè¿™æ—¶å˜é‡ a çš„å€¼å°±æ˜¯ 10 äº†ã€‚\r\n\r\n## å‡½æ•°å£°æ˜\r\nå‡½æ•°å£°æ˜ä¸å˜é‡å£°æ˜è§„åˆ™åŸºæœ¬ä¸€è‡´ï¼Œä¼˜å…ˆçº§æ¯”å˜é‡å£°æ˜è¦é«˜\r\n\r\næ˜¯ä¸æ˜¯åªè¯´è¿™ä¸€å¥è¯å¤§å®¶æœ‰äº›å¤±æœ›ï¼Œå¦‚æœåªæ˜¯å•ç‹¬æ¥è¯´å‡½æ•°å£°æ˜æœªå…å¤ªæ²¡æ„æ€ï¼Œä¸‹é¢å°±ç»“åˆå˜é‡å£°æ˜æ¥è¯´è¯´å‡½æ•°å£°æ˜ï¼Œæ¯•ç«Ÿä»£ç åªæœ‰å˜é‡å£°æ˜å°±åšä¸åˆ°æœ‰è¶£äº†ã€‚\r\n``` js\r\na();\r\nvar a = 10;\r\nfunction a() {\r\n  console.log(5);\r\n}\r\n```\r\nä¸Šé¢çš„æ‰§è¡Œç»“æœæ˜¯æ‰“å°æ•°å­— 5ï¼Œä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§æƒ…å†µå‘¢ï¼Ÿä¸Šé¢æˆ‘ä»¬å·²ç»è¯´äº†å‡½æ•°å£°æ˜ä¼˜å…ˆäºå˜é‡å£°æ˜ï¼Œé‚£ä¹ˆä¸Šé¢ä»£ç å®é™…å¯ä»¥æ‹†å°æˆä¸‹é¢å½¢å¼\r\n``` js\r\nfunction a() {\r\n  // ...\r\n}\r\na();\r\na = 10;\r\n```\r\nä½ å¯èƒ½è¿˜æœ‰ç–‘æƒ‘ï¼Œäº‹å®ä¸Šå¦‚æœå˜é‡æå‡çš„æ—¶å€™å‘ç°å·²ç»å­˜åœ¨å˜é‡å°±ä¼šé»˜é»˜å¿½ç•¥æ‰ï¼Œæ¯”å¦‚ä¸Šé¢çš„ä»£ç å˜é‡ a å·²ç»æ˜¯ä¸€ä¸ªå‡½æ•°äº†ï¼Œé‚£ä¹ˆå˜é‡å£°æ˜çš„ a ä¼šè¢«å¿½ç•¥ã€‚\r\n\r\næœ€åè¯´ä¸‹å‡½æ•°å‚æ•°ï¼Œå‚æ•°ä¹Ÿæ˜¯å˜é‡çš„ä¸€ç§å½¢å¼ï¼Œå®ƒçš„ä¼˜å…ˆçº§æœ€é«˜ï¼Œä½†æ˜¯åŒæ ·ä¼šå—åˆ°å‡½æ•°å£°æ˜çš„å½±å“\r\n``` js\r\nfunction a(x) {\r\n  console.log(x);\r\n  function x() {}\r\n}\r\na(5);\r\n```\r\nè¿™é‡Œè¾“å‡ºç»“æœæ˜¯å‡½æ•° xï¼ŒåŸå› æ˜¯å‡½æ•°å£°æ˜æå‡çš„æ—¶å€™ä¼šæ‰§è¡Œä¸€ä¸ªè¦†ç›–æ“ä½œï¼Œå°±åƒæˆ‘ä»¬å†™ä»£ç `x = 5`è¿™æ ·\r\n\r\n## æœ€å\r\nè¿™é‡Œè¯´çš„æœ‰å¾ˆå¤šåœ°æ–¹ä¸è¶³ï¼Œåªæ˜¯è‡ªå·±çš„è§è§£ï¼Œæ›´æ¨èä¸€ç¯‡æ–‡ç« [10 åˆ†é’Ÿç†è§£æ‰§è¡Œä¸Šä¸‹æ–‡](https://zhuanlan.zhihu.com/p/25879753)\r\n\r\næœ€åæ ¹æ®ä¸Šé¢çš„å†…å®¹è®²è§£ä¸€ä¸‹ä»–å¸ƒç½®çš„ä¸€åˆ°é¢˜ç›®\r\n``` js\r\nconsole.log(x);\r\nvar x = 10;\r\n\r\nconsole.log(x);\r\nx = 20;\r\n\r\nfunction x() {}\r\nconsole.log(x);\r\n\r\nif (true) {\r\n  var a = 1;\r\n} else {\r\n  var b = true;\r\n}\r\n\r\nconsole.log(a);\r\nconsole.log(b);\r\n```\r\né¦–å…ˆåˆå§‹åŒ–é˜¶æ®µï¼Œ`function x` æœ€å…ˆè¢«æå‡ï¼Œåé¢çš„å˜é‡æå‡å› ä¸ºå·²ç»å­˜åœ¨å‡½æ•° x çš„åŸå› ä¼šè¢«å¿½ç•¥ ç¬¬ä¸€ä¸ª console è¾“å‡ºçš„æ˜¯å‡½æ•°` x`ï¼Œ\r\n\r\nä¹‹åæ‰§è¡Œåˆ°ç¬¬äºŒè¡Œä»£ç çš„æ—¶å€™ `x` è¢«æ”¹å˜å˜æˆ` 10`ï¼Œç¬¬äºŒä¸ª `console` è¾“å‡ºä¸º `10`ï¼Œä¹‹åç»§ç»­è¢«èµ‹å€¼ä¸º `20`ï¼Œç¬¬ä¸‰ä¸ª` console` è¾“å‡ºä¸º `20`ï¼Œ\r\n\r\nç¬¬å››ä¸ªå’Œç¬¬äº”ä¸ª `console` çš„è¾“å‡ºåˆ†åˆ«ä¸º `1` å’Œ` undefined`ï¼Œè¿™æ˜¯å› ä¸º es5 çš„ç¯å¢ƒä¸‹å¹¶ä¸å­˜åœ¨å—çº§ä½œç”¨åŸŸï¼Œå˜é‡ `a` å’Œ `b` ä¼šæ‰§è¡Œå˜é‡æå‡è¿™ä¸€æ­¥éª¤ï¼Œ \r\nä¸åŒçš„æ˜¯ `a` è¢«èµ‹å€¼ä¸ºäº† `1`ï¼Œè€Œ `b` å› ä¸ºæ²¡æœ‰æ‰§è¡Œåˆ° `var b = true` æ‰€ä»¥å€¼è¿˜æ˜¯ `undefined`ã€‚",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/11/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/11/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/32",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/32/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/32/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/32/events",
      "html_url": "https://github.com/bosens-China/blog/issues/32",
      "id": 503866389,
      "node_id": "MDU6SXNzdWU1MDM4NjYzODk=",
      "number": 32,
      "title": "æ¨¡æ‹Ÿå®ç°new",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1602397157,
          "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
          "name": "æ·±å…¥ç³»åˆ—",
          "color": "719192",
          "default": false,
          "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2019-10-08T07:03:22Z",
      "updated_at": "2021-12-21T03:04:48Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "> new è¿ç®—ç¬¦åˆ›å»ºä¸€ä¸ªç”¨æˆ·å®šä¹‰çš„å¯¹è±¡ç±»å‹çš„å®ä¾‹æˆ–å…·æœ‰æ„é€ å‡½æ•°çš„å†…ç½®å¯¹è±¡çš„å®ä¾‹ã€‚\r\n\r\nä¸Šé¢çš„å®šä¹‰æœ‰ç‚¹æŠ½è±¡ï¼Œæˆ‘ä»¬æ¥é€šè¿‡ä¸€ä¸ªä¾‹å­çœ‹ new è¿ç®—ç¬¦æ‰®æ¼”çš„è§’è‰²\r\n\r\n```js\r\nfunction Foo(name, age) {\r\n  this.name = name;\r\n  this.age = age;\r\n}\r\nFoo.prototype.getName = function() {\r\n  return this.name;\r\n};\r\nFoo.prototype.foo = \"foo\";\r\nvar f = new Foo(\"zhangsan\", 18);\r\nf.getName(); // zhangsan\r\nf.foo; // foo\r\n```\r\n\r\nä¸Šé¢é€šè¿‡ new åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå¹¶ä¸”è¿™ä¸ªå¯¹è±¡é€šè¿‡åŸå‹é“¾è®¿é—®åˆ°äº†åŸå‹ä¸Šçš„æ–¹æ³•å’Œå±æ€§ï¼Œæ‰€ä»¥ new è¿ç®—ç¬¦å°±æ˜¯æ‰§è¡Œæ„é€ å‡½æ•°è¿”å›ä¸€ä¸ªå®ä¾‹å¯¹è±¡ã€‚\r\n\r\nnew è¿ç®—ç¬¦åœ¨æ‰§è¡Œæ—¶æ‰§è¡Œäº†ä¸‹é¢å››æ­¥ï¼š\r\n\r\n1. åˆ›å»ºä¸€ä¸ªç©ºçš„ç®€å• JavaScript å¯¹è±¡ï¼ˆå³{}ï¼‰ï¼›\r\n2. é“¾æ¥è¯¥å¯¹è±¡ï¼ˆå³è®¾ç½®è¯¥å¯¹è±¡çš„æ„é€ å‡½æ•°ï¼‰åˆ°å¦ä¸€ä¸ªå¯¹è±¡ ï¼›\r\n3. å°†æ­¥éª¤ 1 æ–°åˆ›å»ºçš„å¯¹è±¡ä½œä¸º this çš„ä¸Šä¸‹æ–‡ ï¼›\r\n4. å¦‚æœè¯¥å‡½æ•°æ²¡æœ‰è¿”å›å¯¹è±¡ï¼Œåˆ™è¿”å› thisã€‚\r\n\r\n## å®ç°\r\n\r\næ ¹æ®ä¸Šé¢çš„æ‰§è¡Œæ­¥éª¤æˆ‘ä»¬æ¥å°è¯•å®ç°ä¸‹ï¼Œå½“ç„¶ new æ“ä½œç¬¦è‚¯å®šæ˜¯æ¨¡æ‹Ÿä¸äº†äº†ï¼Œä¸‹é¢é€šè¿‡å‡½æ•°çš„å½¢å¼å±•ç¤º\r\n\r\n```js\r\nfunction newCall(fn) {\r\n  var args = Array.prototype.slice.call(arguments, 1);\r\n  var obj = {};\r\n  obj.__proto__ = fn.prototype;\r\n  var result = fn.apply(obj, args);\r\n  return result && typeof result === \"object\" ? result : obj;\r\n}\r\n```\r\n\r\nOkï¼Œåˆ°è¿™é‡Œå°±å®ç°äº†ä¸€ä¸ªæ¨¡æ‹Ÿ new çš„æ“ä½œï¼Œæˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹\r\n\r\n```js\r\nfunction Otaku(name, age) {\r\n  this.name = name;\r\n  this.age = age;\r\n\r\n  this.habit = \"Games\";\r\n}\r\n\r\nOtaku.prototype.strength = 60;\r\n\r\nOtaku.prototype.sayYourName = function() {\r\n  console.log(\"I am \" + this.name);\r\n};\r\n\r\nfunction newCall(fn) {\r\n  var args = Array.prototype.slice.call(arguments, 1);\r\n  var obj = {};\r\n  obj.__proto__ = fn.prototype;\r\n  var result = fn.apply(obj, args);\r\n  return result && typeof result === \"object\" ? result : obj;\r\n}\r\n\r\nvar person = newCall(Otaku, \"Kevin\", \"18\");\r\n\r\nconsole.log(person.name); // Kevin\r\nconsole.log(person.habit); // Games\r\nconsole.log(person.strength); // 60\r\n```\r\n\r\næ’’èŠ± âœ¿âœ¿ ãƒ½(Â°â–½Â°)ãƒ âœ¿ï¼Œä¸è¿‡é¢å¤–æé†’ä¸€ä¸‹`__proto__`æ˜¯æµè§ˆå™¨å®ç°çš„éæ ‡å‡†å±æ€§ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸æ¨èä½¿ç”¨ï¼Œä¸è¿‡æ—¢ç„¶æ˜¯æ¨¡æ‹Ÿ es5 æ¨èçš„`Object.setPrototypeOf`è‚¯å®šæ²¡åŠæ³•ç”¨äº†ï¼Œåªèƒ½å°†å°±ç€ç”¨äº†\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/32/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/32/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/59",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/59/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/59/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/59/events",
      "html_url": "https://github.com/bosens-China/blog/issues/59",
      "id": 647201487,
      "node_id": "MDU6SXNzdWU2NDcyMDE0ODc=",
      "number": 59,
      "title": "æ·±æµ…æ‹·è´å’Œextend",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1602397157,
          "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
          "name": "æ·±å…¥ç³»åˆ—",
          "color": "719192",
          "default": false,
          "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2020-06-29T07:59:36Z",
      "updated_at": "2021-12-21T03:04:38Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "## å‰è¨€\r\n\r\næ·±æµ…æ‹·è´å’Œ extend æ˜¯é¡¹ç›®ä¸­å¸¸ç”¨çš„å·¥å…·ç±»å‡½æ•°ï¼Œä»Šå¤©å°±åŠ¨æ‰‹å®ç°ä¸€ä¸‹\r\n\r\nä¸‹é¢ä¼šé‡å¤è¿™å‡ ä¸ªåŸºç¡€å‡½æ•°ï¼Œä¸ºäº†ç®€æ´ä¸‹é¢ä¸ä¼šå‡ºç°ç›¸å…³å®šä¹‰\r\n\r\n```js\r\nfunction isObject(obj) {\r\n  return obj && typeof obj === \"object\";\r\n}\r\nfunction type(obj) {\r\n  return Object.prototype.toString\r\n    .call(obj)\r\n    .replace(/\\[object.(.+?)\\]/, \"$1\")\r\n    .toLowerCase();\r\n}\r\nfunction array(par) {\r\n  return type(par) === \"array\";\r\n}\r\n```\r\n\r\n## æµ…æ‹·è´ç”¨æ³•\r\n\r\n```js\r\nvar obj = { name: \"test\", args: [{ name: 1 }] };\r\nvar test = { ...obj };\r\n// ä¿®æ”¹ä¸‹åŸæ¥å±æ€§\r\nobj.name = \"foo\";\r\n// test.name test\r\nobj.args.push(\"456\");\r\n// args: (2) [{â€¦}, \"456\"]\r\n```\r\n\r\nä»ä¸Šé¢ä¾‹å­å¯ä»¥çœ‹åˆ°ï¼Œå½“ä¸¤ä¸ªå¯¹è±¡å‡ºç°ç›¸åŒå­—æ®µçš„æ—¶å€™ï¼Œåè€…ä¼šè¦†ç›–å‰è€…ï¼Œè€Œä¸ä¼šè¿›è¡Œæ·±å±‚æ¬¡çš„è¦†ç›–ã€‚\r\n\r\nç”±æ­¤å¯ä»¥å¾—åˆ°ä¸€ä¸ªç»“è®ºï¼šæµ…æ‹·è´å¯ä»¥ç®€å•ç†è§£ä¸ºåªæ‹·è´å¯¹è±¡çš„ä¸€å±‚å±æ€§ï¼Œå¦‚æœæ‹·è´çš„å±æ€§è¿˜æ˜¯å¯¹è±¡ï¼Œé‚£ä¹ˆä¿®æ”¹å®ƒåˆ™ä¼šå½±å“åˆ°æ‹¥æœ‰ç›¸åŒå±æ€§çš„å¯¹è±¡ã€‚\r\n\r\n## æµ…æ‹·è´å®ç°\r\n\r\nç»“åˆä¸Šé¢çš„ç»“è®ºï¼Œæˆ‘ä»¬åŠ¨æ‰‹å®ç°ä¸€ä¸ªå‡½æ•°\r\n\r\n```js\r\nexport function copy(obj) {\r\n  if (!isObject(obj)) {\r\n    return;\r\n  }\r\n  const src = array(obj) ? [] : {};\r\n  for (const key in obj) {\r\n    const value = obj[key];\r\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\r\n      src[key] = value;\r\n    }\r\n  }\r\n  return src;\r\n}\r\n```\r\n\r\næµ‹è¯•ç”¨ä¾‹\r\n\r\n```js\r\ntest(\"æµ…æ‹·è´\", () => {\r\n  const value = { a: 123, b: 456, c: [1] };\r\n  const test = copy(value);\r\n  expect(test).toEqual({ a: 123, b: 456, c: [1] });\r\n  expect(value === test).toBeFalsy();\r\n  expect(value.c === test.c).toBeTruthy();\r\n  expect(value.a === test.a).toBeTruthy();\r\n});\r\n```\r\n\r\n## æ·±æ‹·è´\r\n\r\nä¸Šé¢æˆ‘ä»¬å·²ç»å®ç°äº†æµ…æ‹·è´ï¼Œæµ…æ‹·è´åªæ˜¯ç®€å•çš„æ‹·è´äº†ä¸€å±‚å±æ€§ï¼Œå¦‚æœæ˜¯æ·±æ‹·è´å‘¢ï¼Ÿ\r\n\r\nå…¶å®å°±æ˜¯å¯¹å±æ€§ä¸ºå¯¹è±¡è¿›è¡Œé‡å¤çš„è°ƒç”¨ï¼Œåœ¨å®ç°è¿™ä¸ªä¹‹å‰å…ˆçœ‹ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„åšæ³•ã€‚\r\n\r\n#### json\r\n\r\n```js\r\nfunction deepAssign(par) {\r\n  return JSON.parse(JSON.stringify(par));\r\n}\r\n// æµ‹è¯•ç”¨ä¾‹\r\nconst value = {a: {name: 456}};\r\nconst test = deepAssign({value);\r\ntest.a === value.a;\r\n//false\r\ndeepAssign({ a() {}, b: /abc/, c: Math.floor, d: null, e: new Set() });\r\n// {b: {}, d: null, e: {}}\r\n```\r\n\r\néœ€è¦ç‰¹åˆ«æ³¨æ„ç”¨è¿™ä¸ªæ–¹æ³•å¤„ç†å‡½æ•°ã€æ­£åˆ™ä¹‹ç±»çš„å¯¹è±¡ä¸ä¼šå‡ºç°é¢„æœŸç»“æœï¼Œä¸è¿‡åœ¨å¤„ç†æ¥å£è¿”å›çš„æ•°æ®ä¸å¤±ä¸ºä¸€ç§æ–¹æ³•ã€‚\r\n\r\n#### é€’å½’\r\n\r\nç›¸æ¯”`JSON`çš„æ–¹å¼å®ç°ï¼Œå¯ä»¥è®©æˆ‘ä»¬è‡ªç”±å®šåˆ¶ä¸€äº›ç±»å‹ï¼Œä¾‹å¦‚ä¸Šé¢çš„`æ­£åˆ™`å°±å¯ä»¥é€šè¿‡`hack`æ–¹æ³•åˆ›å»ºï¼Œä¸ºäº†ç®€åŒ–æºç ï¼Œè¿™é‡Œåªå¤„ç†å¯¹è±¡å’Œæ•°ç»„ï¼Œå¯¹äºå…¶ä»–ç±»å‹çš„å¤„ç†å¯ä»¥å‚è€ƒä¸€ä¸‹ç¬¬ä¸‰æ–¹åº“\r\n\r\n```js\r\nfunction deepCopy(obj, has = new WeakMap()) {\r\n  if (!isObject(obj)) {\r\n    return;\r\n  }\r\n  // é¿å…å¾ªç¯å¼•ç”¨\r\n  if (has.has(obj)) {\r\n    return has.get(obj);\r\n  }\r\n  const src = array(obj) ? [] : {};\r\n  has.set(obj, src);\r\n  for (const key in obj) {\r\n    const value = obj[key];\r\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\r\n      // æ³¨æ„è¿™ä¸€è¡Œ\r\n      src[key] = isObject(value) ? copy(value, has) : value;\r\n    }\r\n  }\r\n  return src;\r\n}\r\n```\r\n\r\næµ‹è¯•ç”¨ä¾‹\r\n\r\n```js\r\ntest(\"æ·±æ‹·è´\", () => {\r\n  const value = { a: 123, b: 456, c: [1] };\r\n  const test = deepCopy(value);\r\n  expect(test).toEqual({ a: 123, b: 456, c: [1] });\r\n  expect(value === test).toBeFalsy();\r\n  expect(value.c === test.c).toBeFalsy();\r\n  expect(value.a === test.a).toBeTruthy();\r\n});\r\n```\r\n\r\næ³¨æ„ä¸Šé¢ç”¨äº†ä¸€ä¸ª`WeakMap`ï¼Œè¿™ä¸ªæ˜¯ä¸ºäº†é¿å…å¾ªç¯å¼•å…¥ï¼Œä½ å¯ä»¥æŠŠä¸Šé¢çš„`WeakMap`ç›¸å…³ä»£ç å»æ‰ï¼Œç„¶ååœ¨æ§åˆ¶å°è¾“å…¥ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œçœ‹çœ‹ä¼šå‡ºç°ä»€ä¹ˆç»“æœã€‚\r\n\r\n```js\r\nvar a = {};\r\na.a = a;\r\nvar test = deepCopy(a);\r\n```\r\n\r\n## extend\r\n\r\nextend åˆ†ä¸ºä¸¤éƒ¨åˆ†:\r\n\r\n1. æµ…åˆå¹¶ï¼Œ`Object.assign`å°±æ˜¯æµ…æ‹·è´ï¼›\r\n2. æ·±åˆå¹¶ï¼Œæ²¡æœ‰ç›¸å…³çš„çš„ apiï¼Œéœ€è¦æ‰‹åŠ¨å®ç°\r\n\r\n#### æµ…åˆå¹¶ä½¿ç”¨æ–¹æ³•\r\n\r\nåœ¨å®ç°è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬çº¦å®šä¸€ä¸‹æ ¼å¼\r\n\r\n```js\r\nassign( target [, object1 ] [, objectN ] )\r\n```\r\n\r\nç¬¬ä¸€ä¸ªå‚æ•°ä¸ºç›®æ ‡å¯¹è±¡å¿…é¡»æ˜¯å¯¹è±¡ï¼Œä¹‹åçš„å‚æ•°æ˜¯ç›®æ ‡å¯¹è±¡ï¼Œå¯ä»¥ä¸ä¸ºå¯¹è±¡\r\n\r\n```js\r\nvar obj1 = {\r\n  a: 1,\r\n  b: { b1: 1, b2: 2 },\r\n};\r\n\r\nvar obj2 = {\r\n  b: { b1: 3, b3: 4 },\r\n  c: 3,\r\n};\r\n\r\nvar obj3 = {\r\n  d: 4,\r\n};\r\n\r\nconsole.log(assign(obj1, obj2, obj3));\r\n\r\n// {\r\n//    a: 1,\r\n//    b: { b1: 3, b3: 4 },\r\n//    c: 3,\r\n//    d: 4\r\n// }\r\n```\r\n\r\n#### æµ…åˆå¹¶å®ç°\r\n\r\næ ¹æ®ä¸Šé¢çš„çº¦æŸï¼ŒåŠ¨æ‰‹å®ç°ä¸€ä¸‹\r\n\r\n```js\r\nfunction assign() {\r\n  let target = arguments[0];\r\n  let i = 1,\r\n    leg = arguments.length;\r\n  if (!isObject(target)) {\r\n    target = {};\r\n  }\r\n  for (; i < leg; i++) {\r\n    const value = arguments[i];\r\n    if (value == null) {\r\n      continue;\r\n    }\r\n    for (const name in value) {\r\n      if (Object.prototype.hasOwnProperty.call(value, name)) {\r\n        const copy = value[name];\r\n        target[name] = copy;\r\n      }\r\n    }\r\n  }\r\n  return target;\r\n}\r\n```\r\n\r\næµ‹è¯•ç”¨ä¾‹\r\n\r\n```js\r\ntest(\"æµ…æ‹·è´\", () => {\r\n  const value1 = { name: \"test\", age: 17 };\r\n  const value2 = { name: \"app\", age: [1, 2, 3] };\r\n  const test = assign(value1, value2, null, undefined, \"abc\");\r\n  expect(assign(test)).toEqual({\r\n    name: \"app\",\r\n    age: [1, 2, 3],\r\n    0: \"a\",\r\n    1: \"b\",\r\n    2: \"c\",\r\n  });\r\n  expect(test.age === value2.age).toBeTruthy();\r\n  var obj1 = {\r\n    a: 1,\r\n    b: { b1: 1, b2: 2 },\r\n  };\r\n\r\n  var obj2 = {\r\n    b: { b1: 3, b3: 4 },\r\n    c: 3,\r\n  };\r\n\r\n  var obj3 = {\r\n    d: 4,\r\n  };\r\n  expect(assign(obj1, obj2, obj3)).toEqual({\r\n    a: 1,\r\n    b: { b1: 3, b3: 4 },\r\n    c: 3,\r\n    d: 4,\r\n  });\r\n});\r\n```\r\n\r\n#### æ·±åˆå¹¶\r\n\r\n```js\r\nfunction deepAssign(...args) {\r\n  let obj = {};\r\n  for (const value of args) {\r\n    if (array(value)) {\r\n      if (!array(obj)) {\r\n        obj = [];\r\n      }\r\n      // å¯¹æ•°ç»„å†…å®¹è¿›è¡Œæ·±æ‹·è´\r\n      const arr = value.reduce((x, y) => {\r\n        x = x.concat(isObject(y) ? deepAssign([], y) : y);\r\n        return x;\r\n      }, []);\r\n      obj = [...obj, ...arr];\r\n    } else if (isObject(value)) {\r\n      for (let [name, val] of Object.entries(value)) {\r\n        if (isObject(val) && name in obj) {\r\n          val = deepAssign(obj[name], val);\r\n        }\r\n        obj = {\r\n          ...obj,\r\n          [name]: val,\r\n        };\r\n      }\r\n    }\r\n  }\r\n  return obj;\r\n}\r\n```\r\n\r\n`if (isObject(val) && name in obj)`æ³¨æ„è¿™è¡Œçš„åˆ¤æ–­ï¼Œåªæœ‰å½“ target å±æ€§ä¸Šæœ‰å€¼çš„æ—¶å€™æ‰ä¼šè¿›è¡Œé€’å½’è°ƒç”¨ã€‚\r\n\r\næµ‹è¯•ç”¨ä¾‹\r\n\r\n```js\r\ntest(\"æ·±åˆå¹¶\", () => {\r\n  const value1 = [1, 2, { name: { age: [1, 2, 3, 4, 5] } }];\r\n  const value2 = [1, 2, { age: 18 }];\r\n  const test = deepAssign(value1, value2);\r\n  expect(test[2] === value1[2]).toBe(false);\r\n  expect(test).toEqual([\r\n    1,\r\n    2,\r\n    { name: { age: [1, 2, 3, 4, 5] } },\r\n    1,\r\n    2,\r\n    { age: 18 },\r\n  ]);\r\n  const obj1 = { name: [1, 2, 3] };\r\n  const obj2 = { age: 17, name: [4, 5, 6] };\r\n  const obj = deepAssign(obj1, obj2);\r\n  expect(obj).toEqual({ name: [1, 2, 3, 4, 5, 6], age: 17 });\r\n  const a = {};\r\n  a.a = a;\r\n  expect(deepAssign(a)).toEqual({ a: { a } });\r\n});\r\n```\r\n\r\n## æœ€å\r\n\r\nå¦‚æœæœ‰é”™è¯¯æˆ–è€…ä¸ä¸¥è°¨çš„åœ°æ–¹ï¼Œè¯·åŠ¡å¿…ç»™äºˆæŒ‡æ­£ï¼Œååˆ†æ„Ÿè°¢ã€‚å¦‚æœå–œæ¬¢æˆ–è€…æœ‰æ‰€å¯å‘ï¼Œæ¬¢è¿ `star`ï¼Œå¯¹ä½œè€…ä¹Ÿæ˜¯ä¸€ç§é¼“åŠ±ã€‚\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/59/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/59/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/44",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/44/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/44/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/44/events",
      "html_url": "https://github.com/bosens-China/blog/issues/44",
      "id": 547208786,
      "node_id": "MDU6SXNzdWU1NDcyMDg3ODY=",
      "number": 44,
      "title": "globalå¯¹è±¡è·å–",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1371686609,
          "node_id": "MDU6TGFiZWwxMzcxNjg2NjA5",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/JavaScript",
          "name": "JavaScript",
          "color": "F7DF1E",
          "default": false,
          "description": "JavaScriptç³»åˆ—çš„æ–‡ç« "
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2020-01-09T02:19:18Z",
      "updated_at": "2021-12-21T03:03:16Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "global åœ¨å¼€å‘ä¸­ç»å¸¸ç»å¸¸ä½¿ç”¨ï¼Œä¾‹å¦‚ä¸‹é¢ä¸€æ®µä»£ç è°ƒç”¨çš„å°±æ˜¯ global å†…ç½®çš„å¯¹è±¡\r\n\r\n```js\r\nconst min = Math.min(...[1, 11, 22, 55, -2, -1]);\r\n```\r\n\r\nè¿™é‡Œçš„ Math å¯¹è±¡å°±æ˜¯ global å†…ç½®çš„ï¼Œåœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹æˆ‘ä»¬å¯ä»¥é€šè¿‡`window.Math.min`æ˜¾ç¤ºè°ƒç”¨ï¼Œè€Œåœ¨ node ç¯å¢ƒä¸‹æˆ‘ä»¬åˆ™è¦é€šè¿‡`global.Math.min`æ¥è°ƒç”¨ï¼Œåœ¨å®é™…ä¸­æˆ‘ä»¬ä¸ä¼šé€šè¿‡`window.Math.min`è¿™ç§æ–¹å¼æ¥è°ƒç”¨ï¼Œä¸è¿‡å´ä¹Ÿèƒ½çœ‹åˆ°ä¸åŒç¯å¢ƒä¸‹è·å– global å¯¹è±¡å„ä¸ç›¸åŒã€‚\r\n\r\nä¸‹é¢å°±ä»¥ç¼–å†™ä¸€ä¸ªç°ä»£çš„å·¥å…·åº“ä¸ºå‡è®¾ï¼Œè¿™ä¸ªåº“è¦æ”¯æŒå…¨å±€å¼•ç”¨ä¹Ÿæ˜¯å¾ˆç§‘å­¦çš„ï¼Œä½†æ˜¯å¦‚ä½•è®©å…¶æŒ‚è½½åœ¨å…¨å±€å±æ€§ä¸Šå‘¢ï¼Ÿ\r\n\r\n## ç¬¬ä¸€ç‰ˆ\r\n\r\n```js\r\n(function() {\r\n  var _global = this;\r\n  var _ = {};\r\n  _.debounce = function() {};\r\n  // ...ä¸€äº›å…¶ä»–çš„æ–¹æ³•\r\n  return (_global._ = _);\r\n})();\r\n```\r\n\r\nè¿™é‡Œçš„æƒ³æ³•æ˜¯é€šè¿‡å…¨å±€ç¯å¢ƒä¸‹è¿è¡Œ this æ¥è¿”å›ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œåœ¨å…¨å±€å¯¹è±¡ä¸ŠæŒ‚è½½æˆ‘ä»¬çš„å·¥å…·å‡½æ•°ï¼Œä¸é€šè¿‡ `window` æ˜¾ç¤ºæŒ‚è½½æ˜¯å› ä¸ºæˆ‘ä»¬ä¸ä»…è¦è®©è¿™ä¸ªå·¥å…·åº“è¿è¡Œåœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹,åŒæ—¶ä¹Ÿè®©ä»–è¿è¡Œåœ¨ `node` ç¯å¢ƒä¸­ã€‚\r\n\r\n## ä¸¥æ ¼æ¨¡å¼\r\n\r\nä¸Šé¢çš„å†™æ³•æ˜¯å‡è®¾åœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹è¿è¡Œï¼Œè€Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹è¿è¡Œï¼Œthis ä¼šè¿”å›ä¸€ä¸ª`undefined`\r\n\r\n```js\r\n(function() {\r\n  \"use strict\";\r\n  console.log(this === undefined); // true\r\n})();\r\n```\r\n\r\nä¸‹é¢æˆ‘ä»¬æ¥å°è¯•ä¿®è®¢ä¸€ä¸‹ä¸¥æ ¼æ¨¡å¼ä¸‹çš„é”™è¯¯\r\n\r\n```js\r\n(function() {\r\n  // é˜²æ­¢nullå‡ºç°\r\n  function isObjectLike(par) {\r\n    return par && typeof par == \"object\";\r\n  }\r\n  var _global;\r\n  if (isObjectLike(global) && global.global === global) {\r\n    _global = global;\r\n  } else {\r\n    _global = window;\r\n  }\r\n  var _ = {};\r\n  _.debounce = function() {};\r\n  // ...ä¸€äº›å…¶ä»–çš„æ–¹æ³•\r\n  return (_global._ = _);\r\n})();\r\n```\r\n\r\nè¿™é‡Œæˆ‘ä»¬é€šè¿‡åˆ¤æ–­ global æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨å°±æ˜¯ `node` ç¯å¢ƒå¦‚æœä¸å­˜åœ¨å°±æ˜¯æµè§ˆå™¨ç¯å¢ƒã€‚\r\n\r\n> `global.global`å’Œ`window.window`éƒ½æ˜¯æŒ‡å‘è‡ªèº«ï¼Œå¯ä»¥ç†è§£ä¸ºæ— é™åµŒå¥—çš„å±æ€§\r\n\r\n## Web Worker\r\n\r\nWeb Worker æ˜¯ä¸º JavaScript åˆ›é€ å¤šçº¿ç¨‹ç¯å¢ƒå‡ºç°çš„ï¼Œä¸è¿‡ä½¿ç”¨å®ƒæ˜¯æœ‰ä¸€äº›é™åˆ¶æ— æ³•ä½¿ç”¨ `documentã€windowã€parent`ç­‰è¿™äº›å¯¹è±¡ï¼Œæ‰€ä»¥åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­å¦‚æœæˆ‘ä»¬åœ¨ Web Worker ç¯å¢ƒä¸­ä¸€å®šä¼šæŠ¥é”™ï¼Œå› ä¸ºä¸å­˜åœ¨ `global` å’Œ `window` å¯¹è±¡\r\n\r\nä¸è¿‡ Worker å¯ä»¥é€šè¿‡`self`æ¥æ‹¿åˆ°å­çº¿ç¨‹çš„å…¨å±€å¯¹è±¡ï¼Œè€Œä¸” self åœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹ä¹ŸæŒ‡å‘ window\r\n\r\n```js\r\n(function() {\r\n  // é˜²æ­¢nullå‡ºç°\r\n  function isObjectLike(par) {\r\n    return par && typeof par == \"object\";\r\n  }\r\n  var _global;\r\n  if (isObjectLike(global) && global.global === global) {\r\n    _global = global;\r\n  } else if (isObjectLike(self) && self === self) {\r\n    _global = self;\r\n  }\r\n  var _ = {};\r\n  _.debounce = function() {};\r\n  // ...ä¸€äº›å…¶ä»–çš„æ–¹æ³•\r\n  return (_global._ = _);\r\n})();\r\n```\r\n\r\n## node è™šæ‹Ÿæœº\r\n\r\nnode vmï¼ˆæ²™ç›’ï¼‰ ç¯å¢ƒä¸‹ä¸å­˜åœ¨ global å’Œ window å¯¹è±¡ï¼Œæ‰€ä»¥ä¸Šé¢ä»£ç è¿˜æ˜¯ä¼šå‡ºç°é—®é¢˜ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥é€šè¿‡\r\n`new Function('return this')()`æˆ–è€…`this`çš„å½¢å¼æ¥è§£å†³\r\n\r\n```js\r\n(function() {\r\n  // é˜²æ­¢nullå‡ºç°\r\n  function isObjectLike(par) {\r\n    return par && typeof par == \"object\";\r\n  }\r\n  var _global;\r\n  if (isObjectLike(global) && global.global === global) {\r\n    _global = global;\r\n  } else if (isObjectLike(self) && self === self) {\r\n    _global = self;\r\n  } else {\r\n    _global = new Function(\"return this\")();\r\n    // æˆ–è€…\r\n    // _global = this;\r\n  }\r\n  var _ = {};\r\n  _.debounce = function() {};\r\n  // ...ä¸€äº›å…¶ä»–çš„æ–¹æ³•\r\n  return (_global._ = _);\r\n})();\r\n```\r\n\r\n## Content Security Policy\r\n\r\nä¸Šé¢ä½ å¯èƒ½æ³¨æ„åˆ°äº†ï¼Œæˆ‘åœ¨ä¸Šä¸€ç‰ˆæåˆ°äº†ä¸¤ä¸ªæ–¹æ³•æ¥æœ€åè·å– `global` çš„å€¼\r\n\r\n- \\_global = new Function(\"return this\")();\r\n- \\_global = this;\r\n\r\nä¸è¿‡åœ¨ç½‘é¡µå®‰å…¨æ”¿ç­–ï¼ˆContent Security Policyï¼‰ä¸‹åªä¼šåŠ è½½ä¿¡ä»»çš„ç™½åå•ï¼Œ`evalã€new Function`è¿™äº›æ–¹æ³•éƒ½å¯èƒ½æ— æ³•ä½¿ç”¨ï¼Œåªèƒ½ä½¿ç”¨`\\_global = this`æ¥è·å– global\r\n\r\n```js\r\n(function() {\r\n  // é˜²æ­¢nullå‡ºç°\r\n  function isObjectLike(par) {\r\n    return par && typeof par == \"object\";\r\n  }\r\n  var _global;\r\n  if (isObjectLike(global) && global.global === global) {\r\n    _global = global;\r\n  } else if (isObjectLike(self) && self === self) {\r\n    _global = self;\r\n  } else {\r\n    // æˆ–è€…\r\n    _global = this;\r\n  }\r\n  var _ = {};\r\n  _.debounce = function() {};\r\n  // ...ä¸€äº›å…¶ä»–çš„æ–¹æ³•\r\n  return (_global._ = _);\r\n})();\r\n```\r\n\r\n## å¾®ä¿¡å°ç¨‹åº\r\n\r\nåœ¨å¾®ä¿¡å°ç¨‹åºä¸­`global`å’Œ`window`éƒ½ä¸å­˜åœ¨å†åŠ ä¸Šä½¿ç”¨çš„æ˜¯ä¸¥æ ¼æ¨¡å¼ï¼Œthis ä¼šè¿”å›`undefined`æ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦åœ¨åŠ ä¸€ä¸ªåˆ¤æ–­\r\n\r\n```js\r\n(function() {\r\n  // é˜²æ­¢nullå‡ºç°\r\n  function isObjectLike(par) {\r\n    return par && typeof par == \"object\";\r\n  }\r\n  var _global;\r\n  if (isObjectLike(global) && global.global === global) {\r\n    _global = global;\r\n  } else if (isObjectLike(self) && self === self) {\r\n    _global = self;\r\n  } else {\r\n    // æˆ–è€…\r\n    _global = this || {};\r\n  }\r\n  var _ = {};\r\n  _.debounce = function() {};\r\n  // ...ä¸€äº›å…¶ä»–çš„æ–¹æ³•\r\n  return (_global._ = _);\r\n})();\r\n```\r\n\r\n## globalThis\r\n\r\nä¸Šé¢çš„åˆ¤æ–­æ–¹å¼æ˜¯ç°åœ¨ç¤¾åŒºä¸»æµåšæ³•ï¼Œä¸è¿‡åœ¨ tc39 çš„ææ¡ˆä¸­`globalThis`å¯ä»¥è·å–å…¨å±€å¯¹è±¡ï¼Œä½¿ç”¨æ–¹æ³•ä¹Ÿå¾ˆç®€å•\r\n\r\n```js\r\n// æµè§ˆå™¨ç¯å¢ƒ\r\nglobalThis === window; // true\r\n// node\r\nglobalThis === global; // true\r\n```\r\n\r\nç›®å‰æ˜¯`Stage 3`ä½¿ç”¨çš„è¯è¿˜æ˜¯éœ€è¦åšä¸€äº›å…¼å®¹æ€§çš„å¤„ç†ï¼Œä¸‹é¢å°±æ¥å†™æœ€åä¸€ç‰ˆ\r\n\r\n```js\r\n(function() {\r\n  // é˜²æ­¢nullå‡ºç°\r\n  function isObjectLike(par) {\r\n    return par && typeof par == \"object\";\r\n  }\r\n  function getGlobal() {\r\n    if (isObjectLike(globalThis) && globalThis.Object === Object) {\r\n      return globalThis;\r\n    }\r\n    if (isObjectLike(global) && global.global === global) {\r\n      return global;\r\n    }\r\n\r\n    if (isObjectLike(self) && self === self) {\r\n      return self;\r\n    }\r\n    return this || {};\r\n  }\r\n\r\n  var _global = getGlobal();\r\n  var _ = {};\r\n  _.debounce = function() {};\r\n  // ...ä¸€äº›å…¶ä»–çš„æ–¹æ³•\r\n  return (_global._ = _);\r\n})();\r\n```\r\n\r\n## æœ€å\r\n\r\næœ¬æ¥å¯ä»¥ä¸€æ¬¡å†™å®Œï¼Œä¸è¿‡è¿˜æ˜¯å¸Œæœ›å¾ªå¾ªè€Œè¿›äº†è§£å†™äº†è¿™ä¹ˆå¤šåˆ¤æ–­ç©¶ç«Ÿæ˜¯ä¸ºä»€ä¹ˆï¼Œæœ€åå¦‚æœæœ‰ä¸æ­£ç¡®çš„åœ°æ–¹å¸Œæœ›æœ‰å°ä¼™ä¼´æŒ‡å‡ºæ¥ï¼Œæ¬¢è¿ starï¼Œå¯¹ä½œè€…ä¹Ÿæ˜¯ä¸€ç§é¼“åŠ±ã€‚\r\n\r\n## å‚è€ƒé“¾æ¥\r\n\r\n- https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CSP\r\n- https://github.com/mqyqingfeng/Blog/issues/56\r\n- https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/globalThis\r\n- https://github.com/lodash/lodash/blob/master/.internal/root.js\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/44/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/44/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/54",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/54/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/54/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/54/events",
      "html_url": "https://github.com/bosens-China/blog/issues/54",
      "id": 588233327,
      "node_id": "MDU6SXNzdWU1ODgyMzMzMjc=",
      "number": 54,
      "title": "ä½¿ç”¨ canvas å®ç°è´ªåƒè›‡",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1371686609,
          "node_id": "MDU6TGFiZWwxMzcxNjg2NjA5",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/JavaScript",
          "name": "JavaScript",
          "color": "F7DF1E",
          "default": false,
          "description": "JavaScriptç³»åˆ—çš„æ–‡ç« "
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2020-03-26T08:13:17Z",
      "updated_at": "2021-12-21T02:57:58Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "<div align=center><img src=\"https://user-images.githubusercontent.com/39508895/139045104-f01d3705-928a-478a-8859-ae6e3cf20c98.png\" alt=\"è´ªåƒè›‡\"></div>\r\n\r\n\r\nç«¥å¹´ä½¿ç”¨çš„è¯ºåŸºäºšåŸºæœ¬ä¸Šéƒ½ä¼šæ­è½½è¿™æ¬¾å°æ¸¸æˆï¼Œæœ€è¿‘å¿ƒè¡€æ¥æ½®æƒ³ç”¨ canvas æ¥å®ç°è¿™ä¸ªæ¸¸æˆå°±æœ‰äº†è¿™ç¯‡æ–‡ç« ï¼Œä¸‹é¢è®²è§£ä¸€ä¸‹å®ç°çš„æ€è·¯ï¼Œæœ¬æ–‡çš„æœ€ç»ˆä»£ç å·²ç»æ”¾åˆ°äº†[codesandbox](https://codesandbox.io/s/peaceful-firefly-c1i43?file=/src/index.js)ä¸Šã€‚\r\n\r\nå½“ç„¶å®ç°çš„æ–¹å¼å¹¶ä¸æ­¢ `canvas` è¿™ä¸€ç§ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ `html` + `css` çš„å½¢å¼ï¼Œè¿™é‡Œä¸è®¨è®ºä¼˜åŠ£å–èˆï¼Œè®©æˆ‘ä»¬å¿«é€Ÿå¼€å§‹å§ã€‚\r\n\r\n## æ¸¸æˆè§„åˆ™\r\n\r\nåœ¨å¼€å‘ä¹‹å‰å…ˆè¦è®¾è®¡æ¸¸æˆçš„å…·ä½“è§„åˆ™æ˜¯æ€ä¹ˆæ ·çš„ï¼Œå°±åƒæ˜¯å®ç°`polyfill`ä¹Ÿè¦å¯¹ç…§è§„èŒƒä¸€æ ·ï¼Œè´ªåƒè›‡æ¸¸æˆè§„åˆ™è¿˜æ˜¯è›®ç®€å•ä¸‹é¢æ¦‚æ‹¬ä¸€ä¸‹ï¼š\r\n\r\n- åˆå§‹çš„æ—¶å€™ä¼šè¢«å››å‘¨å¢™ä½“åŒ…å›´ç€ï¼Œè´ªåƒè›‡è¿™æ—¶å€™å¾ˆè™šå¼±åªæœ‰ä¸€èŠ‚ï¼Œå¢™çš„å‘¨å›´éšæœºåˆ†å¸ƒç€ä¸€ä¸ªé¸¡è›‹ï¼ˆå¥–åŠ±å“ï¼‰\r\n- æŒ‰ä¸‹æ–¹å‘é”®æ¸¸æˆå¼€å§‹ï¼Œåƒåˆ°é¸¡è›‹èº«ä½“ä¼šè¾¹é•¿ï¼ŒåŒæ—¶ä¼šç”Ÿæˆæ–°çš„é¸¡è›‹\r\n- æ’åˆ°å¢™ä½“å’Œæ’åˆ°èº«ä½“ä¼šç»“æŸæ¸¸æˆ\r\n\r\nä¸Šé¢è§„åˆ™æ¦‚æ‹¬æˆä»£ç å°±æ˜¯æˆ‘ä»¬éœ€è¦ç»™ä¸€ä¸ªç•Œé¢èŒƒå›´ã€ç»˜åˆ¶è›‡å’Œé¸¡è›‹ã€è®©è›‡åŠ¨èµ·æ¥ã€‚\r\n\r\n## åŸºæœ¬æ¦‚å¿µ\r\n\r\n`canvas` æ˜¯ `html5` å‡ºç°çš„å…ƒç´ ï¼Œå®ƒå¯ä»¥ç”¨äºæ•°æ®å¯è§†åŒ–ã€åŠ¨ç”»ã€æ¸¸æˆã€å›¾åƒæ“ä½œã€è§†é¢‘ç­‰æ–¹é¢ï¼Œå®ƒä»¥ `JavaScript` çš„æ–¹å¼æ¥è¿›è¡Œäº¤äº’ã€‚\r\n\r\nä¸ºäº†æ–¹ä¾¿ä¸‹é¢çš„ç†è§£ä»‹ç»å‡ ä¸ªåŸºæœ¬æ¦‚å¿µ\r\n\r\n- `var ctx = canvas.getContext(contextType);`\r\n\r\n`getContext` è¿”å› `canvas` çš„ä¸Šä¸‹æ–‡ï¼Œ`contextType` æŒ‡å®šäº†ä½•ç§ä¸Šä¸‹æ–‡ï¼Œå®ƒæœ‰ `2d`ã€`webgl`ã€`webgl2`ã€`bitmaprenderer`è¿™å‡ ç§é€‰é¡¹ï¼Œè¿™é‡Œåªéœ€è¦ 2d ç•Œé¢ï¼Œæ‰€ä»¥å¡«å†™ 2d å³å¯ã€‚\r\n\r\n> å¯ä»¥æ ¹æ® `canvas.getContext` å­˜åœ¨åˆ¤æ–­æµè§ˆå™¨æ”¯ä¸æ”¯æŒ `canvas` å…ƒç´ \r\n\r\n- `CanvasRenderingContext2D.clearRect`\r\n\r\næŒ‡å®šçŸ©å½¢åŒºåŸŸçš„åƒç´ éƒ½å˜æˆé€æ˜ï¼Œ**æ³¨æ„è¿™ä¸ªæ–¹æ³•ä¸ç­‰äºå®Œå…¨æ¸…é™¤ç”»å¸ƒï¼Œå¯¹äºä¸€äº› `path` çš„æ–¹æ³•è®°å¾—æ‰‹åŠ¨ `closePath()`**\r\n\r\n- åŠ¨ç”»çš„ç»„æˆåŸç†\r\n\r\nåç»­æˆ‘ä»¬éœ€è¦è®©è´ªåƒè›‡åŠ¨èµ·æ¥ï¼Œä½†æ˜¯åŠ¨è¿™ä¸ªæ¦‚å¿µæ˜¯ä¸€ä¸ªä¼ªå‘½é¢˜ï¼Œæƒ³ä¸€ä¸‹ç”µè§†å’Œç”µå½±æ˜¯æ€ä¹ˆè®©æˆ‘ä»¬æ„Ÿè§‰åˆ°åŠ¨çš„å‘¢ï¼Ÿå°±æ˜¯é€šè¿‡ä¸€å¸§å¸§çš„ç”»é¢å¿«é€Ÿæ’­æ”¾å¾—åˆ°çš„è§†è§‰æ•ˆæœã€‚\r\n\r\nåé¢è®©è›‡åŠ¨èµ·æ¥ä¹Ÿæ˜¯é€šè¿‡å®šæ—¶å™¨æ¥è®© `canvas` ä¸æ–­é‡ç»˜è¾¾åˆ°åŠ¨ç”»çš„æ•ˆæœã€‚\r\n\r\n## å®ç°æ€è·¯\r\n\r\n![åæ ‡](https://user-images.githubusercontent.com/39508895/139045144-fb2d7562-20a8-4c52-a76b-30a1eca7031c.png)\r\n\r\n\r\nå¦‚æ–‡ç« é¦–é¡µçš„ç¤ºä¾‹å›¾ç‰‡ï¼Œè´ªåƒè›‡å¯ä»¥æƒ³è±¡æˆä¸€ä¸ªåæ ‡ï¼Œæ ¹æ®è¿™ä¸ªåæ ‡å¾ˆå®¹æ˜“å¾—åˆ°ä¸‹é¢å¯ç¤ºï¼š\r\n\r\n- è›‡å’Œé¸¡è›‹éƒ½ä¼šåœ¨åæ ‡ä¸­å‡ºç°ï¼Œä½†ä¸ä¼šè¶…å‡º\r\n- æ’åˆ°åæ ‡çš„è¾¹ç•Œå³æ˜¯æ’å¢™\r\n- æ¯æ¬¡è´ªåƒè›‡ç§»åŠ¨éƒ½éœ€è¦æ“¦æ‹­ç§»åŠ¨çš„è·¯å¾„\r\n- åˆ¤æ–­æœ‰æ²¡æœ‰æ’åˆ°èº«ä½“å’Œåƒä¸æ˜¯åƒåˆ°é¸¡è›‹ï¼Œåˆ¤æ–­ç§»åŠ¨çš„åæ ‡å€¼æ˜¯ä»€ä¹ˆå³å¯\r\n\r\nä¹Ÿå°±æ˜¯è¯´ï¼Œè´ªåƒè›‡è¿™ä¸ªæ¸¸æˆæœ€æ ¸å¿ƒçš„å°±æ˜¯åæ ‡è¿™ä¸ªæ¦‚å¿µï¼Œä¸ºäº†å¿«é€Ÿå¾—åˆ°åæ ‡çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬æœŸå¾…ä»¥ä¸‹é¢çš„å½¢å¼æ¥å‚¨å­˜æ•°æ®ã€‚\r\n\r\n```js\r\ninterface CoordinateAll {\r\n  [x: number]: {\r\n    [y: number]: 'block' | 'egg' | 'sanke';\r\n  };\r\n}\r\n// è½¬åŒ–æˆJavaScriptè¡¨ç¤º\r\n{\r\n  1: {1: 'block', 2: 'egg', 'block'},\r\n  2: {1: 'block', 2: 'block', 'block'},\r\n  // ...\r\n}\r\n```\r\n\r\nä¸ºäº†åç»­çš„ä½¿ç”¨æ–¹ä¾¿ï¼Œæå‰å®šä¹‰ä¸¤ä¸ªæ–‡ä»¶\r\n\r\n```js\r\n// utils.js\r\n// ä¼ é€’ä¸€ä¸ªæ•´æ•°ï¼Œæ¥å¾ªç¯å®ƒ\r\nexport const eachNumber = (n, fn) => {\r\n  for (let i = 0; i < n; i++) {\r\n    fn(i);\r\n  }\r\n};\r\n// è¿”å›éšæœºæ•´æ•°\r\nexport const randomNumber = (min, max) => {\r\n  return Math.floor(Math.random() * (max - min + 1)) + min;\r\n};\r\n```\r\n\r\n```js\r\n// const.js\r\n// canvaså®½åº¦\r\nexport const WIDTH = 400;\r\n// é«˜åº¦\r\nexport const HEIGHT = 400;\r\n// åƒç´ x\r\nexport const PIXEL_X = 20;\r\n// åƒç´ y\r\nexport const PIXEL_Y = 20;\r\n// è¡Œ\r\nexport const ROW = HEIGHT / PIXEL_Y;\r\n// åˆ—\r\nexport const COLUMN = WIDTH / PIXEL_X;\r\n// åŠå¾„\r\nexport const RADIUS = 10;\r\n// å®šæ—¶å™¨é—´éš”\r\nexport const INTERVAL = 150;\r\n// é¸¡è›‹é¢œè‰²\r\nexport const EGG_COLOR = '#767803';\r\n// è›‡é¢œè‰²\r\nexport const SANKE_COLOR = '#6f5f06';\r\n// è¾¹æ¡†é¢œè‰²\r\nexport const BORDER_COLOR = '#796e09';\r\n```\r\n\r\nåé¢å°±å¼€å§‹ç»˜åˆ¶åˆå§‹çš„ç•Œé¢ã€‚\r\n\r\n## åˆå§‹åŒ–ç•Œé¢\r\n\r\n```js\r\nclass Sanke {\r\n  constructor() {\r\n    const canvas = document.createElement('canvas');\r\n    canvas.width = WIDTH;\r\n    canvas.height = HEIGHT;\r\n    this.canvas = canvas;\r\n    document.body.appendChild(canvas);\r\n    const ctx = canvas.getContext('2d');\r\n    this.ctx = ctx;\r\n\r\n    // è›‡èº«\r\n    this.currentSanke = [];\r\n    // å‡ºç°çš„eggä½ç½®\r\n    this.currentEgg = null;\r\n    // åæ ‡ç³»\r\n    this.coordinateAll = {};\r\n    this.init();\r\n  }\r\n  init() {\r\n    // åˆ›å»ºåæ ‡ç³»\r\n    this.coordinateAll = {};\r\n    eachNumber(ROW, (x) => {\r\n      this.coordinateAll[x] = {};\r\n      eachNumber(COLUMN, (y) => {\r\n        this.coordinateAll[x][y] = 'block';\r\n      });\r\n    });\r\n    const sanke = this.randomCoordinate();\r\n    this.setCoordinate(sanke, 'sanke');\r\n    this.currentSanke = [sanke];\r\n    this.currentEgg = this.randomCoordinate();\r\n    this.setCoordinate(this.currentEgg, 'egg');\r\n    this.repaint();\r\n  }\r\n  repaint() {\r\n    const { ctx, canvas, currentSanke } = this;\r\n    // ç»˜åˆ¶eggå’Œç»˜åˆ¶sanke\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n    ctx.strokeStyle = BORDER_COLOR;\r\n    ctx.strokeRect(0, 0, canvas.width, canvas.height);\r\n    ctx.fillStyle = SANKE_COLOR;\r\n    currentSanke.forEach((item) => {\r\n      ctx.fillRect(item.x * PIXEL_X, item.y * PIXEL_Y, PIXEL_X, PIXEL_Y);\r\n    });\r\n    // ç»˜åˆ¶egg\r\n    ctx.beginPath();\r\n    ctx.fillStyle = EGG_COLOR;\r\n    if (!this.currentEgg) {\r\n      this.currentEgg = this.randomCoordinate();\r\n      this.setCoordinate(this.currentEgg, 'egg');\r\n    }\r\n    const { currentEgg } = this;\r\n    ctx.arc(\r\n      0 + RADIUS + currentEgg.x * PIXEL_X,\r\n      0 + RADIUS + currentEgg.y * PIXEL_Y,\r\n      RADIUS,\r\n      0,\r\n      Math.PI * 2,\r\n      true\r\n    );\r\n    ctx.fill();\r\n    ctx.closePath();\r\n  }\r\n\r\n  randomCoordinate() {\r\n    const arr = [];\r\n    eachNumber(ROW, (x) => {\r\n      eachNumber(COLUMN, (y) => {\r\n        const value = this.coordinateAll[x][y];\r\n        if (value === 'block') {\r\n          arr.push({ x, y });\r\n        }\r\n      });\r\n    });\r\n    // è¯´æ˜æ— åæ ‡å¯å–\r\n    if (!arr.length) {\r\n      return null;\r\n    }\r\n    return arr[randomNumber(0, arr.length)];\r\n  }\r\n  setCoordinate({ x, y }, value) {\r\n    this.coordinateAll[x][y] = value;\r\n  }\r\n  getCoordinate({ x, y }) {\r\n    if (x < 0 || y < 0 || x > ROW - 1 || y > COLUMN - 1) {\r\n      return null;\r\n    }\r\n    return this.coordinateAll[x][y];\r\n  }\r\n}\r\n```\r\n\r\nä»£ç çœ‹èµ·æ¥è¿˜æ˜¯è›®å¤šçš„ï¼Œä¸è¿‡ä¹‹å‰å·²ç»ä»‹ç»è¿‡å®ç°çš„æ€è·¯äº†ï¼Œæ¥ä¸‹æ¥ä¸€æ­¥æ­¥åˆ†ææ‰§è¡Œï¼š\r\n\r\n- `constructor`\r\n\r\nè¿™é‡Œä¸»è¦æ˜¯åˆ›å»º `canvas` å¯¹è±¡ï¼Œåœ¨ `this` ä¸Šç»‘å®šä¸€äº›å¿…è¦çš„å±æ€§ï¼Œä¾‹å¦‚`åæ ‡ç³»`ã€`egg ä½ç½®`å’Œ `sanke ä½ç½®`ï¼Œè¿™é‡Œ `currentSanke` ` array` æ˜¯å› ä¸ºè›‡å­˜åœ¨å¤šèŠ‚ï¼Œç”¨æ•°ç»„ç®¡ç†æ¯”è¾ƒæ–¹ä¾¿çš„ã€‚\r\n\r\n- `init`\r\n\r\nç”¨ `init` æ¥å®Œæˆç»„è£…ï¼Œç¬¬ä¸€æ­¥æ˜¯åˆ›å»ºåæ ‡ç³»ï¼Œè¿™é‡Œç»™æ‰€æœ‰çš„åˆå§‹å…ƒç´ æ‰“ä¸Š `block`ï¼Œå®ƒä¸€å…±ä¸‰ä¸ªå€¼ï¼š`'block' | 'egg' | 'sanke'`ã€‚\r\nåé¢éšæœºè·å–è›‹çš„ä½ç½®å’Œè›‡çš„ä½ç½®ï¼Œå‚¨å­˜åˆ°` coordinateAll` ä¸­ï¼Œæœ€åè°ƒç”¨ `repaint` å®Œæˆç»˜åˆ¶\r\n\r\n- `repaint`\r\n\r\nè¿™ä¸€æ­¥å°±æ˜¯è°ƒç”¨ `canvas` å®Œæˆç•Œé¢ç»˜åˆ¶ï¼Œä¸»è¦ç”¨åˆ°äº†ä¸¤ä¸ª `api`\r\n\r\n[ctx.arc](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/arc) å’Œ [ctx.fillRect](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/fillRect)ï¼Œå‰è€…ç»˜åˆ¶å¼§å½¢åè€…å¡«å……çŸ©å½¢ï¼Œå…ˆ `clearRect` åç»˜åˆ¶æ˜¯å› ä¸ºè¿™ä¸ªæ–¹æ³•åç»­ä¼šè¢«é‡å¤è°ƒç”¨ï¼Œåé¢çš„ä¸€äº›`randomCoordinate`ã€`setCoordinate`ã€`getCoordinate`éƒ½æ˜¯è·Ÿåæ ‡æ–¹æ³•æœ‰å…³ï¼Œæ¯”è¾ƒç®€å•çœ‹ä¸€ä¸‹å³å¯ã€‚\r\n\r\n![é™æ€æ•ˆæœ](https://user-images.githubusercontent.com/39508895/139045166-b0b27e8d-3517-4e16-a0e7-c8b3cbdb01a3.png)\r\n\r\n\r\nåˆ°è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°é™æ€çš„æ•ˆæœï¼Œåé¢å°±æ˜¯è®©å…¶åŠ¨èµ·æ¥ã€‚\r\n\r\n## åŠ¨èµ·æ¥\r\n\r\næƒ³è®©è´ªåƒè›‡åŠ¨èµ·æ¥ï¼Œæˆ‘ä»¬éœ€è¦åšä¸¤æ­¥ï¼š\r\n\r\n- ç›‘å¬æ–¹å‘é”®ï¼Œä¹Ÿå°±æ˜¯åŠ¨çš„æ–¹å‘ï¼ˆä¹Ÿå……å½“å¯åŠ¨æ¸¸æˆä½œç”¨ï¼‰\r\n- ä½¿ç”¨å®šæ—¶å™¨ä¸æ–­çš„é‡ç»˜è›‡å’Œé¸¡è›‹çš„ä½ç½®æ¥é€ æˆè§†è§‰çš„ç§»åŠ¨\r\n\r\nç›‘å¬æ–¹å‘é”®å¾ˆç®€å•ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨ `body` ä¸Šç›‘å¬ `keydown` å³å¯ï¼Œè¿™ä¸ªäº‹ä»¶åœ¨é”®ç›˜æŒ‰ä¸‹çš„æ—¶å€™è§¦å‘\r\n\r\n```js\r\nthis.keydownFn = (e) => {\r\n  const code = e.code;\r\n  const result = ['ArrowDown', 'ArrowUp', 'ArrowLeft', 'ArrowRight'].indexOf(\r\n    code\r\n  );\r\n  if (result <= -1) {\r\n    return;\r\n  }\r\n  this.direction = code;\r\n};\r\nmonitor() {\r\n  document.body.addEventListener('keydown', this.keydownFn);\r\n};\r\n```\r\n\r\n```js\r\nmove() {\r\n  if (this.timeId) {\r\n    clearInterval(this.timeId);\r\n  }\r\n  this.timeId = setInterval(() => {\r\n    const { direction, currentSanke, currentEgg } = this;\r\n    // å¦‚æœæ–¹å‘é”®ä¸å­˜åœ¨å°±è¿”å›\r\n    if (!direction) {\r\n      return;\r\n    }\r\n    let nextCoordinate;\r\n    // è›‡å¤´å§‹ç»ˆæ˜¯0\r\n    const { x, y } = currentSanke[0];\r\n    switch (direction) {\r\n      case 'ArrowDown':\r\n      case 'ArrowUp':\r\n        nextCoordinate = { x, y: direction === 'ArrowUp' ? y - 1 : y + 1 };\r\n        break;\r\n      case 'ArrowLeft':\r\n      case 'ArrowRight':\r\n        nextCoordinate = { y, x: direction === 'ArrowLeft' ? x - 1 : x + 1 };\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    // nextCoordinateçš„ä½œç”¨æ˜¯ç¡®è®¤ä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆç±»å‹\r\n    const value = this.getCoordinate(nextCoordinate);\r\n    switch (value) {\r\n      case 'block':\r\n        this.setCoordinate(currentSanke.pop(), 'block');\r\n        currentSanke.unshift(nextCoordinate);\r\n        this.setCoordinate(nextCoordinate, 'sanke');\r\n        break;\r\n      case 'egg':\r\n        this.setCoordinate(currentEgg, 'sanke');\r\n        this.currentEgg = null;\r\n        currentSanke.unshift(nextCoordinate);\r\n        break;\r\n      case 'sanke':\r\n      case null:\r\n        // æ¸¸æˆç»“æŸ\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    this.repaint();\r\n  }, INTERVAL);\r\n};\r\n```\r\n\r\nä¹‹ååœ¨ init ä¸­æ’å…¥è¿™è¿™ä¸¤ä¸ªæ–¹æ³•\r\n\r\n```js\r\ninit() {\r\n  // ...\r\n  this.monitor();\r\n  this.move();\r\n}\r\n```\r\n\r\n![ç¤ºä¾‹](https://user-images.githubusercontent.com/39508895/139045193-71ae885b-bb3d-4613-82b9-9c7b4d9f6e38.png)\r\n\r\n\r\nåˆ°è¿™ä¸€æ­¥ï¼Œè´ªåƒè›‡ä¹Ÿå®ç°äº†åŠ¨èµ·æ¥çš„è¦æ±‚ï¼Œåœ¨ `swtich` ä¸­åˆ¤æ–­ `value` çš„ç±»å‹æ¥å†³å®šåæ ‡å€¼å¦‚ä½•å˜åŒ–ï¼Œä¹‹åç»§ç»­æ‰§è¡Œ `repaint` é‡ç»˜ç•Œé¢\r\n\r\n## ç»“æŸæ¸¸æˆ\r\n\r\nä¸Šé¢ `move` å¯¹æ¸¸æˆç»“æŸåªè¿›è¡Œäº†æ³¨é‡Šï¼Œä¸‹é¢å°±æŠŠ` case null:`ä¸‹é¢è¯­å¥æ›¿æ¢æˆ`this.end`\r\n\r\n```js\r\nend() {\r\n  if (this.timeId) {\r\n    clearInterval(this.timeId);\r\n  }\r\n  this.timeId = null;\r\n  document.body.removeEventListener('keydown', this.keydownFn);\r\n  alert(`æ¸¸æˆç»“æŸï¼Œå½“å‰åˆ†æ•°ï¼š${(this.currentSanke.length - 1) * 10}`);\r\n};\r\n```\r\n\r\n## æœ€å\r\n\r\nå¦‚æœæœ‰ä»€ä¹ˆé”™è¯¯è¯·ä¸åæŒ‡ç‚¹ï¼Œå¯¹ä½ æœ‰å¸®åŠ©ä¹Ÿå¯ä»¥ `start` ä¸€ä¸‹ã€‚\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/54/reactions",
        "total_count": 1,
        "+1": 1,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/54/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/75",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/75/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/75/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/75/events",
      "html_url": "https://github.com/bosens-China/blog/issues/75",
      "id": 975496779,
      "node_id": "MDU6SXNzdWU5NzU0OTY3Nzk=",
      "number": 75,
      "title": "æ€ä¹ˆç”¨ Vue Composition é€ è½®å­",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1473940161,
          "node_id": "MDU6TGFiZWwxNDczOTQwMTYx",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3",
          "name": "æ¡†æ¶ç›¸å…³",
          "color": "42b883",
          "default": false,
          "description": "ç›®å‰Vueå’ŒReactä¸ºä¸»"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2021-08-20T10:51:18Z",
      "updated_at": "2021-08-20T10:51:18Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "\r\n![wallhaven-zmmwzw](https://user-images.githubusercontent.com/39508895/130222612-f8e2410a-4101-47dd-ba41-f488225cb94d.jpg)\r\n\r\n\r\næœ€è¿‘é¡¹ç›®ä¸´è¿‘å°¾å£°ï¼Œç»ˆäºæœ‰æ—¶é—´æ¥å¯¹è¿™æ®µå·¥ä½œæ€»ç»“ã€‚å…¶å®ä¹‹å‰ä½¿ç”¨çš„ä¸€ç›´æ˜¯ Vue ä½†æ˜¯ç°åœ¨å…¬å¸çš„ä¸»è¦ä¸šåŠ¡ä½¿ç”¨æ˜¯ React ä¸ºæ­¤è¿˜ç‰¹æ„çœ‹äº†è®¸å¤šæ–‡ç« ï¼ŒåŠ ä¸Šå®é™…ä¸Šè¿™ä¸¤ä¸ªæ¡†æ¶æœ‰å¾ˆå¤šç±»ä¼¼çš„åœ°æ–¹ï¼Œæ‰€ä»¥å°±æœ‰äº†è¿™ç¯‡æ–‡ç« ã€‚\r\n\r\nå› ä¸ºä¸»è¦æ˜¯åˆ†äº«ç»éªŒæ‰€ä»¥ä¸‹é¢çš„ç¤ºä¾‹ä¸»è¦ä½œä¸ºæŠ›ç –å¼•ç‰çš„ä½œç”¨ï¼Œåœ¨æ­£å¼åˆ†äº«ä¹‹å‰å…ˆç§‘æ™®ä¸¤ä¸ªå°çŸ¥è¯†\r\n\r\n- hooks é»˜è®¤ä»¥ use ä¸ºå‰ç¼€ï¼Œè¿™ä¸ªæ˜¯ React çš„å®˜æ–¹æ¨èåšæ³•ï¼Œçº¦æŸå¤§äºé…ç½®ä¹Ÿæ–¹ä¾¿ eslint ç­‰è§£æå·¥å…·è¯†åˆ«ï¼Œè¿™é‡Œä¹Ÿéµå¾ªè¿™ä¸ªåšæ³•ï¼›\r\n- watchEffect ä¸ useEffect æœ€å¤§çš„åŒºåˆ«å°±æ˜¯ï¼ŒwatchEffect å¯ä»¥è‡ªåŠ¨æ£€æµ‹ä¾èµ–ï¼Œè€Œ useEffect éœ€è¦ä½ æ˜¾ç¤ºæŒ‡å®šï¼›\r\n\r\n```js\r\nconst count = ref(0);\r\nconst onClick = () => {\r\n  count.value++;\r\n};\r\nwatchEffect(() => {\r\n  console.log(`è¢«ç‚¹å‡»`);\r\n});\r\n```\r\n\r\nä¾‹å¦‚ä¸Šé¢è¿™æ®µä»£ç ï¼Œå½“ `onClick` è¢«è§¦å‘çš„æ—¶å€™ watchEffect ä¸ä¼šé‡å¤æ‰§è¡Œï¼Œå› ä¸ºå®ƒå†…éƒ¨æœ‰ä¸€ä¸ªæ”¶é›†ç›¸å…³ä¾èµ–çš„è¿‡ç¨‹ï¼Œåªæœ‰ä¾èµ–å˜åŒ–æ‰ä¼šé‡æ–°æ‰§è¡Œï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦ï¼Œè¯·è®°ä½ã€‚\r\n\r\n## ç¤ºä¾‹\r\næ ¹æ®å¸¸è§åœºæ™¯åˆ’åˆ†äº†ä¸‰ä¸ªç±»å‹ï¼Œå¦‚æœä½ æœ‰æ›´å¥½çš„ä¾‹å­æ¬¢è¿è¡¥å……\r\n### DOM\r\n\r\n#### ä¿®æ”¹é¡µé¢ title\r\n\r\n```js\r\nimport { ref, watchEffect } from 'vue';\r\n\r\nconst useTitle = (title) => {\r\n  const str = ref(title);\r\n  watchEffect(() => {\r\n    document.title = str.value;\r\n  });\r\n};\r\n```\r\n\r\nè°ƒç”¨`useTitle`å³å¯æ›´æ–°æ ‡é¢˜\r\n\r\n#### ç›‘å¬é¡µé¢å¤§å°å˜åŒ–\r\n\r\n```js\r\nimport { watchEffect, reactive, toRefs } from 'vue';\r\n\r\nconst useResize = () => {\r\n  const size = reactive({\r\n    width: window.innerWidth,\r\n    height: window.innerHeight,\r\n  });\r\n  const onChange = () => {\r\n    Object.assign(size, {\r\n      width: window.innerWidth,\r\n      height: window.innerHeight,\r\n    });\r\n  };\r\n  watchEffect((onInvalidate) => {\r\n    window.addEventListener('resize', onChange);\r\n    onInvalidate(() => {\r\n      window.removeEventListener('resize', onChange);\r\n    });\r\n  });\r\n  return toRefs(size);\r\n};\r\n```\r\n\r\nè¿™é‡Œè°ƒç”¨ `toRefs` çš„åŸå› æ˜¯ä¸ºäº†è§£æ„çš„æƒ…å†µä¹Ÿå¯ä»¥ä½¿ç”¨ï¼Œä¾‹å¦‚\r\n\r\n```js\r\nconst { width } = useResize();\r\n```\r\n\r\n#### ç›‘å¬ç½‘ç»œæ˜¯å¦æ–­å¼€\r\n\r\n```js\r\nimport { ref, watchEffect } from 'vue';\r\n\r\nconst useLineState = () => {\r\n  const line = ref(window.navigator.onLine);\r\n  const onLine = () => {\r\n    line.value = true;\r\n  };\r\n  const onOffline = () => {\r\n    line.value = false;\r\n  };\r\n\r\n  watchEffect((onInvalidate) => {\r\n    window.addEventListener('online', onLine);\r\n    window.addEventListener('offline', onOffline);\r\n    onInvalidate(() => {\r\n      window.removeEventListener('online', onLine);\r\n      window.removeEventListener('offline', onOffline);\r\n    });\r\n  });\r\n\r\n  return line;\r\n};\r\n```\r\n\r\nè·Ÿä¸Šé¢çš„ `useResize` ç±»ä¼¼ï¼Œç›‘å¬ç›¸å…³äº‹ä»¶æ¥å†³å®š `state` çš„ç›¸å…³çŠ¶æ€\r\n\r\n#### ç›‘å¬ dom å…ƒç´ å˜åŒ–\r\n\r\n```js\r\nimport { watchEffect, reactive, toRefs } from 'vue';\r\n\r\nconst isObject = (obj) => typeof obj === 'object' && obj;\r\nconst isElement = (obj) => isObject(obj) && obj.nodeType === Node.ELEMENT_NODE;\r\nconst useResizeObserver = (dom) => {\r\n  if (!isElement(dom)) {\r\n    throw new Error(`DOM is not an element!`);\r\n  }\r\n  const size = reactive(dom.getBoundingClientRect());\r\n  watchEffect((onInvalidate) => {\r\n    const resizeObserver = new ResizeObserver(() => {\r\n      Object.assign(size, dom.getBoundingClientRect());\r\n    });\r\n    onInvalidate(() => {\r\n      resizeObserver.disconnect();\r\n    });\r\n  });\r\n  return toRefs(size);\r\n};\r\n```\r\n\r\nè¿™é‡Œç›‘å¬å…ƒç´ ä½¿ç”¨äº†è¿˜åœ¨å®éªŒé˜¶æ®µçš„ `ResizeObserver` ï¼Œä¸ºäº†å…¼å®¹æ€§è¯·ä½¿ç”¨ `polyfill`\r\n\r\n### å°è£…è¯·æ±‚\r\n\r\najax çš„è¯·æ±‚å¾ˆå¸¸è§ï¼Œä¸è¿‡åœ¨ vue2.x ä¸­æˆ‘ä»¬å¾ˆå®¹æ˜“å†™å‡ºä¸‹é¢çš„ä»£ç \r\n\r\n```js\r\nmounted(() => {\r\n  fn().then().catch().finally();\r\n});\r\n```\r\n\r\nè¿™æ ·çš„ä»£ç æœ€å¤§çš„é—®é¢˜å°±æ˜¯ä¸å¤Ÿæ¸…æ™°ï¼Œå› ä¸ºå˜é‡åœ¨ `data` ä¸­å®šä¹‰ï¼Œè€Œå¦‚æœåˆ‡æ¢æˆä¸‹é¢è¿™ç§å½¢å¼ï¼Œçœ‹èµ·æ¥å°±ä¼šç›´è§‚è®¸å¤šã€‚\r\n\r\næ›´å¤šçš„ä¾‹å­è¿˜å¯ä»¥ç»“åˆ `form` å’Œ `table` è¿›è¡Œæ›´åŠ æ·±åº¦çš„ hooks å°è£…\r\n\r\n```js\r\nconst { data, loading, error } = useRequest(() => {\r\n  //...\r\n});\r\nif (loading) {\r\n  //...\r\n}\r\nif (error) {\r\n  // ...\r\n}\r\n```\r\n\r\n```js\r\nimport { watchEffect, reactive, toRefs } from 'vue';\r\n\r\nconst useRequest = (fn, { manual } = {}) => {\r\n  const obj = reactive({\r\n    loading: false,\r\n    data: undefined,\r\n    error: undefined,\r\n  });\r\n  const run = () => {\r\n    obj.loading = true;\r\n    Promise.resolve(fn())\r\n      .then((data) => {\r\n        obj.data = data;\r\n      })\r\n      .catch((err) => {\r\n        obj.error = err;\r\n      })\r\n      .finally(() => {\r\n        obj.loading = false;\r\n      });\r\n  };\r\n  watchEffect(() => {\r\n    if (!manual) {\r\n      run();\r\n    }\r\n  });\r\n\r\n  return {\r\n    ...toRefs(obj),\r\n    run,\r\n  };\r\n};\r\n```\r\n\r\n### æ¨¡æ‹Ÿç”Ÿå‘½å‘¨æœŸ\r\n\r\nè¿™é‡Œ Vue å®˜æ–¹çš„è‡ªå¸¦ç”Ÿå‘½å‘¨æœŸå·²ç»å¾ˆé½å…¨äº†ï¼Œä¸è¿‡æœ‰çš„ç”Ÿå‘½å‘¨æœŸè¿˜æ˜¯å¯ä»¥é€šè¿‡ `watchEffect` åšåˆ°æ¨¡æ‹Ÿã€‚\r\n\r\nä¾‹å¦‚ï¼š`mounted` å’Œ `beforeUnmount`ï¼Œè¿™é‡Œå®ç°çš„åŸç†ä¸»è¦å°±æ˜¯åˆ©ç”¨ `watchEffect` è‡ªåŠ¨æ£€æµ‹ä¾èµ–ï¼Œé‚£å¦‚æœä¸å¯¹å“åº”å¼å˜é‡åšæ”¶é›†çš„ç›¸å…³æ“ä½œå…¶å®å°±æ˜¯ä¸€ä¸ª `mounted`\r\n\r\n```js\r\nimport { watchEffect, nextTick } from 'vue';\r\n\r\nconst useMounted = (fn) => {\r\n  watchEffect(() => {\r\n    if (typeof fn !== 'function') {\r\n      return;\r\n    }\r\n    nextTick().then(() => {\r\n      fn();\r\n    });\r\n  });\r\n};\r\n\r\nconst useBeforeUnmount = (fn) => {\r\n  watchEffect((onInvalidate) => {\r\n    onInvalidate(() => {\r\n      if (typeof fn !== 'function') {\r\n        return;\r\n      }\r\n      fn();\r\n    });\r\n  });\r\n};\r\n```\r\n\r\n### å°è£…æŒä¹…åŒ–\r\n\r\nåœ¨ä¸€äº›ç™»å½•é¡µé¢ä¸­å¾ˆå®¹æ˜“çœ‹åˆ°è®°ä½ç›¸å…³è´¦å·å’Œå¯†ç ï¼Œä¼ ç»Ÿçš„åšæ³•å°±æ˜¯ `login` ä¹‹åå­˜å‚¨ç›¸å…³çš„è´¦å·å’Œå¯†ç ï¼Œç„¶ååœ¨é¡µé¢æ¸²æŸ“çš„æ—¶å€™æŸ¥çœ‹ç›¸å…³ `localStorage` æœ‰æ²¡æœ‰å¯¹åº”çš„æ•°æ®ã€‚\r\n\r\nè¿™æ ·å†™åšå¤§çš„é—®é¢˜è¿˜æ˜¯åˆ†ç¦»ï¼Œä»¥åŠä¹¦å†™çš„ä»£ç é‡å¾ˆå¤šï¼Œä¸‹é¢å°±ä»‹ç»ä¸€ä¸‹å¦‚ä½•ç»“åˆ `localStorage` åšåˆ°ä¸€ä¸ªæ”¯æŒå¯¹è±¡çš„ hooks\r\n\r\n```js\r\nimport { ref, watchEffect } from 'vue';\r\nconst isObject = (obj) => typeof obj === 'object' && obj;\r\nconst useLocalStorageState = (key, defaultValue) => {\r\n  const value = ref(undefined);\r\n  try {\r\n    value.value = window.localStorage.getItem(key);\r\n    if (value.value === undefined) {\r\n      value.value = defaultValue;\r\n    }\r\n    value.value = JSON.parse(value.value);\r\n  } catch {}\r\n\r\n  watchEffect(() => {\r\n    const v = value.value;\r\n    window.localStorage.setItem(key, isObject(v) ? JSON.stringify(v) : v);\r\n  });\r\n  return value;\r\n};\r\n```\r\n\r\n```js\r\nconst name = useLocalStorageState('name', 'admin');\r\n```\r\n\r\n## æœ€å\r\n\r\nä»¥ä¸Šä»£ç å…¨éƒ¨ä¸Šä¼ åˆ°äº†[codesandbox](https://codesandbox.io/s/nostalgic-chaum-9bwuo)ï¼Œå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©å¯ä»¥`star`ä¸€ä¸‹\r\n\r\n## å‚è€ƒæ–‡ç« \r\n\r\n- [ç²¾è¯»ã€Šæ€ä¹ˆç”¨ React Hooks é€ è½®å­ã€‹](https://github.com/ascoders/weekly/blob/v2/080.%E7%B2%BE%E8%AF%BB%E3%80%8A%E6%80%8E%E4%B9%88%E7%94%A8%20React%20Hooks%20%E9%80%A0%E8%BD%AE%E5%AD%90%E3%80%8B.md)\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/75/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/75/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/51",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/51/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/51/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/51/events",
      "html_url": "https://github.com/bosens-China/blog/issues/51",
      "id": 566103021,
      "node_id": "MDU6SXNzdWU1NjYxMDMwMjE=",
      "number": 51,
      "title": "åŸºäºHistoryå®ç°å‰ç«¯è·¯ç”±",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1371686609,
          "node_id": "MDU6TGFiZWwxMzcxNjg2NjA5",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/JavaScript",
          "name": "JavaScript",
          "color": "F7DF1E",
          "default": false,
          "description": "JavaScriptç³»åˆ—çš„æ–‡ç« "
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2020-02-17T07:21:46Z",
      "updated_at": "2020-02-17T07:21:46Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "`History`æ˜¯ HTML5 æ–°å¢çš„æ ‡å‡†ï¼Œå¯¹æ¯”`hash`å®ƒçš„å±•ç¤ºæ›´åŠ ä¼˜é›…ï¼Œä½†ä½ç‰ˆæœ¬ ie è¿˜æœ‰å…¼å®¹é—®é¢˜ã€‚\r\n\r\né¦–å…ˆ`History`è¡¨ç¤ºçª—å£æµè§ˆå†å²ï¼Œå¯ä»¥é€šè¿‡`pushState`æ–¹æ³•æ·»åŠ å†å²è®°å½•ï¼Œä»¥åŠé€šè¿‡`go`æ–¹æ³•æ¥å®ç°è·³è½¬ï¼Œè¿˜æœ‰`popstate`äº‹ä»¶å¯ä»¥ç›‘å¬åˆ°è®°å½•å˜æ›´ã€‚\r\n\r\nä¸‹é¢å°±æ¥åˆ†æå®ç°ä¸€ä¸ª`Historyè·¯ç”±`çš„åŸºç¡€æ˜¯ä»€ä¹ˆ\r\n\r\n1. å®ƒéœ€è¦åœ¨å˜æ›´åœ°å€çš„æ—¶å€™ï¼Œä¸ä¼šå¯¼è‡´æ–‡æ¡£ç›´æ¥è·³è½¬ï¼Œä¾‹å¦‚`hashè·¯ç”±`çš„å‡ºç°æ˜¯å› ä¸º url çš„`hash`å˜æ›´ä¸ä¼šå¯¼è‡´æ–‡æ¡£å˜åŒ–ï¼›\r\n2. éœ€è¦æœ‰äº‹ä»¶å¯ä»¥è¾…åŠ©æˆ‘ä»¬ç›‘å¬åˆ°è¿™ä¸ªå˜åŒ–;\r\n\r\nè¿™ä¸¤ä¸ªè¦æ±‚`History`éƒ½èƒ½å¾ˆå¥½æ»¡è¶³ï¼Œå½“ä½¿ç”¨`pushState`æ–¹æ³•æ·»åŠ ä¸€æ¡è®°å½•çš„æ—¶å€™ï¼Œåªä¼šå¯¼è‡´æµè§ˆå™¨çš„åœ°å€æ å‘ç”Ÿå˜åŒ–ï¼Œä½†æ˜¯ä¸ä¼šè·³è½¬åˆ°è¿™ä¸ªåœ°å€ï¼Œå¹¶ä¸”æµè§ˆå™¨ä¹Ÿä¸ä¼šæ£€æŸ¥è¿™ä¸ªåœ°å€ï¼Œåˆ©ç”¨è¿™ä¸ªç‰¹æ€§æˆ‘ä»¬å¯ä»¥å®ç°æ¯”è¾ƒä¼˜é›…çš„è·¯ç”±åœ°å€ï¼Œä¾‹å¦‚`https://xxx.com/a`ï¼Œ`a`å°±æ˜¯è¿™ä¸ªè·¯ç”±åœ°å€ã€‚\r\n\r\nä¸ºäº†æ–¹ä¾¿ç†è§£ä¸‹é¢å®ç°çš„ä»£ç ï¼Œç®€çŸ­ä»‹ç»ä¸€ä¸‹`pushState`\r\n\r\n#### pushState\r\n\r\n`pushState`æ–¹æ³•ï¼Œå®ƒæœ‰ä¸‰ä¸ªå‚æ•°\r\n\r\n- ç¬¬ä¸€ä¸ªæ˜¯`state`ï¼Œè¡¨ç¤ºå‘ç”Ÿ`popstate`äº‹ä»¶çš„æ—¶å€™ä¼ é€’çš„å¯¹è±¡ï¼›\r\n- titleï¼Œå½“å‰æµè§ˆå™¨å·²ç»å¿½ç•¥äº†ï¼Œä¼ é€’`''`å°±å¥½äº†ï¼›\r\n- ç½‘å€ï¼Œè¦æ›´æ”¹çš„åœ°å€ï¼Œæ³¨æ„è¦ç¬¦åˆåŒæºæ”¿ç­–ï¼›\r\n\r\nä¸¾ä¸ªä¾‹å­ï¼Œå½“å‰ç½‘ç«™çš„æ ¹è·¯å¾„æ˜¯`https://xxx.com`ï¼Œæˆ‘ä»¬ä½¿ç”¨`pushState`æ·»åŠ ä¸€æ¡è®°å½•\r\n\r\n```js\r\nhistory.pushState({ path: \"/abc\" }, \"\", \"/abc\");\r\n```\r\n\r\nå½“å‰çš„ç½‘å€å°±æ˜¯`https://xxx.com/abc`ã€‚\r\n\r\n#### popstate\r\n\r\n`pushState`äº‹ä»¶è§¦å‘çš„æ¡ä»¶æ˜¯ç”¨æˆ·ç‚¹å‡»`å‰è¿›`ã€`åé€€`æŒ‰é’®æˆ–è€…è°ƒç”¨ `History.back()`ã€`History.forward()`ã€`History.go()`æ–¹æ³•æ—¶æ‰ä¼šè§¦å‘ã€‚\r\n\r\nè§¦å‘äº‹ä»¶åæœ‰ä¸€ä¸ª`event`å¯¹è±¡ï¼Œå®ƒæœ‰ä¸€ä¸ª`state`å±æ€§ï¼Œå°±æ˜¯å¯¹åº”`pushState`æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚\r\n\r\næ›´å¤šå…³äº`history`çš„ä¿¡æ¯å¯ä»¥æŸ¥é˜…[MDN](https://developer.mozilla.org/zh-CN/docs/Web/API/History)\r\n\r\n### history è·¯ç”±å®ç°\r\n\r\n```js\r\nclass Router {\r\n  constructor() {\r\n    this.routes = new Map();\r\n    this.init();\r\n  }\r\n  change(e) {\r\n    // é˜²æ­¢ä¸ºnull\r\n    const { path } = e.state || {};\r\n    this.implement(path);\r\n  }\r\n  init() {\r\n    window.addEventListener(\"popstate\", this.change.bind(this));\r\n    window.addEventListener(\"load\", () => {\r\n      const { pathname } = location;\r\n      history.replaceState({ path: pathname }, \"\", pathname);\r\n      this.implement(pathname);\r\n    });\r\n  }\r\n  implement(path) {\r\n    if (!this.routes.has(path)) {\r\n      return;\r\n    }\r\n    const fn = this.routes.get(path);\r\n    typeof fn == \"function\" && fn.call(this, path);\r\n  }\r\n  go(num) {\r\n    history.go(num);\r\n  }\r\n  route(state, fn) {\r\n    this.routes.set(state, fn);\r\n  }\r\n  push(state) {\r\n    history.pushState({ path: state }, \"\", state);\r\n    this.implement(state);\r\n  }\r\n  replace(state) {\r\n    history.replaceState({ path: state }, \"\", state);\r\n    this.implement(state);\r\n  }\r\n}\r\n```\r\n\r\nè¿™ä¸€å—æ¯”è¾ƒç®€å•å°±ä¸åšæ›´å¤šèµ˜è¿°äº†ï¼Œå”¯ä¸€ä¸€ç‚¹éœ€è¦æ³¨æ„çš„å°±æ˜¯é¡µé¢åŠ è½½å®Œæ¯•ä¹Ÿéœ€è¦ç›‘å¬ä¸€æ¬¡ï¼Œè¿™é‡Œç”¨äº†`loadäº‹ä»¶`ã€‚\r\n\r\n### ä½¿ç”¨æ–¹æ³•\r\n\r\n```html\r\n<ul>\r\n  <li><a href=\"/\">hash1</a></li>\r\n  <li><a href=\"/hash2\">hash2</a></li>\r\n  <li><a href=\"/hash3\">hash3</a></li>\r\n</ul>\r\n<div><button class=\"f\">å‰è¿›</button> <button class=\"b\">åé€€</button></div>\r\n```\r\n\r\n```js\r\nconst color = {\r\n  \"/\": \"yellow\",\r\n  \"/hash2\": \"#333\",\r\n  \"/hash3\": \"#DDD\"\r\n};\r\nconst route = new Router();\r\nroute.route(\"/\", function(e) {\r\n  document.body.style.background = color[e];\r\n});\r\nroute.route(\"/hash2\", function(e) {\r\n  document.body.style.background = color[e];\r\n});\r\nroute.route(\"/hash3\", function(e) {\r\n  document.body.style.background = color[e];\r\n});\r\nArray.from(document.links).forEach(fn => {\r\n  fn.addEventListener(\"click\", e => {\r\n    e.preventDefault();\r\n    const href = fn.href;\r\n    const { pathname } = new URL(href);\r\n    route.push(pathname);\r\n  });\r\n});\r\nconst backOff = document.querySelector(\".b\");\r\nconst forward = document.querySelector(\".f\");\r\nbackOff.addEventListener(\"click\", () => route.go(-1));\r\nforward.addEventListener(\"click\", () => route.go(1));\r\n```\r\n\r\nè¿™é‡Œæ³¨æ„ï¼Œæˆ‘ç›´æ¥å±è”½äº†`a`é“¾æ¥çš„é»˜è®¤è·³è½¬ï¼Œè¿™ä¸ªæ˜¯é˜²æ­¢å®ƒç›´æ¥åˆ°å…¶ä»–æ–‡æ¡£ã€‚\r\n\r\n### æœ€å\r\n\r\nå…³äºå‰ç«¯è·¯ç”±çš„ä¸¤ç§å®ç°ï¼Œè¿™é‡Œå°±æŠ›ç –å¼•ç‰çš„è®²è§£å®Œæˆäº†ï¼Œå‰©ä¸‹çš„å°±æ˜¯åœ¨è¿™ä¸ªåŸç†ä¸Šæ›´åŠ å®Œå–„ï¼Œä¾‹å¦‚å¯¹ 404 é¡µé¢çš„å¤„ç†ã€‚\r\n\r\nå¦‚æœæœ‰å¸®åŠ©å¯ä»¥ **star** ä¸€ä¸‹ã€‚\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/51/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/51/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/50",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/50/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/50/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/50/events",
      "html_url": "https://github.com/bosens-China/blog/issues/50",
      "id": 566035569,
      "node_id": "MDU6SXNzdWU1NjYwMzU1Njk=",
      "number": 50,
      "title": "åŸºäºhashå®ç°å‰ç«¯è·¯ç”±",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1371686609,
          "node_id": "MDU6TGFiZWwxMzcxNjg2NjA5",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/JavaScript",
          "name": "JavaScript",
          "color": "F7DF1E",
          "default": false,
          "description": "JavaScriptç³»åˆ—çš„æ–‡ç« "
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2020-02-17T03:34:23Z",
      "updated_at": "2020-02-17T03:34:23Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "> å‰ç«¯è·¯ç”±åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œhash è·¯ç”±å’Œ History è·¯ç”±ï¼Œä¾‹å¦‚æˆ‘ä»¬å¸¸ç”¨çš„ vue-roter å°±åŒ…å«è¿™ä¸¤éƒ¨åˆ†ï¼Œè¿™é‡Œå¹¶ä¸æ¢è®¨æ¡†æ¶æ˜¯å¦‚ä½•è¿›è¡Œå°è£…çš„ï¼Œè€Œæ˜¯ä½¿ç”¨åŸç”Ÿçš„ api æ¥å®ç°è¿™æ ·ä¸€ä¸ªåŠŸèƒ½ã€‚\r\n\r\n> é¢„è®¡åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œè¿™é‡Œå…ˆä»‹ç» hash è·¯ç”±ï¼Œå®ç°åŸºæœ¬çš„æ¥å—å“åº”å’Œå‰è¿›åé€€ï¼ˆä¸ºäº†æ–¹ä¾¿ï¼Œä¸‹é¢ä»£ç ä¸åšä»»ä½•å…¼å®¹å¤„ç†ï¼‰\r\n\r\nhash æŒ‡çš„å°±æ˜¯ url æ ‡è¯†ç¬¦åé¢`#`å·éƒ¨åˆ†çš„å†…å®¹ï¼ˆåŒ…å«#ï¼‰ï¼Œä¾‹å¦‚ï¼š`https://xxx#abc`è¿™ä¸ª url çš„ hash å°±æ˜¯`#abc`ã€‚\r\n\r\nè€Œ hash è·¯ç”±å°±æ˜¯æŒ‡æ¥æ”¶ hash çš„å˜åŒ–æ›´æ–°å¯¹åº”çš„è·¯ç”±è§†å›¾ï¼Œå®ƒçš„ä¼˜ç‚¹å°±æ˜¯å…¼å®¹æ€§å¾ˆå¥½ï¼Œåœ¨ ie ä¸‹ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œï¼Œä¸è¶³ä¹‹å¤„å°±æ˜¯`#`è¿™ä¸ªç¬¦å·å¾ˆä¸‘é™‹ã€‚\r\n\r\n### ç›‘å¬ hash å˜åŒ–\r\n\r\nwindow å¯¹è±¡ä¸Šæœ‰`hashchange`äº‹ä»¶å¯ä»¥ç›‘å¬åˆ° hash çš„å˜åŒ–ï¼Œæˆ‘ä»¬å…ˆæ‹¿æ¥ç”¨ç”¨ï¼Œçœ‹çœ‹å¥½ä¸å¥½ç”¨ã€‚\r\n\r\n```js\r\nclass Router {\r\n  constructor() {\r\n    this.hash = new Map();\r\n    this.change = () => {\r\n      const href = this.getHash();\r\n      this.move(href);\r\n    };\r\n    window.addEventListener(\"hashchange\", this.change);\r\n  }\r\n  route(href, fn) {\r\n    this.hash.set(href, fn);\r\n  }\r\n  move(href) {\r\n    if (!this.hash.has(href)) {\r\n      return false;\r\n    }\r\n    const fn = this.hash.get(href);\r\n    if (typeof fn == \"function\") {\r\n      fn.call(this, href);\r\n    }\r\n    return true;\r\n  }\r\n  getHash() {\r\n    return location.hash ? location.hash.slice(1) : \"/\";\r\n  }\r\n}\r\n```\r\n\r\n#### ä½¿ç”¨æ–¹æ³•\r\n\r\n```js\r\nconst color = {\r\n  hash1: \"#333\",\r\n  hash2: \"#666\",\r\n  hash3: \"#DDD\"\r\n};\r\nconst route = new Router();\r\nroute.route(\"hash1\", function(e) {\r\n  document.body.style.background = color[e];\r\n});\r\nroute.route(\"hash2\", function(e) {\r\n  document.body.style.background = color[e];\r\n});\r\nroute.route(\"hash3\", function(e) {\r\n  document.body.style.background = color[e];\r\n});\r\n```\r\n\r\nè¿™é‡Œå·²ç»å®ç°äº† hash å“åº”äº†ï¼Œä¸è¿‡è¿˜æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯å¦‚æœç‚¹å‡» hash ä¹‹ååˆ·æ–°æµè§ˆå™¨ï¼Œå¯¹åº”çš„å›è°ƒå‡½æ•°å¹¶ä¸ä¼šæ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦æµè§ˆå™¨åŠ è½½å®Œæˆåå“åº”å¯¹åº”çš„å›è°ƒå‡½æ•°ï¼Œä¿®è®¢è¿™ä¸ªé—®é¢˜å¾ˆç®€å•ç›‘å¬ load äº‹ä»¶å³å¯ã€‚\r\n\r\n```js\r\n// çœç•¥å…¶ä»–ä»£ç \r\nconstructor() {\r\n    window.addEventListener('load', this.change);\r\n    window.addEventListener(\"hashchange\", this.change);\r\n  }\r\n```\r\n\r\n### åé€€åŠŸèƒ½\r\n\r\nä¸Šé¢å®Œæˆäº†åŸºç¡€åŠŸèƒ½ï¼Œä¸‹é¢å¯¹è¿™ä¸ªä»£ç è¿›è¡Œæ”¹é€ ï¼Œé¦–å…ˆæ–°å¢ä¸€ä¸ªåé€€å¤„ç†ã€‚\r\n\r\nå®ç°çš„æ€è·¯æ˜¯æ–°å¢ä¸€ä¸ª`history`æ•°ç»„æ¥å‚¨å­˜å˜åŒ–çš„ hashï¼Œå¹¶ä¸”åˆ›å»ºä¸€ä¸ªæŒ‡é’ˆï¼Œåœ¨åé€€çš„æ—¶å€™ç§»åŠ¨æŒ‡é’ˆå˜åŒ–ï¼ŒåŒæ—¶è§¦å‘å¯¹åº”çš„å‡½æ•°ã€‚\r\n\r\n```js\r\nclass Router {\r\n  constructor() {\r\n    this.hash = new Map();\r\n    // å‚¨å­˜hashå˜åŒ–çš„æ•°ç»„\r\n    this.history = [];\r\n    // æŒ‡é’ˆ\r\n    this.pointer = this.history.length - 1;\r\n    this.change = () => {\r\n      const href = this.getHash();\r\n      if (!this.move(href)) {\r\n        return console.error(`hashè·¯ç”±${href}æ— å¯¹åº”å¤„ç†å‡½æ•°`);\r\n      }\r\n      // åœ¨è·¯ç”±å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼ŒåŒæ—¶å¯¹historyæ·»åŠ ï¼Œå’Œç§»åŠ¨æŒ‡é’ˆ\r\n      this.history.push(href);\r\n      this.pointer++;\r\n    };\r\n    // åé€€\r\n    this.backOff = () => {\r\n      // æ•°ç»„ä¸‹è¡¨ä¸èƒ½è´Ÿ\r\n      if (this.pointer <= 0) {\r\n        this.pointer = 0;\r\n      } else {\r\n        // ç§»åŠ¨ä¸‹æ ‡\r\n        this.pointer -= 1;\r\n      }\r\n      // è¯»å–å¯¹åº”çš„å€¼ï¼Œç§»åŠ¨hash\r\n      const href = this.history[this.pointer];\r\n      console.log(href, this.pointer, this.history);\r\n      this.setHash(href);\r\n      this.move(href);\r\n    };\r\n    window.addEventListener(\"load\", this.change);\r\n    window.addEventListener(\"hashchange\", this.change);\r\n  }\r\n  route(href, fn) {\r\n    this.hash.set(href, fn);\r\n  }\r\n  move(href) {\r\n    if (!this.hash.has(href)) {\r\n      return false;\r\n    }\r\n    const fn = this.hash.get(href);\r\n    if (typeof fn == \"function\") {\r\n      fn.call(this, href);\r\n    }\r\n    return true;\r\n  }\r\n  getHash() {\r\n    // è¿‡æ»¤æ‰'#'\r\n    return location.hash ? location.hash.slice(1) : \"/\";\r\n  }\r\n  setHash(href) {\r\n    if (!href) {\r\n      return;\r\n    }\r\n    if (!/^/.test(href)) {\r\n      href = `#${href}`;\r\n    }\r\n    location.hash = href;\r\n  }\r\n}\r\n```\r\n\r\nä¸Šé¢çœ‹ä¼¼å®ç°äº†åé€€åŠŸèƒ½ï¼Œä¸è¿‡ä»”ç»†è§‚å¯Ÿä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬ä¼šå‘ç°è¿™æ ·å®ç°æ˜¯æœ‰é—®é¢˜çš„\r\n\r\n1. å›è°ƒå‡½æ•°è¢«æ‰§è¡Œä¸¤æ¬¡ï¼›\r\n2. `history`æ•°ç»„è®°å½•çš„ hash ä¸å¯¹ï¼Œå› ä¸ºåé€€æ˜¯ä¸éœ€è¦è®°å½•çš„ï¼›\r\n\r\nä¸‹é¢æ¥ä¿®æ­£è¿™ä¸¤ä¸ªé—®é¢˜ã€‚\r\n\r\n```js\r\nclass Router {\r\n  constructor() {\r\n    this.hash = new Map();\r\n    // å‚¨å­˜hashå˜åŒ–çš„æ•°ç»„\r\n    this.history = [];\r\n    // æŒ‡é’ˆ\r\n    this.pointer = this.history.length - 1;\r\n    // æ˜¯å¦åé€€ï¼Œé»˜è®¤ç»™false\r\n    this.isBackOff = false;\r\n    this.change = () => {\r\n      const href = this.getHash();\r\n      if (!this.hash.has(href)) {\r\n        return console.error(`hashè·¯ç”±${href}æ— å¯¹åº”å¤„ç†å‡½æ•°`);\r\n      }\r\n      if (!this.isBackOff) {\r\n        // çœ‹ä¸€ä¸‹æŒ‡é’ˆé•¿åº¦å¯¹ä¸å¯¹ï¼Œå¦‚æœå¤šä½™å°±æˆªå–æ‰\r\n        if (this.pointer < this.history.length - 1) {\r\n          this.history = this.history.slice(0, this.pointer + 1);\r\n        }\r\n        // åœ¨è·¯ç”±å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼ŒåŒæ—¶å¯¹historyæ·»åŠ ï¼Œå’Œç§»åŠ¨æŒ‡é’ˆ\r\n        this.history.push(href);\r\n        this.pointer++;\r\n      }\r\n      this.move(href);\r\n      this.isBackOff = false;\r\n    };\r\n    // åé€€\r\n    this.backOff = () => {\r\n      this.isBackOff = true;\r\n      // æ•°ç»„ä¸‹è¡¨ä¸èƒ½è´Ÿ\r\n      if (this.pointer <= 0) {\r\n        this.pointer = 0;\r\n      } else {\r\n        // ç§»åŠ¨ä¸‹æ ‡\r\n        this.pointer -= 1;\r\n      }\r\n      // è¯»å–å¯¹åº”çš„å€¼ï¼Œç§»åŠ¨hash\r\n      const href = this.history[this.pointer];\r\n      console.log(href, this.pointer, this.history);\r\n      this.setHash(href);\r\n    };\r\n    window.addEventListener(\"load\", this.change);\r\n    window.addEventListener(\"hashchange\", this.change);\r\n  }\r\n  route(href, fn) {\r\n    this.hash.set(href, fn);\r\n  }\r\n  move(href) {\r\n    const fn = this.hash.get(href);\r\n    if (typeof fn == \"function\") {\r\n      fn.call(this, href);\r\n    }\r\n  }\r\n  getHash() {\r\n    // è¿‡æ»¤æ‰'#'\r\n    return location.hash ? location.hash.slice(1) : \"/\";\r\n  }\r\n  setHash(href) {\r\n    if (!href) {\r\n      return;\r\n    }\r\n    if (!/^/.test(href)) {\r\n      href = `#${href}`;\r\n    }\r\n    location.hash = href;\r\n  }\r\n}\r\n```\r\n\r\nå€ŸåŠ©å˜é‡`isBackOff`æ¥æ§åˆ¶ï¼Œå¦‚æœæ˜¯åé€€åªæ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œå½“æ­£å¸¸æ“ä½œçš„æ—¶å€™æ–°å¢`history`æ•°æ®ï¼ŒåŒæ—¶æ¸…æ¥šå¤šä½™æ•°ç»„ï¼Œå‰è¿›è·Ÿåé€€ç±»ä¼¼ï¼Œä¸‹é¢å°±æ¥å®ç°å®ƒã€‚\r\n\r\n### å‰è¿›\r\n\r\næ€è·¯è·Ÿåé€€çš„ä¸€è‡´ï¼Œå€ŸåŠ©å˜é‡æ¥è¿›è¡Œæ§åˆ¶ï¼Œå®šä¹‰ä¸€ä¸ªå‰è¿›æ–¹æ³•ã€‚\r\n\r\n```js\r\nclass Router {\r\n  constructor() {\r\n    this.hash = new Map();\r\n    // å‚¨å­˜hashå˜åŒ–çš„æ•°ç»„\r\n    this.history = [];\r\n    // æŒ‡é’ˆ\r\n    this.pointer = this.history.length - 1;\r\n    // æ˜¯å¦åé€€ï¼Œé»˜è®¤ç»™false\r\n    this.isBackOff = false;\r\n    // å‰è¿›æ ‡è¯†\r\n    this.isForward = false;\r\n    this.change = () => {\r\n      const href = this.getHash();\r\n      if (!this.hash.has(href)) {\r\n        return console.error(`hashè·¯ç”±${href}æ— å¯¹åº”å¤„ç†å‡½æ•°`);\r\n      }\r\n      if (!this.isBackOff && !this.isForward) {\r\n        // çœ‹ä¸€ä¸‹æŒ‡é’ˆé•¿åº¦å¯¹ä¸å¯¹ï¼Œå¦‚æœå¤šä½™å°±æˆªå–æ‰\r\n        if (this.pointer < this.history.length - 1) {\r\n          this.history = this.history.slice(0, this.pointer + 1);\r\n        }\r\n        // åœ¨è·¯ç”±å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼ŒåŒæ—¶å¯¹historyæ·»åŠ ï¼Œå’Œç§»åŠ¨æŒ‡é’ˆ\r\n        this.history.push(href);\r\n        this.pointer++;\r\n      }\r\n      this.move(href);\r\n      this.isBackOff = false;\r\n      this.isForward = false;\r\n    };\r\n    // åé€€\r\n    this.backOff = () => {\r\n      this.isBackOff = true;\r\n      // æ•°ç»„ä¸‹è¡¨ä¸èƒ½è´Ÿ\r\n      if (this.pointer <= 0) {\r\n        this.pointer = 0;\r\n      } else {\r\n        // ç§»åŠ¨ä¸‹æ ‡\r\n        this.pointer -= 1;\r\n      }\r\n      // è¯»å–å¯¹åº”çš„å€¼ï¼Œç§»åŠ¨hash\r\n      const href = this.history[this.pointer];\r\n      console.log(href, this.pointer, this.history);\r\n      this.setHash(href);\r\n    };\r\n    // å‰è¿›\r\n    this.forward = () => {\r\n      this.isForward = true;\r\n      // æ•°ç»„ä¸‹è¡¨ä¸èƒ½è´Ÿ\r\n      if (this.pointer >= this.history.length - 1) {\r\n        this.pointer = this.history.length - 1;\r\n      } else {\r\n        // ç§»åŠ¨ä¸‹æ ‡\r\n        this.pointer += 1;\r\n      }\r\n      // è¯»å–å¯¹åº”çš„å€¼ï¼Œç§»åŠ¨hash\r\n      const href = this.history[this.pointer];\r\n      console.log(`å‰è¿›${href}`, this.pointer, this.history);\r\n      this.setHash(href);\r\n    };\r\n    window.addEventListener(\"load\", this.change);\r\n    window.addEventListener(\"hashchange\", this.change);\r\n  }\r\n  route(href, fn) {\r\n    this.hash.set(href, fn);\r\n  }\r\n  move(href) {\r\n    const fn = this.hash.get(href);\r\n    if (typeof fn == \"function\") {\r\n      fn.call(this, href);\r\n    }\r\n  }\r\n  getHash() {\r\n    // è¿‡æ»¤æ‰'#'\r\n    return location.hash ? location.hash.slice(1) : \"/\";\r\n  }\r\n  setHash(href) {\r\n    if (!href) {\r\n      return;\r\n    }\r\n    if (!/^/.test(href)) {\r\n      href = `#${href}`;\r\n    }\r\n    location.hash = href;\r\n  }\r\n}\r\n```\r\n\r\nè·Ÿåé€€å¯¹æ¯”ï¼Œå®è´¨ä¸Šä¹Ÿåªæ˜¯æŠŠåé€€æŒ‡é’ˆæ”¹æˆå‰è¿›äº†ï¼Œå¦‚æœæƒ³è¦å®ç°`go`è·³è½¬çš„åŠŸèƒ½ä¹Ÿè·Ÿå‰è¿›ã€åé€€æ€è·¯ä¸€æ ·ã€‚\r\n\r\n### ä½¿ç”¨æ–¹æ³•\r\n\r\n```html\r\n<ul>\r\n  <li><a href=\"#hash1\">hash1</a></li>\r\n  <li><a href=\"#hash2\">hash2</a></li>\r\n  <li><a href=\"#hash3\">hash3</a></li>\r\n</ul>\r\n<div><button class=\"f\">å‰è¿›</button> <button class=\"b\">åé€€</button></div>\r\n1\r\n```\r\n\r\n```js\r\nconst color = {\r\n  hash1: \"#333\",\r\n  hash2: \"#666\",\r\n  hash3: \"#DDD\"\r\n};\r\nconst route = new Router();\r\nroute.route(\"hash1\", function(e) {\r\n  document.body.style.background = color[e];\r\n});\r\nroute.route(\"hash2\", function(e) {\r\n  document.body.style.background = color[e];\r\n});\r\nroute.route(\"hash3\", function(e) {\r\n  document.body.style.background = color[e];\r\n});\r\nconst backOff = document.querySelector(\".b\");\r\nconst forward = document.querySelector(\".f\");\r\nbackOff.addEventListener(\"click\", route.backOff);\r\nforward.addEventListener(\"click\", route.forward);\r\n```\r\n\r\n### æœ€å\r\n\r\nè¿™é‡Œå®ç°äº† hash è·¯ç”±çš„`å“åº”å˜åŒ–`å’Œ`å‰è¿›`ã€`åé€€`ã€`404` çš„åŠŸèƒ½ï¼Œä½†æ˜¯è¿˜æœ‰å¾ˆå¤šåœ°æ–¹éœ€è¦å®Œå–„ï¼Œæ¯”å¦‚`go`è·³è½¬ã€‚\r\n\r\nä¸‹ä¸€èŠ‚å°†ä»‹ç» `History è·¯ç”±çš„å®ç°`ï¼Œå¦‚æœå–œæ¬¢è¯·ç‚¹å‡»ä¸€ä¸‹ **star**\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/50/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/50/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/28",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/28/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/28/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/28/events",
      "html_url": "https://github.com/bosens-China/blog/issues/28",
      "id": 499359943,
      "node_id": "MDU6SXNzdWU0OTkzNTk5NDM=",
      "number": 28,
      "title": "MatchMedia API",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1580833992,
          "node_id": "MDU6TGFiZWwxNTgwODMzOTky",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%AE%9E%E9%AA%8C%E6%80%A7%20API",
          "name": "å®éªŒæ€§ API",
          "color": "7aa9d6",
          "default": false,
          "description": "è¿˜æœªå®šç¨¿çš„API"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2019-09-27T10:12:54Z",
      "updated_at": "2019-09-27T10:14:33Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "\r\n![456](https://user-images.githubusercontent.com/39508895/65761913-63d54580-e152-11e9-89e1-76f82d5df39f.jpg)\r\n\r\n\r\n> æ³¨æ„`matchMedia`ä¸ºå®éªŒæ€§è¯­æ³•æ–‡æ¡£å¯èƒ½è¢«é‡æ–°ä¿®è®¢ï¼Œåé¢æœ‰å¯èƒ½ä¼šæ”¹å˜è¯­æ³•ï¼Œåœ¨ç”Ÿäº§ä¸­è¯·é…åˆ[matchMedia polyfill](https://github.com/paulirish/matchMedia.js)ä½¿ç”¨\r\n\r\né€šè¿‡åª’ä½“æŸ¥è¯¢ï¼Œæ‚¨å¯ä»¥æ ¹æ®å„ç§è®¾å¤‡ç‰¹å¾å’Œå‚æ•°çš„å€¼æˆ–è€…æ˜¯å¦å­˜åœ¨æ¥è°ƒæ•´æ‚¨çš„ç½‘ç«™æˆ–åº”ç”¨ï¼›\r\n\r\nä¸Šé¢æ˜¯ MDN å¯¹åª’ä½“æŸ¥è¯¢çš„å®šä¹‰ï¼Œç®€å•æƒ…å†µé€šè¿‡ css åª’ä½“æŸ¥è¯¢ è°ƒæ•´é¡µé¢å·²ç»è¶³å¤Ÿäº†ï¼Œä¸è¿‡ç°åœ¨é¡µé¢äº¤äº’å’ŒåŠŸèƒ½è¶Šæ¥è¶Šå¤šï¼Œæ¯”å¦‚ä¸€ä¸ªé¡µé¢è¦å“åº”å¼å¸ƒå±€ï¼ŒåŒæ—¶åœ¨ä¸åŒå±å¹•ä¸‹é¡µé¢ç»“æ„ä¸åŒï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰æœ‰äº›åŠ›ä¸ä»å¿ƒäº†ï¼Œä¸‹é¢ä»‹ç»ä¸€ä¸‹`matchMedia`ã€‚\r\n\r\n## ä½¿ç”¨æ–¹æ³•\r\n\r\n```js\r\nvar mqList = window.matchMedia(mediaQueryString);\r\n```\r\n\r\nmatchMedia å¯ä»¥å®ç°ç¼–ç¨‹æ–¹æ³•å¼åª’ä½“æŸ¥è¯¢ï¼Œå‚æ•°`mediaQueryString`ä¸ºåª’ä½“è¯­å¥ï¼Œè¿”å›ç±»å‹ä¸º`MediaQueryList`ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­\r\n\r\n```js\r\nif (window.matchMedia(\"(min-width: 400px)\").matches) {\r\n  // çª—å£å¤§äºç­‰äº400 æƒ…å†µ\r\n} else {\r\n  // çª—å£å°äº400\r\n}\r\n```\r\n\r\n## MediaQueryListÂ \r\n\r\n- å±æ€§\r\n\r\n  - matches:booleanï¼š å¦‚æœå½“å‰ document åŒ¹é…è¯¥åª’ä½“æŸ¥è¯¢åˆ—è¡¨åˆ™å…¶å€¼ä¸º trueï¼›åä¹‹å…¶å€¼ä¸º falseã€‚åªè¯»ï¼›\r\n  - media:DOMString åºåˆ—åŒ–çš„åª’ä½“æŸ¥è¯¢åˆ—è¡¨ï¼›\r\n\r\n- æ–¹æ³•\r\n  - addListener(call: Function):void\r\n  - removeListener(call: Function):void\r\n\r\n### addListener\r\n\r\n```js\r\nMediaQueryList.addListener(func);\r\n```\r\n\r\nfunc æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œåˆç‰ˆå‚æ•°çš„ç±»å‹ä¸º[MediaQueryListListener ](https://developer.mozilla.org/en-US/docs/Web/API/MediaQueryListListener)æ–°ä¿®è®¢çš„å‚æ•°ç±»å‹ä¸º[MediaQueryListEvent,](https://developer.mozilla.org/en-US/docs/Web/API/MediaQueryListEvent)\r\n\r\n```js\r\nvar mql = window.matchMedia(\"(max-width: 600px)\");\r\n\r\nfunction screenTest(e) {\r\n  if (e.matches) {\r\n    // å±å¹•å°äºç­‰äº600\r\n  } else {\r\n    // å±å¹•å¤§äº600\r\n  }\r\n}\r\nmql.addListener(screenTest);\r\n```\r\n\r\n### removeListener\r\n\r\n```js\r\nMediaQueryList.removeListener(func);\r\n```\r\n\r\nfunc è¡¨ç¤ºè¦åˆ é™¤çš„å›è°ƒå‡½æ•°çš„å‡½æ•°æˆ–å‡½æ•°å¼•ç”¨\r\n\r\n```js\r\nvar mql = window.matchMedia(\"(max-width: 600px)\");\r\n\r\nfunction screenTest(e) {\r\n  if (e.matches) {\r\n    // å±å¹•å°äºç­‰äº600\r\n  } else {\r\n    // å±å¹•å¤§äº600\r\n  }\r\n}\r\n\r\nmql.addListener(screenTest);\r\n\r\n// å–æ¶ˆç›‘å¬\r\nmql.removeListener(screenTest);\r\n```\r\n\r\n## å‚è€ƒ\r\n\r\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaQueryList/media\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/28/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/28/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/26",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/26/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/26/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/26/events",
      "html_url": "https://github.com/bosens-China/blog/issues/26",
      "id": 498112062,
      "node_id": "MDU6SXNzdWU0OTgxMTIwNjI=",
      "number": 26,
      "title": "ResizeObserver API",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1580833992,
          "node_id": "MDU6TGFiZWwxNTgwODMzOTky",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%AE%9E%E9%AA%8C%E6%80%A7%20API",
          "name": "å®éªŒæ€§ API",
          "color": "7aa9d6",
          "default": false,
          "description": "è¿˜æœªå®šç¨¿çš„API"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2019-09-25T07:51:27Z",
      "updated_at": "2019-09-27T02:03:01Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "\r\n![123](https://user-images.githubusercontent.com/39508895/65580529-6d24ad80-dfac-11e9-868f-328d7427391e.jpg)\r\n\r\næ— æ„ä¹‹é—´çœ‹åˆ°è¿™ä¸ª APIï¼Œå‘ç°è¿™ä¸ª API ååˆ†å®ç”¨ç‰¹æ¥åˆ†äº«ä¸€ä¸‹ã€‚\r\n\r\nResizeObserver å¯ä»¥ç›‘å¬åˆ° Element çš„å…ƒç´ çš„å˜åŒ–ï¼Œä¾‹å¦‚å¤§å°å˜åŒ–ï¼Œåœ¨ä¹‹å‰æˆ‘ä»¬å¯èƒ½è¦ç›‘å¬ window å¯¹è±¡ï¼Œå› ä¸º resize å®šä¹‰åœ¨ window ä¸Šï¼Œä¸è¿‡æ³¨æ„è¿™ä¸ª API è¿˜æ˜¯å¤„äºå®éªŒæ€§é˜¶æ®µï¼Œåœ¨é¡¹ç›®ä¸­è¦é…åˆ [polyfill](https://github.com/que-etc/resize-observer-polyfill) æ¥ä½¿ç”¨\r\n\r\n## constructor\r\n\r\n```js\r\nvar ResizeObserver = new ResizeObserver(callback);\r\n```\r\n\r\nä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼ŒResizeObserver æ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå½“å°ºå¯¸å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ `callback` å‡½æ•°æ¥æ”¶ä¸€ä¸ª `ResizeObserverEntry` æ•°ç»„ï¼Œä¸‹é¢çœ‹ä¸€ä¸ªä¾‹å­\r\n\r\n```html\r\n<div class=\"box\"></div>\r\n<script>\r\n  const box = document.querySelector(\".box\");\r\n  const resizeObserver = new ResizeObserver(entries => {\r\n    for (let entry of entries) {\r\n      const dimensions = entry.contentRect;\r\n      console.log(`${dimensions.width} x ${dimensions.height}`);\r\n    }\r\n  });\r\n  resizeObserver.observe(box);\r\n  setTimeout(() => {\r\n    box.style.width = \"99px\";\r\n  }, 1000);\r\n</script>\r\n```\r\n\r\nä¸Šé¢å®šä¹‰äº†ä¸€ä¸ª box çš„å…ƒç´ ï¼Œå¹¶åœ¨ä¸€ç§’åæ›´æ”¹å®½åº¦ `ResizeObserver` å¯ä»¥ç›‘å¬åˆ°è¿™ä¸€æ›´æ”¹ã€‚\r\n\r\n> ç‰¹åˆ«æé†’ä¸€ä¸‹ï¼Œæ·»åŠ åˆå§‹å…ƒç´ çš„æ—¶å€™é»˜è®¤å°±ä¼šæ‰§è¡Œæ‰§è¡Œä¸€æ¬¡å›è°ƒï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ç”¨æ‰‹åŠ¨æ‰§è¡Œä¸€æ¬¡è·å–åˆå§‹ä¿¡æ¯äº†ã€‚\r\n\r\n## ResizeObserverEntry\r\n\r\nä½ å¯èƒ½å¥½å¥‡ ResizeObserverEntry ä¼šè¿”å›ä»€ä¹ˆæ ¼å¼çš„æ•°æ®ï¼Ÿ\r\nå®ƒç”±ä¸¤éƒ¨åˆ†ç»„æˆ\r\n\r\n- target\r\n  target å¾ˆå¥½ç†è§£å°±æ˜¯æˆ‘ä»¬æ·»åŠ çš„å…ƒç´ \r\n\r\n- contentRect\r\n  contentRect å…¶å®å°±æ˜¯ä¸€ä¸ªç›’å­ä¿¡æ¯ï¼Œå®ƒçš„ç±»å‹æ˜¯ [DOMRectReadOnly](https://developer.mozilla.org/zh-CN/docs/Web/API/DOMRectReadOnly),æœ‰ä»¥ä¸‹å‡ ä¸ªå±æ€§\r\n  - bottom\r\n    è¿”å›çš„åº•éƒ¨åæ ‡å€¼ï¼ˆé€šå¸¸ä¸ y + é«˜åº¦ç›¸åŒï¼‰\r\n  - height\r\n    é«˜åº¦\r\n  - width\r\n    å®½åº¦\r\n  - left\r\n    è¿”å›çš„å·¦åæ ‡å€¼ï¼ˆé€šå¸¸ä¸ x ç›¸åŒï¼‰\r\n  - right\r\n    è¿”å›çš„å³åæ ‡å€¼ï¼ˆé€šå¸¸ä¸ x + width ç›¸åŒï¼‰\r\n  - top\r\n    è¿”å›çš„é¡¶éƒ¨åæ ‡å€¼ï¼ˆé€šå¸¸ä¸ y ç›¸åŒï¼‰\r\n  - x\r\n    åŸç‚¹çš„ x åæ ‡\r\n  - y\r\n    åŸç‚¹çš„ y åæ ‡\r\n\r\n## æ–¹æ³•\r\n\r\n### observe\r\n\r\n```js\r\nresizeObserver.observe(target);\r\n```\r\n\r\nä¸Šé¢çš„ç¤ºä¾‹ä¸­ä¹Ÿæœ‰ç”¨åˆ°è¿™ä¸ªæ–¹æ³•ï¼Œç”¨äºæ·»åŠ ç›‘å¬çš„å…ƒç´ ï¼Œæ³¨æ„ target çš„ç±»å‹å¿…é¡»æ˜¯ Element æˆ– SVGElement å¼•ç”¨ã€‚\r\n\r\n### disconnect\r\n\r\n```js\r\nresizeObserver.disconnect();\r\n```\r\n\r\nåœæ­¢å’Œå–æ¶ˆç›®æ ‡å¯¹è±¡ä¸Šæ‰€æœ‰å¯¹ Element æˆ– SVGElement çš„ç›‘å¬ã€‚\r\n\r\n### unobserve\r\n\r\n```js\r\nresizeObserver.unobserve(target);\r\n```\r\n\r\næ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œåœæ­¢å¯¹æŒ‡å®šç›®æ ‡çš„ç›‘å¬ï¼Œtarget çš„ç±»å‹ä¸º Element æˆ– SVGElement å¼•ç”¨\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/26/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/26/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    },
    {
      "url": "https://api.github.com/repos/bosens-China/blog/issues/18",
      "repository_url": "https://api.github.com/repos/bosens-China/blog",
      "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/18/labels{/name}",
      "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/18/comments",
      "events_url": "https://api.github.com/repos/bosens-China/blog/issues/18/events",
      "html_url": "https://github.com/bosens-China/blog/issues/18",
      "id": 479907836,
      "node_id": "MDU6SXNzdWU0Nzk5MDc4MzY=",
      "number": 18,
      "title": "æ— æ•ˆçš„height100%ï¼Ÿ",
      "user": {
        "login": "bosens-China",
        "id": 39508895,
        "node_id": "MDQ6VXNlcjM5NTA4ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bosens-China",
        "html_url": "https://github.com/bosens-China",
        "followers_url": "https://api.github.com/users/bosens-China/followers",
        "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
        "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
        "organizations_url": "https://api.github.com/users/bosens-China/orgs",
        "repos_url": "https://api.github.com/users/bosens-China/repos",
        "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bosens-China/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1371686610,
          "node_id": "MDU6TGFiZWwxMzcxNjg2NjEw",
          "url": "https://api.github.com/repos/bosens-China/blog/labels/css%20%E7%9B%B8%E5%85%B3",
          "name": "css ç›¸å…³",
          "color": "42b883",
          "default": false,
          "description": "css æŠ€å·§å’ŒåŸºç¡€ä¸ºä¸»"
        }
      ],
      "state": "open",
      "locked": false,
      "assignee": null,
      "assignees": [],
      "milestone": null,
      "comments": 0,
      "created_at": "2019-08-13T00:34:13Z",
      "updated_at": "2019-08-13T00:34:13Z",
      "closed_at": null,
      "author_association": "OWNER",
      "active_lock_reason": null,
      "body": "ä¹‹æ‰€ä»¥å†™ heightï¼Œæ˜¯å› ä¸ºå®ƒå‡ºç°çš„åœºæ‰€æ¯”è¾ƒå¤š\r\n``` css\r\nbody {\r\n  height: 100%;\r\n}\r\n```\r\nä¸çŸ¥é“ä½ ä»¬æœ‰æ²¡æœ‰è¿™æ ·å†™è¿‡ css å±æ€§ï¼Œä¸è¿‡å¾ˆé—æ†¾è¿™æ˜¯æ— æ•ˆçš„ã€‚\r\n\r\nçˆ¶çº§æ²¡æœ‰ç»™å®šæ˜ç¡®çš„é«˜åº¦ä¹ˆï¼Ÿ è¿™æ ·è¯´æœ‰ä¸€å®šæ­£ç¡®æ€§ï¼Œä¸è¿‡ä¸å¤Ÿå…¨é¢ï¼Œåœ¨ height çš„è§„èŒƒä¸­è§„å®šäº†ä¸¤ç§æƒ…å†µ 100%å¯ä»¥è§£æå‡ºæ¥\r\n\r\n1. çˆ¶çº§ç»™å®šæ˜ç¡®çš„é«˜åº¦\r\nè¿™ä¸ªæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œå¹³æ—¶æˆ‘ä»¬ä¹Ÿæ˜¯è¿™æ ·å†™çš„ æ¯”å¦‚ä¸Šé¢ body æ²¡æœ‰ç”Ÿæ•ˆå°±æ˜¯å› ä¸ºæ²¡æœ‰æŒ‡å®š html çš„é«˜åº¦ï¼Œæ‰€ä»¥è¦è¿™æ ·å†™\r\n``` css\r\nhtml,\r\nbody {\r\n  height: 100%;\r\n}\r\n```\r\n\r\n2. ä½¿ç”¨ç»å¯¹å®šä½å…ƒç´ \r\n``` css\r\n.box {\r\n  position: relative;\r\n  .child {\r\n    position: absolute;\r\n    height: 100%;\r\n    widows: 100%;\r\n  }\r\n}\r\n```\r\nè¿™æ ·å°±è·å–åˆ°äº†é«˜åº¦ï¼Œä¸è¿‡æ³¨æ„ç»å¯¹å®šä½è·å–çš„é«˜åº¦ä¸çˆ¶çº§ç»™å®šé«˜åº¦æœ‰ä¸€å®šåŒºåˆ«\r\n\r\n## åŒºåˆ«\r\ncss æ˜¯å­˜åœ¨ç›’å­æ¨¡å‹çš„ï¼Œå¹³æ—¶é«˜åº¦å’Œå®½åº¦éƒ½æ˜¯ä½œç”¨åœ¨ `content-box` ä¸Šçš„ï¼Œè€Œä¸Šé¢è¯´çš„ç¬¬ä¸€ç§æ–¹å¼ï¼Œé«˜åº¦è·å–åˆ°çš„å°±æ˜¯çˆ¶çº§ content ç›’å­çš„é«˜åº¦ï¼Œæ€ä¹ˆæ¥è¯æ˜å‘¢ï¼Ÿ `box-sizing` å¯ä»¥æ”¹å˜ä½œç”¨é«˜åº¦å’Œå®½åº¦çš„ç›’å­ï¼Œæˆ‘ä»¬æ¥ç”¨è¿™ä¸ªå®éªŒã€‚\r\n``` html\r\n<div class=\"box\">\r\n  <div class=\"child\"></div>\r\n</div>\r\n.box {\r\n  width: 180px;\r\n  background: #ddd;\r\n  height: 150px;\r\n  padding: 30px;\r\n  box-sizing: border-box;\r\n  .child {\r\n    height: 100%;\r\n    background: #666;\r\n  }\r\n}\r\n```\r\nå¯ä»¥å°†ä¸Šé¢ä»£ç å¤åˆ¶åˆ°æœ¬åœ°è¿è¡Œä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°å­å…ƒç´ çš„é«˜åº¦å¹¶æ²¡æœ‰å ç”¨çˆ¶å…ƒç´ çš„ 100%ã€‚ æ”¹å†™ä¸€ä¸‹ï¼Œæ”¹æˆç»å¯¹å®šä½æ¥å®ç°\r\n``` css\r\n.box {\r\n  width: 180px;\r\n  background: #ddd;\r\n  height: 150px;\r\n  padding: 30px;\r\n  box-sizing: border-box;\r\n  position: relative;\r\n  border: 20px solid;\r\n  .child {\r\n    height: 100%;\r\n    background: #666;\r\n    position: absolute;\r\n    width: 100%;\r\n  }\r\n}\r\n```\r\nå¯¹æ¯”ä¸€ä¸‹å¯ä»¥çœ‹åˆ°ç»å¯¹å®šä½çš„é«˜åº¦æ˜¯åŒ…å«` padding` åŒºåŸŸçš„\r\n\r\næœ€åä»¥ä¸€ä¸ªç¤ºä¾‹ç»“å°¾\r\n``` html\r\n<div class=\"box\">\r\n  <a href=\"javascript:\" class=\"nav\"></a>\r\n  <a href=\"javascript:\" class=\"nav nav1\"></a>\r\n  <img src=\"https://demo.cssworld.cn/images/common/l/1.jpg\" alt=\"\" />\r\n</div>\r\n.box {\r\n  display: inline-block;\r\n  position: relative;\r\n  .nav {\r\n    position: absolute;\r\n    height: 100%;\r\n    left: 0;\r\n    width: 50%;\r\n    opacity: 0.7;\r\n    background: #ddd;\r\n  }\r\n  .nav1 {\r\n    left: 50%;\r\n    background: #34538b;\r\n  }\r\n}\r\n```\r\nå€ŸåŠ©ç»å¯¹å®šä½å®ç°äº†é«˜åº¦è‡ªé€‚åº”çš„æ•ˆæœ\r\n\r\n## å‚è€ƒ\r\nã€Šcss ä¸–ç•Œã€‹",
      "reactions": {
        "url": "https://api.github.com/repos/bosens-China/blog/issues/18/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/18/timeline",
      "performed_via_github_app": null,
      "state_reason": null
    }
  ],
  "labelsMap": [
    [
      "1473940161",
      [
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/100",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/100/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/100/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/100/events",
          "html_url": "https://github.com/bosens-China/blog/issues/100",
          "id": 1955954444,
          "node_id": "I_kwDOCzPAy850lX8M",
          "number": 100,
          "title": "resso æºç è§£æ",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1473940161,
              "node_id": "MDU6TGFiZWwxNDczOTQwMTYx",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3",
              "name": "æ¡†æ¶ç›¸å…³",
              "color": "42b883",
              "default": false,
              "description": "ç›®å‰Vueå’ŒReactä¸ºä¸»"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2023-10-22T15:57:10Z",
          "updated_at": "2023-10-22T15:57:25Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "åœ¨ä¹‹å‰ç”¨ React å†™ä¸€äº›å°é¡¹ç›®çš„æ—¶å€™æœ‰æ—¶ä¹Ÿéœ€è¦ç”¨åˆ°çŠ¶æ€ç®¡ç†ï¼Œä½†æ˜¯ç”¨ Redux æœ‰ä¸€ç§â€œå¤§æå°ç”¨â€æ„Ÿè§‰ï¼Œå°±åœ¨å¯»æ‰¾æœ‰æ²¡æœ‰å¾ˆç²¾å·§çš„å®ç°ï¼Œæœ€å¥½æ˜¯å“åº”å¼çš„ï¼Œæœ€åæœç´¢äº†ä¸€ç•ªåœ¨ Github å‘ç°äº†ä¸¤ä¸ªæ»¡è¶³æˆ‘éœ€æ±‚çš„åº“ï¼š\r\n\r\n- [valtio](https://github.com/pmndrs/valtio)\r\n- [resso](https://github.com/nanxiaobei/resso)\r\n\r\n```jsx\r\n// valtio\r\nimport resso from 'resso';\r\nimport { proxy, useSnapshot } from 'valtio';\r\n\r\nconst state = proxy({ count: 0, text: 'hello' });\r\n\r\nfunction Counter() {\r\n  const snap = useSnapshot(state);\r\n  return (\r\n    <div>\r\n      {snap.count}\r\n      <button onClick={() => ++state.count}>+1</button>\r\n    </div>\r\n  );\r\n}\r\n// resso\r\nconst store = resso({ count: 0, text: 'hello' });\r\n\r\nfunction App() {\r\n  const { count } = store; // data used in UI â†’ must destructure at top first ğŸ¥·\r\n  return (\r\n    <>\r\n      {count}\r\n      <button onClick={() => (store.count += 1)}>+</button>\r\n    </>\r\n  );\r\n}\r\n```\r\n\r\nç»“åˆå®˜æ–¹ç»™å‡ºçš„æ–‡æ¡£ç¤ºä¾‹è¿˜æ˜¯æœ€ç»ˆåœ¨é¡¹ç›®ç”¨äº† ressoï¼Œæ‰€ä»¥å°±æœ‰äº†è¿™ç¯‡æ–‡ç« ï¼ŒåŒæ—¶ä½œè€…åœ¨çŸ¥ä¹ä¹Ÿä¸“é—¨å†™äº†ä¸€ç¯‡æ–‡ç« ä»‹ç»ä»–çš„æ€è·¯å®ç°[ressoï¼Œä¸–ç•Œä¸Šæœ€ç®€å•çš„ React çŠ¶æ€ç®¡ç†å™¨](https://zhuanlan.zhihu.com/p/468417292)ã€‚æœ‰å…´è¶£å°ä¼™ä¼´å¯ä»¥ä¸“é—¨å»ç…ç…ã€‚\r\n\r\nä¸è¿‡åœ¨é˜…è¯»æºç å®ç°ï¼Œéœ€è¦å…ˆäº†è§£ä¸¤ä¸ª APIï¼š\r\n\r\n- useSyncExternalStore\r\n- ReactDOM.unstable_batchedUpdates\r\n\r\n## useSyncExternalStore\r\n\r\nè¿™ä¸ª API å¯èƒ½ä½ å®Œå…¨é™Œç”Ÿï¼Œäº‹å®ä¸Šæˆ‘ä¹Ÿæ˜¯ï¼Œåé¢ä¸“é—¨å»å®˜æ–¹æ–‡æ¡£æŸ¥é˜…äº†ä¸€ä¸‹ [useSyncExternalStore](https://zh-hans.react.dev/reference/react/useSyncExternalStore)ï¼Œå®ƒçš„ä½œç”¨å¯ä»¥ç®€å•ç†è§£ä¸ºè®¢é˜…å¤–éƒ¨çš„ storeï¼Œä¾‹å¦‚æˆ‘ä»¬åœ¨ä½¿ç”¨ redux ä¹‹ç±»çš„æ—¶å€™ï¼Œå®ƒå¯èƒ½ä¸æ˜¯é€šè¿‡ useState çš„å½¢å¼è€Œæ˜¯åœ¨å¤–éƒ¨ç»´æŠ¤äº†ä¸€ä¸ª storeï¼Œç„¶åç»“åˆå‘å¸ƒè®¢é˜…æ¨¡å¼æ¥å®ç°æ•°æ®çš„æ›´æ–°ã€‚\r\n\r\nä¸‹é¢ç”¨å®˜æ–¹ç»™å‡ºçš„åˆ‡æ¢ç¦»çº¿å’Œåœ¨çº¿ hooks ä¾‹å­å¿«é€Ÿçœ‹ä¸‹è¿™ä¸ª api\r\n\r\n```js\r\nimport { useSyncExternalStore } from 'react';\r\n\r\nfunction getSnapshot() {\r\n  return navigator.onLine;\r\n}\r\nfunction subscribe(callback) {\r\n  window.addEventListener('online', callback);\r\n  window.addEventListener('offline', callback);\r\n  return () => {\r\n    window.removeEventListener('online', callback);\r\n    window.removeEventListener('offline', callback);\r\n  };\r\n}\r\n\r\nfunction ChatIndicator() {\r\n  const isOnline = useSyncExternalStore(subscribe, getSnapshot);\r\n  // ...\r\n}\r\n```\r\n\r\nè¿™é‡Œæ¯æ¬¡ online æˆ–è€… offline å‘ç”Ÿå˜åŒ–æ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œè€Œæ¯æ¬¡æ‰§è¡Œ getSnapshot å¦‚æœè¿”å›å€¼ä¸åŒï¼Œå°±ä¼šè®© React é‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚\r\n\r\n> æ¯æ¬¡å¯¹æ¯” getSnapshot è¿”å›å€¼ä½¿ç”¨çš„æ˜¯ Object.isã€‚\r\n\r\n## unstable_batchedUpdates\r\n\r\nä¹‹æ‰€ä»¥ä»‹ç»è¿™ä¸ª API å…¶å®å’Œæ€§èƒ½ä¼˜åŒ–æœ‰å…³ï¼Œåœ¨ React18 ä¹‹å‰å¯¹äºéåŒæ­¥ä»£ç å’Œä¸æ˜¯ react äº‹ä»¶å¤„ç†å‡½æ•° setState ä¸ä¼šè¿›è¡Œæ‰¹å¤„ç†ï¼Œä¾‹å¦‚ä¸‹é¢ä»£ç ï¼š\r\n\r\n```js\r\nimport React, { useEffect, useState } from 'react';\r\n\r\nconst App: React.FC = () => {\r\n  console.log('Appç»„ä»¶æ¸²æŸ“äº†ï¼');\r\n  const [count1, setCount1] = useState(0);\r\n  const [count2, setCount2] = useState(0);\r\n  useEffect(() => {\r\n    document.body.addEventListener('click', () => {\r\n      setCount1((count) => count + 1);\r\n      setCount2((count) => count + 1);\r\n    });\r\n    // åœ¨åŸç”Ÿjsäº‹ä»¶ä¸­ä¸ä¼šè¿›è¡Œæ‰¹å¤„ç†\r\n  }, []);\r\n  return (\r\n    <>\r\n      <div>count1ï¼š {count1}</div>\r\n      <div>count2ï¼š {count2}</div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default App;\r\n```\r\n\r\nè¿™é‡Œæ¯æ¬¡ç‚¹å‡»ç»„ä»¶éƒ½ä¼šæ¸²æŸ“ä¸¤æ¬¡ï¼Œå…±è®¡è¾“å‡ºå…­æ¬¡ console.log ä¿¡æ¯ã€‚\r\n\r\nä½†æ˜¯æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥æ”¹å˜å‘¢ï¼Ÿä¸‹é¢ç”¨ ReactDOM.unstable_batchedUpdates é‡å†™ä¸Šé¢è¿™ä¸ªä¾‹å­\r\n\r\n```js\r\nimport React, { useEffect, useState } from 'react';\r\n\r\nconst App: React.FC = () => {\r\n  console.log('Appç»„ä»¶æ¸²æŸ“äº†ï¼');\r\n  const [count1, setCount1] = useState(0);\r\n  const [count2, setCount2] = useState(0);\r\n  useEffect(() => {\r\n    document.body.addEventListener('click', () => {\r\n      ReactDOM.unstable_batchedUpdates(() => {\r\n        setCount1((count) => count + 1);\r\n        setCount2((count) => count + 1);\r\n      });\r\n    });\r\n  }, []);\r\n  return (\r\n    <>\r\n      <div>count1ï¼š {count1}</div>\r\n      <div>count2ï¼š {count2}</div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default App;\r\n```\r\n\r\nè¿™æ ·å°±ä¼šæ¯æ¬¡æ›´æ–°çŠ¶æ€ç»„ä»¶åªæ¸²æŸ“ä¸€æ¬¡äº†ï¼Œæœ€åæç¤ºä¸€ä¸‹ **unstable_batchedUpdates æ˜¯åŒæ­¥ä»£ç **ã€‚\r\n\r\n## å®ç°æ€æƒ³\r\n\r\nåœ¨ä»£ç é˜…è¯»ä¹‹å‰æœ‰å¿…è¦è¯´ä¸‹å®ƒçš„è®¾è®¡å®ç°æ€æƒ³æ˜¯å•¥å­ã€‚\r\n\r\nåœ¨ä½¿ç”¨ redux çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ›´æ–°å¯èƒ½æ˜¯é€šè¿‡ `dispatch` è¿™æ ·çš„ä¸€ä¸ªå‡½æ•°æ¥å®Œæˆï¼Œä½†æ˜¯æœ‰æ²¡æœ‰å…¶ä»–æ–¹å¼å‘¢ï¼ŸES6 å¼•å…¥äº† proxy å¯ä»¥å¯¹å¯¹è±¡çš„å€¼è¿›è¡ŒåŠ«æŒï¼Œæ¯æ¬¡æ›´æ–°éƒ½å¯ä»¥è·å–åˆ°å¯¹åº”çš„ key å’Œ valueã€‚\r\n\r\n> äº‹å®ä¸Šåœ¨ Vue2 ä¸­ä¹Ÿå¯ä»¥é€šè¿‡ç›‘å¬å±æ€§çš„ seter æ¥å®ç°ç›‘å¬ï¼Œè™½ç„¶æ•ˆæœä¸å®Œæ•´ã€‚\r\n\r\nè¯•ç€å®šä¹‰ä¸€ä¸ª store\r\n\r\n```js\r\nexport const store = { a: 123, b: 456 };\r\n```\r\n\r\nåœ¨ç»„ä»¶ä¸­åˆ†åˆ«ä½¿ç”¨\r\n\r\n```js\r\n// ç»„ä»¶ A\r\nconst {a} = store;\r\n\r\n// ç»„ä»¶B\r\nconst {a,b} = store;\r\n```\r\n\r\næ›´æ–°æ–¹å¼ä¹Ÿå¾ˆç®€å•ï¼Œç›´æ¥æ›´æ”¹ store å±æ€§å°±è¡Œï¼Œä¾‹å¦‚ï¼š\r\n\r\n```js\r\n// ç»„ä»¶ A å’Œ B éƒ½å¾—åˆ°æ›´æ–°\r\nstore.b = 'b';\r\n```\r\n\r\né‚£ä¹ˆè¦æ€ä¹ˆå®ç°ä¸Šè¿°æˆ‘ä»¬å®šä¹‰çš„è¿™æ ·ä¸€ä¸ªä½¿ç”¨æ–¹å¼å‘¢ï¼Ÿ\r\n\r\nä½œè€…æ˜¯é€šè¿‡ proxy æ¯æ¬¡ get çš„æ—¶å€™è‡ªåŠ¨æŠŠå¯¹åº”çš„ key å€¼ä¿å­˜åˆ° map é”®åï¼Œè€Œå¯¹åº”çš„ setState ä½œä¸º valueï¼Œä¾‹å¦‚åœ¨ç»„ä»¶ A å’Œ B å®ƒä»¬å¯èƒ½æ˜¯è¿™æ ·å‚¨å­˜çš„ã€‚\r\n\r\n```js\r\n// ç»„ä»¶ A\r\nconst [a, setA] = useState(store.a);\r\n// ç»„ä»¶ B\r\nconst [a, setA] = useState(store.a);\r\nconst [b, setB] = useState(store.b);\r\n// map\r\nconst listenerMap = {\r\n  a: [setA, setA],\r\n  b: [setB],\r\n};\r\n\r\n```\r\n\r\nä¹‹åç›‘å¬ä¿®æ”¹çš„å±æ€§ï¼Œå¦‚æœæœ‰æ›´æ–°ç›´æ¥è°ƒç”¨å¯¹åº” key ä¸‹çš„ setState å°±å¯ä»¥åšåˆ°æ›´æ–°ã€‚\r\n``` js\r\n// å‡è®¾æ›´æ–° A\r\nlistenerMap.a.forEach((setA) => setA(store.a));\r\n```\r\n\r\n## æºç åˆ†æ\r\n\r\nä½œè€…æ˜¯é€šè¿‡ TypeScript æ¥å®ç°çš„ï¼Œä½†æ˜¯è¿™é‡Œå…³æ³¨å…·ä½“çš„å®ç°ï¼Œå¯¹äºç±»å‹ç›´æ¥åˆ é™¤äº†ï¼Œå¦‚æœæœ‰éœ€è¦å°ä¼™ä¼´å¯ä»¥è‡ªè¡Œå»é˜…è¯»ã€‚\r\n\r\nå› ä¸ºä»£ç é‡ä¸æ˜¯å¾ˆå¤§ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥é€šè¿‡è´´ä»£ç +æ³¨é‡Šçš„å½¢å¼æ¥è¿›è¡Œè®²è§£ã€‚\r\n\r\n```js\r\n// è¿™é‡Œå› ä¸ºæ˜¯çŠ¶æ€åº“ï¼Œéœ€è¦è€ƒè™‘ä¸åŒçš„ React ç‰ˆæœ¬ï¼ŒReact18 å¯ä»¥ç›´æ¥ import React æ¥è·å– useSyncExternalStore\r\nimport { useSyncExternalStore } from 'use-sync-external-store/shim';\r\n\r\n// åˆ¤æ–­æ˜¯å¦ä¸ºå¼€å‘ç¯å¢ƒ\r\nconst __DEV__ = process.env.NODE_ENV !== 'production';\r\n\r\n// åˆ¤æ–­æ˜¯å¦ä¸ºå¯¹è±¡ï¼Œ {} è¿™æ ·çš„ï¼Œé€šç”¨çš„ mapã€set ä¹‹ç±»çš„å¯¹è±¡éƒ½ç»Ÿç»Ÿä¸å¯ä»¥\r\nconst isObj = (val) => {\r\n  return Object.prototype.toString.call(val) === '[object Object]';\r\n};\r\n\r\n// è¿™é‡Œæ˜¯ä¸€ä¸ªæ ‡è¯†ç¬¦åé¢è®²è§£\r\nlet isGetStateInMethod = false;\r\n\r\nlet run = (fn) => {\r\n  fn();\r\n};\r\n\r\nconst resso = (obj) => {\r\n  // åˆå§‹æ£€æŸ¥\r\n  if (__DEV__ && !isObj(obj)) {\r\n    throw new Error('object required');\r\n  }\r\n\r\n  /*\r\n   * å®ƒå‚¨å­˜çš„å½¢å¼ä¸º {[key:string]: Set()}\r\n   */\r\n  const state = {};\r\n  /*\r\n   * å®ƒå‚¨å­˜çš„å½¢å¼ä¸º {key: Function}\r\n   */\r\n  const methods = {};\r\n\r\n  Object.keys(obj).forEach((key) => {\r\n    const initVal = obj[key];\r\n    // ç»™ methods æ·»åŠ å±æ€§\r\n    if (initVal instanceof Function) {\r\n      methods[key] = (...args) => {\r\n        isGetStateInMethod = true;\r\n        const res = initVal(...args);\r\n        isGetStateInMethod = false;\r\n        return res;\r\n      };\r\n      return;\r\n    }\r\n    // ç»™ state æ·»åŠ å±æ€§\r\n    const listeners = new Set();\r\n\r\n    state[key] = {\r\n      // æ·»åŠ  getSnapshot åˆ° listeners\r\n      subscribe: (listener) => {\r\n        listeners.add(listener);\r\n        return () => listeners.delete(listener);\r\n      },\r\n      // æ•°æ®å¿«ç…§\r\n      getSnapshot: () => obj[key],\r\n      // æ›´æ–°æ–¹æ³•\r\n      setSnapshot: (val) => {\r\n        if (val !== obj[key]) {\r\n          obj[key] = val;\r\n          run(() => listeners.forEach((listener) => listener()));\r\n        }\r\n      },\r\n      useSnapshot: () => {\r\n        return useSyncExternalStore(\r\n          state[key].subscribe,\r\n          state[key].getSnapshot,\r\n          state[key].getSnapshot\r\n        );\r\n      },\r\n    };\r\n  });\r\n\r\n  const setState = (key, val) => {\r\n    // åªæ›´æ–°åˆå§‹ obj å®šä¹‰å±æ€§\r\n    if (key in obj) {\r\n      if (key in state) {\r\n        // åˆ¤æ–­æ˜¯å±æ€§æ›´æ–°è¿˜æ˜¯å‡½æ•°è°ƒç”¨æ›´æ–°\r\n        const newVal = val instanceof Function ? val(obj[key]) : val;\r\n        // è°ƒç”¨ä¸Šæ–‡çš„ setSnapshot\r\n        state[key].setSnapshot(newVal);\r\n      } else if (__DEV__) {\r\n        throw new Error(`\\`${key}\\` is a method, can not update`);\r\n      }\r\n    } else if (__DEV__) {\r\n      throw new Error(`\\`${key}\\` is not initialized in store`);\r\n    }\r\n  };\r\n\r\n  return new Proxy(() => undefined, {\r\n    get: (_target, key) => {\r\n      if (key in methods) {\r\n        return methods[key];\r\n      }\r\n      // é‡ç‚¹è®²ä¸‹è¿™æ®µä»£ç ï¼Œé¦–å…ˆåˆ¤æ–­æ˜¯å¦ä¸º stateï¼Œä¹Ÿå°±æ˜¯ä¸Šæ–‡ä¸­åˆå§‹ä¼ é€’çš„å¯¹è±¡éå‡½æ•°éƒ¨åˆ†\r\n      if (key in state) {\r\n        // è¿™é‡Œåˆ¤æ–­æ˜¯å¦ isGetStateInMethod ä¸»è¦æ˜¯å› ä¸ºå¯èƒ½å­˜åœ¨åœ¨ methods ä¸­æ¥å¼•ç”¨ store ä¸­çš„å±æ€§ï¼Œæ‰€ä»¥å¦‚æœæ˜¯è¿™ç§æƒ…å†µç›´æ¥è¿”å›\r\n        if (isGetStateInMethod) {\r\n          return obj[key];\r\n        }\r\n        // è¿™é‡Œä»å¤–éƒ¨æ‹¿åˆ°å¯¹åº”çš„å€¼è¿”å›ï¼Œå¦‚æœä¸æ˜¯åœ¨æœ€å¤–å±‚ä½¿ç”¨ï¼ˆReact é™åˆ¶ï¼Œä¸å¯ä»¥åœ¨å›è°ƒä¹‹ç±»çš„å‡½æ•°å†…ä½¿ç”¨useä¹‹ç±»æ–¹æ³•ï¼Œè¿™é‡Œç›´æ¥è¿”å› obj ä¸‹çš„å€¼ï¼‰\r\n        try {\r\n          return state[key].useSnapshot();\r\n        } catch (err) {\r\n          return obj[key];\r\n        }\r\n      }\r\n      if (__DEV__) {\r\n        if (key !== 'prototype' && key !== 'name' && key !== 'displayName') {\r\n          throw new Error(`\\`${key}\\` is not initialized in store`);\r\n        }\r\n      }\r\n    },\r\n    // è¿™é‡Œç›‘å¬å±æ€§å˜åŠ¨ï¼Œä¾‹å¦‚è¿™ç§å½¢å¼è°ƒç”¨æ›´æ–° store.count = 60;\r\n    set: (_target, key, val) => {\r\n      setState(key, val);\r\n      return true;\r\n    },\r\n\r\n    /* \r\n    * appleæ˜¯æŒ‡å‡½æ•°è°ƒç”¨ï¼Œå®˜æ–¹æ–‡æ¡£æ˜¯æ”¯æŒä¸‹é¢è¿™ç§å½¢å¼æ¥æ›´æ–°çš„\r\n    * store({ count: 60, text: 'world' });\r\n    * å‚æ•°åˆ†åˆ«æ˜¯ç›®æ ‡å¯¹è±¡ã€ç›®æ ‡å¯¹è±¡çš„ä¸Šä¸‹æ–‡å¯¹è±¡ï¼ˆthisï¼‰å’Œç›®æ ‡å¯¹è±¡çš„å‚æ•°æ•°ç»„\r\n    * è¿™é‡Œä¹‹æ‰€ä»¥è§£æ„æˆ [firstArg, oneAction] å½¢å¼æ˜¯å› ä¸ºï¼Œé™¤äº†ä¸Šé¢è¿™ç§æ–¹å¼è¿˜å¯ä»¥\r\n      store('count', (prev) => prev + 1); \r\n      store((prev) => ({\r\n        count: prev.count + 1,\r\n        text: prev.text === 'hello' ? 'world' : 'hello',\r\n      }));\r\n    */\r\n    apply: (_target, _thisArg, [firstArg, oneAction]) => {\r\n      // store('count', (prev) => prev + 1);\r\n      if (typeof firstArg === 'string') {\r\n        setState(firstArg, oneAction);\r\n        return;\r\n      }\r\n      // store({ count: 60, text: 'world' });\r\n      if (isObj(firstArg)) {\r\n        const newObj = firstArg;\r\n        Object.keys(newObj).forEach((key) => {\r\n          setState(key, newObj[key]);\r\n        });\r\n        return;\r\n      }\r\n      //  store((prev) => ({\r\n      //   count: prev.count + 1,\r\n      //   text: prev.text === 'hello' ? 'world' : 'hello',\r\n      // }));\r\n      if (typeof firstArg === 'function') {\r\n        const newObj = firstArg(obj);\r\n        Object.keys(newObj).forEach((key) => {\r\n          setState(key, newObj[key]);\r\n        });\r\n      }\r\n    },\r\n  });\r\n};\r\n\r\n// è¿™é‡Œæ˜¯ç»™ç”¨æˆ·æš´éœ²é…ç½®ï¼Œä¾‹å¦‚ä¸Šé¢è¯´çš„ï¼Œä½ æƒ³è¦åœ¨å¼‚æ­¥ä»£ç ä¸­æ‰§è¡Œæ‰¹é‡æ›´æ–° unstable_batchedupdates\r\nresso.config = ({ batch }) => {\r\n  run = batch;\r\n};\r\n\r\nexport default resso;\r\n```\r\n\r\n## æœ€å\r\n\r\nè¿™æ˜¯ä¸€ç¯‡å¾ˆæ—©ä¹‹å‰å°±æƒ³å†™çš„æ–‡ç« ï¼Œä¸€ç›´æ‹–åˆ°ç°åœ¨æ‰å®Œæˆï¼Œæœ€åå¦‚æœæœ‰ç†è§£é”™è¯¯æˆ–è€…æ–‡ç¬”é”™è¯¯æ¬¢è¿æŒ‡å‡ºï¼ŒåŒæ—¶æœ‰å¯ä»¥å†…æ¨çš„å²—ä½æ¬¢è¿æ»´æ»´ã€‚\r\n\r\næ–‡ç« å‚è€ƒï¼š\r\n\r\n- [React æ€§èƒ½ä¼˜åŒ–ä¹‹ unstable_batchedupdatesï¼ˆbatchï¼‰ç”¨æ³•è¯¦è§£](https://juejin.cn/post/6860308689313693709)\r\n- [React18 æ–°ç‰¹æ€§è§£è¯» & å®Œæ•´ç‰ˆå‡çº§æŒ‡å—](https://juejin.cn/post/7094037148088664078)\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/100/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/100/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/96",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/96/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/96/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/96/events",
          "html_url": "https://github.com/bosens-China/blog/issues/96",
          "id": 1672296843,
          "node_id": "I_kwDOCzPAy85jrTmL",
          "number": 96,
          "title": "hookä¸‹å¦‚ä½•ä¹¦å†™å‘å¸ƒè®¢é˜…",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1473940161,
              "node_id": "MDU6TGFiZWwxNDczOTQwMTYx",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3",
              "name": "æ¡†æ¶ç›¸å…³",
              "color": "42b883",
              "default": false,
              "description": "ç›®å‰Vueå’ŒReactä¸ºä¸»"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 1,
          "created_at": "2023-04-18T03:43:26Z",
          "updated_at": "2023-06-01T08:44:54Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "è¿™ç¯‡æ–‡ç« çš„æ€è·¯æ¥æºä¸º [ahooks](https://github.com/alibaba/hooks/blob/master/packages/hooks/src/useEventEmitter/index.ts)ï¼Œå› ä¸º react å·²ç»æœ‰ç›¸å¯¹åº”çš„å®ç°äº†ï¼Œæ‰€ä»¥è¿™é‡Œä¸»è¦ä»‹ç» vue ä¸‹å¦‚ä½•å®ç°ä¸€ä¸ª hook çš„å‘å¸ƒè®¢é˜…ã€‚\r\n\r\nå‡è®¾æœ‰ä¸€ä¸ªéœ€æ±‚ï¼Œå½“ä»·æ ¼å‘ç”Ÿæ”¹å˜çš„æ—¶å€™åˆ·æ–°åˆ—è¡¨ï¼Œåœ¨ vue ä¸­å¾ˆè‡ªç„¶è€Œç„¶æƒ³åˆ°è°ƒç”¨ watch è§‚å¯Ÿï¼Œä½†æ˜¯è¿™æ ·çš„è°ƒç”¨è¿˜æ˜¯æœ‰ç‚¹ç¹çã€‚ä¾‹å¦‚ä¸‹é¢ä¸€æ®µä¼ªä»£ç \r\n\r\n```js\r\nimport { ref, watch } from 'vue';\r\n\r\nconst isChange = ref(false);\r\nconst refreshList = () => {\r\n  // çœç•¥\r\n  isChange.value = false;\r\n};\r\n\r\nconst onClick = () => {\r\n  isChange.value = true;\r\n};\r\n\r\nwatch(isChange, (val) => {\r\n  if (!val) {\r\n    return;\r\n  }\r\n  refreshList();\r\n});\r\n```\r\n\r\nä½†æ˜¯ä»”ç»†è§‚å¯Ÿä¸€ä¸‹ï¼Œå…¶å®æˆ‘ä»¬åªæ˜¯æƒ³è®©å˜åŒ–çš„æ—¶å€™é€šçŸ¥ä¸€ä¸‹ï¼Œç„¶åè°ƒç”¨ refreshList å³å¯ã€‚\r\n\r\nä¸”æˆ‘ä»¬ä¹Ÿä¸å¸Œæœ›æ¯æ¬¡éƒ½å¤åˆ¶è¿™æ ·ä¸€æ®µä»£ç åœ¨å…¶ä»–ç»„ä»¶ä¸­é‡å¤ä½¿ç”¨ï¼ŒåŸºäºä¸Šé¢çš„åœºæ™¯æˆ‘ä»¬å¾ˆå®¹æ˜“æƒ³åˆ°å¯ä»¥å†™ä¸€ä¸ªå‘å¸ƒè®¢é˜…çš„æ¨¡å—æ¥å®ç°æˆ‘ä»¬éœ€æ±‚ã€‚\r\n\r\n## EventEmitter\r\n\r\n```js\r\nclass EventEmitter {\r\n  subscriptions = new Set();\r\n\r\n  emit = (val) => {\r\n    for (const subscription of this.subscriptions) {\r\n      subscription(val);\r\n    }\r\n  };\r\n\r\n  useSubscription = (callback) => {\r\n    this.subscriptions.add(subscription);\r\n  };\r\n}\r\n```\r\n\r\nä¸Šé¢çš„å‘å¸ƒè®¢é˜…æ¨¡å—å¾ˆç®€å•ï¼Œ`useSubscription` æ¥è®¢é˜…ï¼Œ`emit` æ¥è¿›è¡Œé€šçŸ¥ã€‚ä¸‹é¢æ˜¯ä½¿ç”¨å½¢å¼\r\n\r\n```js\r\nconst event = new EventEmitter();\r\nconst refreshList = () => {};\r\nconst fn = (val) => {\r\n  if (val !== 'refresh') {\r\n    return;\r\n  }\r\n  refreshList();\r\n};\r\nevent.useSubscription('refresh', fn);\r\n\r\nconst onClick = () => {\r\n  event.emit('refresh');\r\n};\r\n\r\nonUnmounted(() => {\r\n  event.subscriptions.delete(fn);\r\n});\r\n```\r\n\r\nä½¿ç”¨æ–¹å¼ç¨å¾®ç®€åŒ–äº†ä¸€ä¸‹ï¼Œä¸è¿‡ä¹Ÿå¤šå‡ºäº† `onUnmounted`ï¼Œè¿™ä¹Ÿè°ˆä¸ä¸Šæ–¹ä¾¿ï¼Œå› ä¸ºä¼šæœ‰é¢å¤–çš„å¿ƒæ™ºè´Ÿæ‹…ï¼Œä¸Šé¢ä¹‹æ‰€ä»¥å•ç‹¬å†™ä¸€ä¸ª `fn` å°±æ˜¯å› ä¸ºå¸è½½çš„æ—¶å€™éœ€è¦å¸è½½å¯¹åº”çš„å‡½æ•°æ‰è¡Œã€‚\r\n\r\nåŸºäºç®€åŒ–å’Œä¸æƒ³é‡å¤ç®¡ç†çš„éœ€æ±‚ï¼Œæˆ‘ä»¬å†é‡æ–°å†™ä¸€ç‰ˆï¼Œè¿™é‡Œæˆ‘ä»¬é‡‡ç”¨ hook çš„å½¢å¼æ¥ä¹¦å†™\r\n\r\n## useEventEmitter\r\n\r\n```js\r\nclass EventEmitter {\r\n  subscriptions = new Set();\r\n\r\n  emit = (val) => {\r\n    for (const subscription of this.subscriptions) {\r\n      subscription(val);\r\n    }\r\n  };\r\n\r\n  useSubscription = (callback) => {\r\n    this.subscriptions.add(callback);\r\n    onUnmounted(() => {\r\n      this.subscriptions.delete(callback);\r\n    });\r\n  };\r\n}\r\nconst useEventEmitter = () => {\r\n  const event = new EventEmitter();\r\n\r\n  return event;\r\n};\r\n```\r\n\r\nä¸Šé¢çš„é€»è¾‘æ”¹å˜äº†ä¸€ä¸‹ï¼Œæˆ‘ä»¬åœ¨ `useSubscription` ä¸­è°ƒç”¨ `onUnmounted` æ¥å®Œæˆä¸€ä¸ªè‡ªåŠ¨çš„å¸è½½ã€‚\r\n\r\nä¹‹åä½¿ç”¨æ–¹æ³•\r\n\r\n```js\r\nconst event = useEventEmitter();\r\n\r\nconst refreshList = () => {};\r\n\r\nevent.useSubscription((val) => {\r\n  if (val !== 'refresh') {\r\n    return;\r\n  }\r\n  refreshList();\r\n});\r\n\r\nconst onClick = () => {\r\n  event.emit('refresh');\r\n};\r\n```\r\n\r\nè¿™é‡Œå°±è¾¾åˆ°æˆ‘ä»¬æœŸå¾…çš„ä¸€ä¸ªæ•ˆæœäº†ï¼Œä¸è¿‡è¿˜æ˜¯æœ‰éœ€è¦æ”¹è¿›çš„åœ°æ–¹ï¼š\r\n\r\nåœ¨ä½¿ç”¨å‘å¸ƒè®¢é˜…çš„åœºæ™¯åŸºæœ¬ä¸Šç»„ä»¶ä¹‹é—´çš„å±‚çº§ä¼šåµŒå¥—å¾ˆå¤šï¼Œä¾‹å¦‚ä¸Šé¢æ¯æ¬¡è°ƒç”¨ `useEventEmitter` ç”Ÿæˆä¸€ä¸ªæ–°çš„ `event` æ‰€ä»¥é€šè¿‡å•ä¾‹ç®€åŒ–ä¸ºå…¨å±€å”¯ä¸€çš„ event å³å¯ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥å€ŸåŠ© `provide` å’Œ `inject` è§£å†³è¿™ä¸€é—®é¢˜\r\n\r\n## æ”¹è¿›ä¹‹å\r\n\r\n```js\r\nclass EventEmitter {\r\n  subscriptions = new Set();\r\n\r\n  emit = (val) => {\r\n    for (const subscription of this.subscriptions) {\r\n      subscription(val);\r\n    }\r\n  };\r\n\r\n  useSubscription = (callback) => {\r\n    this.subscriptions.add(callback);\r\n    onUnmounted(() => {\r\n      this.subscriptions.delete(callback);\r\n    });\r\n  };\r\n}\r\nconst event = new EventEmitter();\r\nconst useEventEmitter = () => {\r\n  return event;\r\n};\r\n```\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/96/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/96/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/74",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/74/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/74/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/74/events",
          "html_url": "https://github.com/bosens-China/blog/issues/74",
          "id": 931481508,
          "node_id": "MDU6SXNzdWU5MzE0ODE1MDg=",
          "number": 74,
          "title": "ä¸º React æ·»åŠ åŒå‘ç»‘å®š hooks",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1473940161,
              "node_id": "MDU6TGFiZWwxNDczOTQwMTYx",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3",
              "name": "æ¡†æ¶ç›¸å…³",
              "color": "42b883",
              "default": false,
              "description": "ç›®å‰Vueå’ŒReactä¸ºä¸»"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2021-06-28T11:43:52Z",
          "updated_at": "2021-12-21T10:03:06Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "æœ€è¿‘æ¢äº†ä¸€å®¶æ–°å…¬å¸ï¼Œç”¨çš„æŠ€æœ¯æ ˆ`react`ä¸ºä¸»ï¼Œæ‰€ä»¥ä¸Šå‘¨ç´§æ€¥çš„çœ‹äº†ä¸€ä¸‹`react`ç›¸å…³çš„æ–‡æ¡£ï¼Œä¹Ÿå¯¹ç…§æ–‡æ¡£å†™äº†å‡ ä¸ª demoï¼Œä¸è¿‡åœ¨å¼€å‘é˜¶æ®µæˆ‘çš„ä½“éªŒè¿˜æ˜¯è›®å·®çš„ã€‚\r\n\r\n- ç”Ÿæ€å¾ˆç¹è£ï¼Œä½†æ˜¯ä¸çŸ¥é“é‚£ç§æ–¹æ¡ˆæ˜¯æœ€ä½³\r\n- å¼€å‘æ•ˆç‡å¾ˆç¹çï¼ˆè¿™ä¸€ç‚¹å¾…å•†æ¦·ï¼‰\r\n\r\nåˆšåˆšç®€å•å†™äº†ä¸€ä¸ª todolist çš„åŠŸèƒ½ï¼Œä¸è¿‡åœ¨å¯¹ list è¿›è¡Œä¿å­˜ã€ä¿®æ”¹ã€åˆ é™¤çš„æ—¶å€™ï¼Œæ„Ÿè§‰å¾ˆé…¸çˆ½\r\n\r\n```js\r\n// ...\r\nconst list = myContent.list[props.index]!;\r\nlist.title = inp;\r\nlist.show = false;\r\nmyContent.setlist([...myContent.list]);\r\n```\r\n\r\nå¤§é‡è¿™æ ·çš„ä»£ç ï¼Œæ‰€ä»¥å°±æƒ³é€šè¿‡ hook + æ•°æ®åŠ«æŒ æ¥å®ç°ä¸‹é¢è¿™æ ·çš„åŠŸèƒ½\r\n\r\n```js\r\nimport { useModel } from './utils';\r\nconst app = () => {\r\n  // ... çœç•¥å…¶ä»–ä»£ç \r\n  const [arr] = useModel([]);\r\n  arr.push(1);\r\n};\r\n```\r\n\r\nåœ¨ push ä¹‹ç±»çš„æ“ä½œæ—¶ï¼Œè‡ªåŠ¨å¸®æˆ‘ä»¬å®Œæˆ`setArr([...arr])`è¿™æ ·çš„æ“ä½œ\r\n\r\n## å®ç°æ€è·¯\r\n\r\nä¹‹å‰æƒ³å€Ÿé‰´`useEffect, useCallback`ä¹‹ç±»è‡ªå¸¦çš„ hook æ¥å®ç°ï¼Œä¸è¿‡å¾ˆé—æ†¾è¿™ä¸ªå¿…é¡»è¦æ˜¾ç¤ºè°ƒç”¨`setxxx`æ‰ä¼šè§¦å‘ï¼Œæ‰€ä»¥ç°åœ¨æ‘†åœ¨é¢å‰çš„å¦‚ä½•é€šè¿‡å˜åŒ–ä¹‹åé€šè¿‡å›è°ƒæ¥è§¦å‘ set çš„æ“ä½œã€‚\r\n\r\nå› ä¸ºä¹‹å‰ä½¿ç”¨çš„æ˜¯ vue æ‰€ä»¥è„‘æµ·ä¸­æœ€å…ˆè¹¦å‡ºçš„å°±æ˜¯é€šè¿‡`Object.defineProperty`æ¥åŠ«æŒæ•°æ®\r\n\r\n> è¿™é‡Œè¡¥å……ä¸€ç‚¹ï¼Œproxy çš„æ•ˆæœæ›´å¥½ï¼Œä¸è¿‡è¿™é‡Œä¼šæœ‰ä¸€äº›å…¼å®¹æ€§é—®é¢˜ï¼Œåé¢æˆ‘ä¼šå°†è¿™äº›åŠŸèƒ½å°è£…æˆä¸€ä¸ªåº“ï¼Œä¼˜å…ˆä½¿ç”¨`proxy`ä¹‹åé™çº§åˆ°`Object.defineProperty`\r\n\r\n## Object.defineProperty\r\n\r\nåˆ·è¿‡é¢è¯•é¢˜çš„åº”è¯¥å¯¹è¿™ä¸ª api åº”è¯¥ä¸é™Œç”Ÿï¼Œå®ƒæ˜¯ vue2.x å®ç°æ•°æ®åŠ«æŒçš„å…³é”®ï¼Œé€šè¿‡æ‹¦æˆªå¯¹è±¡çš„ get å’Œ set å±æ€§ï¼Œä¹‹ååˆ†å‘äº‹ä»¶æ¥é€šçŸ¥è§†å›¾è¿›è¡Œæ›´æ–°ã€‚\r\n\r\nä¸è¿‡è¿™ä¸ª api æ˜¯æœ‰ä¸€äº›ç¼ºç‚¹çš„ï¼Œå°¤å…¶æ˜¯å¯¹æ•°ç»„è€Œè¨€\r\n\r\n- ä¸æ”¯æŒæ‹¦æˆª`length`å±æ€§ï¼Œè¿™ç‚¹å¾ˆå…³é”®ï¼Œä¼šå¯¼è‡´æˆ‘ä»¬ç›´æ¥ä¿®æ”¹`arr.length = 0`æ— æ•ˆï¼ŒåŸå› æ˜¯å†…éƒ¨å¼•æ“çš„è§„å®šä¸å…è®¸ç›‘å¬\r\n\r\n- ä¸æ”¯æŒæ–¹æ³•ç›‘å¬ï¼Œä¾‹å¦‚ä½¿ç”¨ push ç­‰\r\n\r\næ˜ç¡®ä¸Šé¢ä¸¤ç‚¹ä¹‹åï¼Œæˆ‘ä»¬å°±æ¥åŠ¨æ‰‹è®¾è®¡è¿™ä¸ª`useModel`åº”è¯¥æ€ä¹ˆå†™ï¼Œæ€è·¯å€Ÿé‰´ vue2.x çš„å†™æ³•ï¼Œ\r\n\r\n- çº¦å®šä¸èƒ½ç›´æ¥ä¿®æ”¹`length`ï¼Œä¾‹å¦‚ï¼š`arr[100] = {}`ï¼›\r\n- ä½¿ç”¨å˜å¼‚æ–¹æ³•`pushã€popã€shiftã€unshiftã€spliceã€sortã€reverse`æ¥å®Œæˆå¯¹æ•°ç»„çš„åˆ é™¤å’Œå…¶ä»–ä¿®æ”¹ï¼›\r\n- å…è®¸ä¿®æ”¹å­˜åœ¨çš„æ•°ç»„ä¸‹æ ‡ï¼Œå¯ä»¥ç›´æ¥ä¿®æ”¹ arr[0]è¿™æ ·çš„æ•°æ®ï¼›\r\n\r\n> è¿™é‡Œç¨å¾®æä¸€ä¸‹ vue å®˜æ–¹ä¸å…è®¸ä¿®æ”¹å·²å­˜åœ¨æ•°ç»„ä¸‹æ ‡æ˜¯å› ä¸ºå­˜åœ¨æ€§èƒ½è€ƒè™‘\r\n\r\n## å®ç°æ€è·¯\r\n\r\nå®ç°æ€è·¯å¾ˆç®€å•ï¼Œä¸»è¦å°±æ˜¯é€’å½’éå†å¯¹è±¡çš„æ‰€æœ‰å±æ€§ï¼Œä¹‹åå°†å±æ€§æ”¹ç”¨`get`å’Œ`set`çš„å½¢å¼è¿›è¡Œå®šä¹‰ï¼Œåœ¨å¯¹è±¡å±æ€§å€¼æ›´æ”¹çš„æ—¶å€™æ¥è°ƒç”¨`useState`è¿”å›çš„ set æ–¹æ³•è¿›è¡Œæ•°æ®çš„æ›´æ–°ã€‚\r\n\r\nè€Œæ•°ç»„çš„å˜å¼‚æ–¹æ³•ç›‘å¬ï¼Œåˆ™æ˜¯é€šè¿‡æ”¹å†™æ•°ç»„çš„åŸå‹é“¾å®ç°ï¼Œä¾‹å¦‚\r\n\r\n```js\r\nconst arr = [];\r\nconst myProto = Object.create(Array.prototype);\r\nconst arrFn = arr.push;\r\nmyProto.push = (...rest) => {\r\n  consoole.log(1);\r\n  arrFn.push.apply(arr, rest);\r\n};\r\nObject.setPrototypeOf(arr, myProto);\r\n// 1\r\narr.push(1);\r\n```\r\n\r\nå°†è¿™ä¸ªæ•°ç»„çš„ `__propo__`æŒ‡å‘æˆ‘ä»¬è‡ªå®šä¹‰çš„åŸå‹å¯¹è±¡ä¸Šï¼Œè¿™ä¸ªåŸå‹å¯¹è±¡ä¸Šæœ‰ pushã€pop ç­‰å˜å¼‚æ–¹æ³•ï¼Œé€šè¿‡è°ƒç”¨å˜å¼‚æ–¹æ³•å®Œæˆå¯¹åŸæ•°ç»„çš„çš„æ“ä½œå’Œå¯¹ set çš„æ›´æ–°\r\n\r\n![å®ç°æ€è·¯](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/db03f6a89974472f9bd617577d3b6365~tplv-k3u1fbpfcp-zoom-1.image)\r\n\r\n## å…·ä½“å®ç°\r\n\r\nä»£ç é‡å¹¶ä¸æ˜¯å¾ˆå¤§ï¼Œæ‰€ä»¥ç›´æ¥æ”¾ä»£ç äº†ï¼Œä¸€äº›å…³é”®çš„åœ°æ–¹å·²ç»è¿›è¡Œäº†æ³¨é‡Š\r\n\r\n```js\r\nimport { useState } from 'react';\r\nconst isObject = (obj) => {\r\n  return (typeof obj === 'object' && obj) || typeof obj === 'function';\r\n};\r\n// ç›´æ¥æ”¹å†™æˆä¸€ä¸ªé€šç”¨éå†ï¼Œè¿™é‡Œè¿›è¡Œç±»å‹åˆ¤æ–­ï¼Œåç»­çš„useModelåˆ™ä¸éœ€è¦è¿›è¡Œåˆ¤æ–­äº†\r\nconst each = (obj, change) => {\r\n  if (!isObject(obj)) {\r\n    return;\r\n  }\r\n  const isArr = Array.isArray(obj);\r\n  const keys = isArr ? obj : Object.keys(obj);\r\n  for (let i = 0, len = keys.length; i < len; i++) {\r\n    const key = isArr ? i : keys[i];\r\n    const value = obj[key];\r\n    change(key, value);\r\n  }\r\n};\r\nexport const useModel = (obj) => {\r\n  const [model, setModel] = useState(obj);\r\n  // æ›´æ–°çš„æ—¶å€™ç›´æ¥æ›´æ–°é¡¶å±‚å¯¹è±¡å³å¯ï¼Œå› ä¸ºè¿™æ˜¯hookå†™æ³•ä¸å­˜åœ¨classçš„å±€éƒ¨æ›¿æ¢\r\n  const setRootValue = () => {\r\n    if (Array.isArray(model)) {\r\n      setModel([...model]);\r\n      return;\r\n    }\r\n    setModel(Object.assign({...model});\r\n  };\r\n  // å®šä¹‰å¯¹è±¡çš„key\r\n  const defineProperty = (key, value, o) => {\r\n    Object.defineProperty(o, key, {\r\n      enumerable: true,\r\n      get() {\r\n        return value;\r\n      },\r\n      set(v) {\r\n        if (v === value || (Number.isNaN(v) && Number.isNaN(value))) {\r\n          return;\r\n        }\r\n        value = v;\r\n        setRootValue();\r\n      },\r\n    });\r\n  };\r\n  const definePropertyArray = (all) => {\r\n    const myProto = Object.create(Array.prototype);\r\n    each(['push', 'pop', 'shift', 'unshift', 'splice', 'sort', 'reverse'], (_, value) => {\r\n      const fn = all[value];\r\n      myProto[value] = (...rest) => {\r\n        fn.apply(all, rest);\r\n        setRootValue();\r\n      };\r\n    });\r\n    Object.setPrototypeOf(all, myProto);\r\n  };\r\n  const observer = (all) => {\r\n    each(all, (key, value) => {\r\n      defineProperty(key, value, all);\r\n      observer(value);\r\n    });\r\n    if (Array.isArray(all)) {\r\n      definePropertyArray(all);\r\n    }\r\n  };\r\n  observer(model);\r\n  return [model, setRootValue];\r\n};\r\n```\r\n\r\n> æ³¨æ„ï¼Œä¸Šé¢å¹¶æ²¡æœ‰åœ¨`Object.defineProperty`set çš„æ—¶å€™ç»§ç»­æ‰§è¡Œæ·±åº¦ç›‘å¬ï¼Œæ˜¯å› ä¸º hook åœ¨æ”¹å˜çš„æ—¶å€™å°±ä¼šé‡æ–°æ‰§è¡Œè¿™ä¸ªæ–¹æ³•ï¼Œæ‰€ä»¥å¹¶ä¸éœ€è¦æ·±åº¦ç›‘å¬\r\n\r\n## æœ€å\r\n\r\nå¦‚æœå†™çš„æœ‰ä»€ä¹ˆä¸å¯¹çš„åœ°æ–¹æ¬¢è¿æŒ‡å‡ºï¼Œå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©å¯ä»¥ç‚¹ä¸€ä¸‹`start`\r\n\r\nä¸ºäº†æ–¹ä¾¿éªŒè¯æ•ˆæœï¼Œæ”¾ä¸€ä¸ª[ç¤ºä¾‹ä»£ç ï¼ˆå¯èƒ½éœ€è¦ç¿»å¢™ï¼‰](https://codesandbox.io/s/eloquent-kilby-1cdj7?from-embed=&file=/src/App.js)\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/74/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/74/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/41",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/41/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/41/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/41/events",
          "html_url": "https://github.com/bosens-China/blog/issues/41",
          "id": 539716296,
          "node_id": "MDU6SXNzdWU1Mzk3MTYyOTY=",
          "number": 41,
          "title": "VuePressæ’ä»¶å¼€å‘ä¸å®Œå…¨æŒ‡å—",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1473940161,
              "node_id": "MDU6TGFiZWwxNDczOTQwMTYx",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3",
              "name": "æ¡†æ¶ç›¸å…³",
              "color": "42b883",
              "default": false,
              "description": "ç›®å‰Vueå’ŒReactä¸ºä¸»"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2019-12-18T14:30:58Z",
          "updated_at": "2021-12-21T09:47:25Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "æœ€è¿‘ç”¨ `vuepress` æŠŠç¤¾åŒºçš„ typeScript ç¿»è¯‘æ–‡ç« æ‰“åŒ…æˆäº†ä¸€ä¸ª[åœ¨çº¿æ–‡æ¡£](https://bosens-china.github.io/Typescript-manual/dist/)ï¼Œä¸è¿‡æœ‰ä¸€äº›æ’ä»¶ç¤¾åŒºæ²¡æœ‰æˆ–è€…å®ç°çš„ä¸ç¬¦åˆè‡ªå·±å®šåˆ¶éœ€æ±‚ï¼Œæ‰€ä»¥å†³å®šè‡ªå®šä¹‰å®ç°ä¸€ä¸ªï¼Œè¿™ç¯‡æ–‡åŒ–ä»¥æ˜é‡‘`å¤åˆ¶ä»£ç `åŠŸèƒ½ä¸ºä¾‹å­ã€‚\r\nå…ˆçœ‹ä¸€ä¸‹å¼€å‘å®Œæˆçš„ç•Œé¢\r\n\r\n![1](https://user-images.githubusercontent.com/39508895/71094442-f3384500-21e5-11ea-91b5-a0de07c72903.png)\r\n\r\n\r\nå…ˆçœ‹ä¸€ä¸‹å®˜æ–¹ç»™å‡ºçš„æ¶æ„å›¾\r\n![](https://user-gold-cdn.xitu.io/2019/12/18/16f195bad0aeb2f4?w=1774&h=2334&f=png&s=65238)\r\næ˜¯ä¸æ˜¯æ„Ÿè§‰æœ‰ç‚¹å¤´ç–¼ï¼Œè¿™é‡Œè®°ä¸ä½æ²¡æœ‰å…³ç³»ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“**æ’ä»¶æ˜¯åœ¨ node ç¯å¢ƒä¸‹è¿è¡Œ**ï¼Œæ‰€ä»¥æˆ‘ä»¬æ’ä»¶çš„è¿”å›å½¢å¼å¿…é¡»æ˜¯`CommonJS`å½¢å¼ã€‚\r\n\r\nä¸ vue ç±»ä¼¼ï¼Œ`vuepress`ä¹Ÿæœ‰ç”Ÿå‘½å‘¨æœŸ\r\n\r\n- ready\r\n\r\nå¯ä»¥ç®€å•ç†è§£ä¸ºåˆå§‹åŒ–å®Œæˆè°ƒç”¨\r\n\r\n- updated\r\n\r\né¡µé¢æ›´æ–°è°ƒç”¨\r\n\r\n- generated\r\n\r\nç”Ÿäº§ç¯å¢ƒæ„å»ºå®Œæˆè°ƒç”¨\r\n\r\n### å®ç°æ€è·¯\r\n\r\nå› ä¸º`vuepress`ä¼šå°† md æ–‡ä»¶æ‰“åŒ…æˆå¤šä»½ html æ–‡ä»¶ï¼Œæ‰€ä»¥åœ¨æ¯æ¬¡æ–‡ä»¶åœ°å€å˜æ›´çš„æ—¶å€™æˆ‘ä»¬éƒ½éœ€è¦çŸ¥é“è¿™ä¸ªå˜æ›´ä¹‹åæ›´æ–°æˆ‘ä»¬çš„ç»„ä»¶ï¼Œæ ¹æ®ä¸Šé¢çš„ç”Ÿå‘½å‘¨æœŸå¯ä»¥åœ¨`updated`å®ç°æˆ‘ä»¬çš„éœ€æ±‚\r\n\r\nè‡³äºå¦‚ä½•å°†å¤åˆ¶ç²˜è´´çš„ç»„ä»¶æ’å…¥åˆ°æŒ‡å®šçš„`code`ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é¡µé¢åŠ è½½å®Œæˆåï¼Œæœç´¢æ‰€æœ‰çš„æŒ‡å®šèŠ‚ç‚¹ï¼Œä¹‹åé€šè¿‡`appendChild`å°†ç»„ä»¶æ’å…¥\r\n\r\n### é¡¹ç›®ç»“æ„\r\n\r\n```sh\r\ncopy\r\nâ”œâ”€ clientRootMixin.js\r\nâ”œâ”€ clipboard.js\r\nâ”œâ”€ copy.vue\r\nâ””â”€ index.js\r\n```\r\n\r\n- index.js\r\n\r\næš´éœ²çš„å‡ºå£æ–‡ä»¶\r\n\r\n- copy.vue\r\n\r\nå…·ä½“å®ç°å¤åˆ¶ä»£ç ç»„ä»¶\r\n\r\n- clipboard.js\r\n\r\nè´Ÿè´£å®ç°ç½®å‰ªåˆ‡æ¿æ–‡æœ¬\r\n\r\n- clientRootMixin.js\r\n\r\nè´Ÿè´£å®ç°å°†ç»„ä»¶æ’å…¥åˆ°ä¸åŒçš„é¡µé¢ä¹‹ä¸­\r\n\r\n### index.js\r\n\r\nä¸Šé¢è¯´äº†æˆ‘ä»¬è¦å¼€å‘ä¸€ä¸ªå¤åˆ¶ä»£ç çš„æ’ä»¶ï¼Œæˆ‘ä»¬å°±å…ˆæŒ‰ç…§ç®€å•çš„åšæ³•å®šä¹‰ä¸‰ä¸ªå‚æ•°\r\n\r\n- ç¬¬ä¸€ä¸ªæ˜¯é€‰æ‹©å™¨çš„èŒƒå›´\r\n- ç¬¬äºŒä¸ªæ˜¯å¤åˆ¶ä»£ç æ˜¾ç¤ºçš„æ–‡æœ¬\r\n- ç¬¬ä¸‰ä¸ªåˆ™æ˜¯å›è°ƒå‡½æ•°ï¼Œè´Ÿè´£æ¥æ”¶å˜æ›´æ¶ˆæ¯ï¼Œå®ç°è‡ªå®šä¹‰çš„åŠ¨ç”»æ•ˆæœ\r\n\r\nåœ¨å®˜æ–¹ç»™å‡ºçš„ä¾‹å­ï¼Œæœ‰ä¸¤ç§æ–¹å¼ä½¿ç”¨æ’ä»¶\r\n\r\n```js\r\n// ä¾‹1\r\nmodule.exports = {\r\n  plugins: [\r\n    [\r\n      \"vuepress-plugin-xxx\",\r\n      {\r\n        /* options */\r\n      }\r\n    ]\r\n  ]\r\n};\r\n// ä¾‹2\r\nmodule.exports = {\r\n  plugins: {\r\n    xxx: {\r\n      /* options */\r\n    }\r\n  }\r\n};\r\n```\r\n\r\nå¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæœ‰å‚æ•°çš„è¯å¯ä»¥è¿™æ ·ä¼ é€’ï¼Œé‚£ä¹ˆæˆ‘ä»¬å®šä¹‰çš„æ’ä»¶ç¬¬ä¸€æ­¥å°±æ˜¯è¦å¤„ç†è¿™ä¸ªå‚æ•°ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä¸æ¥å—ï¼Œå¦‚æœä¸æ¥å—ç›´æ¥è¿”å›ä¸€ä¸ªå¯¹è±¡å°±å¯ä»¥äº†\r\n\r\n```js\r\nmodule.exports = {\r\n  // ...\r\n};\r\n```\r\n\r\nä¸‹é¢æ¥å®šä¹‰ä¸€ä¸ªç®€å•æ¥å—`options`çš„å‡½æ•°\r\n\r\n```js\r\n// å¯¹è±¡å¼\r\n\r\nmodule.exports = {\r\n  define: {\r\n    selector: options.selector || 'div[class*=\"language-\"] pre',\r\n    copyText: options.copyText || \"å¤åˆ¶ä»£ç \",\r\n    change: options.change\r\n  }\r\n};\r\n// å‡½æ•°å¼:\r\nmodule.exports = (options, context) => ({\r\n  define() {\r\n    return {\r\n      selector: options.selector || 'div[class*=\"language-\"] pre',\r\n      copyText: options.copyText || \"å¤åˆ¶ä»£ç \",\r\n      change: options.change\r\n    };\r\n  }\r\n});\r\n```\r\n\r\næ³¨æ„å¿…é¡»è¿”å›æ˜¯`CommonJS`å½¢å¼ï¼Œä¸Šé¢æˆ‘ä»¬é€šè¿‡`define`å±æ€§æ¥å®šä¹‰ä¾›æˆ‘ä»¬æ’ä»¶å†…éƒ¨ä½¿ç”¨çš„å…¨å±€å˜é‡ï¼Œä»–æ”¯æŒå‡½æ•°å’Œå¯¹è±¡ä¸¤ç§å½¢å¼ï¼Œå¯ä»¥ç†è§£ä¸º vue çš„ data å±æ€§\r\n\r\nè¿™ä¸€æ­¥æ¯”è¾ƒç®€å•ï¼Œå°±ä¸åšå…¶ä»–è¿‡å¤šè¯´æ˜äº†ï¼Œä¸Šé¢æˆ‘ä»¬æåˆ°äº†éœ€è¦å°†ç»„ä»¶æ³¨å…¥åˆ°æ‰€æœ‰é¡µé¢ä¸­ï¼Œè¿™ä¸€æ­¥æ˜¯`clientRootMixin.js`æ‰€éœ€è¦è´Ÿè´£çš„äº‹æƒ…ï¼Œä¸‹é¢å°±æ˜¯å®ç°å®ƒï¼Œæˆ‘ä»¬éœ€è¦åœ¨`index.js`å¼•å…¥å®ƒï¼Œä¸€ä¸ªå®Œæ•´çš„`index.js`çœ‹èµ·æ¥åº”è¯¥æ˜¯è¿™æ ·\r\n\r\n```js\r\nconst path = require(\"path\");\r\n\r\nmodule.exports = (options = {}, ctx) => ({\r\n  define: {\r\n    // ...\r\n  },\r\n  clientRootMixin: path.resolve(__dirname, \"clientRootMixin.js\")\r\n});\r\n```\r\n\r\n### clientRootMixin.js\r\n\r\n`clientRootMixin` å¯ä»¥è®©æˆ‘ä»¬æ§åˆ¶æ ¹æ–‡ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Œè¿™é‡Œæˆ‘ä»¬åªéœ€è¦ç›‘å¬`updated`äº‹ä»¶ï¼Œä¹‹åæŠŠ`copy.vue`æ’å…¥åˆ°å½“å‰é¡µé¢å†…å³å¯\r\n\r\n```js\r\nimport CodeCopy from \"./copy.vue\";\r\nimport Vue from \"vue\";\r\n\r\nexport default {\r\n  updated() {\r\n    // ç­‰å¾…domåŠ è½½å®Œæˆä¹‹åæ‰§è¡Œ\r\n    this.$nextTick(() => {\r\n      this.update();\r\n    });\r\n  },\r\n  methods: {\r\n    update() {\r\n      // è·å–æ‰€æœ‰çš„domï¼Œä¹‹ååœ¨æ‰€æœ‰çš„ä»£ç å—ä¸Šæ’å…¥vueçš„ç»„ä»¶\r\n      const dom = Array.from(document.querySelectorAll(selector));\r\n      dom.forEach(el => {\r\n        // åˆ¤æ–­ä¸€ä¸‹ï¼Œå½“å‰èŠ‚ç‚¹æ˜¯ä¸æ˜¯å·²ç»æ’å…¥äº†\r\n        if (/v-copy/.test(el.className)) {\r\n          return;\r\n        }\r\n        // åˆ›å»ºcopyç»„ä»¶\r\n        const C = Vue.extend(CodeCopy);\r\n        const copy = new C();\r\n        // ä¸‹é¢è¿™äº›æ˜¯ç»„ä»¶çš„propsä»¥åŠä¸€äº›ç§æœ‰å±æ€§\r\n        copy.copyText = copyText;\r\n        copy.code = el.textContent;\r\n        copy._parent = el;\r\n        copy.$mount();\r\n        el.className += ` v- copy`;\r\n        el.appendChild(copy.$el);\r\n      });\r\n    }\r\n  }\r\n};\r\n```\r\n\r\nOKï¼Œåˆ°è¿™ä¸€æ­¥ä¹Ÿå®Œæˆäº†ï¼Œä¸‹é¢å°±æ˜¯æ€ä¹ˆæŠŠä»£ç ç½®å…¥å‰ªåˆ‡æ¿äº†\r\n\r\n### clipboard.js\r\n\r\n- navigator.clipboard\r\n  æ”¯æŒå¼‚æ­¥å‰ªè´´æ¿\r\n- document.execCommand()\r\n  å…¼å®¹æ€§æ¯”è¾ƒå¥½ä¸€äº›ï¼Œä½†æ˜¯åªèƒ½åŒæ­¥å‰ªè´´æ¿\r\n\r\nä¸Šé¢æ˜¯ä¸¤ç§åŸç”Ÿçš„æ–¹å¼ï¼Œä¸è¿‡è¿™é‡Œå› ä¸ºæ˜¯ä½œä¸ºåº“ä½¿ç”¨ï¼Œéœ€è¦è€ƒè™‘å…¼å®¹æ€§é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©äº†å·²ç»å°è£…å¥½çš„`clipboard.js`ä½œä¸ºå®ç°å¤åˆ¶ç²˜è´´ï¼Œä¸‹é¢æ˜¯å…·ä½“çš„å°è£…æ–¹æ³•ï¼Œè¿™ä¸€æ­¥å¯ä»¥è·³è¿‡\r\n\r\n```js\r\nimport ClipboardJS from \"clipboard\";\r\n// å°è£…çš„å‰ªåˆ‡æ¿äº‹ä»¶\r\nconst btn = document.createElement(\"div\");\r\nbtn.style.display = \"none\";\r\ndocument.body.appendChild(btn);\r\n\r\nfunction setUpText(text = \"\") {\r\n  return new Promise((resolve, reject) => {\r\n    const cli = new ClipboardJS(btn, {\r\n      text() {\r\n        return text;\r\n      }\r\n    });\r\n    // è§¦å‘ç‚¹å‡»äº‹ä»¶\\\r\n    const click = new Event(\"click\");\r\n    cli.on(\"success\", function() {\r\n      resolve(text);\r\n      // æ— è®ºæˆåŠŸä¸å¦éƒ½åˆ é™¤\r\n      cli.destroy();\r\n    });\r\n\r\n    cli.on(\"error\", function(e) {\r\n      reject(e.action);\r\n      // æ— è®ºæˆåŠŸä¸å¦éƒ½åˆ é™¤\r\n      cli.destroy();\r\n    });\r\n    btn.dispatchEvent(click);\r\n  });\r\n}\r\n\r\nexport default setUpText;\r\n```\r\n\r\nOKï¼Œåˆ°è¿™ä¸€æ­¥åŸºæœ¬ä¸Šå°±å®Œæˆäº†å‡†å¤‡å·¥ä½œï¼Œä¸‹é¢å°±å›å½’æˆ‘ä»¬ç†Ÿæ‚‰çš„ vue ç»„ä»¶å¼€å‘äº†\r\n\r\n### copy.vue\r\n\r\nè¿™ä¸€æ­¥æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯å®šä¹‰ä¸€äº› css å±æ€§ç‚¹å‡»æŒ‰é’®çš„æ—¶å€™æ‰§è¡Œ`clipboard.js`å°±è¡Œäº†\r\n\r\n```vue\r\n<template>\r\n  <span>\r\n    <span ref=\"btn\" class=\"v-copy-code-btn\" @click=\"copyClick\">{{\r\n      copyText\r\n    }}</span>\r\n  </span>\r\n</template>\r\n\r\n<script>\r\nimport clipboard from \"./clipboard\";\r\nexport default {\r\n  props: {\r\n    copyText: {\r\n      type: String,\r\n      default: \"å¤åˆ¶ä»£ç \"\r\n    },\r\n    code: String\r\n  },\r\n  methods: {\r\n    copyClick() {\r\n      clipboard(this.code);\r\n      // æ‰§è¡Œå¤åˆ¶å…·ä½“å®ç°çœç•¥\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style>\r\n<!-- çœç•¥ -->\r\n</style>\r\n```\r\n\r\n### æœ€å\r\n\r\næ’’èŠ±ï¼Œå®Œæˆè¿™ä¸€æ­¥ä¹‹åå°±æ˜¯å°†ä»£ç å‘å¸ƒåˆ° npm ä¸Šä¾›å¤§å®¶ä½¿ç”¨ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±ä¸å†æè¿°äº†ã€‚\r\n\r\næœ€åæœ¬äººç›®å‰å‡†å¤‡æ‰¾å·¥ä½œï¼Œæœ‰å°ä¼™ä¼´å†…æ¨ä¸€ä¸‹ä¹ˆï¼Œä¸èƒœæ„Ÿæ¿€\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/41/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/41/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/75",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/75/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/75/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/75/events",
          "html_url": "https://github.com/bosens-China/blog/issues/75",
          "id": 975496779,
          "node_id": "MDU6SXNzdWU5NzU0OTY3Nzk=",
          "number": 75,
          "title": "æ€ä¹ˆç”¨ Vue Composition é€ è½®å­",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1473940161,
              "node_id": "MDU6TGFiZWwxNDczOTQwMTYx",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%A1%86%E6%9E%B6%E7%9B%B8%E5%85%B3",
              "name": "æ¡†æ¶ç›¸å…³",
              "color": "42b883",
              "default": false,
              "description": "ç›®å‰Vueå’ŒReactä¸ºä¸»"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2021-08-20T10:51:18Z",
          "updated_at": "2021-08-20T10:51:18Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "\r\n![wallhaven-zmmwzw](https://user-images.githubusercontent.com/39508895/130222612-f8e2410a-4101-47dd-ba41-f488225cb94d.jpg)\r\n\r\n\r\næœ€è¿‘é¡¹ç›®ä¸´è¿‘å°¾å£°ï¼Œç»ˆäºæœ‰æ—¶é—´æ¥å¯¹è¿™æ®µå·¥ä½œæ€»ç»“ã€‚å…¶å®ä¹‹å‰ä½¿ç”¨çš„ä¸€ç›´æ˜¯ Vue ä½†æ˜¯ç°åœ¨å…¬å¸çš„ä¸»è¦ä¸šåŠ¡ä½¿ç”¨æ˜¯ React ä¸ºæ­¤è¿˜ç‰¹æ„çœ‹äº†è®¸å¤šæ–‡ç« ï¼ŒåŠ ä¸Šå®é™…ä¸Šè¿™ä¸¤ä¸ªæ¡†æ¶æœ‰å¾ˆå¤šç±»ä¼¼çš„åœ°æ–¹ï¼Œæ‰€ä»¥å°±æœ‰äº†è¿™ç¯‡æ–‡ç« ã€‚\r\n\r\nå› ä¸ºä¸»è¦æ˜¯åˆ†äº«ç»éªŒæ‰€ä»¥ä¸‹é¢çš„ç¤ºä¾‹ä¸»è¦ä½œä¸ºæŠ›ç –å¼•ç‰çš„ä½œç”¨ï¼Œåœ¨æ­£å¼åˆ†äº«ä¹‹å‰å…ˆç§‘æ™®ä¸¤ä¸ªå°çŸ¥è¯†\r\n\r\n- hooks é»˜è®¤ä»¥ use ä¸ºå‰ç¼€ï¼Œè¿™ä¸ªæ˜¯ React çš„å®˜æ–¹æ¨èåšæ³•ï¼Œçº¦æŸå¤§äºé…ç½®ä¹Ÿæ–¹ä¾¿ eslint ç­‰è§£æå·¥å…·è¯†åˆ«ï¼Œè¿™é‡Œä¹Ÿéµå¾ªè¿™ä¸ªåšæ³•ï¼›\r\n- watchEffect ä¸ useEffect æœ€å¤§çš„åŒºåˆ«å°±æ˜¯ï¼ŒwatchEffect å¯ä»¥è‡ªåŠ¨æ£€æµ‹ä¾èµ–ï¼Œè€Œ useEffect éœ€è¦ä½ æ˜¾ç¤ºæŒ‡å®šï¼›\r\n\r\n```js\r\nconst count = ref(0);\r\nconst onClick = () => {\r\n  count.value++;\r\n};\r\nwatchEffect(() => {\r\n  console.log(`è¢«ç‚¹å‡»`);\r\n});\r\n```\r\n\r\nä¾‹å¦‚ä¸Šé¢è¿™æ®µä»£ç ï¼Œå½“ `onClick` è¢«è§¦å‘çš„æ—¶å€™ watchEffect ä¸ä¼šé‡å¤æ‰§è¡Œï¼Œå› ä¸ºå®ƒå†…éƒ¨æœ‰ä¸€ä¸ªæ”¶é›†ç›¸å…³ä¾èµ–çš„è¿‡ç¨‹ï¼Œåªæœ‰ä¾èµ–å˜åŒ–æ‰ä¼šé‡æ–°æ‰§è¡Œï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦ï¼Œè¯·è®°ä½ã€‚\r\n\r\n## ç¤ºä¾‹\r\næ ¹æ®å¸¸è§åœºæ™¯åˆ’åˆ†äº†ä¸‰ä¸ªç±»å‹ï¼Œå¦‚æœä½ æœ‰æ›´å¥½çš„ä¾‹å­æ¬¢è¿è¡¥å……\r\n### DOM\r\n\r\n#### ä¿®æ”¹é¡µé¢ title\r\n\r\n```js\r\nimport { ref, watchEffect } from 'vue';\r\n\r\nconst useTitle = (title) => {\r\n  const str = ref(title);\r\n  watchEffect(() => {\r\n    document.title = str.value;\r\n  });\r\n};\r\n```\r\n\r\nè°ƒç”¨`useTitle`å³å¯æ›´æ–°æ ‡é¢˜\r\n\r\n#### ç›‘å¬é¡µé¢å¤§å°å˜åŒ–\r\n\r\n```js\r\nimport { watchEffect, reactive, toRefs } from 'vue';\r\n\r\nconst useResize = () => {\r\n  const size = reactive({\r\n    width: window.innerWidth,\r\n    height: window.innerHeight,\r\n  });\r\n  const onChange = () => {\r\n    Object.assign(size, {\r\n      width: window.innerWidth,\r\n      height: window.innerHeight,\r\n    });\r\n  };\r\n  watchEffect((onInvalidate) => {\r\n    window.addEventListener('resize', onChange);\r\n    onInvalidate(() => {\r\n      window.removeEventListener('resize', onChange);\r\n    });\r\n  });\r\n  return toRefs(size);\r\n};\r\n```\r\n\r\nè¿™é‡Œè°ƒç”¨ `toRefs` çš„åŸå› æ˜¯ä¸ºäº†è§£æ„çš„æƒ…å†µä¹Ÿå¯ä»¥ä½¿ç”¨ï¼Œä¾‹å¦‚\r\n\r\n```js\r\nconst { width } = useResize();\r\n```\r\n\r\n#### ç›‘å¬ç½‘ç»œæ˜¯å¦æ–­å¼€\r\n\r\n```js\r\nimport { ref, watchEffect } from 'vue';\r\n\r\nconst useLineState = () => {\r\n  const line = ref(window.navigator.onLine);\r\n  const onLine = () => {\r\n    line.value = true;\r\n  };\r\n  const onOffline = () => {\r\n    line.value = false;\r\n  };\r\n\r\n  watchEffect((onInvalidate) => {\r\n    window.addEventListener('online', onLine);\r\n    window.addEventListener('offline', onOffline);\r\n    onInvalidate(() => {\r\n      window.removeEventListener('online', onLine);\r\n      window.removeEventListener('offline', onOffline);\r\n    });\r\n  });\r\n\r\n  return line;\r\n};\r\n```\r\n\r\nè·Ÿä¸Šé¢çš„ `useResize` ç±»ä¼¼ï¼Œç›‘å¬ç›¸å…³äº‹ä»¶æ¥å†³å®š `state` çš„ç›¸å…³çŠ¶æ€\r\n\r\n#### ç›‘å¬ dom å…ƒç´ å˜åŒ–\r\n\r\n```js\r\nimport { watchEffect, reactive, toRefs } from 'vue';\r\n\r\nconst isObject = (obj) => typeof obj === 'object' && obj;\r\nconst isElement = (obj) => isObject(obj) && obj.nodeType === Node.ELEMENT_NODE;\r\nconst useResizeObserver = (dom) => {\r\n  if (!isElement(dom)) {\r\n    throw new Error(`DOM is not an element!`);\r\n  }\r\n  const size = reactive(dom.getBoundingClientRect());\r\n  watchEffect((onInvalidate) => {\r\n    const resizeObserver = new ResizeObserver(() => {\r\n      Object.assign(size, dom.getBoundingClientRect());\r\n    });\r\n    onInvalidate(() => {\r\n      resizeObserver.disconnect();\r\n    });\r\n  });\r\n  return toRefs(size);\r\n};\r\n```\r\n\r\nè¿™é‡Œç›‘å¬å…ƒç´ ä½¿ç”¨äº†è¿˜åœ¨å®éªŒé˜¶æ®µçš„ `ResizeObserver` ï¼Œä¸ºäº†å…¼å®¹æ€§è¯·ä½¿ç”¨ `polyfill`\r\n\r\n### å°è£…è¯·æ±‚\r\n\r\najax çš„è¯·æ±‚å¾ˆå¸¸è§ï¼Œä¸è¿‡åœ¨ vue2.x ä¸­æˆ‘ä»¬å¾ˆå®¹æ˜“å†™å‡ºä¸‹é¢çš„ä»£ç \r\n\r\n```js\r\nmounted(() => {\r\n  fn().then().catch().finally();\r\n});\r\n```\r\n\r\nè¿™æ ·çš„ä»£ç æœ€å¤§çš„é—®é¢˜å°±æ˜¯ä¸å¤Ÿæ¸…æ™°ï¼Œå› ä¸ºå˜é‡åœ¨ `data` ä¸­å®šä¹‰ï¼Œè€Œå¦‚æœåˆ‡æ¢æˆä¸‹é¢è¿™ç§å½¢å¼ï¼Œçœ‹èµ·æ¥å°±ä¼šç›´è§‚è®¸å¤šã€‚\r\n\r\næ›´å¤šçš„ä¾‹å­è¿˜å¯ä»¥ç»“åˆ `form` å’Œ `table` è¿›è¡Œæ›´åŠ æ·±åº¦çš„ hooks å°è£…\r\n\r\n```js\r\nconst { data, loading, error } = useRequest(() => {\r\n  //...\r\n});\r\nif (loading) {\r\n  //...\r\n}\r\nif (error) {\r\n  // ...\r\n}\r\n```\r\n\r\n```js\r\nimport { watchEffect, reactive, toRefs } from 'vue';\r\n\r\nconst useRequest = (fn, { manual } = {}) => {\r\n  const obj = reactive({\r\n    loading: false,\r\n    data: undefined,\r\n    error: undefined,\r\n  });\r\n  const run = () => {\r\n    obj.loading = true;\r\n    Promise.resolve(fn())\r\n      .then((data) => {\r\n        obj.data = data;\r\n      })\r\n      .catch((err) => {\r\n        obj.error = err;\r\n      })\r\n      .finally(() => {\r\n        obj.loading = false;\r\n      });\r\n  };\r\n  watchEffect(() => {\r\n    if (!manual) {\r\n      run();\r\n    }\r\n  });\r\n\r\n  return {\r\n    ...toRefs(obj),\r\n    run,\r\n  };\r\n};\r\n```\r\n\r\n### æ¨¡æ‹Ÿç”Ÿå‘½å‘¨æœŸ\r\n\r\nè¿™é‡Œ Vue å®˜æ–¹çš„è‡ªå¸¦ç”Ÿå‘½å‘¨æœŸå·²ç»å¾ˆé½å…¨äº†ï¼Œä¸è¿‡æœ‰çš„ç”Ÿå‘½å‘¨æœŸè¿˜æ˜¯å¯ä»¥é€šè¿‡ `watchEffect` åšåˆ°æ¨¡æ‹Ÿã€‚\r\n\r\nä¾‹å¦‚ï¼š`mounted` å’Œ `beforeUnmount`ï¼Œè¿™é‡Œå®ç°çš„åŸç†ä¸»è¦å°±æ˜¯åˆ©ç”¨ `watchEffect` è‡ªåŠ¨æ£€æµ‹ä¾èµ–ï¼Œé‚£å¦‚æœä¸å¯¹å“åº”å¼å˜é‡åšæ”¶é›†çš„ç›¸å…³æ“ä½œå…¶å®å°±æ˜¯ä¸€ä¸ª `mounted`\r\n\r\n```js\r\nimport { watchEffect, nextTick } from 'vue';\r\n\r\nconst useMounted = (fn) => {\r\n  watchEffect(() => {\r\n    if (typeof fn !== 'function') {\r\n      return;\r\n    }\r\n    nextTick().then(() => {\r\n      fn();\r\n    });\r\n  });\r\n};\r\n\r\nconst useBeforeUnmount = (fn) => {\r\n  watchEffect((onInvalidate) => {\r\n    onInvalidate(() => {\r\n      if (typeof fn !== 'function') {\r\n        return;\r\n      }\r\n      fn();\r\n    });\r\n  });\r\n};\r\n```\r\n\r\n### å°è£…æŒä¹…åŒ–\r\n\r\nåœ¨ä¸€äº›ç™»å½•é¡µé¢ä¸­å¾ˆå®¹æ˜“çœ‹åˆ°è®°ä½ç›¸å…³è´¦å·å’Œå¯†ç ï¼Œä¼ ç»Ÿçš„åšæ³•å°±æ˜¯ `login` ä¹‹åå­˜å‚¨ç›¸å…³çš„è´¦å·å’Œå¯†ç ï¼Œç„¶ååœ¨é¡µé¢æ¸²æŸ“çš„æ—¶å€™æŸ¥çœ‹ç›¸å…³ `localStorage` æœ‰æ²¡æœ‰å¯¹åº”çš„æ•°æ®ã€‚\r\n\r\nè¿™æ ·å†™åšå¤§çš„é—®é¢˜è¿˜æ˜¯åˆ†ç¦»ï¼Œä»¥åŠä¹¦å†™çš„ä»£ç é‡å¾ˆå¤šï¼Œä¸‹é¢å°±ä»‹ç»ä¸€ä¸‹å¦‚ä½•ç»“åˆ `localStorage` åšåˆ°ä¸€ä¸ªæ”¯æŒå¯¹è±¡çš„ hooks\r\n\r\n```js\r\nimport { ref, watchEffect } from 'vue';\r\nconst isObject = (obj) => typeof obj === 'object' && obj;\r\nconst useLocalStorageState = (key, defaultValue) => {\r\n  const value = ref(undefined);\r\n  try {\r\n    value.value = window.localStorage.getItem(key);\r\n    if (value.value === undefined) {\r\n      value.value = defaultValue;\r\n    }\r\n    value.value = JSON.parse(value.value);\r\n  } catch {}\r\n\r\n  watchEffect(() => {\r\n    const v = value.value;\r\n    window.localStorage.setItem(key, isObject(v) ? JSON.stringify(v) : v);\r\n  });\r\n  return value;\r\n};\r\n```\r\n\r\n```js\r\nconst name = useLocalStorageState('name', 'admin');\r\n```\r\n\r\n## æœ€å\r\n\r\nä»¥ä¸Šä»£ç å…¨éƒ¨ä¸Šä¼ åˆ°äº†[codesandbox](https://codesandbox.io/s/nostalgic-chaum-9bwuo)ï¼Œå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©å¯ä»¥`star`ä¸€ä¸‹\r\n\r\n## å‚è€ƒæ–‡ç« \r\n\r\n- [ç²¾è¯»ã€Šæ€ä¹ˆç”¨ React Hooks é€ è½®å­ã€‹](https://github.com/ascoders/weekly/blob/v2/080.%E7%B2%BE%E8%AF%BB%E3%80%8A%E6%80%8E%E4%B9%88%E7%94%A8%20React%20Hooks%20%E9%80%A0%E8%BD%AE%E5%AD%90%E3%80%8B.md)\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/75/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/75/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        }
      ]
    ],
    [
      "3661377607",
      [
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/99",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/99/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/99/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/99/events",
          "html_url": "https://github.com/bosens-China/blog/issues/99",
          "id": 1951726236,
          "node_id": "I_kwDOCzPAy850VPqc",
          "number": 99,
          "title": "koaæ´‹è‘±ç»“æ„è§£æ",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 3661377607,
              "node_id": "LA_kwDOCzPAy87aPDBH",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/Node%E7%B3%BB%E5%88%97",
              "name": "Nodeç³»åˆ—",
              "color": "9F9262",
              "default": false,
              "description": "å’Œnode.jsç›¸å…³å†…å®¹"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2023-10-19T09:33:07Z",
          "updated_at": "2023-10-19T09:33:17Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dbf97f99bdf142bbb9c18449b82700e3~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1149&h=1000&s=159098&e=png&b=fefefe)\r\n\r\nç»å¸¸åœ¨ä½¿ç”¨ koa çš„æ—¶å€™ï¼Œé€šè¿‡ `.use` çš„å½¢å¼æ¥æ³¨å†Œå„ç§ä¸­é—´ä»¶ï¼Œä¾‹å¦‚ä¸‹é¢ä¸€æ®µä»£ç \r\n\r\n```js\r\napp.use(async (ctx, next) => {\r\n  console.log(1);\r\n  await next();\r\n  console.log(2);\r\n});\r\napp.use(async (ctx, next) => {\r\n  console.log(3);\r\n  await next();\r\n  console.log(4);\r\n});\r\n```\r\n\r\nè¿™é‡Œä¼šè¾“å‡º 1,3,4,2ï¼Œä¸‹é¢å°±æ¥ç¿»çœ‹ä¸€ä¸‹æºç çœ‹çœ‹è¿™ä¸ªä¸­é—´ä»¶å®ç°çš„å…·ä½“åŸç†ã€‚\r\n\r\nåœ¨çœ‹å…·ä½“ä»£ç ä¹‹å‰ï¼Œå…ˆæ¸©ä¹ ä¸€ä¸‹ï¼Œä½¿ç”¨ koa çš„æœ€å°è¿è¡Œä»£ç æ˜¯ä»€ä¹ˆæ ·çš„\r\n\r\n```js\r\nconst Koa = require(\"koa\");\r\nconst app = new Koa();\r\n\r\n// response\r\napp.use((ctx) => {\r\n  ctx.body = \"Hello Koa\";\r\n});\r\n\r\napp.listen(3000);\r\n```\r\n\r\nå¯ä»¥çœ‹åˆ°ï¼Œæœ€åé€šè¿‡ listen æ–¹æ³•æ¥å¯åŠ¨æœåŠ¡ï¼Œé‚£æˆ‘ä»¬é‡ç‚¹å…ˆçœ‹ä¸‹ use å’Œ listen åšäº†ä»€ä¹ˆäº‹æƒ…ã€‚\r\n\r\n## [use](https://github.com/koajs/koa/blob/master/lib/application.js#L140C1-L145C4)\r\n\r\n```js\r\n  use (fn) {\r\n    if (typeof fn !== 'function') throw new TypeError('middleware must be a function!')\r\n    debug('use %s', fn._name || fn.name || '-')\r\n    this.middleware.push(fn)\r\n    return this\r\n  }\r\n```\r\n\r\nä»£ç æ¯”è¾ƒå°‘ï¼Œè¿™é‡Œç›´æ¥è´´ä¸Šå»äº†ï¼Œuse çš„ä¸»è¦ä½œç”¨å°±æ˜¯ç»™ middleware æ·»åŠ ç›¸å¯¹åº”çš„ fnã€‚\r\n\r\n## [listen](https://github.com/koajs/koa/blob/master/lib/application.js#L97)\r\n\r\n```js\r\n  listen (...args) {\r\n    debug('listen')\r\n    const server = http.createServer(this.callback())\r\n    return server.listen(...args)\r\n  }\r\n```\r\n\r\nè¿™é‡Œ server æ˜¯ http çš„åº“çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å…ˆä¸ç®¡ï¼Œä¸»è¦çœ‹ä¸€ä¸‹ this.callback åšäº†ä»€ä¹ˆäº‹æƒ…ã€‚\r\n\r\n```js\r\n  callback () {\r\n    const fn = this.compose(this.middleware)\r\n\r\n    if (!this.listenerCount('error')) this.on('error', this.onerror)\r\n\r\n    const handleRequest = (req, res) => {\r\n      const ctx = this.createContext(req, res)\r\n      if (!this.ctxStorage) {\r\n        return this.handleRequest(ctx, fn)\r\n      }\r\n      return this.ctxStorage.run(ctx, async () => {\r\n        return await this.handleRequest(ctx, fn)\r\n      })\r\n    }\r\n\r\n    return handleRequest\r\n  }\r\n```\r\n\r\nhandleRequest è¿™ä¸ªå‡½æ•°çš„å®ç°å¦‚ä¸‹\r\n\r\n```js\r\n  handleRequest (ctx, fnMiddleware) {\r\n    const res = ctx.res\r\n    res.statusCode = 404\r\n    const onerror = err => ctx.onerror(err)\r\n    const handleResponse = () => respond(ctx)\r\n    onFinished(res, onerror)\r\n    return fnMiddleware(ctx).then(handleResponse).catch(onerror)\r\n  }\r\n\r\n```\r\n\r\nå¯ä»¥çœ‹åˆ°ï¼Œæœ€ç»ˆæ˜¯æŠŠ this.compose è¿”å›çš„ fn è¿›è¡Œäº†è°ƒç”¨ï¼Œé‚£ä¹ˆç”±æ­¤å¯ä»¥çŸ¥é“ this.compose å°±æ˜¯å…·ä½“ä¸­é—´ä»¶è°ƒåº¦çš„å…·ä½“å®ç°ã€‚\r\n\r\n## compose\r\n\r\nthis.compose å¯ä»¥åœ¨ constructor ä¸­çœ‹åˆ°ï¼Œé»˜è®¤æƒ…å†µä¸‹å°±æ˜¯ [koa-compose](https://github.com/koajs/compose)ï¼Œè¿™ä¸ªåº“ä¹Ÿéå¸¸ç²¾ç®€åªæœ‰ 50 è¡Œä»£ç ï¼Œä¸‹é¢ä¼šé€šè¿‡æ³¨é‡Šçš„å½¢å¼æ¥å¯¹æºç è¿›è¡Œä¸€ä¸ªè¯´æ˜ã€‚\r\n\r\n```js\r\n// çœç•¥éƒ¨åˆ†æ³¨é‡Šå’Œéƒ¨åˆ†ä»£ç \r\n\r\nfunction compose(middleware) {\r\n  // åˆ¤æ–­ä¼ é€’æ˜¯å¦ä¸ºæ•°ç»„ï¼Œä¸”æ¯ä¸ªæ•°ç»„éƒ½å¿…é¡»ä¸ºå‡½æ•°ï¼Œå¦åˆ™æŠ›å‡ºå¼‚å¸¸\r\n  if (!Array.isArray(middleware))\r\n    throw new TypeError(\"Middleware stack must be an array!\");\r\n  for (const fn of middleware) {\r\n    if (typeof fn !== \"function\")\r\n      throw new TypeError(\"Middleware must be composed of functions!\");\r\n  }\r\n  // è¿™é‡Œé»˜è®¤è¿”å›ä¸€ä¸ªå‡½æ•°ï¼ŒhandleRequestå‡½æ•°ä¼šè°ƒç”¨è¿™ä¸ªè¿”å›çš„å‡½æ•°ï¼Œå¹¶ä¸”ä¼ é€’ context\r\n  return function (context, next) {\r\n    let index = -1;\r\n    // é»˜è®¤æƒ…å†µä¸‹æ‰§è¡Œä¸€æ¬¡ dispatch ï¼Œdispatchå› ä¸ºæ˜¯å‡½æ•°å£°æ˜æ‰€ä»¥ä¼šæå‡åˆ°åšä½œç”¨åŸŸé¡¶éƒ¨\r\n    return dispatch(0);\r\n    function dispatch(i) {\r\n      // é€šå¸¸æƒ…å†µä¸‹ä¸ä¼šé‡åˆ°ï¼Œä½†æ˜¯å¦‚æœæ‰§è¡Œä¸¤æ¬¡å°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œä¾‹å¦‚ç¬¬ä¸€æ¬¡è°ƒç”¨indexä¸º-1ï¼Œiä¸º0ï¼Œç¬¬äºŒæ¬¡æ‰§è¡Œåˆ™å˜æˆindexä¸º0ï¼Œiä¹Ÿä¸º0åˆ™æŠ›å‡ºé”™è¯¯\r\n      if (i <= index)\r\n        return Promise.reject(new Error(\"next() called multiple times\"));\r\n      index = i;\r\n      let fn = middleware[i];\r\n      // è¿™é‡Œä»koaçš„å®ç°å¯ä»¥çœ‹åˆ°ï¼Œæ˜¯æ²¡æœ‰ä¼ é€’nextçš„ï¼Œæ‰€ä»¥è¿™è¡Œä»£ç å¯ä»¥è·³è¿‡\r\n      if (i === middleware.length) fn = next;\r\n      // æ‰§è¡Œåˆ°æœ€åä¸€é¡¹çš„æ—¶å€™ç›´æ¥è¿”å›ä¸å†ç»§ç»­é€’å½’ä¸‹å»\r\n      if (!fn) return Promise.resolve();\r\n      try {\r\n        // è¿™é‡Œå®ç°å¾ˆå·§å¦™ï¼Œåˆ©ç”¨äº†bindçš„åŸç†ï¼Œbindçš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºthisï¼Œä¹‹åçš„å‚æ•°ä¸ºå‡½æ•°çš„é¢„è®¾å€¼ï¼Œæœ€åè¿”å›ä¸€ä¸ªå‡½æ•°\r\n        // ç„¶åæ ¹æ®Promise.resolveçš„å®ç°è§„èŒƒï¼Œå¦‚æœä¼ é€’çš„Promise.resolveæ˜¯ä¸€ä¸ªPromiseè¦ç­‰å¾…æ–°çš„Promiseæ‰§è¡Œå®Œæˆä¹‹åå†³å®šçŠ¶æ€\r\n        // è¿™é‡Œæ¨èçœ‹ä¸‹PromiseA+è§„èŒƒå®ç°\r\n        return Promise.resolve(fn(context, dispatch.bind(null, i + 1)));\r\n      } catch (err) {\r\n        return Promise.reject(err);\r\n      }\r\n    }\r\n  };\r\n}\r\n```\r\n\r\nokï¼Œè¿™é‡ŒåŸºæœ¬ä¸Šå°±è®²å®Œäº†ï¼Œè¿˜æ˜¯å¯¹ç…§æœ€åˆçš„ç¤ºä¾‹æ¥çœ‹\r\n\r\n```js\r\napp.use(async (ctx, next) => {\r\n  console.log(1);\r\n  await next();\r\n  console.log(2);\r\n});\r\napp.use(async (ctx, next) => {\r\n  console.log(3);\r\n  await next();\r\n  console.log(4);\r\n});\r\n```\r\n\r\nè¿™é‡Œä¼ é€’ç»™ compose([fn1, fn2])ï¼Œä¹‹å i ä¸º 0ï¼Œè¿”å›\r\n\r\n```js\r\nconst fn = async (ctx, next) => {\r\n  console.log(1);\r\n  await next();\r\n  console.log(2);\r\n};\r\nreturn Promise.resolve(fn(context, dispatch.bind(null, i + 1)));\r\n```\r\n\r\nä¹‹å i ä¸º 1 çš„æ—¶å€™\r\n\r\n```js\r\nconst fn = async (ctx, next) => {\r\n  console.log(3);\r\n  await next();\r\n  console.log(4);\r\n};\r\nreturn Promise.resolve(fn(context, dispatch.bind(null, i + 1)));\r\n```\r\n\r\næ­¤æ—¶ i ä¸º 2ï¼Œå‘ç°æ•°ç»„å–ä¸åˆ°å€¼äº†ï¼Œæ‰§è¡Œ\r\n\r\n```js\r\nif (!fn) return Promise.resolve();\r\n```\r\n\r\nå›åˆ°æœ€æœ€åä¸€æ­¥ï¼Œè¿˜æ²¡æœ‰è§£é‡Šä¸ºä»€ä¹ˆä¼šæ´‹è‘±ç»“æ„è¿™æ ·æ¥æ‰§è¡Œä»£ç \r\n\r\n```js\r\napp.use(async (ctx, next) => {\r\n  console.log(1);\r\n  await next();\r\n  console.log(2);\r\n});\r\napp.use(async (ctx, next) => {\r\n  console.log(3);\r\n  await next();\r\n  console.log(4);\r\n});\r\n```\r\n\r\nè¿™é‡Œæˆ‘ä»¬çŸ¥é“å…ˆæ‰§è¡Œç¬¬ä¸€ä¸ªå‡½æ•°\r\n\r\n1. è¾“å‡º console.log(1);\r\n2. æ‰§è¡Œçš„è¿‡ç¨‹ä¸­é‡åˆ° `await next()` ä¼šæ‰§è¡Œ nextï¼Œè€Œä»æºç  `dispatch.bind(null, i + 1)` å¯ä»¥çŸ¥é“ä¸‹ä¸€é¡¹å°±æ˜¯ç¬¬äºŒä¸ªå‡½æ•°\r\n3. æ‰§è¡Œç¬¬äºŒä¸ªå‡½æ•°\r\n4. è¾“å‡º console.log(3)\r\n5. ç»§ç»­æ‰§è¡Œ `await next()` ä»æºç çŸ¥é“ i ä¸º 2 çš„æ—¶å€™ï¼Œè¿”å›çš„æ˜¯ `if (!fn) return Promise.resolve();`\r\n6. æ‰§è¡Œ conosle.log(4)ï¼Œè¿”å› Promise çŠ¶æ€ä¸ºå·²å®Œæˆï¼Œç»“æœä¸º undefined\r\n7. æ‰§è¡Œ console.log(2)\r\n\r\nä¸Šé¢å¯èƒ½æœ‰ç‚¹ç»•ï¼Œä½†æ˜¯å…¶å® koa-compose åˆ©ç”¨äº†äº‹ä»¶å¾ªç¯çš„æœºåˆ¶ï¼Œå¯¹äºå¾®ä»»åŠ¡æ¯æ¬¡æ‰§è¡Œéƒ½ä¼šæ”¾åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œç­‰å¾…ä¸»çº¿ç¨‹æ‰§è¡Œæ ˆè°ƒç”¨ï¼Œè€Œæ ˆçš„ç‰¹ç‚¹å°±æ˜¯å…ˆè¿›åå‡ºï¼Œæ‰€ä»¥è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¼šè¾“å‡º 1,3,4,2 çš„åŸå› äº†ã€‚\r\n\r\n## æœ€å\r\n\r\nå¦‚æœæ–‡ç« æœ‰è¯´çš„ä¸å¯¹åœ°æ–¹æ¬¢è¿æŒ‡å‡ºï¼Œæœ€åæœ¬äººæ­£åœ¨æ‰¾å·¥ä½œï¼Œæœ‰ç›¸å…³ hc å²—ä½æ¬¢è¿æ»´æ»´ã€‚\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/99/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/99/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/90",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/90/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/90/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/90/events",
          "html_url": "https://github.com/bosens-China/blog/issues/90",
          "id": 1115786958,
          "node_id": "I_kwDOCzPAy85CgY7O",
          "number": 90,
          "title": "vite æºç è§£æä¹‹ create-vite ",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 3661377607,
              "node_id": "LA_kwDOCzPAy87aPDBH",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/Node%E7%B3%BB%E5%88%97",
              "name": "Nodeç³»åˆ—",
              "color": "9F9262",
              "default": false,
              "description": "å’Œnode.jsç›¸å…³å†…å®¹"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2022-01-27T05:20:46Z",
          "updated_at": "2022-01-27T05:20:46Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "\r\n![home](https://user-images.githubusercontent.com/39508895/151296625-9fdcf1c2-7cfb-40b8-8c55-4ffe42540073.png)\r\n\r\n\r\nå¦‚é¢˜è¿™æ˜¯ä¸€ä¸ªç³»åˆ—æ–‡ç« ä¸è¿‡æ›´æ–°èµ·æ¥å¯èƒ½å¾ˆç¼“æ…¢ï¼Œä» [vite](https://github.com/vitejs/vite) å‡ºæ¥ä¹‹é™…æˆ‘å°±å¼€å§‹å…³æ³¨ï¼Œç›®å‰ [npm](https://www.npmjs.com/package/vite) çš„åŒ…ä¸‹è½½é‡ä¸º `1,589,416+`ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»éå¸¸ç¨³å®šäº†ã€‚è€Œä¸”å¼€å‘ååˆ†é¦™ï¼Œå®Œå…¨å°±æ˜¯å¼€ç®±å³ç”¨ï¼Œä¸‹é¢å°±æ¥æ¢è®¨ä¸€ä¸‹ vite æ˜¯å¦‚ä½•å°†é¡¹ç›®åˆ›å»ºåˆ°ç›®å½•ä¸­çš„ã€‚\r\n\r\n## ä½¿ç”¨æ–¹å¼\r\n\r\nç›®å‰æ¯”è¾ƒç«çš„ç®¡ç†ä»£ç å½¢å¼ä¸º monorepoï¼ŒVue3 å’Œ vite éƒ½é‡‡å–äº†è¿™ç§æ–¹å¼ï¼Œæ‰“å¼€ [packages](https://github.com/vitejs/vite/tree/main/packages) å¯ä»¥å¾ˆæ˜æ˜¾çœ‹åˆ°åˆ†å¸ƒåœ¨ packages ä¸‹çš„å„ä¸ªåŒ…ï¼Œè¿™ç¯‡æ–‡ç« é‡ç‚¹èŠä¸€èŠ `create-vite`ã€‚\r\n\r\næ‰“å¼€ create-vite ç›®å½•å¯ä»¥çœ‹åˆ°ä¸‹é¢ç»“æ„\r\n\r\n![ç•Œé¢](https://user-images.githubusercontent.com/39508895/151296636-12bc9f7f-8483-42d2-b75b-8a95463e9a7a.png)\r\n\r\n\r\nå…¶ä¸­ä»¥ **template-** å¼€å¤´çš„æ–‡ä»¶ä¸ºæ¨¡æ¿æ–‡ä»¶ï¼Œè€Œ \\_\\_test\\_\\_ å¼€å¤´çš„æ˜¯æµ‹è¯•æ–‡ä»¶ï¼Œ`updateVersions.ts` æ˜¯æ›´æ–°ç›¸å…³ template æ–‡ä»¶å¤¹ä¸‹çš„ `package.json` æ–‡ä»¶è®©å…¶ä¸ vite çš„ç‰ˆæœ¬å·ä¿æŒä¸€è‡´ã€‚\r\n\r\næˆ‘ä»¬é‡ç‚¹çœ‹ index.js æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶è´Ÿè´£å…·ä½“çš„åˆ›å»ºï¼Œä¸è¿‡åœ¨è¯´æºç ä¹‹å‰å…ˆçœ‹ä¸‹æ–‡æ¡£çš„ä½¿ç”¨å½¢å¼\r\n\r\n- `npm init vite@latest`\r\n- `npm init vite@latest my-vue-app --template vue`\r\n\r\nè¿™é‡Œ init å…¶å®æ˜¯ä¸€ä¸ªå¿«æ·æŒ‡ä»¤ï¼Œå®ƒç›¸å½“äºæŠŠ `create-vite` ç®€åŒ–æˆåªéœ€è¦ `init create-åé¢éƒ¨åˆ†å³å¯`ï¼Œyarn ä¸‹çš„ create ä¹Ÿè·Ÿ npm init ç±»ä¼¼ã€‚\r\n\r\nå¦‚æœç›´æ¥ä½¿ç”¨ç¬¬ä¸€ç§å½¢å¼ï¼Œvite ä¼šè¯¢é—®ä¸€ç³»åˆ—ä¿¡æ¯ï¼Œä¾‹å¦‚åŒ…çš„åç§°ã€æ¨¡æ¿ç­‰ï¼Œè€Œä½¿ç”¨ç¬¬äºŒç§å½¢å¼åˆ™å¯ä»¥çœç•¥è¯¢é—®ä¿¡æ¯ã€‚\r\n\r\n> [vite é•œåƒç½‘ç«™](https://vitejs.bootcss.com/guide/#using-unreleased-commits)\r\n\r\n## æºç \r\n\r\nvite-create ä½¿ç”¨äº†ä¸‰ä¸ªæ¨¡å—ï¼Œè¿™é‡Œæå‰è¯´ä¸‹å®ƒä»¬çš„ä½œç”¨æ˜¯ä»€ä¹ˆ\r\n\r\n### minimist\r\n\r\n[minimist](https://www.npmjs.com/package/minimist) çš„ä½œç”¨å°±æ˜¯å°†å‘½ä»¤è¡Œè¾“å…¥çš„ä¿¡æ¯è§£æå‡ºæ¥ï¼Œä¾‹å¦‚ä¸Šé¢æˆ‘ä»¬ä½¿ç”¨ `npm init vite@latest my-vue-app --template vue` å®ƒä¼šå°†å…¶è§£ææˆä¸‹é¢å†…å®¹\r\n\r\n```js\r\n{\r\n  _: ['my-vue-app'],\r\n  template: 'vue'\r\n}\r\n```\r\n\r\n### prompts\r\n\r\n[prompts](https://www.npmjs.com/package/prompts) åˆ™æ˜¯ä¸ç”¨æˆ·äº¤äº’çš„ä¸€ä¸ªåŒ…ï¼Œå®ƒæä¾›äº† `input`ã€`select` ç­‰äº¤äº’æ–¹å¼ï¼Œæ›´å¤šå†…å®¹å¯ä»¥æŸ¥çœ‹æ–‡æ¡£äº†è§£ã€‚\r\n\r\n### kolorist\r\n\r\n[kolorist](https://www.npmjs.com/package/kolorist) å®ƒæ˜¯ä¸€ä¸ª color åŒ…ï¼Œä¸»è¦ä½œç”¨å°±æ˜¯è®© node å±•ç¤ºçš„æ–‡å­—æ›´æœ‰è¶£ï¼Œä¸å†æ˜¯é»˜è®¤çš„é¢œè‰²ã€‚\r\n\r\n### æµç¨‹\r\n\r\nvite-create å°†ä»»åŠ¡æ”¾åˆ°äº† init å‡½æ•°ä¸­ï¼Œä¸ºäº†ä¿æŒé˜…è¯»ä½“éªŒè¿™é‡Œç›´æ¥åœ¨ä»£ç ä¸­è¿›è¡Œè®²è§£\r\n\r\n```js\r\nasync function init() {\r\n  // è·å–é»˜è®¤è¾“å…¥çš„æ–‡ä»¶å¤¹åç§°ï¼Œä¾‹å¦‚ npm init vite@latest my-vue-app --template vue è¿™ä¸ªæ—¶å€™ targetDir ä¸º my-vue-app\r\n  let targetDir = argv._[0];\r\n  // è·å–æ˜¯å¦æœ‰æŒ‡å®šçš„ template\r\n  let template = argv.template || argv.t;\r\n  // é»˜è®¤åˆ›å»ºé¡¹ç›®åç§°\r\n  const defaultProjectName = !targetDir ? 'vite-project' : targetDir;\r\n  // prompts è¿”å›çš„ä¸€ç³»åˆ—ç»“æœ\r\n  let result = {};\r\n\r\n  /*\r\n   * prompts å¦‚æœ type ä¸º null ä¸ä¼šæ‰§è¡Œä¸‹å»ï¼Œå¹¶ä¸” prompts çš„ tasks æ˜¯æŒ‰ç…§é¡ºåºæ‰§è¡Œä¸‹å»çš„\r\n   */\r\n\r\n  try {\r\n    result = await prompts(\r\n      [\r\n        // å¦‚æœæ²¡æœ‰æŒ‡å®š targetDir åˆ™éœ€è¦ç”¨æˆ·æ‰‹åŠ¨è¾“å…¥\r\n        {\r\n          type: targetDir ? null : 'text',\r\n          name: 'projectName',\r\n          message: reset('Project name:'),\r\n          initial: defaultProjectName,\r\n          onState: (state) =>\r\n            (targetDir = state.value.trim() || defaultProjectName),\r\n        },\r\n        // å¦‚æœç›®æ ‡ç›®å½•å­˜åœ¨ï¼Œè¦æ±‚ç”¨æˆ·æŒ‡å®šå¤„ç†æ–¹å¼ï¼Œæ˜¯åˆ é™¤è¿˜æ˜¯é€€å‡º\r\n        {\r\n          type: () =>\r\n            !fs.existsSync(targetDir) || isEmpty(targetDir) ? null : 'confirm',\r\n          name: 'overwrite',\r\n          message: () =>\r\n            (targetDir === '.'\r\n              ? 'Current directory'\r\n              : `Target directory \"${targetDir}\"`) +\r\n            ` is not empty. Remove existing files and continue?`,\r\n        },\r\n        //å¦‚æœä¸Šä¸€æ­¥é€‰æ‹©åˆ é™¤ä¸º false é€€å‡º\r\n        {\r\n          type: (_, { overwrite } = {}) => {\r\n            if (overwrite === false) {\r\n              throw new Error(red('âœ–') + ' Operation cancelled');\r\n            }\r\n            return null;\r\n          },\r\n          name: 'overwriteChecker',\r\n        },\r\n        // æ ¡éªŒè¾“å…¥é¡¹ç›®åç§°æ˜¯å¦ç¬¦åˆ npm åç§°ï¼Œå¦‚æœä¸ç¬¦åˆè§„åˆ™åˆ™ä¸èƒ½é€šè¿‡\r\n        {\r\n          type: () => (isValidPackageName(targetDir) ? null : 'text'),\r\n          name: 'packageName',\r\n          message: reset('Package name:'),\r\n          initial: () => toValidPackageName(targetDir),\r\n          validate: (dir) =>\r\n            isValidPackageName(dir) || 'Invalid package.json name',\r\n        },\r\n        // ç”¨æˆ·å¦‚æœç›´æ¥ä¼ é€’çš„ template ä¸å­˜åœ¨æ¨¡æ¿ä¸­è®©å…¶é‡æ–°é€‰æ‹©\r\n        {\r\n          type: template && TEMPLATES.includes(template) ? null : 'select',\r\n          name: 'framework',\r\n          message:\r\n            typeof template === 'string' && !TEMPLATES.includes(template)\r\n              ? reset(\r\n                  `\"${template}\" isn't a valid template. Please choose from below: `\r\n                )\r\n              : reset('Select a framework:'),\r\n          initial: 0,\r\n          choices: FRAMEWORKS.map((framework) => {\r\n            const frameworkColor = framework.color;\r\n            return {\r\n              title: frameworkColor(framework.name),\r\n              value: framework,\r\n            };\r\n          }),\r\n        },\r\n        // é€‰æ‹©æ˜¯ js é¡¹ç›®è¿˜æ˜¯ ts é¡¹ç›®\r\n        {\r\n          type: (framework) =>\r\n            framework && framework.variants ? 'select' : null,\r\n          name: 'variant',\r\n          message: reset('Select a variant:'),\r\n          // @ts-ignore\r\n          choices: (framework) =>\r\n            framework.variants.map((variant) => {\r\n              const variantColor = variant.color;\r\n              return {\r\n                title: variantColor(variant.name),\r\n                value: variant.name,\r\n              };\r\n            }),\r\n        },\r\n      ],\r\n      // å¦‚æœæ²¡æœ‰é€‰æ‹© crrl + c é€€å‡º\r\n      {\r\n        onCancel: () => {\r\n          throw new Error(red('âœ–') + ' Operation cancelled');\r\n        },\r\n      }\r\n    );\r\n  } catch (cancelled) {\r\n    console.log(cancelled.message);\r\n    return;\r\n  }\r\n\r\n  // user choice associated with prompts\r\n  const { framework, overwrite, packageName, variant } = result;\r\n\r\n  const root = path.join(cwd, targetDir);\r\n  // ä¸Šé¢æåˆ°äº†å¦‚æœç›®å½•å­˜åœ¨ï¼Œåˆ™è¦æ±‚è¿›è¡Œåˆ é™¤\r\n  if (overwrite) {\r\n    emptyDir(root);\r\n  } else if (!fs.existsSync(root)) {\r\n    // å¦‚æœä¸å­˜åœ¨ç›®å½•åˆ›å»º\r\n    fs.mkdirSync(root);\r\n  }\r\n\r\n  // determine template\r\n  template = variant || framework || template;\r\n\r\n  console.log(`\\nScaffolding project in ${root}...`);\r\n\r\n  // å½“å‰æ¨¡æ¿æ–‡ä»¶æ‰€åœ¨è·¯å¾„\r\n  const templateDir = path.join(__dirname, `template-${template}`);\r\n\r\n  const write = (file, content) => {\r\n    const targetPath = renameFiles[file]\r\n      ? path.join(root, renameFiles[file])\r\n      : path.join(root, file);\r\n    if (content) {\r\n      fs.writeFileSync(targetPath, content);\r\n    } else {\r\n      copy(path.join(templateDir, file), targetPath);\r\n    }\r\n  };\r\n\r\n  /*\r\n   * å†™å…¥æ–‡ä»¶ï¼Œpackage.json å•ç‹¬å¤„ç†\r\n   */\r\n  const files = fs.readdirSync(templateDir);\r\n  for (const file of files.filter((f) => f !== 'package.json')) {\r\n    write(file);\r\n  }\r\n\r\n  const pkg = require(path.join(templateDir, `package.json`));\r\n\r\n  pkg.name = packageName || targetDir;\r\n\r\n  write('package.json', JSON.stringify(pkg, null, 2));\r\n\r\n  // è¿™é‡Œæ˜¯æŸ¥çœ‹è°ƒç”¨ç¨‹åºçš„æ˜¯ yarn è¿˜æ˜¯ npm æˆ–è€… pnpm\r\n  const pkgInfo = pkgFromUserAgent(process.env.npm_config_user_agent);\r\n  const pkgManager = pkgInfo ? pkgInfo.name : 'npm';\r\n\r\n  console.log(`\\nDone. Now run:\\n`);\r\n  if (root !== cwd) {\r\n    console.log(`  cd ${path.relative(cwd, root)}`);\r\n  }\r\n  switch (pkgManager) {\r\n    case 'yarn':\r\n      console.log('  yarn');\r\n      console.log('  yarn dev');\r\n      break;\r\n    default:\r\n      console.log(`  ${pkgManager} install`);\r\n      console.log(`  ${pkgManager} run dev`);\r\n      break;\r\n  }\r\n  console.log();\r\n}\r\n```\r\n\r\nä¸Šé¢çš„æµç¨‹è¿˜æ˜¯å¾ˆæ¸…æ™°çš„æ¦‚æ‹¬ä¸‹æ¥å°±æ˜¯\r\n\r\n- è¦æ±‚ç”¨æˆ·è¾“å…¥åˆ›å»ºæ‰€éœ€è¦çš„é¡¹ç›®åç§°ï¼ˆå¦‚æœç”¨æˆ·æŒ‡å®šè·³è¿‡\r\n- å¦‚æœé¡¹ç›®å­˜åœ¨ï¼Œåˆ™è¯¢é—®æ˜¯å¦åˆ é™¤\r\n- æ ¡éªŒè¾“å…¥çš„åç§°æ˜¯å¦ç¬¦åˆ `npm.name` çš„è¦æ±‚\r\n- å¦‚æœç”¨æˆ·æŒ‡å®š template åˆ™è¿›è¡Œæ ¡éªŒï¼ŒæŒ‡å®š template å¦‚æœä¸å­˜åœ¨é‡æ–°è¦æ±‚é€‰æ‹©\r\n- æ‹‰å–æŒ‡å®šæ¨¡æ¿ä»“åº“ï¼Œå°†å…¶ copy åˆ°ç›®æ ‡æ–‡ä»¶å¤¹ä¸‹\r\n- ä¿®æ”¹ package.json æ–‡ä»¶è¾“å…¥\r\n- è¾“å‡ºå®Œæˆä¿¡æ¯ï¼Œç»“æŸ\r\n\r\nä¹‹å‰è®²è§£ `init` å‡½æ•°ä¸ºäº†é˜…è¯»çœç•¥äº†ä¸€äº›å‰ç½®å®šä¹‰çš„å˜é‡ï¼Œè¿™é‡Œæ”¾å‡ºæ¥ã€‚\r\n\r\n```js\r\nconst cwd = process.cwd();\r\n\r\nconst FRAMEWORKS = [\r\n  {\r\n    name: 'vanilla',\r\n    color: yellow,\r\n    variants: [\r\n      {\r\n        name: 'vanilla',\r\n        display: 'JavaScript',\r\n        color: yellow,\r\n      },\r\n      {\r\n        name: 'vanilla-ts',\r\n        display: 'TypeScript',\r\n        color: blue,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: 'vue',\r\n    color: green,\r\n    variants: [\r\n      {\r\n        name: 'vue',\r\n        display: 'JavaScript',\r\n        color: yellow,\r\n      },\r\n      {\r\n        name: 'vue-ts',\r\n        display: 'TypeScript',\r\n        color: blue,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: 'react',\r\n    color: cyan,\r\n    variants: [\r\n      {\r\n        name: 'react',\r\n        display: 'JavaScript',\r\n        color: yellow,\r\n      },\r\n      {\r\n        name: 'react-ts',\r\n        display: 'TypeScript',\r\n        color: blue,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: 'preact',\r\n    color: magenta,\r\n    variants: [\r\n      {\r\n        name: 'preact',\r\n        display: 'JavaScript',\r\n        color: yellow,\r\n      },\r\n      {\r\n        name: 'preact-ts',\r\n        display: 'TypeScript',\r\n        color: blue,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: 'lit',\r\n    color: lightRed,\r\n    variants: [\r\n      {\r\n        name: 'lit',\r\n        display: 'JavaScript',\r\n        color: yellow,\r\n      },\r\n      {\r\n        name: 'lit-ts',\r\n        display: 'TypeScript',\r\n        color: blue,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    name: 'svelte',\r\n    color: red,\r\n    variants: [\r\n      {\r\n        name: 'svelte',\r\n        display: 'JavaScript',\r\n        color: yellow,\r\n      },\r\n      {\r\n        name: 'svelte-ts',\r\n        display: 'TypeScript',\r\n        color: blue,\r\n      },\r\n    ],\r\n  },\r\n];\r\n\r\nconst TEMPLATES = FRAMEWORKS.map(\r\n  (f) => (f.variants && f.variants.map((v) => v.name)) || [f.name]\r\n).reduce((a, b) => a.concat(b), []);\r\n\r\nconst renameFiles = {\r\n  _gitignore: '.gitignore',\r\n};\r\n```\r\n\r\n`FRAMEWORKS` å®šä¹‰äº†æ¨¡æ¿çš„ä¿¡æ¯ï¼Œè€Œ `TEMPLATES` ç®€å•æ¥è¯´å°±æ˜¯å°† `TEMPLATES.name` ä¸‹çš„ä¿¡æ¯è¿”å›ï¼Œ\r\né…åˆ prompts åšæ ¡éªŒå’Œé‡æ–°é€‰æ‹©ä½¿ç”¨ï¼Œå®ƒçš„å€¼å¦‚ä¸‹\r\n\r\n```js\r\n[\r\n  'vanilla',\r\n  'vanilla-ts',\r\n  'vue',\r\n  'vue-ts',\r\n  'react',\r\n  'react-ts',\r\n  'preact',\r\n  'preact-ts',\r\n  'lit',\r\n  'lit-ts',\r\n  'svelte',\r\n  'svelte-ts',\r\n];\r\n```\r\n\r\n`renameFiles` åˆ™æ˜¯é‡å‘½åæ–‡ä»¶ï¼Œå°†ä¸€äº›ç‰¹æ®Šçš„æ–‡ä»¶é‡æ–°å‘½åè¾“å‡ºã€‚\r\n\r\nå½“ç„¶ vite-create ä¹Ÿç”¨äº† `fs` çš„ `path` çš„ä¸€äº›æ–¹æ³•ï¼Œè¿™é‡Œé€‰å–é‡ç‚¹çš„å‡ ä¸ªå‡½æ•°è®²è§£ï¼Œå‰©ä½™çš„å‡ ä¸ªå‡½æ•°å¯ä»¥è‡ªè¡Œå»æºç æŸ¥çœ‹ [create-vite/index.js](https://github.com/vitejs/vite/blob/main/packages/create-vite/index.js)\r\n\r\n**emptyDir**\r\n\r\n```js\r\nfunction emptyDir(dir) {\r\n  if (!fs.existsSync(dir)) {\r\n    return;\r\n  }\r\n  for (const file of fs.readdirSync(dir)) {\r\n    const abs = path.resolve(dir, file);\r\n    // baseline is Node 12 so can't use rmSync :(\r\n    if (fs.lstatSync(abs).isDirectory()) {\r\n      emptyDir(abs);\r\n      fs.rmdirSync(abs);\r\n    } else {\r\n      fs.unlinkSync(abs);\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nè¿™ä¸ªæ–¹æ³•æ˜¯åˆ é™¤æ–‡ä»¶å¤¹ï¼Œnode çš„åˆ é™¤æ–‡ä»¶å¤¹å¿…é¡»ä¿è¯æ–‡ä»¶å¤¹å†…æ²¡æœ‰æ–‡ä»¶ï¼Œæ‰€ä»¥éœ€è¦é€’å½’ä¸€å±‚å±‚çš„åˆ é™¤ã€‚\r\n\r\n**isEmpty**\r\n\r\n```js\r\nfunction isEmpty(path) {\r\n  return fs.readdirSync(path).length === 0;\r\n}\r\n```\r\n\r\nè¿™ä¸ªæ–¹æ³•æ¯”è¾ƒç®€å•ï¼Œåˆ¤æ–­ç›®æ ‡æ–‡ä»¶å¤¹çš„æ–‡ä»¶æ•°é‡ï¼Œå¦‚æœä¸å­˜åœ¨è¡¨ç¤ºä¸ºç©ºã€‚\r\n\r\n**copy**\r\n\r\n```js\r\nfunction copy(src, dest) {\r\n  const stat = fs.statSync(src);\r\n  if (stat.isDirectory()) {\r\n    copyDir(src, dest);\r\n  } else {\r\n    fs.copyFileSync(src, dest);\r\n  }\r\n}\r\n```\r\n\r\né…åˆ `copyDir` æ–¹æ³•ï¼Œæ¥å®Œæˆæ•´ä½“ `copy` ç›®å½•çš„æ“ä½œ\r\n\r\n**copyDir**\r\n\r\n```js\r\nfunction copyDir(srcDir, destDir) {\r\n  fs.mkdirSync(destDir, { recursive: true });\r\n  for (const file of fs.readdirSync(srcDir)) {\r\n    const srcFile = path.resolve(srcDir, file);\r\n    const destFile = path.resolve(destDir, file);\r\n    copy(srcFile, destFile);\r\n  }\r\n}\r\n```\r\n\r\nå°† src ç›®å½•ä¸‹çš„å†…å®¹ copy åˆ° dest ä¸‹ï¼Œè¿™é‡Œé¦–å…ˆåˆ›å»º destDir ç›®å½•ï¼Œä¹‹åè°ƒç”¨ copy æ–¹æ³•ï¼Œè€Œ `copy` æ–¹æ³•åªä¼šæ‹·è´æ–‡ä»¶å¦‚æœæ˜¯æ–‡ä»¶å¤¹ç»§ç»­è°ƒç”¨ `copyDir`ã€‚\r\n\r\n## \\_\\_test\\_\\_\r\n\r\nä¸Šé¢å·²ç»æŠŠ create-vite åˆ›å»ºçš„æµç¨‹è®²äº†ä¸€éï¼Œä¸è¿‡åœ¨è½¯ä»¶å¼€å‘ä¸­å•å…ƒæµ‹è¯•ä¹Ÿæ˜¯ä¸€ä¸ªå¤§å¤´ï¼Œæ‰€ä»¥è¿™é‡Œçœ‹ä¸‹ vite-create æ˜¯æ€ä¹ˆå†™çš„å•å…ƒæµ‹è¯•ã€‚\r\n\r\nåœ¨ `cli.spec.ts` æ–‡ä»¶ä¸­ï¼Œvite å¼•ç”¨äº†ä¸¤ä¸ªåº“\r\n\r\n- [execa](https://github.com/sindresorhus/execa)ï¼šå°è£… `child_process` ä½¿ç”¨èµ·æ¥æ›´åŠ æ–¹ä¾¿ï¼›\r\n- [fs-extra](https://github.com/jprichardson/node-fs-extra)ï¼šå°è£…çš„ fs åº“ï¼Œæä¾›äº†æ›´é«˜çº§çš„ç”¨æ³•ï¼Œä¾‹å¦‚ copyã€remove ç­‰ï¼›\r\n\r\nåœ¨ jest è¿è¡Œä¹‹å‰ cli.spce.ts å®šä¹‰äº†ä¸€äº›å˜é‡\r\n\r\n```js\r\n// ..è¿”å›åˆ° index.js,package.json å­˜åœ¨çš„è¿™ä¸ªç›®å½•\r\nconst CLI_PATH = join(__dirname, '..');\r\n// é¡¹ç›®åç§°\r\nconst projectName = 'test-app';\r\n// ç”Ÿæˆçš„ç›®å½•è·¯å¾„\r\nconst genPath = join(__dirname, projectName);\r\n\r\n/*\r\n * å°è£…çš„ run æ–¹æ³•ï¼Œnode CLI_PATH ä¼šé»˜è®¤æ‰§è¡Œ CLI_PATH ä¸‹ index.js æ–‡ä»¶\r\n */\r\nconst run = (\r\n  args: string[],\r\n  options: SyncOptions<string> = {}\r\n): ExecaSyncReturnValue<string> => {\r\n  return commandSync(`node ${CLI_PATH} ${args.join(' ')}`, options);\r\n};\r\n\r\n/*\r\n * å†™å…¥ package.json æ–‡ä»¶ï¼Œä¸ºäº†æ–¹ä¾¿æµ‹è¯•åç»­çš„ package.json ä¿¡æ¯\r\n */\r\n// Helper to create a non-empty directory\r\nconst createNonEmptyDir = () => {\r\n  // Create the temporary directory\r\n  mkdirpSync(genPath);\r\n\r\n  // Create a package.json file\r\n  const pkgJson = join(genPath, 'package.json');\r\n  writeFileSync(pkgJson, '{ \"foo\": \"bar\" }');\r\n};\r\n\r\n// Vue 3 starter template\r\nconst templateFiles = readdirSync(join(CLI_PATH, 'template-vue'))\r\n  // _gitignore is renamed to .gitignore\r\n  .map((filePath) => (filePath === '_gitignore' ? '.gitignore' : filePath))\r\n  .sort();\r\n\r\n// è¿è¡Œä¹‹å‰æ‰§è¡Œæ­¥éª¤ï¼Œåªä¼šæ‰§è¡Œä¸€æ¬¡\r\nbeforeAll(() => remove(genPath));\r\n// æ¯æ¬¡è¿è¡Œä¹‹åæ‰§è¡Œæ­¥éª¤\r\nafterEach(() => remove(genPath));\r\n```\r\n\r\nokï¼Œä¸Šé¢å°±æŠŠä¸€äº›å…³é”®çš„ç‚¹è¯´äº†ï¼Œæˆ‘ä»¬æ¥é€æ¡åˆ†ææµ‹è¯•ç”¨ä¾‹\r\n\r\n### prompts for the project name if none supplied\r\n\r\n```js\r\ntest('prompts for the project name if none supplied', () => {\r\n  const { stdout, exitCode } = run([]);\r\n  expect(stdout).toContain('Project name:');\r\n});\r\n```\r\n\r\n[toContain](https://jestjs.io/zh-Hans/docs/expect) ä½œç”¨ç®€å•æ¥è¯´å°±æ˜¯åŒ¹é…æ•°ç»„æœ‰æ²¡æœ‰å½“å‰å€¼ä¿¡æ¯ï¼Œè¿™æ¡ test æ˜¯ä¸ºäº†éªŒè¯å¦‚æœæ²¡æœ‰è¾“å…¥é¡¹ç›®åç§°æ˜¯å¦å‡ºç° prompts äº¤äº’ä¿¡æ¯\r\n\r\n> è¿™é‡Œå¯ä»¥å‡ºç°äº¤äº’å¾—ç›Šäºä½¿ç”¨çš„ execa åº“ï¼Œè¿™ä¸ªæ˜¯å®ƒçš„åŠŸèƒ½ä¹‹ä¸€\r\n\r\n### prompts for the framework if none supplied\r\n\r\n```js\r\ntest('prompts for the framework if none supplied', () => {\r\n  const { stdout } = run([projectName]);\r\n  expect(stdout).toContain('Select a framework:');\r\n});\r\n```\r\n\r\næŒ‰ç…§ init å‡½æ•°çš„åˆ†æï¼Œè¾“å…¥åç§°å¹¶ä¸”é¡¹ç›®æ²¡æœ‰é‡å¤çš„ï¼Œä¸”ç”¨æˆ·ä¹Ÿæ²¡æœ‰æŒ‡å®š template å°±éœ€è¦é€‰æ‹©æ¡†æ¶äº†ï¼Œè¿™æ¡ jest å°±æ˜¯ä¸ºäº†æµ‹è¯• prompts é¡ºåºã€‚\r\n\r\n### prompts for the framework on not supplying a value for --template\r\n\r\n```js\r\ntest('prompts for the framework on not supplying a value for --template', () => {\r\n  const { stdout } = run([projectName, '--template']);\r\n  expect(stdout).toContain('Select a framework:');\r\n});\r\n```\r\n\r\nç»§ç»­æµ‹è¯• framework æƒ…å†µã€‚å¦‚æœæŒ‡å®š `--template` ä½†æ˜¯æ²¡æœ‰æŒ‡å®š vueã€reactï¼Œ minimist ä¼šå°†å…¶è§£ææˆ trueï¼Œå½“ç„¶ä¹Ÿä¸ç¬¦åˆæƒ…å†µã€‚\r\n\r\n### prompts for the framework on supplying an invalid template\r\n\r\n```js\r\ntest('prompts for the framework on supplying an invalid template', () => {\r\n  const { stdout } = run([projectName, '--template', 'unknown']);\r\n  expect(stdout).toContain(\r\n    `\"unknown\" isn't a valid template. Please choose from below:`\r\n  );\r\n});\r\n```\r\n\r\næŒ‡å®šé”™è¯¯çš„ template ä¼šå‡ºç°é”™è¯¯æç¤ºï¼Œæ ¡éªŒ init å‡½æ•°çš„éªŒè¯ã€‚\r\n\r\n### asks to overwrite non-empty target directory\r\n\r\n```js\r\ntest('asks to overwrite non-empty target directory', () => {\r\n  createNonEmptyDir();\r\n  const { stdout } = run([projectName], { cwd: __dirname });\r\n  expect(stdout).toContain(`Target directory \"${projectName}\" is not empty.`);\r\n});\r\n```\r\n\r\næµ‹è¯•é¡¹ç›®ç›®å½•å¦‚æœå­˜åœ¨æƒ…å†µï¼ŒcreateNonEmptyDir è¿™ä¸ªæ–¹æ³•å‰é¢æœ‰è®²åˆ°ï¼Œç¡®ä¿ç›®å½•ä¸€å®šå­˜åœ¨å¹¶ä¸”å†™å…¥ä¸€äº› package.json ä¿¡æ¯ã€‚\r\n\r\n### asks to overwrite non-empty current directory\r\n\r\n```js\r\ntest('asks to overwrite non-empty current directory', () => {\r\n  createNonEmptyDir();\r\n  const { stdout } = run(['.'], { cwd: genPath, input: 'test-app\\n' });\r\n  expect(stdout).toContain(`Current directory is not empty.`);\r\n});\r\n```\r\n\r\næµ‹è¯•è¾“å…¥é¡¹ç›®åç§°ä¸èƒ½ä¸º `.`ï¼Œ`.` ä¼šè¿”å›å½“å‰ `process.cwd()` ç›®å½•ï¼ŒæŒ‰ç…§ init å‡½æ•°çš„æµç¨‹ï¼Œå¦‚æœç›®å½•å­˜åœ¨ä¼šæç¤ºæ˜¯å¦åˆ é™¤ï¼Œå¦‚æœæ‰§è¡Œäº†åˆ é™¤å°±æ˜¯ä¸€ä¸ªé‡å¤§ bug äº†ã€‚\r\n\r\n### successfully scaffolds a project based on vue starter template\r\n\r\n```js\r\ntest('successfully scaffolds a project based on vue starter template', () => {\r\n  const { stdout } = run([projectName, '--template', 'vue'], {\r\n    cwd: __dirname,\r\n  });\r\n  const generatedFiles = readdirSync(genPath).sort();\r\n\r\n  // Assertions\r\n  expect(stdout).toContain(`Scaffolding project in ${genPath}`);\r\n  expect(templateFiles).toEqual(generatedFiles);\r\n});\r\n```\r\n\r\nè¿™é‡Œæµ‹è¯•äº†ä¸¤æ¡\r\n\r\n- èµ°å®Œäº†æ‰€æœ‰æµç¨‹ï¼›\r\n- ç¡®å®šè¾“å‡ºçš„æ–‡ä»¶ä¿¡æ¯å’Œ templateFiles æ˜¯ä¸€æ ·çš„ï¼›\r\n\r\n### works with the -t alias\r\n\r\n```js\r\ntest('works with the -t alias', () => {\r\n  const { stdout } = run([projectName, '-t', 'vue'], {\r\n    cwd: __dirname,\r\n  });\r\n  const generatedFiles = readdirSync(genPath).sort();\r\n\r\n  // Assertions\r\n  expect(stdout).toContain(`Scaffolding project in ${genPath}`);\r\n  expect(templateFiles).toEqual(generatedFiles);\r\n});\r\n```\r\n\r\nè¿™é‡Œä¸»è¦æ˜¯æµ‹è¯•ç®€å†™è¯­æ³•æ˜¯å¦å¯ä»¥è¯†åˆ«ã€‚\r\n\r\n## æœ€å\r\n\r\nå¦‚æœæ–‡ç« æœ‰é”™åˆ«å­—æˆ–è€…ä¸å¯¹çš„åœ°æ–¹æ¬¢è¿æŒ‡å‡ºã€‚\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/90/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/90/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/89",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/89/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/89/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/89/events",
          "html_url": "https://github.com/bosens-China/blog/issues/89",
          "id": 1103349199,
          "node_id": "I_kwDOCzPAy85Bw8XP",
          "number": 89,
          "title": "ä½¿ç”¨ TypeScript æ¥ç¼–å†™ cli ç¨‹åº",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 3661377607,
              "node_id": "LA_kwDOCzPAy87aPDBH",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/Node%E7%B3%BB%E5%88%97",
              "name": "Nodeç³»åˆ—",
              "color": "9F9262",
              "default": false,
              "description": "å’Œnode.jsç›¸å…³å†…å®¹"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2022-01-14T09:35:23Z",
          "updated_at": "2022-01-14T09:37:18Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "æ–°çš„ä¸€å¹´å·²ç»å¼€å§‹ï¼Œä¹‹å‰åœ¨çŸ¥ä¹åˆ·åˆ°ä¸€ç¯‡æ–°å¹´å±•æœ›è´´ [2022 å‰ç«¯æŠ€æœ¯é¢†åŸŸä¼šæœ‰å“ªäº›æ–°çš„å˜åŒ–ï¼Ÿ](https://www.zhihu.com/question/493891614/answer/2269197391)ï¼Œé‡Œé¢çš„å°ä¼™ä¼´å›ç­”äº†å¾ˆå¤šï¼Œè¿™é‡Œç¨å¾®å½’çº³ä¸€ä¸‹å›ç­”ï¼š\r\n\r\n- Monorepo\r\n- TypeScript\r\n- ESBuild\r\n- ESM åŒ–\r\n- pnpm\r\n- ...\r\n\r\nä¸Šé¢çš„å›ç­”ä¸­ `TypeScript` æåŠçš„æ¬¡æ•°å¾ˆå¤šï¼ŒåŸå› å¾ˆæ˜¯éšç€é¡¹ç›®å¤æ‚ç¨‹åº¦çš„æ—¥è¶‹å¢åŠ ï¼Œéœ€è¦å¯¹ä»£ç è¿›è¡Œä¸€ä¸ªä¸¥æ ¼ç®¡ç†ï¼Œä¸” TypeScript å¯¹ç¼–è¾‘å™¨çš„æ™ºèƒ½æç¤ºå¤ªé¦™äº†ï¼Œç”¨å®Œä¹‹åæ ¹æœ¬æ²¡åŠæ³•æ‹’ç»ã€‚ä¸”è¶Šå¤šæ¡†æ¶å’Œç”Ÿæ€éƒ½åœ¨å¾€å…¶è¿å¾™ï¼Œä½œä¸º er çš„ä¸€ä»½å­ï¼Œæˆ‘ä»¬ä¹Ÿåº”å½“è¿›è¡Œæ‹¥æŠ±ã€‚\r\n\r\nè¿™é‡Œä»¥ node cli çš„å¼€å‘åœºæ™¯è¿›è¡Œä¸¾ä¾‹ï¼Œå› ä¸ºå®ƒçš„ä½¿ç”¨éšå¤„å¯è§ï¼Œä¾‹å¦‚ `vite`ã€`react` æˆ–è€…å†…éƒ¨è‡ªå·±ä½¿ç”¨çš„è„šæ‰‹æ¶ã€‚\r\n\r\n## å¦‚ä½•å¼€å‘å‘½ä»¤è¡Œ\r\n\r\n> è¿™é‡Œæ¨èä¸€ä¸‹é˜®ä¸€å³°çš„ [Node.js å‘½ä»¤è¡Œç¨‹åºå¼€å‘æ•™ç¨‹](https://www.ruanyifeng.com/blog/2015/05/command-line-with-node.html) æ–‡ç« ï¼Œå› ä¸ºç¯‡å¹…çš„é—®é¢˜ï¼Œè¿™é‡Œä¸è¿‡å¤šè®²è§£æ— å…³å†…å®¹ã€‚\r\n\r\nåœ¨ç¼–å†™ä¸€ä¸ªå‘½ä»¤è¡Œç¨‹åºä¹‹å‰é€šå¸¸ä¼šåšä¸¤ä»¶äº‹æƒ…ï¼š\r\n\r\n1. åœ¨å…¥å£æ–‡ä»¶ç¬¬ä¸€è¡Œæ·»åŠ  `#!/usr/bin/env node`ï¼Œå®ƒçš„æ„æ€æ˜¯å‘Šè¯‰ç³»ç»Ÿå¦‚ä½•æ­£ç¡®å¤„ç†è¿™ä¸ªè„šæœ¬ï¼›\r\n2. åœ¨`package.json`çš„ bin å­—æ®µä¸‹æ·»åŠ è„šæœ¬çš„åç§°è·Ÿè·¯å¾„ï¼Œä¾‹å¦‚ï¼š\r\n\r\n```json\r\nbin: {\r\n    \"create\": \"xxx\"\r\n}\r\n```\r\n\r\nä¸Šé¢ bin å­—æ®µä¼šåœ¨å®‰è£… package çš„æ—¶å€™å°† `bin å‘½ä»¤` æ”¾ç½®åˆ° `node_modules` ä¸‹çš„ `bin ç›®å½•`ã€‚\r\n\r\nå¹³æ—¶ä½¿ç”¨çš„ webpack ä¹‹æ‰€ä»¥åœ¨ `scripts` æ‰§è¡Œçš„ `webpack xxx` å¯ä»¥é€šè¿‡ï¼Œå°±æ˜¯å› ä¸ºæŸ¥æ‰¾ `bin ç›®å½•` å­˜åœ¨ webpack çš„å‘½ä»¤ã€‚\r\n\r\nå›åˆ°ä¸»é¢˜ï¼Œä¸Šé¢è¯´äº†ä½¿ç”¨ TypeScript çš„åŸå› æ˜¯å› ä¸ºç¨‹åºçš„å¤æ‚ç¨‹åº¦åœ¨æ—¥è¶‹å¢åŠ ï¼Œé‚£å¦‚æœæˆ‘ä»¬æƒ³ä½¿ç”¨ TypeScript æ¥å¼€å‘ä¸€ä¸ª cli ç¨‹åºæœ‰æ­£ç¡®çš„å§¿åŠ¿æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ\r\n\r\nç›´æ¥åœ¨ TypeScript çš„æ–‡ä»¶ä¸Šæ·»åŠ  `#!/usr/bin/env node` ï¼Ÿ\r\n\r\n```ts\r\n#!/usr/bin/env node\r\nconst obj: Obj = {};\r\n// xxx\r\n```\r\n\r\nä¸Šé¢çš„åšæ³•è‚¯å®šä¸è¡Œï¼Œå› ä¸º node å¹¶ä¸è®¤è¯†è¿™äº›è¯­æ³•ï¼Œä¸‹é¢å°±æ¥åˆ—ä¸¾ä¸€ä¸‹æ—¥å¸¸ä½¿ç”¨çš„æ–¹å¼ã€‚\r\n\r\n## tsc\r\n\r\ntsc æ˜¯å®‰è£… TypeScript æä¾›ç»™æˆ‘ä»¬çš„ä¸€ä¸ªå‘½ä»¤ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯ç¼–è¯‘ TypeScript æ–‡ä»¶ï¼Œä¾‹å¦‚\r\n\r\n```sh\r\ntsc index.ts\r\n```\r\n\r\nå¦‚æœç›®å½•å­˜åœ¨ `tsconfig.json` æ–‡ä»¶ï¼Œè¿è¡Œ tsc ä¼šå°†æ‰€æœ‰ç¬¦åˆçš„ TypeScript æ–‡ä»¶è¾“å‡ºåˆ° `outDir` ç›®å½•ä¸‹ã€‚\r\n\r\nä¸è¿‡ä½¿ç”¨ tsc æ¥å®Œæˆæ„å»ºæœ‰ä¸¤ç‚¹é—®é¢˜ï¼š\r\n\r\n- ä¸èƒ½æ¸…ç†æ­»ä»£ç ï¼›\r\n- è¾“å‡ºçš„ `outDir`æ²¡æœ‰è·Ÿèµ„æºæ–‡ä»¶è¿›è¡Œç»‘å®šï¼›\r\n\r\nç¬¬ä¸€ç‚¹å¾ˆå¥½ç†è§£ï¼Œæˆ‘ä»¬ä½¿ç”¨ rollup ç­‰å·¥å…·ï¼Œåœ¨æŒ‡å®š input æ–‡ä»¶çš„æ—¶å€™ä¼šè¿›è¡Œä¸€ä¸ªä¾èµ–æ”¶é›†ï¼Œå¦‚æœæ²¡æœ‰æ‰§è¡Œåˆ°çš„ä»£ç å°±æ˜¯ä¸€ä¸ªæ­»ä»£ç ï¼Œä¸ä¼šè¢«æœ€ç»ˆ build å‡ºæ¥ï¼Œä¸è¿‡ä½¿ç”¨ tsc å¾ˆæ˜¾ç„¶å®ƒæ˜¯æ²¡æœ‰è¿™ä¸ªèƒ½åŠ›çš„ã€‚\r\n\r\nè€Œç¬¬äºŒç‚¹è¯´çš„åˆ™æ˜¯ï¼Œå¦‚æœ cli å·¥å…·éœ€è¦å®Œæˆæ‹‰å–ç›®å½•çš„æ“ä½œï¼Œä¾‹å¦‚\r\n\r\n```sh\r\n- index.ts\r\n- template-modules\r\n- template-server\r\n- template-react\r\n```\r\n\r\nä¸Šé¢ `index.ts` æ˜¯ç¨‹åºå…¥å£æ–‡ä»¶ï¼Œè€Œå…¶ä»–çš„ `template æ–‡ä»¶å¤¹` åªæ˜¯é™æ€èµ„æºï¼Œå¹³æ—¶ä½¿ç”¨ JavaScript é€šè¿‡ `__dirname + æ–‡ä»¶å¤¹åç§°` å³å¯ç¡®å®šç›®å½•ï¼Œè€Œç°åœ¨ä½¿ç”¨ tscï¼Œå®ƒåªä¼šå°† `index.ts` è¾“å‡ºåˆ° `outDir` ä¸‹ï¼Œå‡è®¾ `outDir` ä¸º `'./dist'`\r\n\r\n```sh\r\n- dist\r\n-  index.ts\r\n- template-modules\r\n- template-server\r\n- template-react\r\n```\r\n\r\nå¦‚æœè¿˜æŒ‰ç…§ `__dirname + æ–‡ä»¶å¤¹åç§°` å½¢å¼è¿è¡Œä»£ç æ˜¯è·å–ä¸åˆ° template ç­‰æ–‡ä»¶å¤¹çš„ã€‚\r\n\r\nç»¼åˆæ¥çœ‹ï¼Œå¦‚æœé¡¹ç›®å¾ˆç®€å•å¯ä»¥ä½¿ç”¨ tsc çš„å½¢å¼ï¼Œè€Œå¦‚æœåŒ…å« `__dirname` è¯­æ³•æˆ–è€…é™æ€èµ„æºçš„é¡¹ç›®åˆ™éœ€è¦æ³¨æ„è·¯å¾„é—®é¢˜ã€‚\r\n\r\n## rollup\r\n\r\nrollup æ˜¯ä¸‹ä¸€ä»£çš„æ‰“åŒ…å™¨ï¼Œvue å’Œ react éƒ½ä½¿ç”¨æ­¤è¿›è¡Œæ‰“åŒ…ï¼Œå› ä¸ºå®ƒçš„ä½¿ç”¨å¾ˆç®€å•å…¶æ¬¡ç”Ÿæˆçš„ä»£ç æ¯” webpack æ›´å¯è¯»ä½“ç§¯æ›´å°ã€‚\r\n\r\nä½¿ç”¨ rollup åŒæ ·ä¹Ÿå¯ä»¥å®Œæˆ cli æ‰“åŒ…ï¼Œåªéœ€è¦åœ¨ `rollup.config.js` è¿›è¡Œç›¸å…³çš„é…ç½®å³å¯ï¼Œä¸‹é¢ä»¥æˆ‘æœ€å¸¸ç”¨çš„é…ç½®ä¸ºä¾‹\r\n\r\n```js\r\n/* eslint-disable @typescript-eslint/indent */\r\n\r\nimport fs from \"fs-extra\";\r\nimport { defineConfig } from \"rollup\";\r\nimport { babel } from \"@rollup/plugin-babel\";\r\nimport commonjs from \"@rollup/plugin-commonjs\";\r\nimport path from \"path\";\r\nimport json from \"@rollup/plugin-json\";\r\nimport { preserveShebangs } from \"rollup-plugin-preserve-shebangs\";\r\nimport { terser } from \"rollup-plugin-terser\";\r\nimport { nodeResolve } from \"@rollup/plugin-node-resolve\";\r\nimport { dependencies } from \"../package.json\";\r\nimport { cwd } from \"process\";\r\nimport copyPlugin from \"rollup-plugin-copy\";\r\nimport { string } from \"rollup-plugin-string\";\r\nimport config from \"./config\";\r\n\r\nimport { DEFAULT_EXTENSIONS } from \"@babel/core\";\r\n\r\nconst extensions = [...DEFAULT_EXTENSIONS, \".ts\"];\r\n\r\nconst dist = path.join(cwd(), \"dist\");\r\nfs.removeSync(dist);\r\n\r\nexport default defineConfig(\r\n  config.map((item) => {\r\n    const { name } = path.parse(item.src);\r\n    // copyæ–‡ä»¶\r\n    const copy = item.copy || [];\r\n\r\n    return defineConfig({\r\n      input: item.src,\r\n      // ç¦æ­¢æ‰“åŒ…å¤–éƒ¨ä¾èµ–\r\n      external: [...Object.keys(dependencies), \"@babel/runtime\"],\r\n      plugins: [\r\n        nodeResolve({ extensions, rootDir: __dirname }),\r\n        commonjs(),\r\n        json(),\r\n        babel({\r\n          babelHelpers: \"runtime\",\r\n          exclude: /exclude/,\r\n          extensions,\r\n          presets: [[\"@babel/preset-env\"], \"@babel/preset-typescript\"],\r\n          // ç¦æ­¢æ‰“åŒ…é‡å¤æ¨¡å—\r\n          plugins: [\"@babel/plugin-transform-runtime\"],\r\n        }),\r\n        terser(),\r\n        copyPlugin({\r\n          targets: copy.map((item) => {\r\n            return { src: item, dest: dist };\r\n          }),\r\n        }),\r\n        preserveShebangs(),\r\n        // å¯¼å…¥éjsèµ„æº\r\n        string({\r\n          include: \"**/*.{md,html}\",\r\n          exclude: [],\r\n        }),\r\n      ],\r\n      output: {\r\n        file: path.join(\r\n          dist,\r\n          item.format === \"cjs\" ? `${name}.js` : `${name}.${item.format}.js`\r\n        ),\r\n        format: item.format,\r\n        sourcemap: true,\r\n        exports: \"auto\",\r\n      },\r\n    });\r\n  })\r\n);\r\n```\r\n\r\næŒ‡å®š inout è¿è¡Œ rollup å³å¯å®Œæˆæ‰“åŒ…ï¼Œä¸è¿‡ä½¿ç”¨ rollup æ‰“åŒ…åŒæ ·ä¹Ÿæœ‰ä¼˜ç¼ºç‚¹\r\n\r\n### ä¼˜ç‚¹\r\n\r\n- å¯ä»¥æ¸…é™¤æ— æ•ˆä»£ç ï¼›\r\n- å¯ä»¥è¿›è¡Œä»£ç å‹ç¼©ï¼›\r\n\r\n### ç¼ºç‚¹\r\n\r\n- ä¹¦å†™ä»£ç éœ€è¦é…ç½®ï¼Œä»¥åŠæ¯æ¬¡å‘å¸ƒä¹‹å‰éƒ½éœ€è¦ buildï¼ˆè™½ç„¶å¯ä»¥ watchï¼Œä½†æ˜¯ä¹Ÿæ˜¯å ç”¨èµ„æºï¼›\r\n- å¯¼å…¥é™æ€èµ„æºï¼Œä¾‹å¦‚ä¸Šé¢ tsc ä¸¾ä¾‹æ‹‰å–é™æ€èµ„æºçš„æ—¶å€™ï¼Œéœ€è¦é…ç½®æ’ä»¶å°†èµ„æºå¤åˆ¶åˆ° build ç›®å½•ä¸‹ï¼Œä¹‹åé€šè¿‡ `__dirname` å½¢å¼æ¥ä½¿ç”¨\r\n\r\n## ts-node\r\n\r\né™¤äº†ä¸Šé¢ä»‹ç»çš„ä¸¤ç§ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ ts-node æ¥å®Œæˆï¼Œæœ€å¼€å¤´çš„æ—¶å€™è®²äº†å¼€å‘ cli ä¸èƒ½ç›´æ¥ä½¿ç”¨ TypeScript çš„åŸå› å°±æ˜¯ node ä¸è¯†åˆ«è¯­æ³•ï¼Œé‚£å¦‚æœå¯ä»¥åšåˆ°è¿è¡Œæ—¶ç¼–è¯‘åˆ° JavaScript ä¸ä¹…å¯ä»¥äº†å—ï¼Ÿ\r\n\r\nå…¥å£æ–‡ä»¶è¿˜æ˜¯ä¸€ä¸ªæ™®é€šçš„ JavaScript æ–‡ä»¶ï¼Œåç»­çš„æ–‡ä»¶é€šè¿‡ ts-node æ¥è§£æè¯­æ³•è¿è¡Œã€‚\r\n\r\n```js\r\n#!/usr/bin/env node\r\nrequire(\"ts-node\").register({\r\n  /* options */\r\n});\r\n// åé¢å¯ä»¥ç›´æ¥åŠ è½½tsæ–‡ä»¶\r\nrequire(\"./index.ts\");\r\n```\r\n\r\n> æ›´å¤šé€‰é¡¹å¯ä»¥å‚è€ƒ https://typestrong.org/ts-node/api/interfaces/RegisterOptions.html\r\n\r\n### ä¼˜ç‚¹\r\n\r\n- æ”¹åŠ¨å¾ˆå°ï¼Œè·ŸåŸç”Ÿ TypeScript å†™æ³•æ²¡åŒºåˆ«ï¼›\r\n\r\n### ç¼ºç‚¹\r\n\r\n- ä¸æ”¯æŒæ­»ä»£ç å»é™¤ï¼›\r\n- è¿è¡Œé€Ÿåº¦å¾ˆæ…¢ï¼›\r\n\r\nä½¿ç”¨ ts-node æœ€è‡´å‘½çš„ç¼ºç‚¹è¿˜æ˜¯åŠ è½½å¾ˆæ…¢ï¼Œå› ä¸ºæ˜¯è¿è¡Œæ—¶è§£æï¼Œä¸”è¿˜ä¼šæ ¡éªŒ TypeScript æ–‡ä»¶ã€‚\r\n\r\n## es-build\r\n\r\nè¿™æ˜¯åŸºäº ts-node æ€è·¯æ¥çš„å˜å¼‚æ–¹æ³•ï¼Œes-build æ˜¯åŸºäº go è¯­è¨€å¼€å‘çš„æ‰“åŒ…å™¨ï¼Œå®ƒå»é™¤äº†è¿è¡Œæ—¶æ ¡éªŒï¼Œæ”¯æŒå¹¶å‘ã€‚\r\n\r\nè¿™é‡Œè´´ä¸€å¼ å®˜æ–¹çš„å¯¹æ¯”å›¾æ¥è¿›è¡Œå±•ç¤ºï¼Œå¦‚æœæƒ³äº†è§£æ›´å¤šå†…å®¹è¯·æŸ¥çœ‹ [å®˜æ–¹](https://esbuild.github.io/)ã€‚\r\n![image](https://user-images.githubusercontent.com/39508895/149493087-842eb40e-4a2e-4eac-9f48-a4f1cbc5a4b1.png)\r\n\r\n\r\nes-build ä¼šå°†ä»£ç ç¼–è¯‘ï¼Œä¸è¿‡è¿™é‡Œæˆ‘ä»¬éœ€è¦çš„æ˜¯ç›´æ¥è¿è¡Œï¼Œes-build æ²¡æœ‰æä¾›ç›¸å…³çš„æ–¹æ³•ã€‚æˆ‘ä»¬å–å·§ä¸€ä¸‹åœ¨å°†å…¥å£æ–‡ä»¶ require å¯¼å…¥çš„ TypeScript æ–‡ä»¶å…¨éƒ¨ç¼–è¯‘ï¼Œä¹‹åå†™åˆ°TypeScriptæ–‡ä»¶ç›®å½•ä¸‹è¿è¡Œï¼Œè¿è¡Œç¨‹åºç»“æŸä¹‹ååˆ é™¤æ–‡ä»¶ã€‚\r\n\r\nå¹¸è¿çš„æ˜¯ï¼Œä¸éœ€è¦æ‰‹åŠ¨æ¥å®Œæˆè¿™æ ·ä¸€ä»¶äº‹æƒ…ï¼Œç¤¾åŒºå·²ç»æœ‰ç›¸å…³çš„åº“ [esbuild-register](https://github.com/egoist/esbuild-register)ï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨å³å¯ã€‚\r\n\r\n```js\r\n#!/usr/bin/env node\r\nrequire(\"esbuild-register/dist/node\");\r\n// åé¢å¯ä»¥ç›´æ¥åŠ è½½tsæ–‡ä»¶\r\nrequire(\"./index.ts\");\r\n```\r\n\r\nå½“å‰ä¼˜ç¼ºç‚¹è·Ÿ ts-node åŸºæœ¬ç›¸åŒï¼Œè¿è¡Œé€Ÿåº¦æ…¢å¾—åˆ°äº†æ”¹å˜ã€‚\r\n\r\n## æœ€å\r\n\r\nç»¼åˆæ¥çœ‹ï¼Œå¦‚æœä½ æƒ³äº«å— TypeScript è¯­æ³•ä¸æƒ³åšå¤ªå¤šçš„æ”¹åŠ¨ï¼Œes-build çš„æ–¹æ¡ˆç»å¯¹æ˜¯æœ€ä½³å®è·µï¼Œè™½ç„¶ä¸æ”¯æŒ rollup ç­‰è¿™æ ·çš„ç”Ÿæ€ï¼Œä½†æ˜¯ç»“åˆ eslint çš„å·¥å…·å¯¹ä»£ç è¿›è¡Œæ£€æŸ¥ï¼Œè¿˜æ˜¯å¯ä»¥å¾ˆå¤§ç¨‹åº¦æ”¹å–„ã€‚\r\n\r\nå¦‚æœæ–‡ç« æœ‰ä»€ä¹ˆé”™åˆ«å­—æˆ–è€…è®²è§£ä¸å¯¹åœ°æ–¹æ¬¢è¿æŒ‡å‡ºï¼Œå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©å¯ä»¥ `star` æ”¯æŒä¸€ä¸‹ã€‚\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/89/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/89/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        }
      ]
    ],
    [
      "1908144759",
      [
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/98",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/98/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/98/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/98/events",
          "html_url": "https://github.com/bosens-China/blog/issues/98",
          "id": 1849714138,
          "node_id": "I_kwDOCzPAy85uQGXa",
          "number": 98,
          "title": "[javaScript]ES2023 å¼•å…¥éç ´åæ€§æ–¹æ³•",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1908144759,
              "node_id": "MDU6TGFiZWwxOTA4MTQ0NzU5",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/ES6%E7%B3%BB%E5%88%97",
              "name": "ES6ç³»åˆ—",
              "color": "0366d6",
              "default": false,
              "description": "ES6çš„æœ€æ–°è¯­æ³•"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2023-08-14T12:49:24Z",
          "updated_at": "2023-08-14T12:51:32Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "å¯¹äº Array çš„ä¸€äº›æ“ä½œï¼Œä¾‹å¦‚ reverseã€sort ç­‰éƒ½ä¼šæ”¹å˜åŸæ•°ç»„ï¼ŒES2023 å¯¹ä»¥ä¸‹è¿™äº›æ–¹æ³•è¿›è¡Œäº†æ‹“å±•ï¼Œæä¾›äº†ç›¸åŒåŠŸèƒ½ä½†æ˜¯è¿”å›æ–°å‰¯æœ¬çš„æ–¹æ³•ã€‚\r\n\r\n- toReversed\r\n- toSorted\r\n- toSpliced\r\n- with\r\n\r\nä¸‹é¢è¿›è¡Œä¸€ä¸ªè¯¦ç»†çš„ä»‹ç»ã€‚\r\n\r\n## toReversed\r\n\r\n- reverseï¼šåè½¬æ•°ç»„å…ƒç´ ï¼Œä½†æ˜¯ä¼šæ”¹å˜æ•°ç»„æœ¬èº«\r\n- toReversedï¼šè·Ÿ reverse åŠŸèƒ½ç›¸åŒï¼Œä½†æ˜¯è¿”å›æ–°å‰¯æœ¬ä¸ä¼šæ”¹å˜æ•°ç»„æœ¬èº«\r\n\r\nç¤ºä¾‹ 1.js\r\n\r\n```\r\n// reverse\r\nconst a = [1, 2, 3];\r\nconst b = a.reverse();\r\n\r\nconsole.log(a); // [3, 2, 1]\r\nconsole.log(b); // [3, 2, 1]\r\n\r\n// toReversed ğŸ‘\r\nconst c = [1, 2, 3];\r\nconst d = c.toReversed();\r\n\r\nconsole.log(c); // [1, 2, 3]\r\nconsole.log(d); // [3, 2, 1]\r\n```\r\n\r\n## toSorted\r\n\r\n- sortï¼šå¯¹æ•°ç»„è¿›è¡Œæ’åºï¼Œä½†æ˜¯ä¼šæ”¹å˜æ•°ç»„æœ¬èº«\r\n- toSortedï¼šè·Ÿ sort æ–¹æ³•ä¸€æ ·ï¼Œä½†æ˜¯è¿”å›æ–°å‰¯æœ¬\r\n\r\nç¤ºä¾‹ 2.js\r\n\r\n```\r\n// sort\r\nconst a = [3, 1, 2];\r\nconst b = a.sort();\r\n\r\nconsole.log(a); // [1, 2, 3]\r\nconsole.log(b); // [1, 2, 3]\r\n\r\n// toSorted ğŸ‘\r\nconst c = [3, 1, 2];\r\nconst d = c.toSorted();\r\n\r\nconsole.log(c); // [3, 1, 2]\r\nconsole.log(d); // [1, 2, 3]\r\n```\r\n\r\n## toSpliced\r\n\r\n- spliceï¼šéå¸¸ä¸‡èƒ½çš„æ–¹æ³•å¯ä»¥å¯¹æ•°ç»„è¿›è¡Œåˆ é™¤ã€æ›¿æ¢æ•°å…ƒç´ ä»¥åŠæ·»åŠ æ–°å…ƒç´ \r\n- toSplicedï¼šè·Ÿ splice ä¸€æ ·ï¼Œä½†æ˜¯æ“ä½œä¸ä¼šå¯¹åŸæ•°ç»„è¿›è¡Œæ”¹å˜\r\n\r\nä¸è¿‡ï¼Œç”±äº splice å’Œ toSpliced çš„è¿”å›å€¼å­˜åœ¨ä»¥ä¸‹å·®å¼‚ï¼Œå› æ­¤å¤„ç†å®ƒä»¬æ—¶ä¼¼ä¹éœ€è¦å°å¿ƒã€‚\r\n\r\n- splice çš„è¿”å›å€¼è¢«åˆ é™¤å€¼çš„æ•°ç»„\r\n- toSpliced çš„è¿”å›å€¼è¿”å›ä»æ•°ç»„ä¸­åˆ é™¤å…ƒç´ çš„å‰¯æœ¬\r\n\r\nç¤ºä¾‹ 3.js\r\n\r\n```\r\n// splice\r\nconst a = [1, 2, 3, 4];\r\nconst b = a.splice(1,2);\r\n\r\nconsole.log(a); // [1,4]\r\nconsole.log(b); // [2,3]ã€€è¿”å›å€¼æ˜¯åˆ é™¤çš„å€¼æ’åˆ—çš„å€¼\r\n\r\n// toSpliced ğŸ‘\r\nconst c = [1, 2, 3, 4];\r\nconst d = c.toSpliced(1,2);\r\n\r\nconsole.log(c); // [1,2,3,4]\r\nconsole.log(d); // [1,4]ã€€è¿”å›ä»æ•°ç»„ä¸­åˆ é™¤å…ƒç´ çš„å‰¯æœ¬\r\n```\r\n\r\n## with\r\n\r\nåœ¨ç¬¬ä¸€ä¸ªå‚æ•°ä¸­æŒ‡å®šæ•°ç»„çš„ç´¢å¼•å·ï¼Œå¹¶å°†è¯¥å…ƒç´ æ›¿æ¢ä¸ºç¬¬äºŒä¸ªå‚æ•°çš„å€¼ã€‚\r\n\r\nJS å·²ç»æœ‰ä¸€ä¸ªå•ç‹¬çš„ [with](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/with)\r\nè¯­å¥ï¼Œä½†å®ƒå·²è¢«å¼ƒç”¨ï¼Œæ‰€ä»¥å®ƒå¾ˆæ··ä¹±ï¼Œå› ä¸ºå®ƒä¸è¿™æ¬¡æ·»åŠ çš„æ•°ç»„æ“ä½œçš„ with æ–¹æ³•é‡å ã€‚\r\n\r\nç¤ºä¾‹ 4.js\r\n\r\n```\r\n// with ğŸ‘\r\nconst c = [1, 2, 3, 4];\r\nconst d = c.with(1,'ğŸ‘');\r\n\r\nconsole.log(c); // [1, 2, 3, 4]\r\nconsole.log(d); // [1, 'ğŸ‘', 3, 4]\r\n```\r\n\r\n## æœ€å\r\n\r\nè¿™äº›æ–¹æ³•çš„å‡ºç°ï¼Œä½¿å¾—ä½ ä¸éœ€è¦æ¯æ¬¡éƒ½æµ…å¤åˆ¶ï¼Œä»£ç çœ‹èµ·æ¥å¾ˆæ¸…çˆ½ã€‚\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/98/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/98/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/82",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/82/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/82/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/82/events",
          "html_url": "https://github.com/bosens-China/blog/issues/82",
          "id": 1085661350,
          "node_id": "I_kwDOCzPAy85AteCm",
          "number": 82,
          "title": "Babel to Classä¹‹ç§æœ‰å±æ€§ï¼ˆ3ï¼‰",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1908144759,
              "node_id": "MDU6TGFiZWwxOTA4MTQ0NzU5",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/ES6%E7%B3%BB%E5%88%97",
              "name": "ES6ç³»åˆ—",
              "color": "0366d6",
              "default": false,
              "description": "ES6çš„æœ€æ–°è¯­æ³•"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2021-12-21T10:13:22Z",
          "updated_at": "2021-12-28T09:51:19Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "## å‰è¨€\r\n\r\nè¿™æ˜¯ã€ŠBabel to Classã€‹ç³»åˆ—çš„ç¬¬ä¸‰ç¯‡\r\n\r\n- [Babel to Classä¹‹ç¼–è¯‘ï¼ˆ1ï¼‰](https://github.com/bosens-China/blog/issues/80)\r\n- [Babel to Class åšäº†ä»€ä¹ˆï¼ˆ2ï¼‰](https://github.com/bosens-China/blog/issues/81)\r\n- [Babel to Classä¹‹åŸç”Ÿæ„é€ å‡½æ•°ç»§æ‰¿ï¼ˆ4ï¼‰](https://github.com/bosens-China/blog/issues/88)\r\n\r\nè¿™ä¸ªç³»åˆ—ä¸»è¦è®² Class çš„æ™®é€šå†™æ³•ã€ç»§æ‰¿ã€ç§æœ‰å±æ€§å’ŒåŸç”Ÿæ„é€ å‡½æ•°ç»§æ‰¿ `babel` æ˜¯å¦‚ä½•å®ç°è¿™ä¸€è¿‡ç¨‹çš„ã€‚\r\n> æ³¨ï¼šæ–‡ç« é¡ºåºå­˜åœ¨å…³è”ï¼Œè¯·æŒ‰ç…§é¡ºåºé˜…è¯»ã€‚\r\n\r\n## å‰ç½®çŸ¥è¯†ç‚¹\r\n\r\n### WeakMap\r\n\r\n`WeakMap` æ˜¯ ES6 æ–°åŠ å…¥çš„æ•°æ®ç»“æ„ï¼Œå®ƒä¸ `map` ç±»ä¼¼ï¼Œä½†æ˜¯é”®ä¸ºå¼±å¼•ç”¨ã€‚\r\n\r\n> å¼±å¼•ç”¨å°±æ˜¯æŒ‡ä¸è®¡å…¥åƒåœ¾å›æ”¶æ¬¡æ•°ï¼Œå½“å¼•ç”¨è¢«åƒåœ¾å›æ”¶ `WeakMap` å¯¹åº”é”®å€¼è‡ªåŠ¨æ¶ˆå¤±ã€‚\r\n\r\n> æ›´å¤šå†…å®¹è¯·å‚è€ƒ[æ–‡æ¡£](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/WeakMap)\r\n\r\n### WeakSet\r\n\r\nä¸ `WeakMap` ç±»ä¼¼ï¼Œä¸åŒåœ¨äº `WeakSet` åªæœ‰é”®åï¼Œæ²¡æœ‰é”®å€¼ã€‚\r\n\r\n> æ›´å¤šå†…å®¹è¯·å‚è€ƒ[æ–‡æ¡£](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/WeakSet)\r\n\r\n### Class ç§æœ‰å±æ€§\r\n\r\nä¹‹å‰ `Class` è¦å®ç°ç§æœ‰å±æ€§åªèƒ½é€šè¿‡ï¼Œ`Symbol` æˆ–è€…å¤–éƒ¨å˜é‡æ¥å®ç°ï¼Œä¸è¿‡éƒ½å„æœ‰ç¼ºç‚¹ï¼Œç°åœ¨æ–°çš„ææ¡ˆ [proposal-private-methods](https://github.com/tc39/proposal-private-methods) æ·»åŠ äº†ç§æœ‰å±æ€§å’Œç§æœ‰æ–¹æ³•ï¼Œä½¿ç”¨æ–¹å¼å¾ˆç®€å•ï¼Œç›´æ¥`#<name>`å³å¯ã€‚\r\n\r\n```js\r\nclass Test {\r\n  #age = 12;\r\n  #getage() {}\r\n}\r\n```\r\n\r\nç§æœ‰å±æ€§åªèƒ½åœ¨æ„é€ å‡½æ•°å†…éƒ¨è°ƒç”¨ï¼Œå¦‚æœåœ¨éå†…éƒ¨è°ƒç”¨åˆ™æŠ›å‡ºå¼‚å¸¸ï¼ˆåœ¨ static ä¸Šè°ƒç”¨ä¹Ÿæ˜¯å¯ä»¥çš„ï¼‰ã€‚\r\n\r\n## ç¤ºä¾‹æ–‡ä»¶\r\n\r\n```js\r\nclass Test {\r\n  #age = 17;\r\n  static #name = 'zhangsan';\r\n\r\n  #getAge() {\r\n    console.log(this.#age);\r\n  }\r\n  static #getName() {\r\n    console.log(this.#name);\r\n  }\r\n\r\n  all() {\r\n    this.#getAge();\r\n    Test.#getName();\r\n  }\r\n}\r\nconst test = new Test();\r\ntest.all();\r\n```\r\n\r\nä»¥ä¸‹å†…å®¹æ ¹æ®æ­¤æ–‡ä»¶è¿›è¡Œè®²è§£ã€‚\r\n\r\n## babel\r\n\r\n```js\r\n'use strict';\r\n\r\nfunction _classCallCheck(instance, Constructor) {\r\n  if (!(instance instanceof Constructor)) {\r\n    throw new TypeError('Cannot call a class as a function');\r\n  }\r\n}\r\n\r\nfunction _defineProperties(target, props) {\r\n  for (var i = 0; i < props.length; i++) {\r\n    var descriptor = props[i];\r\n    descriptor.enumerable = descriptor.enumerable || false;\r\n    descriptor.configurable = true;\r\n    if ('value' in descriptor) descriptor.writable = true;\r\n    Object.defineProperty(target, descriptor.key, descriptor);\r\n  }\r\n}\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\r\n  if (staticProps) _defineProperties(Constructor, staticProps);\r\n  Object.defineProperty(Constructor, 'prototype', { writable: false });\r\n  return Constructor;\r\n}\r\n\r\nfunction _classPrivateMethodInitSpec(obj, privateSet) {\r\n  _checkPrivateRedeclaration(obj, privateSet);\r\n  privateSet.add(obj);\r\n}\r\n\r\nfunction _classPrivateFieldInitSpec(obj, privateMap, value) {\r\n  _checkPrivateRedeclaration(obj, privateMap);\r\n  privateMap.set(obj, value);\r\n}\r\n\r\nfunction _checkPrivateRedeclaration(obj, privateCollection) {\r\n  if (privateCollection.has(obj)) {\r\n    throw new TypeError(\r\n      'Cannot initialize the same private elements twice on an object'\r\n    );\r\n  }\r\n}\r\n\r\nfunction _classStaticPrivateMethodGet(receiver, classConstructor, method) {\r\n  _classCheckPrivateStaticAccess(receiver, classConstructor);\r\n  return method;\r\n}\r\n\r\nfunction _classPrivateMethodGet(receiver, privateSet, fn) {\r\n  if (!privateSet.has(receiver)) {\r\n    throw new TypeError('attempted to get private field on non-instance');\r\n  }\r\n  return fn;\r\n}\r\n\r\nfunction _classStaticPrivateFieldSpecGet(\r\n  receiver,\r\n  classConstructor,\r\n  descriptor\r\n) {\r\n  _classCheckPrivateStaticAccess(receiver, classConstructor);\r\n  _classCheckPrivateStaticFieldDescriptor(descriptor, 'get');\r\n  return _classApplyDescriptorGet(receiver, descriptor);\r\n}\r\n\r\nfunction _classCheckPrivateStaticFieldDescriptor(descriptor, action) {\r\n  if (descriptor === undefined) {\r\n    throw new TypeError(\r\n      'attempted to ' + action + ' private static field before its declaration'\r\n    );\r\n  }\r\n}\r\n\r\nfunction _classCheckPrivateStaticAccess(receiver, classConstructor) {\r\n  if (receiver !== classConstructor) {\r\n    throw new TypeError('Private static access of wrong provenance');\r\n  }\r\n}\r\n\r\nfunction _classPrivateFieldGet(receiver, privateMap) {\r\n  var descriptor = _classExtractFieldDescriptor(receiver, privateMap, 'get');\r\n  return _classApplyDescriptorGet(receiver, descriptor);\r\n}\r\n\r\nfunction _classExtractFieldDescriptor(receiver, privateMap, action) {\r\n  if (!privateMap.has(receiver)) {\r\n    throw new TypeError(\r\n      'attempted to ' + action + ' private field on non-instance'\r\n    );\r\n  }\r\n  return privateMap.get(receiver);\r\n}\r\n\r\nfunction _classApplyDescriptorGet(receiver, descriptor) {\r\n  if (descriptor.get) {\r\n    return descriptor.get.call(receiver);\r\n  }\r\n  return descriptor.value;\r\n}\r\n\r\nvar _age = /*#__PURE__*/ new WeakMap();\r\n\r\nvar _getAge = /*#__PURE__*/ new WeakSet();\r\n\r\nvar Test = /*#__PURE__*/ (function () {\r\n  debugger;\r\n  function Test() {\r\n    _classCallCheck(this, Test);\r\n\r\n    _classPrivateMethodInitSpec(this, _getAge);\r\n\r\n    _classPrivateFieldInitSpec(this, _age, {\r\n      writable: true,\r\n      value: 17,\r\n    });\r\n  }\r\n\r\n  _createClass(Test, [\r\n    {\r\n      key: 'all',\r\n      value: function all() {\r\n        _classPrivateMethodGet(this, _getAge, _getAge2).call(this);\r\n\r\n        _classStaticPrivateMethodGet(Test, Test, _getName).call(Test);\r\n      },\r\n    },\r\n  ]);\r\n\r\n  return Test;\r\n})();\r\n\r\nfunction _getAge2() {\r\n  console.log(_classPrivateFieldGet(this, _age));\r\n}\r\n\r\nfunction _getName() {\r\n  console.log(_classStaticPrivateFieldSpecGet(this, Test, _name));\r\n}\r\n\r\nvar _name = {\r\n  writable: true,\r\n  value: 'zhangsan',\r\n};\r\nvar test = new Test();\r\ntest.all();\r\n```\r\n\r\nä»¥ä¸‹æ–¹æ³•å‡ºç°åœ¨ä¹‹å‰è®²è§£è¿‡çš„ç¯‡å¹…ä¸­å°±ä¸å†èµ˜è¿°\r\n\r\n- `_classCallCheck`\r\n- `_defineProperties`\r\n- `_createClass`\r\n\r\n### \\_checkPrivateRedeclaration\r\n\r\n```js\r\nfunction _checkPrivateRedeclaration(obj, privateCollection) {\r\n  if (privateCollection.has(obj)) {\r\n    throw new TypeError(\r\n      'Cannot initialize the same private elements twice on an object'\r\n    );\r\n  }\r\n}\r\n```\r\n\r\néªŒè¯ `WeakSet` ä¸Šæ˜¯å¦å­˜åœ¨æ„é€ å‡½æ•°ï¼Œå¦‚æœå­˜åœ¨ç›´æ¥æŠ›å‡ºé”™è¯¯ã€‚\r\n\r\n### \\_classPrivateMethodInitSpec\r\n\r\n```js\r\nfunction _classPrivateMethodInitSpec(obj, privateSet) {\r\n  _checkPrivateRedeclaration(obj, privateSet);\r\n  privateSet.add(obj);\r\n}\r\n```\r\n\r\nåœ¨ `WeakSet` ä¸Šæ·»åŠ æ„é€ å‡½æ•°ã€‚\r\n\r\n### \\_classPrivateFieldInitSpec\r\n\r\n```js\r\nfunction _classPrivateFieldInitSpec(obj, privateMap, value) {\r\n  _checkPrivateRedeclaration(obj, privateMap);\r\n  privateMap.set(obj, value);\r\n}\r\n```\r\n\r\nåœ¨ `WeakMap` ä¸Šæ·»åŠ ç§æœ‰å±æ€§ï¼ˆå±æ€§æè¿°ç¬¦å½¢å¼ï¼‰ã€‚\r\n\r\n### \\_classPrivateMethodGet\r\n\r\n```js\r\nfunction _classPrivateMethodGet(receiver, privateSet, fn) {\r\n  if (!privateSet.has(receiver)) {\r\n    throw new TypeError('attempted to get private field on non-instance');\r\n  }\r\n  return fn;\r\n}\r\n```\r\n\r\néªŒè¯æ˜¯å¦åœ¨æ„é€ å‡½æ•°å†…éƒ¨è°ƒç”¨ï¼Œå¦‚æœå¤–éƒ¨åˆ™æŠ›å‡ºé”™è¯¯ `è¯•å›¾åœ¨éå®ä¾‹ä¸Šè·å–ç§æœ‰å­—æ®µ`ã€‚\r\n\r\n### \\_classCheckPrivateStaticAccess\r\n\r\n```js\r\nfunction _classCheckPrivateStaticAccess(receiver, classConstructor) {\r\n  if (receiver !== classConstructor) {\r\n    throw new TypeError('Private static access of wrong provenance');\r\n  }\r\n}\r\n```\r\n\r\nåˆ¤æ–­é™æ€å±æ€§çš„æ¥æºæ˜¯å¦åˆæ³•ï¼Œä¾‹å¦‚\r\n\r\n```js\r\nclass A {\r\n  static #name() {}\r\n}\r\n\r\nclass Test {\r\n  static #name() {\r\n    A.#name();\r\n  }\r\n\r\n  all() {\r\n    Test.#name();\r\n  }\r\n}\r\n\r\nconst test = new Test();\r\ntest.all();\r\n```\r\n\r\næˆ‘ä»¬åœ¨ `Test` è·å–` A.#name` è¿™ç§æƒ…å†µä¸‹å°±è¦æŠ›å‡ºå¼‚å¸¸ã€‚\r\n\r\n### \\_classStaticPrivateMethodGet\r\n\r\n```js\r\nfunction _classStaticPrivateMethodGet(receiver, classConstructor, method) {\r\n  _classCheckPrivateStaticAccess(receiver, classConstructor);\r\n  return method;\r\n}\r\n```\r\n\r\néªŒè¯é€šè¿‡è¿”å› `method`ã€‚\r\n\r\n### \\_classExtractFieldDescriptor\r\n\r\n```js\r\nfunction _classExtractFieldDescriptor(receiver, privateMap, action) {\r\n  if (!privateMap.has(receiver)) {\r\n    throw new TypeError(\r\n      'attempted to ' + action + ' private field on non-instance'\r\n    );\r\n  }\r\n  return privateMap.get(receiver);\r\n}\r\n```\r\n\r\néªŒè¯ `WeakMap` æ˜¯å¦æœ‰æ„é€ å‡½æ•°ï¼Œå¦‚æœæ²¡æœ‰åˆ™æŠ›å‡ºéæ³•è·å–å®ä¾‹é”™è¯¯ï¼Œå¦åˆ™è¿”å›å¯¹åº”çš„ keyã€‚\r\n\r\n### \\_classApplyDescriptorGet\r\n\r\n```js\r\nfunction _classApplyDescriptorGet(receiver, descriptor) {\r\n  if (descriptor.get) {\r\n    return descriptor.get.call(receiver);\r\n  }\r\n  return descriptor.value;\r\n}\r\n```\r\n\r\nè¿”å›ç§æœ‰å±æ€§ï¼Œæ ¹æ®å±æ€§æè¿°ç¬¦ï¼Œå¦‚æœæ˜¯ `getã€set` è¿™ç§å½¢å¼å‚¨å­˜ï¼Œç›´æ¥è°ƒç”¨ `get å‡½æ•°` è¿”å›ï¼Œå¦åˆ™è¿”å› `value`ã€‚\r\n\r\n### \\_classCheckPrivateStaticFieldDescriptor\r\n\r\n```js\r\nfunction _classCheckPrivateStaticFieldDescriptor(descriptor, action) {\r\n  if (descriptor === undefined) {\r\n    throw new TypeError(\r\n      'attempted to ' + action + ' private static field before its declaration'\r\n    );\r\n  }\r\n}\r\n```\r\n\r\nåˆ¤æ–­å±æ€§æè¿°ç¬¦æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨æŠ›å‡ºå¼‚å¸¸ã€‚\r\n\r\n### \\_classStaticPrivateFieldSpecGet\r\n\r\n```js\r\nfunction _classStaticPrivateFieldSpecGet(\r\n  receiver,\r\n  classConstructor,\r\n  descriptor\r\n) {\r\n  _classCheckPrivateStaticAccess(receiver, classConstructor);\r\n  _classCheckPrivateStaticFieldDescriptor(descriptor, 'get');\r\n  return _classApplyDescriptorGet(receiver, descriptor);\r\n}\r\n```\r\n\r\nè¿”å›é™æ€ç§æœ‰æ–¹æ³•\r\n\r\n- è°ƒç”¨ `_classCheckPrivateStaticAccess` ç¡®ä¿æ„é€ å‡½æ•°å’Œè°ƒç”¨å‡½æ•°ä¸€è‡´ï¼›\r\n- è°ƒç”¨ `_classCheckPrivateStaticFieldDescriptor` ç¡®ä¿é™æ€ç§æœ‰å±æ€§ä¸€è‡´ï¼›\r\n- è°ƒç”¨ `_classApplyDescriptorGet` è¿”å›ç§æœ‰å±æ€§;\r\n\r\n### \\_classPrivateFieldGet\r\n\r\n```js\r\nfunction _classPrivateFieldGet(receiver, privateMap) {\r\n  var descriptor = _classExtractFieldDescriptor(receiver, privateMap, 'get');\r\n  return _classApplyDescriptorGet(receiver, descriptor);\r\n}\r\n```\r\n\r\nè¿”å›é™æ€ç§æœ‰å±æ€§ã€‚\r\n\r\n## æ‰§è¡Œè¿‡ç¨‹\r\n\r\nä¸Šé¢å·²ç»æ”¾è¿‡ babel è¿‡çš„ä»£ç ï¼Œè¿™é‡Œå°±ä¸é‡å¤äº†ï¼Œé‡ç‚¹çœ‹ä¸‹æ‰§è¡Œçš„è¿‡ç¨‹ï¼Œä»`var _age = /*#__PURE__*/ new WeakMap();`è¿™æ®µä»£ç å¼€å§‹ã€‚\r\n\r\n- åˆ›å»º `_age` å’Œ `_getAge` çš„ `Weak` å¯¹è±¡ï¼›\r\n- è°ƒç”¨ `_createClass` ç»™ Test å®Œæˆ prototype èµ‹å€¼ï¼›\r\n- `new Test`ï¼Œè¿›å…¥ Test æ„é€ å‡½æ•°å†…éƒ¨ï¼›\r\n- è°ƒç”¨ `_classCallCheck` ç¡®ä¿ä¸º `new` è°ƒç”¨ï¼›\r\n- è°ƒç”¨ `_classPrivateMethodInitSpec`ï¼Œè®© `_getAge` æ·»åŠ å½“å‰ `this`ï¼›\r\n- è°ƒç”¨ `_classPrivateFieldInitSpec`ï¼Œç»™ `_age` æ·»åŠ å±æ€§ï¼Œkey ä¸º thisï¼Œvalue ä¸ºå±æ€§æè¿°ç¬¦ï¼›\r\n- è°ƒç”¨ `all` æ–¹æ³•ï¼›\r\n- æ‰§è¡Œ `_classPrivateMethodGet(this, _getAge, _getAge2).call(this);`ï¼Œå®ƒçš„ä½œç”¨éªŒè¯é€šè¿‡åè°ƒç”¨ `_getAge2`ï¼›\r\n- `_getAge2` å†…éƒ¨æ‰§è¡Œ `_classPrivateFieldGet`ï¼Œè¿”å› `_age` è®¾ç½®çš„å±æ€§æè¿°ç¬¦;\r\n- è¿”å› `all` å†…éƒ¨æ‰§è¡Œ `_classStaticPrivateMethodGet(Test, Test, _getName).call(Test);`è¿™ä¸€è¡Œï¼Œå®ƒçš„ä½œç”¨æ˜¯éªŒè¯åæ‰§è¡Œ `_getName`ï¼›\r\n- `_getName` å†…éƒ¨æ‰§è¡Œ `_classStaticPrivateFieldSpecGet` å®ƒè¿”å›å±æ€§æè¿°ç¬¦ï¼›\r\n- è¾“å‡ºç»“æœï¼Œç»“æŸï¼›\r\n\r\n## å®ç°ç§æœ‰å±æ€§æ–¹æ³•\r\n\r\nä»ä¸Šé¢è¿‡ç¨‹ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå®ç°ç§æœ‰æ–¹æ³•çš„ä¸»è¦æ­¥éª¤æ˜¯é€šè¿‡ `WeakMap` æ¥å®Œæˆï¼Œå¦‚æœä¸è€ƒè™‘éªŒè¯è¿‡ç¨‹ï¼Œå¯ä»¥å¾ˆç®€å•å®ç°ã€‚\r\n\r\n```js\r\nconst privateName = new WeakMap();\r\n\r\nclass Test {\r\n  constructor() {\r\n    privateName.set(this, 'zhangsan');\r\n  }\r\n  getName() {\r\n    return privateName.get(this);\r\n  }\r\n}\r\n```\r\n\r\n## æœ€å\r\n\r\nå¦‚æœæœ‰ä»€ä¹ˆä¸æ­£ç¡®æˆ–è€…ä¹¦å†™é”™è¯¯æ¬¢è¿æŒ‡å‡ºã€‚\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/82/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/82/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/81",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/81/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/81/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/81/events",
          "html_url": "https://github.com/bosens-China/blog/issues/81",
          "id": 1085660852,
          "node_id": "I_kwDOCzPAy85Atd60",
          "number": 81,
          "title": "Babel to Classä¹‹ç»§æ‰¿ï¼ˆ2ï¼‰",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1908144759,
              "node_id": "MDU6TGFiZWwxOTA4MTQ0NzU5",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/ES6%E7%B3%BB%E5%88%97",
              "name": "ES6ç³»åˆ—",
              "color": "0366d6",
              "default": false,
              "description": "ES6çš„æœ€æ–°è¯­æ³•"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2021-12-21T10:12:50Z",
          "updated_at": "2021-12-28T09:51:06Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "## å‰è¨€\r\n\r\nè¿™æ˜¯ã€ŠBabel to Classã€‹ç³»åˆ—çš„ç¬¬äºŒç¯‡\r\n\r\n- [Babel to Classä¹‹ç¼–è¯‘ï¼ˆ1ï¼‰](https://github.com/bosens-China/blog/issues/80)\r\n- [Babel to Classä¹‹ç§æœ‰å±æ€§ï¼ˆ3ï¼‰](https://github.com/bosens-China/blog/issues/82)\r\n- [Babel to Classä¹‹åŸç”Ÿæ„é€ å‡½æ•°ç»§æ‰¿ï¼ˆ4ï¼‰](https://github.com/bosens-China/blog/issues/88)\r\n\r\nè¿™ä¸ªç³»åˆ—ä¸»è¦è®² Class çš„æ™®é€šå†™æ³•ã€ç»§æ‰¿ã€ç§æœ‰å±æ€§å’ŒåŸç”Ÿæ„é€ å‡½æ•°ç»§æ‰¿ `babel` æ˜¯å¦‚ä½•å®ç°è¿™ä¸€è¿‡ç¨‹çš„ã€‚\r\n> æ³¨ï¼šæ–‡ç« é¡ºåºå­˜åœ¨å…³è”ï¼Œè¯·æŒ‰ç…§é¡ºåºé˜…è¯»ã€‚\r\n\r\n## å‰ç½®çŸ¥è¯†ç‚¹\r\n\r\n### super\r\n\r\n`super` é€šå¸¸ç”¨äº Class ç»§æ‰¿ä¸­è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œä»¥åŠåœ¨æ–¹æ³•ä¸­è°ƒç”¨çˆ¶ç±»æ–¹æ³•ã€‚\r\n\r\n```js\r\nclass Rectangle {\r\n  logNbSides() {\r\n    return 'I have 4 sides';\r\n  }\r\n}\r\n\r\nclass Square extends Rectangle {\r\n  logDescription() {\r\n    return super.logNbSides() + ' which are all equal';\r\n  }\r\n}\r\n```\r\n\r\n> æ›´å¤šçš„å†…å®¹è¯·å‚è€ƒ [super](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/super)\r\n\r\n### Object.create\r\n\r\n`Object.create(protoï¼Œ[propertiesObject])`\r\n\r\n`Object.create` ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå¹¶å°†æ–°çš„å¯¹è±¡åŸå‹è®¾ç½®åœ¨ `proto` ä¸Šï¼Œå®ƒè¿˜æ”¯æŒç¬¬äºŒä¸ªå‚æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå¯¹è±¡æ¯ä¸ªå¯¹è±¡çš„å€¼ä¸ºå±æ€§æè¿°ç¬¦ã€‚\r\n\r\n```js\r\nvar o = Object.create(Object.prototype, {\r\n  // fooä¼šæˆä¸ºæ‰€åˆ›å»ºå¯¹è±¡çš„æ•°æ®å±æ€§\r\n  foo: {\r\n    writable: true,\r\n    configurable: true,\r\n    value: 'hello',\r\n  },\r\n  // barä¼šæˆä¸ºæ‰€åˆ›å»ºå¯¹è±¡çš„è®¿é—®å™¨å±æ€§\r\n  bar: {\r\n    configurable: false,\r\n    get: function () {\r\n      return 10;\r\n    },\r\n    set: function (value) {\r\n      console.log('Setting `o.bar` to', value);\r\n    },\r\n  },\r\n});\r\n```\r\n\r\n> æ›´å¤šå†…å®¹è¯·å‚è€ƒ [Object.create](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/create)\r\n\r\n### Reflect.construct\r\n\r\n```js\r\nReflect.construct(target, argumentsList[, newTarget])\r\n```\r\n\r\n- targetï¼šè¢«è¿è¡Œçš„ç›®æ ‡æ„é€ å‡½æ•°\r\n- argumentsListï¼šç±»æ•°ç»„ï¼Œç›®æ ‡æ„é€ å‡½æ•°è°ƒç”¨æ—¶çš„å‚æ•°ã€‚\r\n- newTargetï¼šä½œä¸ºæ–°åˆ›å»ºå¯¹è±¡çš„åŸå‹å¯¹è±¡çš„ constructor å±æ€§ï¼Œ å‚è€ƒ new.target æ“ä½œç¬¦ï¼Œé»˜è®¤å€¼ä¸º targetã€‚\r\n\r\n`Reflect.construct` çš„ä½œç”¨ç›¸å½“äºä¸ç”¨ `new` æ“ä½œç¬¦è°ƒç”¨æ„é€ å‡½æ•°ï¼Œåˆ›å»ºå¯¹è±¡ã€‚\r\n\r\n```js\r\nclass Foo {}\r\nvar obj = new Foo(...args);\r\nvar obj = Reflect.construct(Foo, args);\r\n```\r\n\r\næ³¨æ„ç‚¹ï¼š\r\n\r\n1. ä½¿ç”¨ `Reflect.construct` åˆ›å»ºå¯¹è±¡ï¼Œ`new.target` ä¼šè‡ªåŠ¨æŒ‡å‘ newTargetï¼Œ\r\n2. å¦‚æœæŒ‡å®š newTargetï¼Œ`new.target` ä¼šæŒ‡å‘ newTarget ä¸”æ„é€ å‡½æ•°å†…éƒ¨çš„ this ä¸º newTarget\r\n\r\n> æ›´å¤šå†…å®¹è¯·å‚è€ƒ [Reflect.construct](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Reflect/construct)\r\n\r\n### Class\r\n\r\n- Class extends ç»§æ‰¿çš„å¿…é¡»æ˜¯ `null` æˆ–è€… `function`ï¼ˆclass ä¹Ÿæ˜¯ functionï¼‰ï¼Œå¦åˆ™æŠ›å‡ºé”™è¯¯ï¼›\r\n- Class å­ç±» extends çˆ¶ç±»çš„æ—¶å€™å¿…é¡»åœ¨ `constructor` æ˜¾å¼è°ƒç”¨ `super()`ï¼Œå¦åˆ™æŠ›å‡ºé”™è¯¯ï¼›\r\n\r\n## ç¤ºä¾‹ä»£ç \r\n\r\n```js\r\nclass Parent {\r\n  constructor() {\r\n    this.age = 17;\r\n  }\r\n\r\n  getAge() {\r\n    return this.age;\r\n  }\r\n\r\n  static getName() {\r\n    return this.name;\r\n  }\r\n}\r\n\r\nclass Child extends Parent {\r\n  constructor() {\r\n    super();\r\n    this.name = 'child';\r\n  }\r\n\r\n  static name = 'child';\r\n\r\n  getAll() {\r\n    return {\r\n      name: this.name,\r\n      age: this.age,\r\n    };\r\n  }\r\n}\r\n\r\nconst child = new Child();\r\nconsole.log(child.getAll());\r\nconsole.log(Child.getName());\r\n```\r\n\r\nä»¥ä¸‹è®²è§£åŸºäºä¸Šé¢çš„å†…å®¹è€Œæ¥ã€‚\r\n\r\n## babel\r\n\r\n```js\r\n'use strict';\r\n\r\nfunction _typeof(obj) {\r\n  // ...çœç•¥å®ç°\r\n}\r\n\r\nfunction _inherits(subClass, superClass) {\r\n  // ...çœç•¥å®ç°\r\n}\r\n\r\nfunction _setPrototypeOf(o, p) {\r\n  // ...çœç•¥å®ç°\r\n}\r\n\r\nfunction _createSuper(Derived) {\r\n  // ...çœç•¥å®ç°\r\n}\r\n\r\nfunction _possibleConstructorReturn(self, call) {\r\n  // ...çœç•¥å®ç°\r\n}\r\n\r\nfunction _assertThisInitialized(self) {\r\n  // ...çœç•¥å®ç°\r\n}\r\n\r\nfunction _isNativeReflectConstruct() {\r\n  // ...çœç•¥å®ç°\r\n}\r\n\r\nfunction _getPrototypeOf(o) {\r\n  // ...çœç•¥å®ç°\r\n}\r\n\r\nfunction _defineProperty(obj, key, value) {\r\n  // ...çœç•¥å®ç°\r\n}\r\n\r\nfunction _classCallCheck(instance, Constructor) {\r\n  // ...çœç•¥å®ç°\r\n}\r\n\r\nfunction _defineProperties(target, props) {\r\n  // ...çœç•¥å®ç°\r\n}\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n  // ...çœç•¥å®ç°\r\n}\r\n\r\nvar Parent = /*#__PURE__*/ (function () {\r\n  function Parent() {\r\n    _classCallCheck(this, Parent);\r\n\r\n    this.age = 17;\r\n  }\r\n\r\n  _createClass(\r\n    Parent,\r\n    [\r\n      {\r\n        key: 'getAge',\r\n        value: function getAge() {\r\n          return this.age;\r\n        },\r\n      },\r\n    ],\r\n    [\r\n      {\r\n        key: 'getName',\r\n        value: function getName() {\r\n          return this.name;\r\n        },\r\n      },\r\n    ],\r\n  );\r\n\r\n  return Parent;\r\n})();\r\n\r\nvar Child = /*#__PURE__*/ (function (_Parent) {\r\n  _inherits(Child, _Parent);\r\n\r\n  var _super = _createSuper(Child);\r\n\r\n  function Child() {\r\n    var _this;\r\n\r\n    _classCallCheck(this, Child);\r\n\r\n    _this = _super.call(this);\r\n    _this.name = 'child';\r\n    return _this;\r\n  }\r\n\r\n  _createClass(Child, [\r\n    {\r\n      key: 'getAll',\r\n      value: function getAll() {\r\n        return {\r\n          name: this.name,\r\n          age: this.age,\r\n        };\r\n      },\r\n    },\r\n  ]);\r\n\r\n  return Child;\r\n})(Parent);\r\n\r\n_defineProperty(Child, 'name', 'child');\r\n\r\nvar child = new Child();\r\nconsole.log(child.getAll());\r\nconsole.log(Child.getName());\r\n```\r\n\r\nä¸‹é¢å‡½æ•°åœ¨ [Babel to Class åšäº†ä»€ä¹ˆï¼ˆ1ï¼‰](https://github.com/bosens-China/blog/issues/80) è®²è§£è¿‡äº†\r\n\r\n- `_defineProperty`\r\n- `_classCallCheck`\r\n- `_defineProperties`\r\n- `_createClass`\r\n\r\næ‰€ä»¥ä¸å†èµ˜è¿°ï¼Œé‡ç‚¹å…ˆçœ‹æ–°å‡ºç°çš„å‡½æ•°ã€‚\r\n\r\n### \\_typeof\r\n\r\n```js\r\nfunction _typeof(obj) {\r\n  '@babel/helpers - typeof';\r\n  return (\r\n    (_typeof =\r\n      'function' == typeof Symbol && 'symbol' == typeof Symbol.iterator\r\n        ? function (obj) {\r\n            return typeof obj;\r\n          }\r\n        : function (obj) {\r\n            return obj && 'function' == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype\r\n              ? 'symbol'\r\n              : typeof obj;\r\n          }),\r\n    _typeof(obj)\r\n  );\r\n}\r\n```\r\n\r\nè¿™ä¸ªå‡½æ•°çš„ä½œç”¨ä¸ºç±»å‹åˆ¤æ–­ã€‚\r\n\r\n- `'function' == typeof Symbol && 'symbol' == typeof Symbol.iterator`\r\n  è¿™æ®µåŒ–æ„æ€æ˜¯å¦‚æœæ”¯æŒåŸç”Ÿçš„ `Symbol` å°±ç›´æ¥æ‰§è¡Œ `typeof` å³å¯\r\n\r\n- `obj && 'function' == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype`\r\n  è¿™æ®µä»£ç ä¸»è¦æ˜¯ç”¨äºåˆ¤æ–­ä½ç‰ˆæœ¬ä¸å…¼å®¹ `Symbol` çš„æµè§ˆå™¨æ˜¯ä¸æ˜¯ä½¿ç”¨äº† `polyfill` åº“ï¼Œå¦‚æœæ˜¯çš„åŒ–å°±è¿”å› `symbol`\r\n\r\n- å…¶ä»–æƒ…å†µè¿”å› `typeof` ç»“æœ\r\n\r\n### \\_inherits\r\n\r\n```js\r\nfunction _inherits(subClass, superClass) {\r\n  if (typeof superClass !== 'function' && superClass !== null) {\r\n    throw new TypeError('Super expression must either be null or a function');\r\n  }\r\n  Object.defineProperty(subClass, 'prototype', {\r\n    value: Object.create(superClass && superClass.prototype, {\r\n      constructor: { value: subClass, writable: true, configurable: true },\r\n    }),\r\n    writable: false,\r\n  });\r\n  if (superClass) _setPrototypeOf(subClass, superClass);\r\n}\r\n```\r\n\r\n- è¿™æ®µä»£ç é¦–å…ˆåˆ¤æ–­ç»§æ‰¿çš„ `superClass` æ˜¯å¦ç¬¦åˆè¦æ±‚\r\n- å…¶æ¬¡å¯¹ `subClass.prototype` è¿›è¡Œè®¾ç½®ç¡®ä¿ `prototype` å±æ€§ééå†\r\n- è®¾ç½®åŸå‹ï¼Œå°† `subClass` çš„åŸå‹è®¾ç½®ä¸º `superClass`\r\n\r\n### \\_setPrototypeOf\r\n\r\n```js\r\nfunction _setPrototypeOf(o, p) {\r\n  _setPrototypeOf =\r\n    Object.setPrototypeOf ||\r\n    function _setPrototypeOf(o, p) {\r\n      o.__proto__ = p;\r\n      return o;\r\n    };\r\n  return _setPrototypeOf(o, p);\r\n}\r\n```\r\n\r\nè®¾ç½®åŸå‹é“¾çš„æ–¹æ³•ï¼Œé¦–å…ˆè°ƒç”¨åŸç”Ÿçš„ `Object.setPrototypeOf` æ–¹æ³•ï¼Œå¦‚æœä¸æ”¯æŒå°è¯•ä½¿ç”¨ `__proto__`ï¼Œ`__proto__`æ˜¯æµè§ˆå™¨å®ç°çš„ä¸€ä¸ªç§æœ‰å±æ€§ï¼Œåœ¨å…¶ä»–ç¯å¢ƒä¸‹ä¸æ˜¯å¿…é¡»å®ç°ã€‚\r\n\r\nä¸è¿‡ä»”ç»†è§‚å¯Ÿï¼Œä½ ä¼šå‘ç°å®ƒè¿˜ä½¿ç”¨äº†ä¸€ä¸ªå‡½æ•°æ‡’åŠ è½½ï¼Œç¡®ä¿åˆ¤æ–­åªæ‰§è¡Œä¸€æ¬¡ï¼Œåç»­ç›´æ¥ä¸ä¼šæ”¹å˜äº†ã€‚\r\n\r\n### \\_createSuper\r\n\r\n```js\r\nfunction _createSuper(Derived) {\r\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\r\n  return function _createSuperInternal() {\r\n    var Super = _getPrototypeOf(Derived),\r\n      result;\r\n    if (hasNativeReflectConstruct) {\r\n      var NewTarget = _getPrototypeOf(this).constructor;\r\n      result = Reflect.construct(Super, arguments, NewTarget);\r\n    } else {\r\n      result = Super.apply(this, arguments);\r\n    }\r\n    return _possibleConstructorReturn(this, result);\r\n  };\r\n}\r\n```\r\n\r\nè¿™æ®µä»£ç çš„ä½œç”¨æ˜¯è¿”å› `super`\r\n\r\n- `_isNativeReflectConstruct` è¿™ä¸ªå‡½æ•°æˆ‘ä»¬åé¢è®²è§£ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯åˆ¤æ–­å½“å‰ç¯å¢ƒæ”¯ä¸æ”¯æŒ `Reflect.construct`\r\n- `_possibleConstructorReturn` è¿™ä¸ªå‡½æ•°åé¢è®²è§£ï¼Œä½œç”¨ä¸ºåˆ¤æ–­ Class ç¬¦ä¸ç¬¦åˆè¦æ±‚\r\n\r\n### \\_possibleConstructorReturn\r\n\r\n```js\r\nfunction _possibleConstructorReturn(self, call) {\r\n  debugger;\r\n  if (call && (_typeof(call) === 'object' || typeof call === 'function')) {\r\n    return call;\r\n  } else if (call !== void 0) {\r\n    throw new TypeError('Derived constructors may only return object or undefined');\r\n  }\r\n  return _assertThisInitialized(self);\r\n}\r\n```\r\n\r\nè¿™ä¸ªå‡½æ•°ç”¨äºåˆ¤æ–­ Class å’Œ extends çš„ Class ç¬¦ä¸ç¬¦åˆè¦æ±‚\r\n\r\n- `call && (_typeof(call) === 'object' || typeof call === 'function')`\r\n\r\nè¿™ä¸ªç›¸å½“äºåˆ¤æ–­ isObjectï¼Œæ„é€ å‡½æ•°è¢«è°ƒç”¨æ˜¯å¯ä»¥è¿”å›ä¸€ä¸ªå¯¹è±¡çš„\r\n\r\n```js\r\nfunction Foo() {\r\n  return { name: 1 };\r\n}\r\nnew Foo();\r\n// {name: 1}\r\n```\r\n\r\nå¦‚æœä¸æ˜¯å¯¹è±¡ä¹Ÿæ²¡æœ‰é»˜è®¤è¿”å› `undefined`ï¼Œåˆ™ç›´æ¥æŠ›å‡ºé”™è¯¯\r\n\r\n- `_assertThisInitialized`ï¼Œè¿™ä¸ªå‡½æ•°ç”¨äºåˆ¤æ–­å­ç±»æœ‰æ²¡æœ‰è°ƒç”¨ `super`ï¼Œå¦‚æœæ²¡æœ‰è°ƒç”¨æŠ›å‡ºé”™è¯¯\r\n\r\n### \\_isNativeReflectConstruct\r\n\r\n```js\r\nfunction _isNativeReflectConstruct() {\r\n  if (typeof Reflect === 'undefined' || !Reflect.construct) return false;\r\n  if (Reflect.construct.sham) return false;\r\n  if (typeof Proxy === 'function') return true;\r\n  try {\r\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\r\n    return true;\r\n  } catch (e) {\r\n    return false;\r\n  }\r\n}\r\n```\r\n\r\nåˆ¤æ–­å½“å‰ç¯å¢ƒæ”¯ä¸æ”¯æŒ `Reflect.construct`ï¼Œå®ƒçš„åˆ¤æ–­æ€è·¯ä¸ºå‰ç½®åˆ¤æ–­ï¼Œå¦‚æœä¸ç¬¦åˆæ—©æ—©è¿”å›\r\n\r\n- `if (typeof Reflect === 'undefined' || !Reflect.construct) return false;`ï¼Œä¸æ”¯æŒåŸç”Ÿè¿”å› `false`\r\n- `if (Reflect.construct.sham) return false;`ï¼Œ`polyfill` çš„åˆ™ä¹Ÿè¿”å› `false`\r\n- `if (typeof Proxy === 'function') return true;`ï¼Œè¿”å› `true` çš„åŸå› æ˜¯å› ä¸ºï¼Œ`Proxy` çš„å…¼å®¹æ€§æ¯” `Reflect` å·®ï¼Œå¦‚æœ `Proxy` æ”¯æŒ `Reflect` ä¸€å®šä¹Ÿæ”¯æŒ\r\n  - [proxy å…¼å®¹æ€§æ€»è§ˆ](https://caniuse.com/?search=proxy)\r\n  - [Reflect å…¼å®¹æ€§æ€»è§ˆ](https://caniuse.com/?search=Reflect)\r\n- `Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));`ï¼Œå¦‚æœéƒ½ç¬¦åˆç›´æ¥è¿è¡Œï¼Œå‰é¢è¯´è¿‡ `Reflect.construct` æ”¯æŒç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå¦‚æœè¿è¡Œæ²¡æŠ¥é”™è¿”å› `true`\r\n\r\n### \\_getPrototypeOf\r\n\r\n```js\r\nfunction _getPrototypeOf(o) {\r\n  _getPrototypeOf = Object.setPrototypeOf\r\n    ? Object.getPrototypeOf\r\n    : function _getPrototypeOf(o) {\r\n        return o.__proto__ || Object.getPrototypeOf(o);\r\n      };\r\n  return _getPrototypeOf(o);\r\n}\r\n```\r\n\r\nè¿™æ®µä»£ç ä¸ºè·å–åŸå‹ï¼Œè·Ÿ `_setPrototypeOf` å‡½æ•°ç±»ä¼¼ï¼Œå¦‚æœå½“å‰ç¯å¢ƒæ”¯æŒä¼˜å…ˆä½¿ç”¨ `Object.getPrototypeOf` ä¸Šçš„ï¼Œå¦åˆ™å›æ»šã€‚\r\n\r\n## è¿è¡Œæµç¨‹\r\n\r\nè®²è§£åˆ°è¿™é‡Œï¼Œç»§æ‰¿åŸºæœ¬è®²å®Œäº†ï¼Œç°åœ¨æŠŠå®Œæ•´ä»£ç è´´ä»¥ä¸‹ï¼Œä¹‹åè®²ä¸€ä¸‹è¿è¡Œçš„æµç¨‹\r\n\r\n```js\r\n'use strict';\r\n\r\nfunction _typeof(obj) {\r\n  '@babel/helpers - typeof';\r\n  return (\r\n    (_typeof =\r\n      'function' == typeof Symbol && 'symbol' == typeof Symbol.iterator\r\n        ? function (obj) {\r\n            return typeof obj;\r\n          }\r\n        : function (obj) {\r\n            return obj && 'function' == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype\r\n              ? 'symbol'\r\n              : typeof obj;\r\n          }),\r\n    _typeof(obj)\r\n  );\r\n}\r\n\r\nfunction _inherits(subClass, superClass) {\r\n  if (typeof superClass !== 'function' && superClass !== null) {\r\n    throw new TypeError('Super expression must either be null or a function');\r\n  }\r\n  Object.defineProperty(subClass, 'prototype', {\r\n    value: Object.create(superClass && superClass.prototype, {\r\n      constructor: { value: subClass, writable: true, configurable: true },\r\n    }),\r\n    writable: false,\r\n  });\r\n  if (superClass) _setPrototypeOf(subClass, superClass);\r\n}\r\n\r\nfunction _setPrototypeOf(o, p) {\r\n  _setPrototypeOf =\r\n    Object.setPrototypeOf ||\r\n    function _setPrototypeOf(o, p) {\r\n      o.__proto__ = p;\r\n      return o;\r\n    };\r\n  return _setPrototypeOf(o, p);\r\n}\r\n\r\nfunction _createSuper(Derived) {\r\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\r\n  return function _createSuperInternal() {\r\n    var Super = _getPrototypeOf(Derived),\r\n      result;\r\n    if (hasNativeReflectConstruct) {\r\n      var NewTarget = _getPrototypeOf(this).constructor;\r\n      result = Reflect.construct(Super, arguments, NewTarget);\r\n    } else {\r\n      result = Super.apply(this, arguments);\r\n    }\r\n    return _possibleConstructorReturn(this, result);\r\n  };\r\n}\r\n\r\nfunction _possibleConstructorReturn(self, call) {\r\n  if (call && (_typeof(call) === 'object' || typeof call === 'function')) {\r\n    return call;\r\n  } else if (call !== void 0) {\r\n    throw new TypeError('Derived constructors may only return object or undefined');\r\n  }\r\n  return _assertThisInitialized(self);\r\n}\r\n\r\nfunction _assertThisInitialized(self) {\r\n  if (self === void 0) {\r\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\r\n  }\r\n  return self;\r\n}\r\n\r\nfunction _isNativeReflectConstruct() {\r\n  if (typeof Reflect === 'undefined' || !Reflect.construct) return false;\r\n  if (Reflect.construct.sham) return false;\r\n  if (typeof Proxy === 'function') return true;\r\n  try {\r\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\r\n    return true;\r\n  } catch (e) {\r\n    return false;\r\n  }\r\n}\r\n\r\nfunction _getPrototypeOf(o) {\r\n  _getPrototypeOf = Object.setPrototypeOf\r\n    ? Object.getPrototypeOf\r\n    : function _getPrototypeOf(o) {\r\n        return o.__proto__ || Object.getPrototypeOf(o);\r\n      };\r\n  return _getPrototypeOf(o);\r\n}\r\n\r\nfunction _defineProperty(obj, key, value) {\r\n  if (key in obj) {\r\n    Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true });\r\n  } else {\r\n    obj[key] = value;\r\n  }\r\n  return obj;\r\n}\r\n\r\nfunction _classCallCheck(instance, Constructor) {\r\n  if (!(instance instanceof Constructor)) {\r\n    throw new TypeError('Cannot call a class as a function');\r\n  }\r\n}\r\n\r\nfunction _defineProperties(target, props) {\r\n  for (var i = 0; i < props.length; i++) {\r\n    var descriptor = props[i];\r\n    descriptor.enumerable = descriptor.enumerable || false;\r\n    descriptor.configurable = true;\r\n    if ('value' in descriptor) descriptor.writable = true;\r\n    Object.defineProperty(target, descriptor.key, descriptor);\r\n  }\r\n}\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\r\n  if (staticProps) _defineProperties(Constructor, staticProps);\r\n  Object.defineProperty(Constructor, 'prototype', { writable: false });\r\n  return Constructor;\r\n}\r\n\r\nvar Parent = /*#__PURE__*/ (function () {\r\n  function Parent() {\r\n    _classCallCheck(this, Parent);\r\n\r\n    this.age = 17;\r\n  }\r\n\r\n  _createClass(\r\n    Parent,\r\n    [\r\n      {\r\n        key: 'getAge',\r\n        value: function getAge() {\r\n          return this.age;\r\n        },\r\n      },\r\n    ],\r\n    [\r\n      {\r\n        key: 'getName',\r\n        value: function getName() {\r\n          return this.name;\r\n        },\r\n      },\r\n    ],\r\n  );\r\n\r\n  return Parent;\r\n})();\r\n\r\nvar Child = /*#__PURE__*/ (function (_Parent) {\r\n  _inherits(Child, _Parent);\r\n\r\n  var _super = _createSuper(Child);\r\n\r\n  function Child() {\r\n    var _this;\r\n\r\n    _classCallCheck(this, Child);\r\n\r\n    _this = _super.call(this);\r\n    _this.name = 'child';\r\n    return _this;\r\n  }\r\n\r\n  _createClass(Child, [\r\n    {\r\n      key: 'getAll',\r\n      value: function getAll() {\r\n        return {\r\n          name: this.name,\r\n          age: this.age,\r\n        };\r\n      },\r\n    },\r\n  ]);\r\n\r\n  return Child;\r\n})(Parent);\r\n\r\n_defineProperty(Child, 'name', 'child');\r\n\r\nvar child = new Child();\r\nconsole.log(child.getAll());\r\nconsole.log(Child.getName());\r\n```\r\n\r\nä»£ç ä» `var Parent = /*#__PURE__*/ (function () {` è¿™æ®µå¼€å§‹\r\n\r\n- è°ƒç”¨ `_createClass`ï¼Œå°† `prototype å±æ€§` å’Œ `static å±æ€§` è®¾ç½®åˆ° Parent å‡½æ•°ä¸Š\r\n- ä¹‹åä»£ç å¾€ä¸‹æ‰§è¡Œï¼Œåˆ°`var Child = /*#__PURE__*/ (function (_Parent) {`\r\n- è°ƒç”¨ `_inherits`ï¼Œåˆ¤æ–­ Parent ç¬¦åˆè¦æ±‚ï¼Œè®¾ç½® `Child.prototype` å±æ€§ï¼Œè®¾ç½® Child åŸå‹\r\n- è°ƒç”¨ `_createSuper`ï¼Œè·å– `super`\r\n- è°ƒç”¨ `_createClass`ï¼Œè®¾ç½® `prototype å±æ€§` å’Œ `static å±æ€§` è®¾ç½®åˆ° Child å‡½æ•°ä¸Š\r\n- è°ƒç”¨ `_defineProperty`ï¼Œè¦†ç›– Child ä¸Šçš„å±æ€§ï¼Œç¡®ä¿æ˜¯å¯ä»¥éå†ä¿®æ”¹çš„\r\n- new Child\r\n- Child å‡½æ•°å†…éƒ¨æ‰§è¡Œ `_classCallCheck`ï¼Œç¡®ä¿ä¸€å®šä¸º `new` è°ƒç”¨\r\n- åœ¨ Child å‡½æ•°å†…éƒ¨æ‰§è¡Œ `_super.call(this)` æ“ä½œï¼Œè°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°\r\n- Parent å†…éƒ¨ï¼Œè°ƒç”¨ `_classCallCheck`ï¼Œç¡®ä¿ `new` è°ƒç”¨\r\n- è¿”å› Parent çš„ this å€¼\r\n- Child å†…éƒ¨ä¿®æ”¹ Parent è¿”å›çš„ this å€¼ï¼Œè¿›è¡Œé‡å†™\r\n- æ‰§è¡Œåç»­ä»£ç ...\r\n\r\n## è·Ÿ es5 ç»§æ‰¿çš„å·®å¼‚\r\n\r\nä»ä¸Šé¢ä»£ç ä¸éš¾çœ‹åˆ°è·Ÿ es5 å†™çš„ç»§æ‰¿æœ‰å¾ˆå¤§å·®å¼‚\r\n\r\n1. `prototype` ä¸å¯ä»¥éå†ï¼›\r\n2. ä¸é€šè¿‡ `new` è°ƒç”¨æ˜¾å¼æŠ¥é”™ï¼›\r\n3. Class çš„ç»§æ‰¿ä¸ä»…æ˜¯å°†å­ç±»çš„ `prototype` æŒ‡å‘çˆ¶ç±»çš„ `prototype`ï¼ŒåŒæ—¶ä¹Ÿå°†å­ç±»çš„åŸå‹æŒ‡å‘äº†çˆ¶ç±»ï¼›\r\n4. å¾—ç›Šäºå­ç±»åŸå‹æŒ‡å‘çˆ¶ç±»ï¼Œé™æ€æ–¹æ³•å’Œå±æ€§ä¹Ÿå¯ä»¥è°ƒç”¨ï¼›\r\n\r\n## æœ€å\r\n\r\nå¦‚æœæœ‰ä»€ä¹ˆä¸æ­£ç¡®æˆ–è€…ä¹¦å†™é”™è¯¯æ¬¢è¿æŒ‡å‡ºã€‚\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/81/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/81/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/80",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/80/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/80/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/80/events",
          "html_url": "https://github.com/bosens-China/blog/issues/80",
          "id": 1085660079,
          "node_id": "I_kwDOCzPAy85Atduv",
          "number": 80,
          "title": "Babel to Classä¹‹ç¼–è¯‘ï¼ˆ1ï¼‰",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1908144759,
              "node_id": "MDU6TGFiZWwxOTA4MTQ0NzU5",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/ES6%E7%B3%BB%E5%88%97",
              "name": "ES6ç³»åˆ—",
              "color": "0366d6",
              "default": false,
              "description": "ES6çš„æœ€æ–°è¯­æ³•"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2021-12-21T10:12:08Z",
          "updated_at": "2021-12-28T09:48:18Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "## å‰è¨€\r\n\r\nè¿™æ˜¯ã€ŠBabel to Classã€‹ç³»åˆ—çš„ç¬¬ä¸€ç¯‡\r\n\r\n- [Babel to Classä¹‹ç»§æ‰¿ï¼ˆ2ï¼‰](https://github.com/bosens-China/blog/issues/81)\r\n- [Babel to Classä¹‹ç§æœ‰å±æ€§ï¼ˆ3ï¼‰](https://github.com/bosens-China/blog/issues/82)\r\n- [Babel to Classä¹‹åŸç”Ÿæ„é€ å‡½æ•°ç»§æ‰¿ï¼ˆ4ï¼‰](https://github.com/bosens-China/blog/issues/88)\r\n\r\nè¿™ä¸ªç³»åˆ—ä¸»è¦è®² Class çš„æ™®é€šå†™æ³•ã€ç»§æ‰¿ã€ç§æœ‰å±æ€§å’ŒåŸç”Ÿæ„é€ å‡½æ•°ç»§æ‰¿ `babel` æ˜¯å¦‚ä½•å®ç°è¿™ä¸€è¿‡ç¨‹çš„ã€‚\r\n> æ³¨ï¼šæ–‡ç« é¡ºåºå­˜åœ¨å…³è”ï¼Œè¯·æŒ‰ç…§é¡ºåºé˜…è¯»ã€‚\r\n\r\n## å‰ç½®çŸ¥è¯†ç‚¹\r\n\r\n### Object.defineProperty\r\n\r\n`Object.defineProperty(obj, prop, descriptor)` ç”¨äºå®šä¹‰å¯¹è±¡å±æ€§ï¼Œå®ƒæœ‰ä¸‰ä¸ªå‚æ•°åˆ†ä¸ºåˆ«ï¼šå¯¹è±¡ï¼Œå¯¹è±¡ keyï¼Œä»¥åŠå±æ€§æè¿°ç¬¦ã€‚\r\n\r\nå±æ€§æè¿°ç¬¦é»˜è®¤ä¸ä¼ é€’å…·ä½“çš„å€¼åˆ™ä¸º `false`\r\n\r\n```js\r\nconst a = {};\r\nObject.defineProperty(a, 'd', {});\r\nObject.getOwnPropertyDescriptor(a, 'd');\r\n// {value: undefined, writable: false, enumerable: false, configurable: false}\r\n```\r\n\r\næœ‰ä¸¤ç§è°ƒç”¨å½¢å¼\r\n\r\n```js\r\nvar o = {};\r\n\r\n// 1.\r\nObject.defineProperty(o, 'a', {\r\n  value: 37,\r\n  writable: true,\r\n  enumerable: true,\r\n  configurable: true,\r\n});\r\n\r\n// 2.\r\nvar bValue = 38;\r\nObject.defineProperty(o, 'b', {\r\n  get() {\r\n    return bValue;\r\n  },\r\n  set(newValue) {\r\n    bValue = newValue;\r\n  },\r\n  enumerable: true,\r\n  configurable: true,\r\n});\r\n```\r\n\r\n> æ›´å¤šå†…å®¹ï¼Œä»¥åŠå±æ€§æè¿°ç¬¦åŒ…å«é‚£äº›ï¼Œè¯·[å‚è€ƒæ–‡æ¡£](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty)\r\n\r\n### Class\r\n\r\n- `Class`å¿…é¡»é€šè¿‡ `new` è°ƒç”¨ï¼Œå¦åˆ™æŠ›å‡º `Uncaught TypeError: Class constructor A cannot be invoked without 'new'`\r\n- `Class`çš„ `prototype` å±æ€§é»˜è®¤ä¸å¯éå†\r\n\r\n## ç¤ºä¾‹æ–‡ä»¶\r\n\r\n```js\r\nclass Test {\r\n  constructor() {\r\n    this.name = 'å¼ ä¸‰';\r\n  }\r\n\r\n  _age = 18;\r\n\r\n  get age() {\r\n    return this._age;\r\n  }\r\n\r\n  set age(value) {\r\n    this._age = value;\r\n  }\r\n\r\n  getName() {\r\n    return this.name;\r\n  }\r\n\r\n  static getClassName() {\r\n    return this.name;\r\n  }\r\n\r\n  static name = 'TestClass';\r\n}\r\n```\r\n\r\nä¸Šé¢å°±æ˜¯å‡†å¤‡å¥½çš„ç¤ºä¾‹æ–‡ä»¶ï¼Œç»“æ„å¾ˆç®€å•ï¼Œæˆ‘ä»¬çœ‹ä¸‹ `babel` ä¼šå°†ä»£ç è½¬ç æˆä»€ä¹ˆæ ·\r\n\r\n## babel\r\n\r\nä¸ºäº†æ–¹ä¾¿è®²è§£ï¼Œä¸‹é¢é€šè¿‡æ³¨é‡Šçš„å½¢å¼æ¥è§£è¯»ï¼Œé˜…è¯»éƒ¨åˆ†è¯·ä» `const Test = /* #__PURE__ */ (function () {` è¿™æ®µå¼€å§‹ã€‚\r\n\r\n```js\r\n'use strict';\r\n\r\nfunction _classCallCheck(instance, Constructor) {\r\n  /*\r\n   * Classå¿…é¡»é€šè¿‡newè°ƒç”¨ï¼Œè¿™æ˜¯åˆ¤æ–­è°ƒç”¨çš„thisè·ŸTestè¿›è¡Œinstanceofå¯¹æ¯”ï¼Œå¦‚æœä¸ç¬¦åˆæŠ›å‡ºé”™è¯¯\r\n   */\r\n  if (!(instance instanceof Constructor)) {\r\n    throw new TypeError('Cannot call a class as a function');\r\n  }\r\n}\r\n\r\n/**\r\n * ç”¨äºç»™å¯¹è±¡å®šä¹‰å±æ€§\r\n * æ³¨æ„å®ƒåˆ¤æ–­äº†valueå±æ€§æ˜¯å¦å­˜åœ¨ï¼Œè¿™æ˜¯å› ä¸ºå­˜åœ¨ä¸¤ç§å†™æ³•\r\n * ä¸€ç§æ˜¯ä¼ é€’valueçš„æ™®é€š\r\n * å¦å¤–ä¸€ç§æ˜¯ä¼ é€’getå’Œsetçš„å½¢å¼\r\n */\r\nfunction _defineProperties(target, props) {\r\n  for (let i = 0; i < props.length; i++) {\r\n    const descriptor = props[i];\r\n    descriptor.enumerable = descriptor.enumerable || false;\r\n    descriptor.configurable = true;\r\n    if ('value' in descriptor) descriptor.writable = true;\r\n    Object.defineProperty(target, descriptor.key, descriptor);\r\n  }\r\n}\r\n\r\n/**\r\n * åˆå§‹åŒ–Classå±æ€§\r\n * å…ˆä»å‡½æ•°çš„prototypeå±æ€§æ¥è¿›è¡Œå®šä¹‰\r\n * åé¢å®šä¹‰Constructoræœ¬èº«çš„å±æ€§\r\n */\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\r\n  if (staticProps) _defineProperties(Constructor, staticProps);\r\n  Object.defineProperty(Constructor, 'prototype', { writable: false });\r\n  return Constructor;\r\n}\r\n\r\n/**\r\n * ç”¨äºç»™Testå®ä¾‹å’Œæœ¬èº«å®šä¹‰å±æ€§\r\n * ä¹‹æ‰€ä»¥è¿›è¡Œä¸€ä¸ª in åˆ¤å®šæ˜¯ä¸ºäº†è¦†ç›–æœ¬èº«å·²ç»æœ‰çš„å±æ€§\r\n * ä¾‹å¦‚class.nameå±æ€§ï¼Œè¿™ä¸ªæœ¬èº«å·²ç»å­˜åœ¨ {value: 'A', writable: false, enumerable: false, configurable: true}\r\n * ä½†æ˜¯æˆ‘ä»¬ä»æ–°å®šä¹‰å°±è¦å±æ€§æè¿°ç¬¦å…¨éƒ¨ä¸ºtrue\r\n */\r\nfunction _defineProperty(obj, key, value) {\r\n  if (key in obj) {\r\n    Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true });\r\n  } else {\r\n    obj[key] = value;\r\n  }\r\n  return obj;\r\n}\r\n\r\nconst Test = /* #__PURE__ */ (function () {\r\n  function Test() {\r\n    // åˆå§‹è¿›è¡Œnewè°ƒç”¨åˆ¤æ–­\r\n    _classCallCheck(this, Test);\r\n    // å®ä¾‹å±æ€§å†™æ³•\r\n    _defineProperty(this, '_age', 18);\r\n\r\n    this.name = 'å¼ ä¸‰';\r\n  }\r\n\r\n  // åˆå§‹åŒ–ï¼Œåé¢åˆ†ä¸ºä¸ºprototypeå±æ€§ä»¥åŠé™æ€å±æ€§\r\n  _createClass(\r\n    Test,\r\n    [\r\n      {\r\n        key: 'age',\r\n        get: function get() {\r\n          return this._age;\r\n        },\r\n        set: function set(value) {\r\n          this._age = value;\r\n        },\r\n      },\r\n      {\r\n        key: 'getName',\r\n        value: function getName() {\r\n          return this.name;\r\n        },\r\n      },\r\n    ],\r\n    [\r\n      {\r\n        key: 'getClassName',\r\n        value: function getClassName() {\r\n          return this.name;\r\n        },\r\n      },\r\n    ],\r\n  );\r\n\r\n  return Test;\r\n})();\r\n\r\n_defineProperty(Test, 'name', 'TestClass');\r\n```\r\n\r\næ¦‚å†µä¸€ä¸‹ä¸Šé¢æµç¨‹ï¼š\r\n\r\n1. åˆå§‹åŒ– `Class` ä¸Šçš„ `prototype å±æ€§`ä»¥åŠ `static å±æ€§`\r\n2. `new Class` çš„æ—¶å€™ï¼Œå¯¹ Class çš„è°ƒç”¨å½¢å¼è¿›è¡Œåˆ¤æ–­\r\n3. `new` è¿‡ç¨‹ä¸­èµ‹å€¼å®ä¾‹å±æ€§\r\n4. æ‰§è¡Œ...\r\n\r\n## æœ€å\r\n\r\nå¦‚æœæœ‰ä»€ä¹ˆä¸æ­£ç¡®æˆ–è€…ä¹¦å†™é”™è¯¯æ¬¢è¿æŒ‡å‡ºã€‚\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/80/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/80/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        }
      ]
    ],
    [
      "1371686608",
      [
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/97",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/97/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/97/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/97/events",
          "html_url": "https://github.com/bosens-China/blog/issues/97",
          "id": 1745358720,
          "node_id": "I_kwDOCzPAy85oCA-A",
          "number": 97,
          "title": "ä½¿ç”¨jsxæ¥ç¼–å†™æ¨¡æ¿",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1371686608,
              "node_id": "MDU6TGFiZWwxMzcxNjg2NjA4",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%BC%AB%E8%B0%88%E7%B3%BB%E5%88%97",
              "name": "æ¼«è°ˆç³»åˆ—",
              "color": "e7f3ee",
              "default": false,
              "description": "æµ…è°ˆç±»æ–‡ç« "
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2023-06-07T08:36:19Z",
          "updated_at": "2023-06-07T08:36:19Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "## å‰è¨€\r\n\r\næ¨¡æ¿å¼•æ“è¿™ä¸ªåº”è¯¥éƒ½ä¸é™Œç”Ÿï¼Œæœ€æ—©å¯ä»¥è¿½æº¯åˆ°å‰åç«¯è¿˜æ²¡åˆ†ç¦»çš„æ—¶å€™ï¼Œåç«¯ä¸ºäº†å¾ªç¯ã€åˆ¤æ–­å€¼ä¹‹ç±»ç®€åŒ–ç¼–å†™æµç¨‹è€Œä½¿ç”¨çš„ï¼Œæ¯•ç«Ÿæ‰‹åŠ¨æ‹¼æ¥å­—ç¬¦ä¸²ä¹‹ç±»çš„ä¹Ÿå¤ªéº»çƒ¦äº†ã€‚\r\n\r\nä¸‹é¢æ˜¯ php [easytpl](https://github.com/phppkg/easytpl) çš„ä¸€ä¸ªç¤ºä¾‹ï¼Œä»è¿™ä¸ªå¯ä»¥çœ‹åˆ°æ¨¡æ¿å¼•æ“çš„åŸºæœ¬ç”¨é€”ã€‚\r\n\r\n```php\r\nuse PhpPkg\\EasyTpl\\EasyTemplate;\r\n\r\n$tplCode = <<<'CODE'\r\nMy name is {{ $name | strtoupper }},\r\nMy develop tags:\r\n\r\n{{ foreach($tags as $tag) }}\r\n- {{ $tag }}\r\n\r\n{{ endforeach }}\r\nCODE;\r\n\r\n$t = new EasyTemplate();\r\n\r\n$str = $t->renderString($tplCode, [\r\n    'name' => 'inhere',\r\n    'tags' => ['php', 'go', 'java'],\r\n]);\r\n\r\necho $str;\r\n```\r\n\r\nä¸Šé¢è¿™å¯¹ä»£ç ä¼šè¾“å‡º\r\n\r\n```md\r\nMy name is INHERE,\r\nMy develop tags:\r\n\r\n- php\r\n- go\r\n- java\r\n```\r\n\r\nå›åˆ° JavaScriptï¼Œéšç€èŒèƒ½çš„ä¸æ–­æå‡å‰ç«¯ä¹Ÿé¢ä¸´åŒæ ·çš„é—®é¢˜ï¼Œäºæ˜¯ç¤¾åŒºæ¶Œç°äº†ä¸€å †åº“ï¼Œä¾‹å¦‚ï¼š\r\n\r\n- [ejs](https://ejs.co/)\r\n- [nunjucks](http://mozilla.github.io/nunjucks/templating.html)\r\n- [pug](https://pugjs.org/api/getting-started.html)\r\n- ...\r\n\r\nä¸Šé¢çš„å‡ ä¸ªä½¿ç”¨æ–¹æ³•éƒ½å¤§åŒå°å¼‚ï¼Œéƒ½æ˜¯é€šè¿‡å†…ç½®ä¸€äº›è¯­æ³•æ¥ç®€åŒ–é‡å¤çš„ä¹¦å†™ã€‚ä¸è¿‡æ€è€ƒä¸€ä¸‹ä½¿ç”¨æ¨¡æ¿å¼•æ“ä¼šæœ‰ä»€ä¹ˆç¼ºç‚¹ï¼Ÿ\r\n\r\nä¸‹é¢æ˜¯ä¸€æ®µ ejs ä»£ç ç¤ºä¾‹\r\n\r\n```html\r\n<% if (resultPreSale.length) { %>\r\n<h2>æœ¬æ¬¡æ–°å¢å…¥ç½‘æ¥¼æ ‹ï¼š<%= resultPreSale.length %>ä¸ª</h2>\r\n<ul>\r\n  <% resultPreSale.forEach(function(item){ %>\r\n  <li>\r\n    <p>\r\n      <a href=\"<%= item.url %>\"> é¡¹ç›®åç§°ï¼š<%= item.entryName %> </a>\r\n    </p>\r\n    <p>æ¥¼å¹¢å·ï¼š<%= item.buildingNumber %></p>\r\n    <p>è®¸å¯é¢ç§¯(ã¡)ï¼š<%= item.permittedArea %></p>\r\n    <p>å‘æ”¾æ—¥æœŸï¼š<%= item.time %></p>\r\n  </li>\r\n  <% }); %>\r\n</ul>\r\n<% } %>\r\n```\r\n\r\nä»ä¸Šé¢çš„ç¤ºä¾‹å¯ä»¥çœ‹åˆ°ä»¥ä¸‹ç¼ºç‚¹ï¼š\r\n\r\n1. ç¼ºå°‘è¯­æ³•æç¤ºï¼šåœ¨ä½¿ç”¨ç¼–è¾‘å™¨çš„æ—¶å€™ä½¿ç”¨ç›¸å¯¹åº”è¯­æ³•éƒ½ä¼šæœ‰æç¤ºï¼Œä½†æ˜¯ä¸Šé¢åœ¨ä½¿ç”¨ `forEach` ä¹‹ç±»çš„æ ¹æœ¬ä¸ä¼šæœ‰æç¤ºï¼›\r\n2. ä¸èƒ½å€ŸåŠ© Eslintã€TypeScript æ¥æå‰æ£€æŸ¥ç¼–å†™é”™è¯¯ï¼šä¾‹å¦‚æœ‰ä¸€äº› props æ²¡æœ‰ä¼ é€’æˆ–è€…ç±»å‹ç¼ºå°‘ï¼Œä»¥åŠå˜é‡ä¸å­˜åœ¨è€Œå¼•ç”¨ç­‰é”™è¯¯ï¼Œå¿…é¡»è¿è¡Œä¹‹åæ‰ä¼šå‘ç°é”™è¯¯ï¼›\r\n3. æœ‰é¢å¤–çš„å­¦ä¹ æˆæœ¬ï¼Œæ¯ä¸ªæ¨¡æ¿å¼•æ“çš„è¯­æ³•å…¶å®éƒ½ä¸ä¸€æ ·ï¼Œä¾‹å¦‚ ejs å’Œ pug å°±ä¸ä¸€è‡´ï¼›\r\n\r\n## jsx\r\n\r\nå›å½’åˆ°æœ€ç†Ÿæ‚‰çš„ jsx æœ¬èº«ï¼Œå¾—ç›Šäº React çš„æµè¡Œ jsx è¿™ç§çµæ´»æ–¹ä¾¿çš„è¯­æ³•å°±æ˜¯é¦–é€‰ï¼Œé¦–å…ˆç”Ÿæ€å¾ˆä¸°å¯Œå¯ä»¥è·Ÿ TypeScript å’Œ eslint æ— ç¼è¡”æ¥ï¼Œä¸”è¯­æ³•è·Ÿ js åŸºæœ¬ä¸€è‡´ä¸ä¼šå¢åŠ é¢å¤–çš„å­¦ä¹ æˆæœ¬ï¼Œä¸”è·Ÿç¼–è¾‘å™¨é…åˆå¾ˆå¥½å¯ä»¥æœ‰è¯­æ³•æç¤ºã€‚\r\n\r\nä¸‹é¢æ˜¯ä¸€æ®µç¤ºä¾‹\r\n\r\n```jsx\r\nconst App = (props: Props) => {\r\n  return (\r\n    <>\r\n      <PreSale resultPreSale={props.resultPreSale}></PreSale>\r\n      <List resultList={props.resultList}></List>\r\n      <List resultList={props.residueList} title={<h2>å…¶ä»–æ­£åœ¨æ‘‡å·é¡¹ç›®ï¼ˆ{props.residueList.length}ä¸ªï¼‰ï¼š</h2>}></List>\r\n      <p>æœ¬æ¬¡çˆ¬å–æ—¶é—´ï¼š{props.currentTime}</p>\r\n      <style>{style}</style>\r\n    </>\r\n  );\r\n};\r\n```\r\n\r\njsx åŸºç¡€çš„è¯­æ³•å’Œå¦‚ä½•è§£æè¿™é‡Œå¹¶ä¸å…³å¿ƒï¼Œè¯´å›ä¸»é¢˜å¦‚ä½•ä½¿ç”¨ jsx æ¥ç¼–å†™æ¨¡æ¿å‘¢ï¼Ÿ\r\n\r\n### è§£æ jsx\r\n\r\næ¨¡æ¿è¿”å›çš„éƒ½æ˜¯å­—ç¬¦ä¸²çš„å½¢å¼ï¼Œä½†æ˜¯ä¸Šé¢ç¤ºä¾‹çš„ App æ˜æ˜¾æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥é¦–å…ˆéœ€è¦æŠŠ jsx è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå¹¸è¿çš„æ˜¯ç¤¾åŒºæœ‰ç›¸å…³çš„åº“ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯ [preact-render-to-string](https://github.com/preactjs/preact-render-to-string)ï¼Œ[preact](https://preactjs.com/)æ˜¯ä¸€ä¸ªè·Ÿ React å®ç°å¾ˆæ¥è¿‘çš„åº“ï¼Œä½ å¯ä»¥ç†è§£ä¸º mini Reactã€‚\r\n\r\n> è¿™é‡Œå…¶å®å¹¶ä¸ä¼šä½¿ç”¨ hooks ä¹‹ç±»çš„åŠŸèƒ½ï¼Œä½¿ç”¨çš„åªæ˜¯ jsx è¯­æ³•æœ¬èº«ï¼Œæ‰€ä»¥é€‰ç”¨ä»€ä¹ˆæ¡†æ¶å¹¶ä¸å…³é”®ã€‚\r\n\r\n```jsx\r\nimport { render } from 'preact-render-to-string';\r\nconst html = render(<App {...props}></App>);\r\n```\r\n\r\nå¦‚æœç»“åˆ TypeScript ä½¿ç”¨ï¼Œè¿˜éœ€è¦åšä¸€äº›é¢å¤–çš„é…ç½®\r\n\r\n- å®‰è£… preact\r\n\r\n- ä¿®æ”¹ tsconfig.json\r\n\r\n```json\r\n{\r\n  \"compilerOptions\": {\r\n    \"jsx\": \"react-jsx\",\r\n    \"jsxImportSource\": \"preact\"\r\n  }\r\n}\r\n```\r\n\r\n### node ç¯å¢ƒä½¿ç”¨\r\n\r\nè¿™é‡Œå¹¶æ²¡æœ‰ä¸‡äº‹å¤§å‰ï¼Œåœ¨ node ç¯å¢ƒä½¿ç”¨æ¨¡æ¿å¼•æ“ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆæ­£å¸¸çš„äº‹æƒ…ï¼Œä½†æ˜¯ tsx æˆ–è€… jsx æ–‡ä»¶éƒ½æ˜¯å±äºéœ€è¦ç¼–è¯‘æ¥è¿›è¡Œå¤„ç†çš„ï¼Œå¦åˆ™ node å¹¶ä¸è®¤è¯†ã€‚\r\n\r\n1. [tsx](https://github.com/esbuild-kit/tsx)ï¼Œä½¿ç”¨ tsx è¿™ä¸ªåº“ï¼Œå®ƒé€šè¿‡ esbuild æ¥è¿è¡Œ TypeScript å’Œ ESM æ–‡ä»¶ï¼›\r\n2. webpack\r\n\r\nä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„ webpack ç¤ºä¾‹\r\n\r\n```js\r\nconst path = require('path');\r\nconst nodeExternals = require('webpack-node-externals');\r\nconst RunNodeWebpackPlugin = require('run-node-webpack-plugin');\r\n\r\nmodule.exports = {\r\n  entry: {\r\n    index: './src/index.ts',\r\n  },\r\n  target: 'node',\r\n  devtool: 'source-map',\r\n  externalsPresets: { node: true },\r\n  output: {\r\n    path: path.resolve(__dirname, 'dist'),\r\n    filename: '[name].cjs',\r\n    clean: true,\r\n  },\r\n  resolve: {\r\n    extensions: ['.js', '.jsx', '.ts', '.tsx'],\r\n  },\r\n  module: {\r\n    rules: [\r\n      {\r\n        test: /\\.(js|jsx|ts|tsx)$/,\r\n        exclude: /node_modules/,\r\n        use: [\r\n          {\r\n            loader: 'esbuild-loader',\r\n            options: {\r\n              target: 'es2022',\r\n            },\r\n          },\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n};\r\n```\r\n\r\n## æœ€å\r\n\r\nå¦‚æœæ–‡ç« æœ‰é”™è¯¯æ¬¢è¿ç•™è¨€æŒ‡å‡ºã€‚\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/97/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/97/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/83",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/83/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/83/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/83/events",
          "html_url": "https://github.com/bosens-China/blog/issues/83",
          "id": 1085661652,
          "node_id": "I_kwDOCzPAy85AteHU",
          "number": 83,
          "title": "æ¼«è°ˆç¨‹åºåˆå§‹åŒ–",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1371686608,
              "node_id": "MDU6TGFiZWwxMzcxNjg2NjA4",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%BC%AB%E8%B0%88%E7%B3%BB%E5%88%97",
              "name": "æ¼«è°ˆç³»åˆ—",
              "color": "e7f3ee",
              "default": false,
              "description": "æµ…è°ˆç±»æ–‡ç« "
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2021-12-21T10:13:42Z",
          "updated_at": "2021-12-24T05:45:59Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "## å‰è¨€\r\n\r\nåœ¨è½¯ä»¶å·¥ç¨‹çš„å¼€å‘ä¸­æœ‰ç”Ÿå‘½å‘¨æœŸè¿™ä¸ªæ¦‚å¿µï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯å®šä¹‰å„ä¸ªé˜¶æ®µéœ€è¦å¤„ç†çš„äº‹æƒ…è·Ÿ `tcp/ip` åè®®åˆ†å±‚ä¸€ä¸ªæ„æ€ï¼Œä»Šå¤©é‡ç‚¹èŠä¸€èŠåˆå§‹åŒ–è¿™ä¸ªé˜¶æ®µã€‚\r\n\r\n- åœ¨æ—¥å¸¸ä½¿ç”¨çš„ `webpack`ã€`vite` ç­‰å·¥å…·ä¼šæœ‰ä¸€ä¸ªé…ç½®æ”¶é›†çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯åˆå§‹åŒ–ï¼›\r\n- åœ¨ä½¿ç”¨ `react`ã€`vue` ç­‰æ¡†æ¶æ—¶ä¹Ÿä¼šæœ‰ `created` ç­‰ç”Ÿå‘½å‘¨æœŸå‡½æ•°æš´éœ²ï¼Œåœ¨æ­¤é˜¶æ®µæ‰§è¡Œä¸€äº›è¯·æ±‚ api ç­‰æ“ä½œï¼Œè¿™ä¹Ÿæ˜¯åˆå§‹åŒ–ï¼›\r\n- åœ¨ä½¿ç”¨ `koa` ç­‰ `node` æ¡†æ¶å¯åŠ¨æœåŠ¡ä¹‹å‰è¿›è¡Œ `use` è£…è½½ä¹Ÿæ˜¯åˆå§‹åŒ–ï¼›\r\n- ç”šè‡³ï¼Œä¸€æ®µä»£ç åœ¨æ‰§è¡Œä¹‹å‰é€šå¸¸ä¼šç»å†ä»¥ä¸‹ä¸‰ä¸ªé˜¶æ®µï¼Œä¹Ÿå¯ä»¥æ¦‚æ‹¬ä¸ºåˆå§‹åŒ–\r\n  - åˆ†è¯/è¯æ³•åˆ†æ\r\n  - è§£æ/è¯­æ³•åˆ†æ\r\n  - ç”Ÿæˆä»£ç \r\n\r\nä¸‹é¢ï¼Œæˆ‘æŠŠä»»åŠ¡åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š\r\n\r\n- å¯ä»¥å‰ç½®åŒ–å¤„ç†\r\n- ä¸èƒ½å‰ç½®åŒ–å¤„ç†\r\n\r\n## å‰ç½®åˆå§‹åŒ–\r\n\r\nä¸Šé¢ä¸¾ä¾‹çš„ä¸€å¤§å †ï¼Œä½ ä¼šå‘ç°å¾ˆå¤šä»»åŠ¡æˆ‘ä»¬å¯ä»¥å¾ˆè‡ªç„¶å®Œæˆï¼Œä¾‹å¦‚ï¼š\r\n\r\n- `webpack`ã€`vite` è¯»å–é…ç½®ï¼Œå¦‚æœè®©ä½ å†™å¤§æ¦‚å°±æ˜¯æ ¹æ® `npm script` å¡«å†™ config çš„è·¯å¾„è¿›è¡Œè§£æï¼Œç„¶åé€šè¿‡ node çš„ `fs` æ¨¡å—è¿›è¡Œè¯»å–\r\n- `koa` åœ¨è£…è½½æ’ä»¶ä¹‹å‰å¯èƒ½è¿˜éœ€è¦è‡ªåŠ¨å¯¼å…¥æ‰€æœ‰ç¬¦åˆè¦æ±‚çš„æ–‡ä»¶ï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡ `glob` æ¨¡å—æ¥æŸ¥æ‰¾æ‰€æœ‰ç¬¦åˆè§„åˆ™çš„æ–‡ä»¶è¿›è¡Œæ‰¹é‡å¯¼å…¥\r\n\r\nä¸Šé¢çš„ä»»åŠ¡éƒ½å¯ä»¥é€šè¿‡ node æä¾›çš„åŒæ­¥ api è¿›è¡Œå®Œæˆï¼Œä¸”ä»–ä»¬åªä¼šè¿è¡Œä¸€æ¬¡å¹¶ä¸ä¼šå½±å“åˆ°ä¸»ä½“çš„åŠŸèƒ½ã€‚\r\n\r\nä½†æ˜¯æœ‰ä¸€äº›æ“ä½œï¼Œä¾‹å¦‚è¯·æ±‚ç½‘ç»œï¼Œå¼‚æ­¥åŠ è½½æ¨¡å—åç»­çš„æ“ä½œéƒ½éœ€è¦ç­‰å¾…åŠ è½½å®Œæˆä¹‹åæ‰èƒ½æ‰§è¡Œï¼Œè¿™ç§æƒ…å†µä¸‹æ²¡æœ‰åŒæ­¥çš„è¯­æ³•ä¾›ä½¿ç”¨ï¼Œæ²¡åŠæ³•å®Œæˆå‰ç½®ä¾èµ–çš„å¤„ç†ã€‚\r\n\r\nä¸‹é¢å°±æŠ›ç –å¼•ç‰èŠèŠè¿™ç§æƒ…å†µå¦‚ä½•å¤„ç†\r\n\r\n## éå‰ç½®åŒ–å¤„ç†\r\n\r\nä¸‹é¢çš„ä¾‹å­éƒ½ä»¥ db æ¨¡å—ä¸ºä¾‹ï¼Œå®ƒè´Ÿè´£è¿æ¥æ•°æ®åº“ä¹‹åè¿›è¡Œè¯»å–æ•°æ®ï¼Œå¯èƒ½æœ‰ä¸€ä¸ª connect çš„æ–¹æ³•å’Œ queue çš„æŸ¥è¯¢æ–¹æ³•ã€‚\r\n\r\n```js\r\nclass Db {\r\n  constructor() {\r\n    this.signIn = false;\r\n  }\r\n  connect() {\r\n    if (this.signIn) {\r\n      return Promise.resolve(true);\r\n    }\r\n    return new Promise((resolve) => {\r\n      setTimeout(() => {\r\n        this.signIn = true;\r\n        resolve(true);\r\n      }, 3000);\r\n    });\r\n  }\r\n  async queue(str) {\r\n    if (!this.signIn) {\r\n      throw new Error(`å¿…é¡»è¿æ¥æ•°æ®åº“æ‰èƒ½ä½¿ç”¨queueï¼`);\r\n    }\r\n    console.log(str);\r\n  }\r\n}\r\nconst db = new Db();\r\n\r\nconst app = async () => {\r\n  await db.connect();\r\n  await db.queue(`xx`);\r\n};\r\napp();\r\n```\r\n\r\n> ä¸ºäº†æ¼”ç¤ºï¼Œåé¢ä»£ç å…¨éƒ¨ä¸ºç®€åŒ–ç‰ˆæœ¬ï¼Œä¸æ‰§è¡Œå…·ä½“æ“ä½œ\r\n\r\næˆ‘ä»¬åœ¨ç¨‹åºä¸­è°ƒç”¨è¿™ä¸ª db æ¨¡å—ï¼Œä½ ä¼šå‘ç°å‘ç° `await db.connect()` è¿™æ®µä»£ç çœç•¥ä¸äº†ï¼Œæˆ‘ä»¬çš„ç¨‹åºä¾èµ– connect è¿™ä¸€æ­¥ã€‚\r\n\r\nä¸”å› ä¸ºåªæ˜¯æ¼”ç¤ºæ²¡æœ‰ä¼ é€’å…·ä½“çš„å¯†ç å’Œè´¦å·ï¼Œä½†æƒ³è±¡ä¸€ä¸‹æ¯æ¬¡è°ƒç”¨ db éƒ½éœ€è¦æ‰‹åŠ¨ä¼ é€’ä¸€æ¬¡è´¦å·å’Œå¯†ç ä¹Ÿå¤ªç³Ÿå¿ƒäº†ã€‚\r\n\r\næœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥ç®€åŒ–è¿™ä¸ªè¿‡ç¨‹å‘¢ï¼Ÿå¯ä»¥å¯¹ connect è¿›è¡Œä¸€æ¬¡å°è£…ï¼Œæœ€åæš´éœ² db æ¨¡å—å‡ºå»ã€‚\r\n\r\n### å°è£… connect\r\n\r\n```js\r\nclass Db {\r\n  constructor() {\r\n    this.signIn = false;\r\n  }\r\n  connect() {\r\n    if (this.signIn) {\r\n      return Promise.resolve(true);\r\n    }\r\n    return new Promise((resolve) => {\r\n      setTimeout(() => {\r\n        this.signIn = true;\r\n        resolve(true);\r\n      }, 3000);\r\n    });\r\n  }\r\n  async queue(str) {\r\n    if (!this.signIn) {\r\n      throw new Error(`å¿…é¡»è¿æ¥æ•°æ®åº“æ‰èƒ½ä½¿ç”¨queueï¼`);\r\n    }\r\n    console.log(str);\r\n  }\r\n}\r\nconst proxyDb = (() => {\r\n  const db = new Db();\r\n  let sign = false;\r\n  return async () => {\r\n    if (!sign) {\r\n      sign = await db.connect();\r\n    }\r\n    return db;\r\n  };\r\n})();\r\nconst app = async () => {\r\n  const db = await proxyDb();\r\n  await db.queue('xxx');\r\n};\r\napp();\r\n```\r\n\r\nä½¿ç”¨ä¸€ä¸ªä»£ç†å°† `connect` è¿›è¡Œç¼“å­˜èµ·æ¥ï¼Œç¡®ä¿æ‰§è¡Œä¸€æ¬¡ï¼Œåç»­ä½¿ç”¨ç›´æ¥ await è°ƒç”¨ã€‚\r\n\r\nä¸è¿‡è¿™ç§æ–¹æ³•è™½ç„¶å®ç°ç®€å•ï¼Œä½†æ˜¯ä½“éªŒåªèƒ½è¯´ä¸€èˆ¬ï¼Œæœ‰æ²¡æœ‰æ›´åŠ ä¼˜é›…çš„æ–¹æ³•å‘¢ï¼Ÿ\r\n\r\n### é¢„å…ˆé˜Ÿåˆ—\r\n\r\nè§‚å¯Ÿä¸Šé¢ db çš„æ“ä½œï¼Œå¯ä»¥çœ‹åˆ°ä¸¤éƒ¨åˆ†\r\n\r\n- ç™»å½•æ“ä½œ\r\n- ä¾èµ–ç™»å½•æ“ä½œçš„åç»­\r\n\r\næˆ‘ä»¬å¯ä»¥æŠŠéœ€è¦ä¾èµ–ç™»å½•çš„æ“ä½œè¿›è¡Œä¸€ä¸ªå°è£…ï¼Œå¦‚æœæ²¡æœ‰ç™»å½•å°± push åˆ°é˜Ÿåˆ—ä¸­ï¼Œç­‰åˆ°ç™»å½•çš„æ—¶å€™è¿›è¡Œä¸€ä¸ªæ•´ä½“çš„æ‰§è¡Œã€‚\r\n\r\n```js\r\nclass Db {\r\n  constructor() {\r\n    this.signIn = false;\r\n    this.list = [];\r\n  }\r\n  connect() {\r\n    if (this.signIn) {\r\n      return Promise.resolve(true);\r\n    }\r\n    return new Promise((resolve) => {\r\n      setTimeout(() => {\r\n        this.signIn = true;\r\n        this.list.forEach((fn) => fn());\r\n        this.list = [];\r\n        resolve(true);\r\n      }, 3000);\r\n    });\r\n  }\r\n  queue(str) {\r\n    return new Promise((resolve) => {\r\n      const fn = () => {\r\n        console.log(str);\r\n        resolve(undefined);\r\n      };\r\n      if (this.signIn) {\r\n        return fn();\r\n      }\r\n      this.list.push(fn);\r\n    });\r\n  }\r\n}\r\nconst db = new Db();\r\ndb.connect();\r\nconst app = async () => {\r\n  await db.queue('xxx');\r\n};\r\napp();\r\n```\r\n\r\n- åœ¨ç›´æ¥æ‰§è¡Œ `queue` çš„æ—¶å€™çŠ¶æ€è¿˜æ²¡æœ‰ç™»å½•ï¼Œæ·»åŠ åˆ° `list` ä¸­ï¼›\r\n- `connect` æ‰§è¡ŒæˆåŠŸï¼Œé‡Šæ”¾é˜Ÿåˆ—çš„å€¼\r\n\r\n### é¢„å…ˆé˜Ÿåˆ—çŠ¶æ€åˆ†ç¦»\r\n\r\nä¸Šè¿°çš„è¦æ±‚æˆ‘ä»¬å®ç°äº†ï¼Œä½†æ˜¯åé¢å¦‚æœè¿˜æœ‰å…¶ä»–çš„æ–¹æ³•ï¼Œä¾‹å¦‚ `toArray`ã€`findOne` ç­‰æ–¹æ³•ï¼Œä¸€ä¸ªä¸ªå†™é‡å¤çš„æ­¥éª¤å¤ªç¹çäº†ã€‚\r\n\r\næŒ‰ç…§è®¾è®¡æ¨¡å¼å•ä¸€åŸåˆ™ï¼Œæˆ‘ä»¬å°è¯•è¿›è¡Œåˆ†ç¦»ä¸€ä¸‹\r\n\r\n- æ‰§è¡Œ db ç›¸å…³çš„æ“ä½œåªæ‰§è¡Œè¿™éƒ¨åˆ†\r\n- å¯¹æœªç™»å½•çŠ¶æ€çš„æ“ä½œè¿›è¡Œä¸€ä¸ªç»Ÿä¸€æ‹¦æˆª\r\n\r\nè¿™éƒ¨åˆ†æ‹¦æˆªå¯ä»¥åŸºäº ES6 çš„ `proxy`ï¼Œä¹Ÿå¯ä»¥æ˜¯ class çš„ `extends`ï¼Œè¿™é‡Œé‡‡ç”¨ extends çš„æ–¹å¼æ¥è¿›è¡Œã€‚\r\n\r\n```js\r\nclass Db {\r\n  constructor() {\r\n    this.signIn = false;\r\n  }\r\n  connect() {\r\n    if (this.signIn) {\r\n      return Promise.resolve(true);\r\n    }\r\n    return new Promise((resolve) => {\r\n      setTimeout(() => {\r\n        this.signIn = true;\r\n        resolve(true);\r\n      }, 3000);\r\n    });\r\n  }\r\n  async queue(str) {\r\n    console.log(str);\r\n  }\r\n}\r\nclass ProxyDb extends Db {\r\n  constructor() {\r\n    super();\r\n    this.list = [];\r\n    ['queue'].forEach((item) => {\r\n      this[item] = (...rest) => {\r\n        return new Promise((resolve) => {\r\n          const fn = () => {\r\n            const result = super[item].apply(this, rest);\r\n            return resolve(result);\r\n          };\r\n          if (!super.signIn) {\r\n            this.list.push(fn);\r\n            return;\r\n          }\r\n          fn();\r\n        });\r\n      };\r\n    });\r\n  }\r\n  async connect() {\r\n    await super.connect();\r\n    this.list.forEach((fn) => fn());\r\n  }\r\n}\r\nconst db = new ProxyDb();\r\ndb.connect();\r\ndb.queue('xxx');\r\n```\r\n\r\né€šè¿‡ç»§æ‰¿é‡å†™ `connect` æ“ä½œï¼Œåœ¨ `constructor` é˜¶æ®µæŠŠéœ€è¦ä»£ç†çš„æ–¹æ³•æ‰‹å†™åˆ°å­ç±»ä¸­ï¼Œæœ€ååˆ©ç”¨ Promise çš„ç‰¹æ€§ï¼Œç­‰å¾… `connect `å®Œæˆä¹‹å `resolve`ã€‚\r\n\r\n### é¡¶å±‚ await\r\n\r\né™¤äº†ä¸Šè¿°çš„ä¸¤ç§æ–¹æ³•ï¼ŒES6 çš„æœ€æ–° `é¡¶å±‚ await` ä¹Ÿå¯ä»¥å¸®åŠ©å®ç°æ•ˆæœï¼Œé¡¶å±‚ await æ˜¯ä¸ºäº†è§£å†³æ¨¡å—å¼‚æ­¥åŠ è½½é—®é¢˜ï¼Œå¯¹äºæœ¬æ–‡åˆšå¥½å¯ä»¥ç”¨åˆ°ã€‚\r\n\r\næˆ‘ä»¬ä¹‹æ‰€ä»¥è¦å¯¹ `db` æ¨¡å— è¿›è¡Œç¼“å­˜å’Œé˜Ÿåˆ—ç­‰ä¸€ç³»åˆ—æ“ä½œï¼Œå°±æ˜¯å› ä¸ºåˆå§‹åŒ–è¿™éƒ¨åˆ†æˆ‘ä»¬æ²¡åŠæ³•å®Œæˆå‰ç½®ï¼Œä¸èƒ½åƒè¯»å–é…ç½®æ–‡ä»¶ä¸€æ ·é€šè¿‡åŒæ­¥ api è¯­æ³•å®Œæˆã€‚\r\n\r\nä½†æ˜¯é¡¶å±‚ await çš„å‡ºç°ï¼Œè®©å…¶æœ‰ä¸€ç§åŒæ­¥çš„è¯­æ³•å®Œæˆè¿™éƒ¨åˆ†å·¥ä½œã€‚\r\n\r\n```js\r\nclass Db {\r\n  constructor() {\r\n    this.signIn = false;\r\n  }\r\n  connect() {\r\n    if (this.signIn) {\r\n      return Promise.resolve(true);\r\n    }\r\n    return new Promise((resolve) => {\r\n      setTimeout(() => {\r\n        this.signIn = true;\r\n        resolve(true);\r\n      }, 3000);\r\n    });\r\n  }\r\n  async queue(str) {\r\n    if (!this.signIn) {\r\n      throw new Error(`å¿…é¡»è¿æ¥æ•°æ®åº“æ‰èƒ½ä½¿ç”¨queueï¼`);\r\n    }\r\n    console.log(str);\r\n  }\r\n}\r\n```\r\n\r\nè¿™æ˜¯æœ€åˆæˆ‘ä»¬çš„ db æ¨¡å—ï¼Œä½¿ç”¨é¡¶å±‚ await åªéœ€è¦ï¼Œç›´æ¥ `import` å\r\n\r\n```js\r\nconst db = new Db();\r\nawait db.connect();\r\nawait db.queue('xxx');\r\n```\r\n\r\n## æœ€å\r\n\r\næŠ›ç –å¼•ç‰èŠäº†åˆå§‹åŒ–åŠ è½½å¯èƒ½é‡åˆ°çš„æƒ…å†µï¼Œå—é™äºèŠå¤©çš„æ–¹å‘ï¼Œå¾ˆå¤šå¼‚å¸¸æƒ…å†µæ²¡æœ‰ç»™äºˆè€ƒè™‘ï¼Œä¾‹å¦‚æ•°æ®åº“å¦‚æœè¿æ¥æ“ä½œï¼Œéœ€è¦æ‰‹åŠ¨å¯¹é˜Ÿåˆ—çš„æ“ä½œè¿›è¡Œ `reject` çš„é”™è¯¯æŠ›å‡ºã€‚\r\n\r\næœ€åå¦‚æœæ–‡ç« æœ‰ä»€ä¹ˆé”™è¯¯æˆ–è€…é”™åˆ«å­—æ¬¢è¿æŒ‡å‡ºã€‚\r\n\r\n> å‚è€ƒï¼š\r\n>\r\n> - [é¡¶å±‚ await](https://es6.ruanyifeng.com/#docs/async#%E9%A1%B6%E5%B1%82-await)\r\n> - [ECMAScript proposal: Top-level `await`](https://github.com/tc39/proposal-top-level-await)\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/83/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/83/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/86",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/86/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/86/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/86/events",
          "html_url": "https://github.com/bosens-China/blog/issues/86",
          "id": 1085665053,
          "node_id": "I_kwDOCzPAy85Ate8d",
          "number": 86,
          "title": "æ¼«è°ˆå¼‚æ­¥å‡½æ•°æ‰§è¡Œçš„å‰ä¸–ä»Šç”Ÿ",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1371686608,
              "node_id": "MDU6TGFiZWwxMzcxNjg2NjA4",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%BC%AB%E8%B0%88%E7%B3%BB%E5%88%97",
              "name": "æ¼«è°ˆç³»åˆ—",
              "color": "e7f3ee",
              "default": false,
              "description": "æµ…è°ˆç±»æ–‡ç« "
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2021-12-21T10:17:10Z",
          "updated_at": "2021-12-23T05:42:51Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "ä»Šå¤©ç®€å•èŠèŠå¼‚æ­¥å‡½æ•°çš„æ¼”å˜å²ï¼Œä¸ç€é‡è®²è§£è¯­æ³•æœ¬èº«ï¼Œè€Œæ˜¯å€Ÿæ­¤çª¥æ¢ä¸€ä¸‹æ¼”å˜è¿‡ç¨‹ï¼Œä»¥åŠæ˜¯åŸºäºä»€ä¹ˆåŸå› ä¸€æ­¥æ­¥æ¨è¿›ã€‚\r\n\r\n## å›è°ƒå‡½æ•°\r\n\r\nå›è°ƒå‡½æ•°æ˜¯æœ€ç®€å•å¤„ç†å¼‚æ­¥çš„æ–¹å¼ï¼Œä¹‹æ‰€ä»¥ä¼šæœ‰å›è°ƒå‡½æ•°åŸå› åœ¨äº `JavaScript` æ˜¯å•çº¿ç¨‹çš„è¯­è¨€ï¼Œå¦‚æœé‡åˆ° io è¾“å…¥å°±ä¼šé˜»å¡åœ¨è¿™é‡Œï¼Œä½“éªŒæ„Ÿå—è¾ƒå·®ï¼Œä¸ºäº†ä¸å½±å“æ€§èƒ½åˆ»æ„è®¾è®¡ã€‚\r\n\r\nå½“ç„¶å›è°ƒå‡½æ•°æœ¬èº«ä¸æ˜¯é—®é¢˜ï¼Œä¾‹å¦‚æˆ‘ä»¬ç‚¹å‡»æäº¤æŒ‰é’®ï¼Œåœ¨ `jQuery` å¯èƒ½ä¼šè¿™æ ·å†™\r\n\r\n```js\r\n$(\".btn\").on(\"click\", () => {\r\n  // éªŒè¯é€šè¿‡ï¼Œæ‰§è¡Œå‘é€\r\n  $.ajax({\r\n    url: url,\r\n    data: data,\r\n    success: success,\r\n    dataType: dataType,\r\n  });\r\n});\r\n```\r\n\r\nå¯ä»¥çœ‹åˆ°ï¼Œåœ¨åŠŸèƒ½ç®€å•çš„æƒ…å†µä¸‹ä½¿ç”¨å›è°ƒå‡½æ•°æ˜¯æœ€ç®€æ´çš„å†™æ³•ã€‚\r\n\r\nå›è°ƒå‡½æ•°çš„é—®é¢˜åœ¨äºéœ€æ±‚çš„ä¸æ–­æ‰©å……ï¼Œä½¿å¾—æˆ‘ä»¬åœ¨å›è°ƒå‡½æ•°ä¸åœçš„åµŒå¥—ï¼Œä¸”è¿˜è¦åœ¨æ¯å±‚è€ƒè™‘æŠ›å‡ºå¼‚å¸¸çš„æƒ…å†µï¼Œæƒ³æƒ³å°±è®©äººå¤´å¤§ã€‚\r\n\r\n```js\r\nfn1(fn2(fn3(fn4())));\r\n```\r\n\r\nä¸‹é¢é€šè¿‡ä¸€ä¸ªçˆ¬è™«ä¾‹å­ä¸¾ä¾‹ï¼Œæˆ‘ä»¬éœ€è¦è·å–æŸç½‘ç«™åˆ—è¡¨å­—æ®µè¿˜æœ‰æ¯ä¸ªåˆ—è¡¨å¯¹åº”çš„è¯¦æƒ…å­—æ®µã€‚\r\n\r\n```js\r\nconst request = require(\"request\");\r\n\r\nconst reptile = (fn) => {\r\n  request(\"xxx/list\", function (error, response, body) {\r\n    if (error) {\r\n      return fn(error);\r\n    }\r\n    request(\"xxx/details\", function (err, res, data) {\r\n      if (error) {\r\n        return fn(error);\r\n      }\r\n      fn(body, data);\r\n    });\r\n  });\r\n};\r\n```\r\n\r\né¦–å…ˆæˆ‘ä»¬çœ‹ä¸Šé¢è¿™æ®µä»£ç ï¼Œå› ä¸ºæ˜¯åªè¯·æ±‚ä¸¤æ¬¡æ‰€ä»¥çœ‹èµ·æ¥ä¸ç®—æ··ä¹±ï¼Œä¸è¿‡ä¹Ÿå¯ä»¥å‘ç°ä¸¤å¤„é—®é¢˜ï¼š\r\n\r\n- å›è°ƒå‡½æ•°å†…çš„å‘½åï¼ŒæŒ‰ç…§å¥½çš„åšæ³•ä¸åº”å½“å­˜åœ¨é®è”½ç°è±¡ï¼Œå†…éƒ¨çš„ä»£ç è¦†ç›–å¤–å±‚çš„å˜é‡ï¼Œè¿™æ ·ä¼šå¯¼è‡´å¼•ç”¨å’Œæ­§ä¹‰\r\n- ä»£ç åœ¨æœè¿™ `>>>` çš„å½¢å¼æ‹“å±•\r\n\r\nå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡èŒè´£åˆ†ç¦»æ¥è¿›è¡Œä¸€å®šç¨‹åº¦çš„ç¼“è§£ï¼Œä¾‹å¦‚ä¸Šé¢ä»£ç æˆ‘ä»¬æŠŠçˆ¬å–åˆ—è¡¨å’Œçˆ¬å–è¯¦æƒ…åˆ†ç¦»å¼€ï¼Œé€šè¿‡ä¸€ä¸ªä¸»å‡½æ•°æ¥è¿›è¡Œç»„è£…ï¼Œä¸è¿‡è¿™æ ·çš„ä½œæ³•ä¹Ÿåªæ˜¯ç¼“è§£ï¼Œå½“ç¨‹åºè¶Šæ¥è¶Šåºå¤§ç»´æŠ¤å’Œè°ƒè¯•çš„æˆæœ¬ä¹Ÿä¼šè¶Šæ¥è¶Šé«˜ã€‚\r\n\r\n## Promise\r\n\r\n`Promise` æ˜¯ç¤¾åŒºä¸ºäº†è§£å†³å›è°ƒé—®é¢˜è€Œå‡ºç°çš„ææ¡ˆï¼Œ`ES6` çš„æ—¶å€™å°†å…¶å¸æ”¶åˆ°è§„èŒƒå†…ï¼Œå˜æˆäº†è¯­è¨€å†…ç½®çš„ç‰¹æ€§ã€‚\r\nä¸ºäº†ä¿æŒè·Ÿä¹‹å‰ä»£ç å…¼å®¹ï¼Œç°åœ¨ Promise çš„æ£€æµ‹éƒ½æ˜¯åŸºäº`.then`æ–¹æ³•ã€‚\r\n\r\nåœ¨è¯´ Promise ä¹‹å‰ï¼Œæˆ‘ä»¬æ¥å›å¿†ä¸€ä¸‹å®ƒçš„ç‰¹æ€§\r\n\r\n- Promise åˆ›å»ºä¹‹åä¸å¯å–æ¶ˆ\r\n- Promise åªæœ‰ä¸‰ç§çŠ¶æ€ï¼šè¿›è¡Œã€å®Œæˆå’Œå¤±è´¥ï¼ŒçŠ¶æ€å˜æ›´åä¸ä¼šæ”¹å˜\r\n- Promise å¯ä»¥éšæ—¶ `.then`ï¼Œæ¯æ¬¡ then éƒ½è¿”å›ä¸€ä¸ªæ–°çš„ Promise å®ä¾‹\r\n\r\nä¸Šé¢çš„ç‰¹æ€§æ€»ç»“ä¸‹æ¥å°±æ˜¯ç»™æˆ‘ä»¬ä¸€ä¸ªç»Ÿä¸€çš„å¤„ç†æœºåˆ¶ï¼Œå¯ä»¥éšæ—¶è°ƒç”¨ä¸ç”¨æ‹…å¿ƒé”™è¿‡ï¼Œè¿™ä¸ªåœ¨å›è°ƒå‡½æ•°æ˜¯å¯èƒ½å‘ç”Ÿçš„ï¼Œä¾‹å¦‚ä¸€ä¸ªäº‹ä»¶æ²¡æœ‰åˆå§‹ç›‘å¬ï¼Œåœ¨å‘ç”Ÿä¹‹åç›‘å¬æ˜¯ä¸ä¼šç›‘å¬åˆ°çš„ã€‚\r\n\r\nè¿˜æ˜¯æ‹¿ä¸Šé¢çš„çˆ¬è™«ä¾‹å­ï¼Œçœ‹åŸºäº Promise å†™æ˜¯ä¸æ˜¯æ›´ä¼˜é›…ä¸€äº›\r\n\r\n```js\r\nconst rp = require(\"request-promise\");\r\n// è¿™é‡ŒPromiseåŸæœ¬çš„åº“ä¸æ”¯æŒï¼Œæ‰€ä»¥æ”¹ç”¨ä¸€ä¸‹Promiseç‰ˆæœ¬\r\nconst reptile = () => {\r\n  return rp(\"xxx/list\").then((listData) => {\r\n    return rp(\"xxx/details\").then((detailsData) => {\r\n      return {\r\n        listData,\r\n        detailsData,\r\n      };\r\n    });\r\n  });\r\n};\r\nreptile()\r\n  .then((res) => {\r\n    console.log(res);\r\n  })\r\n  .catch((err) => {\r\n    console.log(err);\r\n  });\r\n```\r\n\r\nè§‚å¯Ÿä¸Šé¢ä»£ç ï¼Œå¯ä»¥æ˜æ˜¾çœ‹åˆ°\r\n\r\n- æ”¹å–„äº†`>>>`ä¹‹å‰æ¨ªå‘ä»£ç çš„å‘å±•ï¼Œç»“æ„æ›´åŠ æ¸…æ™°\r\n- æ‹¥æœ‰äº†ç»Ÿä¸€çš„é”™è¯¯å¤„ç†ï¼Œåœ¨è¯·æ±‚åˆ—è¡¨å¦‚æœå¤±è´¥ï¼Œåç»­çš„.then ä¹Ÿä¸ä¼šæ‰§è¡Œ\r\n\r\nè€Œä¸” Promise åŒ…è£…èµ·æ¥ä¹Ÿååˆ†ç®€å•ï¼Œä¸‹é¢ä»¥ wait å‡½æ•°ä¸ºä¾‹\r\n\r\n```js\r\nconst wait = (time) => new Promise((resolve) => setTimeout(resolve, time));\r\n```\r\n\r\nä¸è¿‡ Promise ä¹Ÿä¸å®Œå…¨éƒ½æ˜¯ä¼˜ç‚¹ï¼Œä¾‹å¦‚å®ƒåªæ˜¯æŠŠä»£ç çš„ä¹¦å†™ç»“æ„ä»`>>>`å˜æˆå¾€ä¸‹çš„å»¶ä¼¸ï¼Œä»£ç ç»“æ„å¤šèµ·æ¥ä¹Ÿæ˜¯æŒºç³Ÿå¿ƒã€‚\r\n\r\n## Generator\r\n\r\n`Generator` æ˜¯ ES6 æ–°å‡ºç°çš„ APIï¼Œå®ƒçš„å‡ºç°è§£å†³äº†ä¸¤ä¸ªé—®é¢˜ï¼š\r\n\r\n- ç»™ Symbol.iterator æä¾›äº†ç®€å•çš„å®ç°\r\n- ç»™å¼‚æ­¥å˜æˆæä¾›äº†æ–°çš„æ€è·¯\r\n\r\næˆ‘ä»¬é‡ç‚¹èŠä¸€èŠç¬¬äºŒç‚¹ï¼Œè¿˜æ˜¯ä¸Šé¢çš„çˆ¬è™«ä¾‹å­ï¼Œçœ‹ä¸‹ç”¨ Generator åº”å½“å¦‚ä½•ä¹¦å†™ï¼Œä¸ºäº†çœå»ä¸€äº›å†™æ‰§è¡Œå™¨çš„è¿‡ç¨‹ï¼Œè¿™é‡Œç›´æ¥ç»“åˆ`co`æ¨¡å—è¿›è¡Œä¹¦å†™ã€‚\r\n\r\n> å¦‚æœå¯¹è¿™éƒ¨åˆ†æ„Ÿå…´è¶£ï¼Œå¯ä»¥ç‚¹å‡»äº†è§£[Generator å‡½æ•°çš„å¼‚æ­¥åº”ç”¨](https://es6.ruanyifeng.com/#docs/generator-async)ï¼Œé‡Œé¢ä¼šä¸€æ­¥æ­¥åŒ…å«å¦‚ä½•å®ç°ä¸€ä¸ªç®€å•æ‰§è¡Œå™¨ã€‚\r\n\r\n```js\r\nconst rp = require(\"request-promise\");\r\n// è¿™é‡ŒPromiseåŸæœ¬çš„åº“ä¸æ”¯æŒï¼Œæ‰€ä»¥æ”¹ç”¨ä¸€ä¸‹Promiseç‰ˆæœ¬\r\nconst co = require(\"co\");\r\nfunction* getList() {\r\n  return rp(\"xxx/list\");\r\n}\r\nfunction* getDetails() {\r\n  return rp(\"xxx/details\");\r\n}\r\nfunction* peptile() {\r\n  const listData = yield getList();\r\n  const detailsData = yield getDetails();\r\n  return {\r\n    listData,\r\n    detailsData,\r\n  };\r\n}\r\nco(peptile);\r\n```\r\n\r\nå†æ¥è§‚å¯Ÿä¸€ä¸‹ä¸Šé¢ä»£ç ï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰å·²ç»æ¥è¿‘åŒæ­¥å‡½æ•°çš„å†™æ³•äº†ï¼Œè¿™å°±æ˜¯ Generator å¸¦æ¥çš„å½±å“ã€‚\r\n\r\nä¸è¿‡å®ƒçš„ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œæ²¡æœ‰å†…ç½®æ‰§è¡Œå™¨ï¼Œéœ€è¦é¢å¤–è‡ªå·±ç¼–å†™ã€‚\r\n\r\n## async\r\n\r\n`ES2017` å¼•ç”¨äº† `async` å‡½æ•°ï¼Œå®ƒæœ¬èº«æ˜¯ Generator çš„è¯­æ³•ç³–ï¼Œæˆ‘ä»¬ä¸Šé¢è¯´ Generator æœ€å¤§ç¼ºç‚¹å°±æ˜¯æ²¡æœ‰è‡ªå¸¦æ‰§è¡Œå™¨ï¼Œasync å‡½æ•°å‡ºç°å¼¥è¡¥äº†è¿™ä¸€ç¼ºé™·ã€‚\r\n\r\n- å®ƒæœ¬èº«è‡ªå¸¦æ‰§è¡Œå™¨ï¼Œawait æ‰§è¡Œçš„å¯ä»¥æ˜¯ä»»ä½•è¡¨è¾¾å¼ï¼Œä¸éœ€è¦ä¸€å®šåŸºäº Promise\r\n- è¯­æ³•æ›´åŠ ç®€æ´ï¼Œè¿”å›å€¼æ˜¯åŸºäº Promise\r\n\r\nè¿˜æ˜¯çˆ¬è™«çš„ä¾‹å­ï¼Œè¿™æ¬¡æˆ‘ä»¬æ”¹ç”¨ async å‡½æ•°ä¹¦å†™\r\n\r\n```js\r\nconst rp = require(\"request-promise\");\r\n// è¿™é‡ŒPromiseåŸæœ¬çš„åº“ä¸æ”¯æŒï¼Œæ‰€ä»¥æ”¹ç”¨ä¸€ä¸‹Promiseç‰ˆæœ¬\r\nfunction getList() {\r\n  return rp(\"xxx/list\");\r\n}\r\nfunction getDetails() {\r\n  return rp(\"xxx/details\");\r\n}\r\nconst peptile = async () => {\r\n  const listData = await getList();\r\n  const detailsData = await getDetails();\r\n  return {\r\n    listData,\r\n    detailsData,\r\n  };\r\n};\r\n```\r\n\r\nä»ä¸Šé¢çš„ä»£ç ä¸éš¾çœ‹å‡º async å‡½æ•°çš„å‡ºç°ï¼Œæ ‡å¿—å¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆçš„æœ€ç»ˆæˆç†Ÿï¼Œç»“åˆ `babel` ç°åœ¨å°±å¯ä»¥åœ¨ä½ç‰ˆæœ¬æµè§ˆå™¨è¿è¡Œèµ·æ¥ã€‚\r\n\r\nä¸è¿‡ async è™½ç„¶å¾ˆå¥½ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›å®ç°ä¸äº†çš„ç‚¹ï¼Œä¾‹å¦‚è®² Promise çš„æ—¶å€™ wait å‡½æ•°ï¼Œç”¨ async å‡½æ•°å°±æ˜¯å®ç°ä¸äº†ï¼Œåœ¨è§£å†³é—®é¢˜ä¸€å®šè¦é›¶å’Œç»„åˆã€‚\r\n\r\n## æœ€å\r\n\r\nç®€å•å›é¡¾äº†ä¸€ä¸‹ js çš„å¼‚æ­¥å²ï¼š`å›è°ƒ > Promise > Generator > async`ã€‚å—é™äºç¯‡å¹…å¹¶æ²¡æœ‰è®²è§£å¤ªå¤šï¼Œä½†æ˜¯ä»å¼‚æ­¥çš„è§£å†³å¯ä»¥çœ‹åˆ° JavaScript æ­£åœ¨èµ°å‘æˆç†Ÿã€‚\r\n\r\næœ€åå¦‚æœè¿™ç¯‡æ–‡ç« æœ‰ä»€ä¹ˆé”™è¯¯æ¬¢è¿æŒ‡ç‚¹ï¼Œå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ä¹Ÿå¯ä»¥`start`ä¸‹ã€‚\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/86/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/86/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/36",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/36/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/36/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/36/events",
          "html_url": "https://github.com/bosens-China/blog/issues/36",
          "id": 522570348,
          "node_id": "MDU6SXNzdWU1MjI1NzAzNDg=",
          "number": 36,
          "title": "æ¼«è°ˆç³»ç»Ÿæƒé™è®¾è®¡",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1371686608,
              "node_id": "MDU6TGFiZWwxMzcxNjg2NjA4",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%BC%AB%E8%B0%88%E7%B3%BB%E5%88%97",
              "name": "æ¼«è°ˆç³»åˆ—",
              "color": "e7f3ee",
              "default": false,
              "description": "æµ…è°ˆç±»æ–‡ç« "
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2019-11-14T01:35:53Z",
          "updated_at": "2021-12-21T09:48:35Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "> è¿™é‡Œä¸ä¼šä»‹ç»å…·ä½“å®ç°çš„æ–¹å¼ï¼Œè¦æ ¹æ®å…¬å¸çš„ä¸šåŠ¡æ¥è¿›è¡Œè°ƒæ•´ï¼Œä¸‹é¢å°±èŠä¸€èŠåŸºæœ¬è®¾è®¡çš„æ€è·¯ã€‚\r\n\r\næƒé™çš„è®¾è®¡å¯¹äºä¸€ä¸ªåå°æ¥è¯´è‡³å…³é‡è¦ï¼Œä¸è¿‡ä¹Ÿè¦æ ¹æ®æƒ…å†µæ¥é€‰æ‹©ï¼Œæ¯”å¦‚æˆ‘ä»¬ä¸ä¼šåœ¨ä¸€ä¸ªåšå®¢æˆ–è€…ä¸ªäººç½‘ç«™çš„åå°ä¸­å†™ä¸Šæƒé™æ§åˆ¶ï¼Œå› ä¸ºè¿™æ˜¯æ²¡æœ‰å¿…è¦çš„ï¼Œä½†æ˜¯å¯¹äºé¢å‘ä¸åŒç”¨æˆ·çš„äº§å“æ¥è¯´å°±å¾ˆæœ‰å¿…è¦äº†ï¼Œä¸¾ä¸ªä¾‹å­æ¥è¯´ï¼Œæ»´æ»´æ‰“è½¦çš„ä¹˜å®¢å’Œè½¦ä¸»è‚¯å®šæ˜¯ä¸¤ä¸ªä¸åŒçš„ç”¨æˆ·äº§å“ï¼Œå¦‚ä½•ç®¡ç†é‡Œé¢çš„æ•°æ®å°±éœ€è¦å¼•ç”¨æƒé™è®¾è®¡çš„åŠŸèƒ½äº†ã€‚\r\n\r\næƒé™è®¾è®¡å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¢åŠ ä¿¡æ¯å®‰å…¨ã€ä¿è¯é¡µé¢çš„ç®€æ´ä¸è‡³äºå‡ºç°è¯¯æ“ä½œçš„äº‹æƒ…ï¼Œä¸‹é¢å°±æ¥è¯´ä¸‹åŸºæœ¬çš„ç»„æˆ\r\n\r\n## ç»„æˆ\r\n\r\n- æƒé™\r\n  ![](https://user-gold-cdn.xitu.io/2019/11/14/16e6786c0af135b6?w=1080&h=638&f=webp&s=9744)\r\n  æƒé™è¿™å—å¯ä»¥åˆ†ä¸ºé¡µé¢æƒé™ã€åŠŸèƒ½æƒé™å’Œæ•°æ®æƒé™ï¼Œé¡µé¢æƒé™å°±æ˜¯æŒ‡æ˜¯å¦èƒ½è®¿é—®å½“å‰é¡µé¢ï¼ŒåŠŸèƒ½æƒé™å¯¹åº”çš„åˆ™æ˜¯ï¼ˆå¢åŠ ã€åˆ é™¤ã€ä¿®æ”¹ç­‰ï¼‰ï¼Œè€Œæ•°æ®æƒé™åˆ™æ˜¯å¯ä»¥è®¿é—®çš„æ•°æ®èŒƒå›´ã€‚\r\n\r\n- è§’è‰²\r\n\r\n  åœ¨ä¸€ä¸ªæˆç†Ÿçš„åå°è®¾è®¡ä¸­å¿…ç„¶è¦å‡ºç°è§’è‰²ï¼Œè¿™æ˜¯ä¸ºäº†é¿å…æ¯æ–°å¢ä¸€ä¸ªç”¨æˆ·å°±è¿˜è¦é‡æ–°ä¸ºä»–å‹¾é€‰ä¸€éæƒé™ï¼Œç”±è§’è‰²èµ‹å€¼ç»™ç”¨æˆ·æƒé™ï¼Œè§’è‰²è¿™å±‚å°±ç›¸å½“äºä¸€ä¸ªä¸­é—´å±‚ï¼ŒåŒæ—¶ä¹Ÿæ–¹ä¾¿ç»´æŠ¤ã€‚\r\n\r\n- ç”¨æˆ·\r\n\r\n  æ¯ä¸ªç”¨æˆ·å¯¹åº”ä¸€ä¸ªè´¦å·ï¼Œåœ¨é»˜è®¤çŠ¶æ€ä¸‹ä¼šç»™äºˆç”¨æˆ·ä¸€ä¸ªæœ€å°çš„æ“ä½œæƒé™ï¼Œæƒé™çš„èµ‹å€¼ç”±è§’è‰²ç»™äºˆï¼Œå¤šä¸ªè§’è‰²çš„æƒé™æ˜¯å¯ä»¥å åŠ çš„ã€‚\r\n\r\n## å»¶ä¼¸\r\n\r\nä¸Šé¢ä»‹ç»çš„å…¶å®å°±æ˜¯`RBAC`æ¨¡å‹çš„ç®€å•æ¦‚å¿µï¼Œåœ¨å®é™…å¼€å‘ä¸­è§‰å¾—è‡³å°‘æœ‰ä»¥ä¸‹å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š\r\n\r\n- admin\r\n\r\nåœ¨å¼€å‘å®Œæˆåéœ€è¦åœ¨è§’è‰²é¢„ç•™ä¸€ä¸ª admin æˆ–è€…è¶…çº§ç®¡ç†å‘˜ï¼Œæ–¹ä¾¿å¼€å‘äººå‘˜çš„ç»´æŠ¤\r\n\r\n- æƒé™çš„ä¼˜å…ˆçº§\r\n\r\nä¸Šé¢ä»‹ç»äº†æƒé™çš„ç»„æˆï¼Œä½†æ˜¯é¡µé¢çš„æƒé™åº”å½“æ˜¯å¤§äºæ“ä½œçš„æƒé™ï¼Œåªæœ‰é¡µé¢çš„æƒé™å¯è§ï¼ŒåŠŸèƒ½çš„æƒé™æ‰æ˜¯æœ‰æ„ä¹‰çš„\r\n\r\n- tips\r\n\r\næ— æƒé™è®¿é—®é¡µé¢ã€é¡µé¢ä¸å­˜åœ¨ã€æœåŠ¡å™¨å‘ç”Ÿé”™è¯¯ç­‰æ–¹é¢çš„æç¤º\r\n\r\n## æœ€å\r\n\r\næœ€åè¯´ä¸€ä¸‹å‰ç«¯å¯¹`tips`è¿™å—çš„å¤„ç†\r\n403ã€404ã€500 çš„å¤„ç†æ€è·¯\r\n\r\n##### 500\r\n\r\n500 çš„å¤„ç†å¯ä»¥é€šè¿‡`axions`çš„æ‹¦æˆªå™¨æ¥å®ç°ï¼Œç°åœ¨åç«¯é»˜è®¤è¿”å›çš„åŸºæœ¬æ ¼å¼éƒ½æ˜¯\r\n\r\n```js\r\n{\r\n  // çŠ¶æ€ç \r\n  status: 200,\r\n  data: {},\r\n  // ...\r\n  }\r\n```\r\n\r\næ‰€ä»¥åˆ¤æ–­æœåŠ¡å™¨å‘ç”Ÿé”™è¯¯ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡\r\n\r\n```js\r\n// æ·»åŠ è¯·æ±‚æ‹¦æˆªå™¨\r\naxios.interceptors.request.use(\r\n  function(config) {\r\n    // åœ¨å‘é€è¯·æ±‚ä¹‹å‰åšäº›ä»€ä¹ˆ\r\n    return config;\r\n  },\r\n  function(error) {\r\n    // å¯¹è¯·æ±‚é”™è¯¯åšäº›ä»€ä¹ˆï¼Œè¿™ä¸€æ­¥å¯ä»¥ç›´æ¥è¿”å›æœåŠ¡å™¨å‘ç”Ÿé”™è¯¯ï¼Œæ–¹ä¾¿æç¤ºä¿¡æ¯çš„å®šåˆ¶\r\n    return Promise.reject(`æœåŠ¡å™¨å‘ç”Ÿé”™è¯¯`);\r\n  }\r\n);\r\n```\r\n\r\n##### 404\r\n\r\n404 çš„å®ç°å¯ä»¥é€šè¿‡`router`æ¥å®ç°ï¼Œè¿™é‡Œæˆ‘ç”¨çš„æ˜¯`vue router`å°±ä»¥è¿™ä¸ªä¸¾ä¾‹ï¼Œå‡è®¾æœ‰ä¸€ç»„è·¯ç”±ä¸º\r\n\r\n```js\r\nconst router = new VueRouter({\r\n  routes: [\r\n    {\r\n      path: \"/user\",\r\n      component: User,\r\n      children: [\r\n        {\r\n          path: \"profile\",\r\n          component: UserProfile\r\n        },\r\n        {\r\n          path: \"posts\",\r\n          component: UserPosts\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      path: \"/sign\",\r\n      component: sign\r\n    }\r\n  ]\r\n});\r\n```\r\n\r\né‚£æˆ‘ä»¬å°±é€šè¿‡é€’å½’å°†æ‰€æœ‰è·¯ç”±æ‹¼æˆä¸€ç»´æ•°ç»„ï¼ˆæ³¨æ„å¯¹æ¯”çš„æ¡ä»¶ï¼Œè¿™é‡Œæˆ‘å¯¹æ¯”çš„æ˜¯ path æ‰€ä»¥åœ¨é€’å½’è¿‡ç¨‹ä¸­è¦å°†çˆ¶ path ç›¸åŠ ï¼‰ï¼Œå…·ä½“çš„é€’å½’å®ç°å–å†³äºä½ çš„å¸¸è§ï¼Œè¿™é‡Œä¸åšæ¼”ç¤ºï¼Œä¹‹åå¯¹æ¯”è®¿é—®çš„è·¯å¾„å­˜ä¸å­˜åœ¨è·¯ç”±ä¿¡æ¯ä¸­ï¼Œä¸å­˜åœ¨åˆ™è¯´æ˜é¡µé¢ä¸å­˜åœ¨è¿”å›`404`\r\n\r\n##### 403\r\n\r\n403 çš„å®ç°éœ€è¦é…åˆåç«¯æ¥å®ç°ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¼šè¯·æ±‚ç”¨æˆ·çš„æ“ä½œæƒé™ä¼šè¿”å›å½“å‰ç”¨æˆ·æƒé™æ‰€èƒ½æ“ä½œçš„èœå•ï¼Œä¹‹åå°†èƒ½è®¿é—®çš„èœå•å’Œè·¯ç”±ä¿¡æ¯å¯¹æ¯”ï¼Œå¦‚æœè®¿é—®çš„è·¯å¾„åœ¨è·¯ç”±ä¿¡æ¯ä¸­ä½†æ˜¯ä¸åœ¨ç”¨æˆ·è¿”å›çš„èœå•è¯´æ˜æ²¡æœ‰é¡µé¢è®¿é—®çš„æƒé™ã€‚\r\n\r\næœ€åè¯´ä¸‹ä¸ºä»€ä¹ˆæ²¡æœ‰ç”¨`*`çš„åŸå› ï¼Œå› ä¸ºä¸å¤ªå¥½å®šåˆ¶ï¼Œåœ¨é»˜è®¤çŠ¶æ€ä¸‹ä»¥`'/'`çš„å½¢å¼è®¿é—®æˆ‘ä»¬è¦ç»™äºˆä¸€ä¸ªç”¨æˆ·èœå•çš„ç¬¬ä¸€é¡¹ï¼Œä½†æ˜¯å¦‚æœ`'/'`ä¸å­˜åœ¨è·¯ç”±ä¸­æˆ‘ä»¬è¿˜è¦å†™é¢å¤–çš„åˆ¤æ–­ï¼Œä¸å¦‚å…¨éƒ¨è‡ªå·±æ¥è‡ªè¡Œå¤„ç†äº†ã€‚\r\n\r\n## å‚è€ƒ\r\n\r\n1. [è§’è‰²æƒé™è®¾è®¡çš„ 100 ç§è§£æ³•](<https://mp.weixin.qq.com/s?__biz=MzI1ODY0NTg0MA==&mid=2247484799&idx=1&sn=5467e1452356e36607d938752805eb7d&chksm=ea044f40dd73c6563e72b1f34d0c27a23d06d5bcd80255568a9caa359ef2d03cd89713f0449b&scene=0&key=7fa4b6bcf3a05ff6a03f1d892329a3a1fcb4a9dd572857d0b82f72ec1386dfb5bd66a733158b657f4524063e1b5b4ade5442b1f23c89adbc9cfa818a68f64fbb4e725cc4baa55d048efe25d963e9e391&ascene=0&uin=MTAyMzI5NDA0Mw%3D%3D&devicetype=iMac+MacBookPro11%2C4+OSX+OSX+10.11.6+build(15G22010)&version=12020010&nettype=WIFI&lang=en&fontScale=100&pass_ticket=GR%2BJaO%2FEpgB4z%2BZuVHJsrM8QYhyiZAEBCQll6nnnN5CpbcQ%2FhZ5WoCr%2Fxr5QWiOL>)\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/36/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/36/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/2",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/2/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/2/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/2/events",
          "html_url": "https://github.com/bosens-China/blog/issues/2",
          "id": 473943664,
          "node_id": "MDU6SXNzdWU0NzM5NDM2NjQ=",
          "number": 2,
          "title": "æ¼«è°ˆECMAScriptæœ‰æ„æ€çš„è®¾è®¡",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1371686608,
              "node_id": "MDU6TGFiZWwxMzcxNjg2NjA4",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%BC%AB%E8%B0%88%E7%B3%BB%E5%88%97",
              "name": "æ¼«è°ˆç³»åˆ—",
              "color": "e7f3ee",
              "default": false,
              "description": "æµ…è°ˆç±»æ–‡ç« "
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2019-07-29T09:23:22Z",
          "updated_at": "2021-12-21T09:33:52Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "æœ€è¿‘é‡è¯»ã€Šä½ æ‰€ä¸çŸ¥é“çš„ JavaScriptã€‹å‘ç°ä¸€äº›æœ‰è¶£çš„ç‚¹ï¼Œæƒ³åˆ†äº«ä¸‹ã€‚\r\n\r\n## å—çº§ä½œç”¨åŸŸ\r\n\r\nES6 å¼•ç”¨äº† let å’Œ constï¼Œè¿™å®é™…ä¸Šå¸¦æ¥äº†å—çº§ä½œç”¨åŸŸï¼Œåœ¨ ES6 ä¹‹å‰åªå­˜åœ¨å…¨å±€ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸï¼Œç›¸ä¿¡å°ä¼™ä¼´å¯¹è¿™å¥è¯åº”å½“ä¸é™Œç”Ÿï¼Œä¸‹é¢å°±æ¥èŠèŠä¸€ä¸ª ES6 ä¹‹å‰å¦‚æœå®ç°å—çº§ä½œç”¨åŸŸã€‚\r\n\r\næ€è€ƒä¸‹é¢ä¸€ä¸ªä¾‹å­ä»£ç è¾“å‡ºå€¼ä¸ºå¤šå°‘\r\n\r\n```js\r\nfor (var i = 0; i < 10; i++) {\r\n  setTimeout(function () {\r\n    console.log(i);\r\n  }, 100);\r\n}\r\n```\r\n\r\nè¿™é‡Œä¼šè¾“å‡º 10 ä¸ª 10ï¼Œå› ä¸ºåªå­˜åœ¨ä¸€ä¸ªå…¨å±€å˜é‡`i`ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç«‹å³æ‰§è¡Œå‡½æ•°æ¥è§£å†³è¿™ä¸ªé—®é¢˜\r\n\r\n```js\r\nfor (var i = 0; i < 10; i++) {\r\n  (function (i) {\r\n    setTimeout(function () {\r\n      console.log(i);\r\n    }, 100);\r\n  })(i);\r\n}\r\n```\r\n\r\nå¦‚æœåœ¨ ES6 ç¯å¢ƒä¸‹è¿˜å¯ä»¥ä½¿ç”¨ let å‘½ä»¤è§£å†³ï¼Œå®ƒä¼šåœ¨æ¯æ¬¡å¾ªç¯çš„æ—¶å€™åˆ›å»ºä¸€ä¸ªä½œç”¨åŸŸï¼Œè‡³äºä¸ºä»€ä¹ˆèƒ½è®°ä½ä¸Šä¸€æ¬¡çš„å€¼ï¼Œé‚£æ˜¯å› ä¸º js å¼•æ“ä¼šè®°ä½ä¸Šä¸€æ¬¡å¾ªç¯çš„å€¼ã€‚\r\n\r\n```js\r\nfor (let i = 0; i < 10; i++) {\r\n  setTimeout(() => {\r\n    console.log(i);\r\n  }, 100);\r\n}\r\n```\r\n\r\nä¸Šé¢çš„ä¾‹å­å¸®æˆ‘ä»¬å›é¡¾ä¸€ä¸‹æ²¡æœ‰å—çº§ä½œç”¨åŸŸçš„ç—›è‹¦ä¹‹ä¸€ï¼Œå®é™…ä¸Šæˆ‘ä»¬å†™é¡¹ç›®çš„æ—¶å€™å¯èƒ½æ—©æ—©çš„å°±ä½¿ç”¨äº†`babel`ï¼Œå®ƒä¼šé€šè¿‡æ€ä¹ˆæ ·çš„å½¢å¼å°†`let`å’Œ`const`è½¬åŒ–ä¸ºæ”¯æŒ ES5 çš„ç¯å¢ƒå‘¢ï¼Ÿ\r\n\r\nå…ˆçœ‹ä¸‹é¢ä¸€ä¸ªä¾‹å­\r\n\r\n```js\r\ntry {\r\n  throw 5;\r\n} catch (e) {\r\n  console.log(e);\r\n}\r\nconsole.log(e); //error e is not defined\r\n```\r\n\r\nè¿™é‡Œ try ä¼šåˆ›å»ºä¸€ä¸ªå—çº§ä½œç”¨åŸŸï¼Œåœ¨å…¨å±€ç¯å¢ƒä¸‹ a ä¸å­˜åœ¨ï¼Œæ‰€ä»¥æŠ¥é”™äº†ã€‚\r\nèªæ˜çš„å°ä¼™ä¼´å¯èƒ½å·²ç»æƒ³åˆ°äº†ï¼Œå¯ä»¥ä½¿ç”¨ try æ¥åˆ›å»ºå—çº§ä½œç”¨åŸŸï¼Œç†è®ºä¸Šæ˜¯å¯è¡Œçš„ï¼Œä¸è¿‡å®é™…ä¸Šæœ‰ä¸¤ç‚¹é—®é¢˜\r\n\r\n1. æ€§èƒ½å¤ªæ…¢\r\n2. è¯­æ³•ä¸‘é™‹ï¼Œè¦æ˜¾ç¤ºçš„æŠ¥é”™\r\n\r\næˆ‘ä»¬æ¥çœ‹ä¸‹`babel`æ€ä¹ˆå¤„ç†ä¸Šé¢çš„ä¾‹å­\r\n\r\n```js\r\n'use strict';\r\n\r\nvar _loop = function _loop(i) {\r\n  setTimeout(function () {\r\n    console.log(i);\r\n  }, 100);\r\n};\r\n\r\nfor (var i = 0; i < 10; i++) {\r\n  _loop(i);\r\n}\r\n```\r\n\r\nå¯ä»¥çœ‹åˆ°ä¸ç«‹å³æ‰§è¡Œå‡½æ•°åŸºæœ¬ç›¸åŒï¼Œä¸è¿‡ä½¿ç”¨ç«‹å³æ‰§è¡Œå‡½æ•°åˆ›å»ºå—çº§ä½œç”¨åŸŸéœ€è¦æ³¨æ„ä¸€ç‚¹`this`çš„æŒ‡å‘ã€‚\r\n\r\nä¾‹å¦‚è¿™ä¸ªä¾‹å­\r\n\r\n```js\r\nconst obj = {\r\n  foo() {\r\n    for (let i = 0; i < 5; i += 1) {\r\n      setTimeout(() => {\r\n        console.log(this.arr[i]);\r\n      }, 1000);\r\n    }\r\n  },\r\n  arr: [1, 2, 3, 4, 5],\r\n};\r\n```\r\n\r\nç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ this å¯¹è±¡ï¼Œæ˜¯å®šä¹‰æ—¶çš„å¯¹è±¡è€Œä¸æ˜¯è¿è¡Œæ—¶çš„å¯¹è±¡ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­æŒ‡å‘çš„æ˜¯ objï¼›\r\nå¦‚æœè¦æŠŠä¸Šé¢çš„ä»£ç è½¬åŒ–ä¸º ES5 ç¯å¢ƒæ”¯æŒçš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½œç”¨åŸŸçš„è§„åˆ™æ¥å®ç°\r\n\r\n```js\r\n(function () {\r\n  var _this = this;\r\n  setTimeout(function () {\r\n    console.log(_this.arr[i]);\r\n  }, 1000);\r\n})();\r\n```\r\n\r\nä¸Šé¢å°±å®ç°äº†æ‰€éœ€çš„åŠŸèƒ½\r\n\r\n## éšè—çš„ global å¯¹è±¡\r\n\r\nä¸‹é¢ä»£ç å‡è®¾ç¯å¢ƒä¸ºæµè§ˆå™¨ç¯å¢ƒï¼ŒJavaScript æœ‰è®¸å¤šè®¾è®¡ç¼ºé™·ï¼Œå…¶ä¸­ä¸ä½¿ç”¨å£°æ˜å£°æ˜å˜é‡ï¼Œä¼šè‡ªåŠ¨å°†å˜é‡åˆ›å»ºåœ¨`global`ä¸Šå°±æ˜¯å…¶ä¸€ï¼Œä¸è¿‡ä¸‹é¢å°±æ¥æ¼«è°ˆç‰¹æ®Šçš„`global`å¯¹è±¡\r\n\r\n```js\r\nvar a = 10;\r\nb = 20;\r\nwindow.a; //10\r\nwindow.b; //20\r\n```\r\n\r\n### index.html\r\n\r\nåˆ›å»ºä¸€ä¸ªå¸¦æœ‰ id çš„ DOM å…ƒç´ ï¼Œhtml å†…çš„ id å…ƒç´ ä¹Ÿä¼šè‡ªåŠ¨åæ˜ åœ¨`global`å¯¹è±¡ä¸Šï¼Œä¾‹å¦‚ä¸‹é¢\r\n\r\n```html\r\n<div id=\"div\"></div>\r\n<script>\r\n  console.log(typeof div); //object\r\n</script>\r\n```\r\n\r\né€šè¿‡`id`çš„ DOM å…ƒç´ ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ DOM ä¸Šçš„ä¸€äº›æ–¹æ³•ï¼Œç®—æ˜¯ä¸€ä¸ªå¥‡æ·«å·§æŠ€\r\n\r\n```js\r\nconsole.log(div.nodeType); //1\r\nconsole.log(div.nodeName); //DIV\r\n//...\r\n```\r\n\r\nä¸è¿‡åº”è¯¥é¿å…ä½¿ç”¨ id çš„ DOM å…ƒç´ ï¼Œä¸æ˜“äºä»£ç çš„å¯è¯»æ€§ï¼Œæ›´æ¨èä½¿ç”¨æ ‡å‡†è·å– dom çš„æ–¹æ³•ã€‚\r\næœ€åæç¤ºä¸€ç‚¹ï¼Œå¦‚æœå­˜åœ¨ç›¸åŒçš„`id`domï¼Œcss ä»£ç ä¼šä½œç”¨ä¸¤ä¸ªç›¸åŒçš„å…ƒç´ \r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/2/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/2/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        }
      ]
    ],
    [
      "1740577858",
      [
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/95",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/95/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/95/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/95/events",
          "html_url": "https://github.com/bosens-China/blog/issues/95",
          "id": 1520334523,
          "node_id": "I_kwDOCzPAy85anna7",
          "number": 95,
          "title": "monorepo å¦‚ä½•è§£å†³åˆ«åé—®é¢˜",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1740577858,
              "node_id": "MDU6TGFiZWwxNzQwNTc3ODU4",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3",
              "name": "å·¥å…·ç›¸å…³",
              "color": "f73d62",
              "default": false,
              "description": "å·¥ç¨‹åŒ–ç›¸å…³çš„ä¸œè¥¿"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2023-01-05T08:43:30Z",
          "updated_at": "2023-01-05T08:43:30Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "å¾—ç›Šäº pnpm è½¯é“¾æ¥å®ç°ç°åœ¨ monorepo é¡¹ç›®å·²ç»ååˆ†æˆç†Ÿäº†ï¼Œä¸è¿‡åœ¨å†™é¡¹ç›®æ—¶å€™è¿˜æ˜¯é‡åˆ°å¾ˆå¤šç—›ç‚¹ï¼Œä¾‹å¦‚ï¼š\r\n\r\n1. å¦‚æœæˆ‘æœ‰å¤šä¸ª packages é¡¹ç›®å¹¶ä¸”ä½¿ç”¨ TypeScriptï¼Œé‚£ä¹ˆæˆ‘è‚¯å®šå¸Œæœ›æ˜¯å†™çš„éƒ½æ˜¯ tsï¼Œåœ¨éœ€è¦è°ƒç”¨çš„æ—¶å€™é€šè¿‡å·¥å…·æ¥å®Œæˆè¿™ä¸€è¿‡ç¨‹çš„è½¬è¯‘ï¼Œä¸è¿‡åœ¨å®é™…å¼€å‘ä¸­å¯èƒ½ä½¿ç”¨äº† vite è¿™æ ·çš„å·¥å…·ï¼Œå¯¼è‡´é‡åˆ°é—®é¢˜åªèƒ½é€šè¿‡å…¶å®ƒæ–¹å¼æ¥ç»•è¿‡å»ï¼›\r\n2. å¦‚æœå†™ä¸€ä¸ªåç«¯é¡¹ç›®ï¼Œé‚£ä¹ˆæ•°æ®åº“å®šä¹‰çš„æ¨¡å‹æè¿°è‚¯å®šå¸Œæœ›åœ¨ web é¡¹ç›®ä¹Ÿå¯ä»¥å¤ç”¨ï¼Œä¸è¿‡åœ¨å¤šå…¥å£ä¸­å¯èƒ½è¿˜éœ€è¦é€šè¿‡ `@new-house/src/xxxx.ts` æ¥å¼•ç”¨ï¼Œè¿™ä¸ª `src/xxx` ä¹Ÿå¤ªä¸ç®€æ´äº†ã€‚\r\n\r\næ‰€ä»¥è¿™ç¯‡æ–‡ç« é‡ç‚¹å°±æ˜¯è§£å†³é—®é¢˜ 2 ï¼Œé—®é¢˜ 1 å¦‚æœæœ‰æœºä¼šå†å•ç‹¬å¼€ä¸€ä¸ªç¯‡å¹…æ¥è¯´ï¼Œåœ¨æ­£å¼è®²è§£ä¹‹å‰éœ€è¦ä»‹ç»ä¸€ä¸‹ `exports` è¿™ä¸ªå±æ€§\r\n\r\n## exports\r\n\r\nè¿™ä¸ªå±æ€§æ·»åŠ äº v12.7.0ï¼Œæœ€ç®€å•çš„ä½¿ç”¨æ–¹å¼å¦‚ä¸‹\r\n\r\n```js\r\n{\r\n  // package.json\r\n  \"exports\": \"./index.js\"\r\n}\r\n```\r\n\r\nå®ƒçš„ä¼˜å…ˆçº§é«˜äº `main`ï¼Œé™¤æ­¤ä¹‹å¤–æ›´å¤šæ˜¯ä½œä¸ºä¸åŒç¯å¢ƒå¯¼å…¥æ–‡ä»¶æ¥ä½¿ç”¨ï¼Œä¾‹å¦‚å¼€å‘äº†ä¸€ä¸ª utils çš„åŒ…å¸Œæœ›å®ƒå¯ä»¥åœ¨ node çš„ cjs å’Œ ems ç¯å¢ƒä¸‹å·¥ä½œï¼Œé‚£ä¹ˆå®ƒå°±å¯ä»¥å‘æŒ¥ä½œç”¨äº†ã€‚\r\n\r\n```js\r\n{\r\n  \"exports\": {\r\n    \".\": {\r\n      \"import\": \"./feature-node.mjs\",\r\n      \"require\": \"./feature-node.cjs\"\r\n    },\r\n  }\r\n}\r\n```\r\n\r\né™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥è§£å†³ç›®å½•åˆ«åé—®é¢˜ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä»‹ç»å®ƒçš„åŸå› \r\n\r\n```js\r\n{\r\n  \"name\": \"my-package\",\r\n  \"exports\": {\r\n    \".\": \"./lib/index.js\",\r\n    \"./lib\": \"./lib/index.js\",\r\n    \"./lib/*\": \"./lib/*.js\",\r\n    \"./lib/*.js\": \"./lib/*.js\",\r\n    \"./feature\": \"./feature/index.js\",\r\n    \"./feature/*\": \"./feature/*.js\",\r\n    \"./feature/*.js\": \"./feature/*.js\",\r\n    \"./package.json\": \"./package.json\"\r\n  }\r\n}\r\n```\r\n\r\nä¸Šé¢çš„ ` \"./feature/*\": \"./feature/*.js\",` ä»¥åŠ `\"./feature/*.js\": \"./feature/*.js\",` ç­‰éƒ½å¯ä»¥é€šè¿‡ `my-package/feature/xxx.js` æ¥å®Œæˆè°ƒç”¨\r\n\r\nexports å°±ä»‹ç»åˆ°è¿™é‡Œï¼Œäº†è§£åˆ°å®ƒå¯ä»¥é€‚é…ä¸åŒç¯å¢ƒä»¥åŠç”¨äºè§£å†³ç›®å½•åˆ«åï¼Œä¸‹é¢å°±æ˜¯é¡¹ç›®å®æˆ˜ã€‚\r\n\r\n## TypeScript ä¸‹ä½¿ç”¨\r\n\r\nä¸ºäº†æ–¹ä¾¿ï¼Œè¿™é‡Œæˆ‘å·²ç»æ­å»ºå¥½äº†ä¸€ä¸ª pnpm monorepo é¡¹ç›®ï¼Œå®ƒçš„æ–‡ä»¶ç»“æ„å¦‚ä¸‹\r\n\r\n```sh\r\ntest\r\nâ”œâ”€ node_modules\r\nâ”œâ”€ package.json\r\nâ”œâ”€ packages\r\nâ”‚    â”œâ”€ utils\r\nâ”‚    â”‚    â”œâ”€ package.json\r\nâ”‚    â”‚    â”œâ”€ src\r\nâ”‚    â”‚    â”‚    â”œâ”€ addition.ts\r\nâ”‚    â”‚    â”‚    â””â”€ subtraction.ts\r\nâ”‚    â”‚    â””â”€ tsconfig.json\r\nâ”‚    â””â”€ web\r\nâ”‚           â”œâ”€ babel.config.js\r\nâ”‚           â”œâ”€ dist\r\nâ”‚           â”‚    â””â”€ index.js\r\nâ”‚           â”œâ”€ node_modules\r\nâ”‚           â”œâ”€ package.json\r\nâ”‚           â”œâ”€ src\r\nâ”‚           â”‚    â””â”€ index.ts\r\nâ”‚           â”œâ”€ tsconfig.json\r\nâ”‚           â””â”€ webpack.config.js\r\nâ”œâ”€ pnpm-lock.yaml\r\nâ”œâ”€ pnpm-workspace.yaml\r\nâ””â”€ tsconfig.json\r\n```\r\n\r\nutils è¿™ä¸ªé¡¹ç›®ç”¨äºç»™ web é¡¹ç›®ä½¿ç”¨ï¼Œå®ƒçš„ package.json å†…å®¹å¦‚ä¸‹\r\n\r\n```js\r\n{\r\n  \"name\": \"@test/utils\",\r\n  \"version\": \"1.0.0\",\r\n  \"exports\": {\r\n    \"./*\": \"./src/*.ts\"\r\n  }\r\n}\r\n```\r\n\r\nè¿™é‡Œè®¾ç½® `\"./*\"` æ˜¯æç¤ºè¿™ä¸ªä¸ºä¸€ä¸ªå­ç›®å½•åˆ«åï¼ŒåŒç†ä½ ä¹Ÿå¯ä»¥è®¾ç½® `\"test/*\"` è¡¨ç¤ºä»¥ test ä¸ºå¼€å¤´ï¼Œå› ä¸º utils è¿™ä¸ªé¡¹ç›®éƒ½æ˜¯ ts æˆ‘å¹¶ä¸æƒ³èŠ±æ—¶é—´æ¯æ¬¡éƒ½ build ä¸€éæˆ js æ‰€ä»¥åªèƒ½å†™æˆ `./src/*.ts`\r\n\r\n> è¿™é‡Œæç¤ºä¸€ä¸‹ï¼Œå¦‚æœæ˜¯ ts é¡¹ç›®å¿…é¡»è¿™ä¸ªç»“å°¾ï¼Œå¦åˆ™ä¼šæç¤ºæ‰¾ä¸åˆ°ç±»å‹æ–‡ä»¶\r\n\r\nç¬¬äºŒæ­¥å°±æ˜¯åœ¨ web é¡¹ç›®ä¸­å¼•ç”¨\r\n\r\n```js\r\n// web/src/index.ts\r\nimport addition from '@test/utils/addition';\r\nimport subtraction from '@test/utils/subtraction';\r\n\r\nconsole.log(addition(1, 1));\r\nconsole.log(subtraction(1, 1));\r\n```\r\n\r\n> å¦‚æœ TypeScript æç¤ºè¯´ä¸åˆ°æ¨¡å—ä¹‹ç±»çš„é”™è¯¯ï¼Œé‚£ä¹ˆä½ éœ€è¦è°ƒæ•´ä¸€ä¸‹ tsconfig.json çš„é…ç½®\r\n>\r\n> ```json\r\n> {\r\n>   \"compilerOptions\": {\r\n>     \"moduleResolution\": \"NodeNext\" // node 16ä¹Ÿå¯ä»¥\r\n>   }\r\n> }\r\n> ```\r\n\r\nè¿™æ ·å°±æ¶ˆé™¤äº†é—¹å¿ƒçš„ src ç›®å½•\r\n\r\n## å…¶å®ƒé—®é¢˜\r\n\r\n### TypeScript ä½¿ç”¨åˆ«åå¦‚ä½•å®šä¹‰ç±»å‹æ–‡ä»¶\r\n\r\nè¿™ä¸ªå¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£çš„å®ç°\r\n\r\n```json\r\n// package.json\r\n{\r\n  \"name\": \"my-package\",\r\n  \"type\": \"module\",\r\n  \"exports\": {\r\n    \".\": {\r\n      // Entry-point for TypeScript resolution - must occur first!\r\n      \"types\": \"./types/index.d.ts\",\r\n      // Entry-point for `import \"my-package\"` in ESM\r\n      \"import\": \"./esm/index.js\",\r\n      // Entry-point for `require(\"my-package\") in CJS\r\n      \"require\": \"./commonjs/index.cjs\"\r\n    }\r\n  },\r\n  // CJS fall-back for older versions of Node.js\r\n  \"main\": \"./commonjs/index.cjs\",\r\n  // Fall-back for older versions of TypeScript\r\n  \"types\": \"./types/index.d.ts\"\r\n}\r\n```\r\n\r\né¢å¤–åœ¨ exports ä¸­æ·»åŠ  types å±æ€§ï¼Œç›¸å…³è®¨è®ºé“¾æ¥ https://github.com/microsoft/TypeScript/issues/33079#issuecomment-598961442\r\n\r\n### è®¾ç½®äº† moduleResolution å¯¼è‡´å¯¼å…¥å…¶å®ƒæ¨¡å—å¿…é¡»ä»¥.js ç»“å°¾\r\n\r\nä»¥.js ç»“å°¾æ˜¯è§„èŒƒçš„è§„å®šï¼Œå¦‚æœä½ ä½¿ç”¨ webpack5 æ¥æ‰“åŒ…é¡¹ç›®å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹\r\n\r\n```js\r\n{\r\n  resolve: {\r\n    extensionAlias: {\r\n      \".js\": [\".ts\", \".js\"],\r\n      \".cjs\": [\".cts\", \".cjs\"],\r\n      \".mjs\": [\".mts\", \".mjs\"],\r\n    }\r\n    // ...\r\n  }\r\n  // ...\r\n}\r\n```\r\n\r\nç›¸å…³é—®é¢˜é“¾æ¥ [Support TypeScript module resolution `node16` Â· Issue #12625 Â· facebook/create-react-app (github.com)](https://github.com/facebook/create-react-app/issues/12625)\r\n\r\n## å‚è€ƒé“¾æ¥\r\n\r\n- [æ¨¡å—ï¼šåŒ…|èŠ‚ç‚¹.js v19.3.0 æ–‡æ¡£ (nodejs.org)](https://nodejs.org/api/packages.html#subpath-imports)\r\n- [TypeScriptï¼š Documentation - ECMAScript Modules in Node.js (typescriptlang.org)](https://www.typescriptlang.org/docs/handbook/esm-node.html)\r\n- [Module çš„åŠ è½½å®ç° - ECMAScript 6 å…¥é—¨ (ruanyifeng.com)](https://es6.ruanyifeng.com/#docs/module-loader)\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/95/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/95/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/93",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/93/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/93/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/93/events",
          "html_url": "https://github.com/bosens-China/blog/issues/93",
          "id": 1254826397,
          "node_id": "I_kwDOCzPAy85KyyGd",
          "number": 93,
          "title": "nginx æç®€å…¥é—¨",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1740577858,
              "node_id": "MDU6TGFiZWwxNzQwNTc3ODU4",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3",
              "name": "å·¥å…·ç›¸å…³",
              "color": "f73d62",
              "default": false,
              "description": "å·¥ç¨‹åŒ–ç›¸å…³çš„ä¸œè¥¿"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2022-06-01T03:35:30Z",
          "updated_at": "2022-06-01T03:35:30Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "nginxï¼ˆè¯»éŸ³ï¼šengine-xï¼ŒéŸ³æ ‡ï¼š[ËˆendÊ’Éªnks']ï¼‰æ˜¯ HTTP å’Œåå‘ä»£ç†æœåŠ¡å™¨ã€é‚®ä»¶ä»£ç†æœåŠ¡å™¨å’Œé€šç”¨ TCP/UDP ä»£ç†æœåŠ¡å™¨ã€‚\r\n\r\næ—¥å¸¸ä¸­æœ€ç»å¸¸å¬åˆ°ç”¨åˆ°çš„å°±æ˜¯åå‘ä»£ç†ä»¥åŠè´Ÿè½½å‡è¡¡ï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯åå‘ä»£ç†å‘¢ï¼Ÿ\r\n\r\n## ä»€ä¹ˆæ˜¯åå‘ä»£ç†ï¼Ÿ\r\n\r\n![reverse-proxy](https://user-images.githubusercontent.com/39508895/171322376-dc12836e-435a-44c1-b3c8-cfdc3f8c4293.png)\r\n\r\n\r\nåå‘ä»£ç†ï¼ˆReverse Proxyï¼‰æ˜¯æŒ‡ä»¥ä»£ç†æœåŠ¡å™¨æ¥æ¥å— internetï¼ˆËˆÉªntÉ™ËŒnÉ›tï¼‰ ä¸Šçš„è¿æ¥è¯·æ±‚ï¼Œç„¶åå°†è¯·æ±‚è½¬å‘ç»™å†…éƒ¨ç½‘ç»œä¸Šçš„æœåŠ¡å™¨ï¼Œå¹¶å°†ä»æœåŠ¡å™¨ä¸Šå¾—åˆ°çš„ç»“æœè¿”å›ç»™ internet ä¸Šè¯·æ±‚è¿æ¥çš„å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶ä»£ç†æœåŠ¡å™¨å¯¹å¤–å°±è¡¨ç°ä¸ºä¸€ä¸ªåå‘ä»£ç†æœåŠ¡å™¨ã€‚\r\n\r\nç®€å•æ¦‚æ‹¬å°±æ˜¯æœ‰ä¸€ä¸ªä¸­è½¬æœåŠ¡å™¨æ¥è½¬å‘ä½ çš„è¯·æ±‚ï¼Œé‚£ä¹ˆä½¿ç”¨åå‘ä»£ç†æœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ\r\n\r\n- éšè—çœŸå®çš„æœåŠ¡åœ°å€\r\n- èŠ‚çœ ip èµ„æºï¼Œå…¬å…±çš„ ip åœ°å€æ˜¯æœ‰é™çš„ï¼Œåå‘ä»£ç†å¯ä»¥è§£å†³æ­¤é—®é¢˜\r\n\r\n### nginx ä¸­å¦‚ä½•é…ç½®åå‘ä»£ç†ï¼Ÿ\r\n\r\nåœ¨ nginx ä¸­é€šè¿‡æŒ‡å®š proxy_passï¼ˆËˆprÉ’ksi pÉ‘Ësï¼‰ å³å¯å®Œæˆè¯·æ±‚è½¬å‘åˆ°æŒ‡å®šæœåŠ¡å™¨\r\n\r\n```nginx\r\n# çœç•¥å…¶ä»–é…ç½®\r\n\r\nserver {\r\n  listen       80;\r\n  server_name  www.helloworld.com;\r\n\r\n  location /app1/ {\r\n    proxy_pass http://api_server;\r\n    rewrite \"^/app1/(.*)$\" /$1 break;\r\n  }\r\n\r\n  location /app2/ {\r\n    proxy_pass http://api_server;\r\n  }\r\n}\r\n```\r\n\r\nä¸Šé¢çš„ä¸¤ç§å½¢å¼æ˜¯æœ€é•¿ä½¿ç”¨çš„åœºæ™¯ã€‚\r\n\r\nå‡è®¾è®¿é—® `www.helloworld.com/api1/user/1`ï¼Œé‚£ä¹ˆçœŸå®è¯·æ±‚çš„æ˜¯ `http://api_server/user/1`ï¼›\r\n\r\nè€Œå¦‚æœè®¿é—®` www.helloworld.com/api2/user/2`ï¼ŒçœŸå®è¯·æ±‚åœ°å€ä¸º `http://api_server/app2/user/2`ã€‚\r\n\r\nä¸Šé¢çš„ `rewriteï¼ˆËˆriËraÉªtï¼‰` æ˜¯é‡å†™è¯·æ±‚åœ°å€ï¼Œè€Œ `(.*)` ä»£è¡¨æ­£åˆ™çš„ç»„åŒ¹é…ï¼Œ$1 æ˜¯è·å– `()` çš„å†…å®¹ï¼ŒåŒç†å¦‚æœå­˜åœ¨å¤šä¸ª `()` è¿˜å¯ä»¥é€šè¿‡$2,$3 çš„å½¢å¼æ¥ç®€å†™ã€‚\r\n\r\n### ä¸ dev å¼€å‘å¯¹æ¯”\r\n\r\nè€Œåœ¨çœŸå®çš„å¼€å‘ä¸­ï¼ˆå¯èƒ½æ˜¯é€šè¿‡ webpack æˆ–è€… vite è¿™æ ·çš„å·¥å…·ï¼‰ï¼Œä¸ºäº†è§£å†³è·¨åŸŸé—®é¢˜ï¼Œæˆ‘ä»¬ä¹Ÿä¼šå¼•å…¥åå‘ä»£ç†ï¼Œä¾‹å¦‚å¦‚ä¸‹é…ç½®ï¼š\r\n\r\n```js\r\nexport default defineConfig({\r\n  server: {\r\n    proxy: {\r\n      // å­—ç¬¦ä¸²ç®€å†™å†™æ³•\r\n      '/foo': 'http://localhost:4567',\r\n      // é€‰é¡¹å†™æ³•\r\n      '/api': {\r\n        target: 'http://jsonplaceholder.typicode.com',\r\n        changeOrigin: true,\r\n        rewrite: (path) => path.replace(/^\\/api/, ''),\r\n      },\r\n    },\r\n  },\r\n});\r\n```\r\n\r\næ‰€ä»¥ç»¼ä¸Šæ‰€è¿°ï¼Œåå‘ä»£ç†æˆ‘ä»¬ä¸€ç›´åœ¨ä½¿ç”¨å¯èƒ½ä½ å¹¶æ²¡æœ‰è§‰å¯Ÿåˆ°ã€‚\r\n\r\n## ä»€ä¹ˆæ˜¯è´Ÿè½½å‡è¡¡ï¼Ÿ\r\n\r\nè´Ÿè½½å‡è¡¡ï¼ˆLoad Balanceï¼‰è¿™ä¸ªè¯ç»å¸¸ä¼šå¬åˆ°ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯åˆ†æ‘Šåˆ°å¤šä¸ªæ“ä½œå•å…ƒä¸Šè¿›è¡Œæ‰§è¡Œã€‚\r\n\r\næ¦‚å¿µè¿˜æ˜¯ä¸å¤ªæ˜æ˜¾ï¼Œä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå¦‚æœæœ‰ä¸€ä¸ªç½‘ç«™ `www.helloworld.com`ï¼Œæ­£å¸¸æƒ…å†µä¸‹å®ƒçš„ web æ¶æ„å¦‚ä¸‹\r\n![demo1](https://pic3.zhimg.com/80/v2-6a7f624cd5e776a6b0b05a051e65666e_720w.jpg)\r\nè¿™é‡Œå¦‚æœæœåŠ¡å™¨å®•æœºäº†æˆ–è€…è¾¾åˆ°è®¿é—®ä¸Šé™å°±ä¼šå‡ºç°æ²¡åŠæ³•è®¿é—®æƒ…å†µã€‚\r\n\r\né‚£ä¹ˆè´Ÿè½½å‡è¡¡å¦‚ä½•è§£å†³å¦‚ä¸Šé—®é¢˜å‘¢ï¼Ÿ\r\n\r\n### è´Ÿè½½å‡è¡¡å¦‚ä½•è§£å†³\r\n\r\n\r\n\r\nåœ¨åç«¯å¼•å…¥ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨å’Œä¸€å°é¢å¤–çš„ web æœåŠ¡å™¨å°±å¯ä»¥ç¼“è§£è¿™ç§æƒ…å†µï¼ˆæ³¨æ„ï¼Œè¿™é‡Œçš„ web æœåŠ¡ä¼šæä¾›ä¸€è‡´çš„æœåŠ¡ï¼‰ã€‚\r\n\r\næ‰€ä»¥è´Ÿè½½å‡è¡¡çš„ä½œç”¨å°±æ˜¯åœ¨äºåˆ†æµï¼Œè€Œåƒä¸Šé¢éƒ¨ç½²ä¸¤å°æˆ–è€…ä»¥ä¸Šçš„ web æœåŠ¡ï¼Œæˆ‘ä»¬ç§°ä¸ºé›†ç¾¤ã€‚\r\n\r\nä¸‹é¢çœ‹ä¸€ä¸ª nginx çš„è´Ÿè½½å‡è¡¡ä¾‹å­ï¼Œä½œä¸ºé¢å¤–çŸ¥è¯†ç‚¹è¡¥å……\r\n\r\n### nginx è´Ÿè½½å‡è¡¡ç¤ºä¾‹\r\n\r\n```nginx\r\nhttp {\r\n     #è®¾å®šmimeç±»å‹,ç±»å‹ç”±mime.typeæ–‡ä»¶å®šä¹‰\r\n    include       /etc/nginx/mime.types;\r\n    default_type  application/octet-stream;\r\n    #è®¾å®šæ—¥å¿—æ ¼å¼\r\n    access_log    /var/log/nginx/access.log;\r\n\r\n    #è®¾å®šè´Ÿè½½å‡è¡¡çš„æœåŠ¡å™¨åˆ—è¡¨\r\n    upstream load_balance_server {\r\n        #weigthå‚æ•°è¡¨ç¤ºæƒå€¼ï¼Œæƒå€¼è¶Šé«˜è¢«åˆ†é…åˆ°çš„å‡ ç‡è¶Šå¤§\r\n        server 192.168.1.11:80   weight=5;\r\n        server 192.168.1.12:80   weight=1;\r\n        server 192.168.1.13:80   weight=6;\r\n    }\r\n\r\n   #HTTPæœåŠ¡å™¨\r\n   server {\r\n        #ä¾¦å¬80ç«¯å£\r\n        listen       80;\r\n\r\n        #å®šä¹‰ä½¿ç”¨www.xx.comè®¿é—®\r\n        server_name  www.helloworld.com;\r\n\r\n        #å¯¹æ‰€æœ‰è¯·æ±‚è¿›è¡Œè´Ÿè½½å‡è¡¡è¯·æ±‚\r\n        location / {\r\n            root        /root;                 #å®šä¹‰æœåŠ¡å™¨çš„é»˜è®¤ç½‘ç«™æ ¹ç›®å½•ä½ç½®\r\n            index       index.html index.htm;  #å®šä¹‰é¦–é¡µç´¢å¼•æ–‡ä»¶çš„åç§°\r\n            proxy_pass  http://load_balance_server ;#è¯·æ±‚è½¬å‘load_balance_server å®šä¹‰çš„æœåŠ¡å™¨åˆ—è¡¨\r\n\r\n            #ä»¥ä¸‹æ˜¯ä¸€äº›åå‘ä»£ç†çš„é…ç½®(å¯é€‰æ‹©æ€§é…ç½®)\r\n            #proxy_redirect off;\r\n            proxy_set_header Host $host;\r\n            proxy_set_header X-Real-IP $remote_addr;\r\n            #åç«¯çš„WebæœåŠ¡å™¨å¯ä»¥é€šè¿‡X-Forwarded-Forè·å–ç”¨æˆ·çœŸå®IP\r\n            proxy_set_header X-Forwarded-For $remote_addr;\r\n            proxy_connect_timeout 90;          #nginxè·Ÿåç«¯æœåŠ¡å™¨è¿æ¥è¶…æ—¶æ—¶é—´(ä»£ç†è¿æ¥è¶…æ—¶)\r\n            proxy_send_timeout 90;             #åç«¯æœåŠ¡å™¨æ•°æ®å›ä¼ æ—¶é—´(ä»£ç†å‘é€è¶…æ—¶)\r\n            proxy_read_timeout 90;             #è¿æ¥æˆåŠŸåï¼Œåç«¯æœåŠ¡å™¨å“åº”æ—¶é—´(ä»£ç†æ¥æ”¶è¶…æ—¶)\r\n            proxy_buffer_size 4k;              #è®¾ç½®ä»£ç†æœåŠ¡å™¨ï¼ˆnginxï¼‰ä¿å­˜ç”¨æˆ·å¤´ä¿¡æ¯çš„ç¼“å†²åŒºå¤§å°\r\n            proxy_buffers 4 32k;               #proxy_buffersç¼“å†²åŒºï¼Œç½‘é¡µå¹³å‡åœ¨32kä»¥ä¸‹çš„è¯ï¼Œè¿™æ ·è®¾ç½®\r\n            proxy_busy_buffers_size 64k;       #é«˜è´Ÿè·ä¸‹ç¼“å†²å¤§å°ï¼ˆproxy_buffers*2ï¼‰\r\n            proxy_temp_file_write_size 64k;    #è®¾å®šç¼“å­˜æ–‡ä»¶å¤¹å¤§å°ï¼Œå¤§äºè¿™ä¸ªå€¼ï¼Œå°†ä»upstreamæœåŠ¡å™¨ä¼ \r\n\r\n            client_max_body_size 10m;          #å…è®¸å®¢æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å•æ–‡ä»¶å­—èŠ‚æ•°\r\n            client_body_buffer_size 128k;      #ç¼“å†²åŒºä»£ç†ç¼“å†²ç”¨æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å­—èŠ‚æ•°\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nè¿™é‡Œåœ¨è®¿é—® www.helloworld.com ä¼šæŒ‰ç…§ä»¥ä¸‹æƒé‡è®¿é—®\r\n\r\n- 192.168.1.13:80\r\n- 192.168.1.11:80\r\n- 192.168.1.12:80\r\n\r\n## nginx å¸¸è§å‘½ä»¤\r\n\r\n| å‘½ä»¤                         | æè¿°                                                                                               |\r\n| ---------------------------- | -------------------------------------------------------------------------------------------------- |\r\n| <kbd>nginx -s stop</kbd>     | å¿«é€Ÿå…³é—­ Nginxï¼Œå¯èƒ½ä¸ä¿å­˜ç›¸å…³ä¿¡æ¯ï¼Œå¹¶è¿…é€Ÿç»ˆæ­¢ web æœåŠ¡ã€‚                                          |\r\n| <kbd>nginx -s quit</kbd>     | å¹³ç¨³å…³é—­ Nginxï¼Œä¿å­˜ç›¸å…³ä¿¡æ¯ï¼Œæœ‰å®‰æ’çš„ç»“æŸ web æœåŠ¡ã€‚                                              |\r\n| <kbd>nginx -s reload</kbd>   | å› æ”¹å˜äº† Nginx ç›¸å…³é…ç½®ï¼Œéœ€è¦é‡æ–°åŠ è½½é…ç½®è€Œé‡è½½ã€‚                                                  |\r\n| <kbd>nginx -s reopen</kbd>   | é‡æ–°æ‰“å¼€æ—¥å¿—æ–‡ä»¶ã€‚                                                                                 |\r\n| <kbd>nginx -c filename</kbd> | ä¸º Nginx æŒ‡å®šä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œæ¥ä»£æ›¿ç¼ºçœçš„ã€‚                                                          |\r\n| <kbd>nginx -t</kbd>          | ä¸è¿è¡Œï¼Œä»…ä»…æµ‹è¯•é…ç½®æ–‡ä»¶ã€‚nginx å°†æ£€æŸ¥é…ç½®æ–‡ä»¶çš„è¯­æ³•çš„æ­£ç¡®æ€§ï¼Œå¹¶å°è¯•æ‰“å¼€é…ç½®æ–‡ä»¶ä¸­æ‰€å¼•ç”¨åˆ°çš„æ–‡ä»¶ã€‚ |\r\n| <kbd>nginx -v</kbd>          | æ˜¾ç¤º nginx çš„ç‰ˆæœ¬ã€‚                                                                                |\r\n| <kbd>nginx -V</kbd>          | æ˜¾ç¤º nginx çš„ç‰ˆæœ¬ï¼Œç¼–è¯‘å™¨ç‰ˆæœ¬å’Œé…ç½®å‚æ•°ã€‚                                                          |\r\n\r\nè¿™é‡Œçš„ nginx -t è¿˜æœ‰ä¸€ä¸ªé¢å¤–ä½œç”¨ï¼Œåœ¨ä¸æŒ‡å®š-c çš„æƒ…å†µä¸‹ä¼šæµ‹è¯•é»˜è®¤çš„é…ç½®æ–‡ä»¶ï¼Œä¸”ä¼šè¾“å‡ºä¸€å¥é¢å¤–ä¿¡æ¯\r\n\r\n```sh\r\nginx: the configuration file /etc/nginx/nginx.conf syntax is ok\r\nnginx: configuration file /etc/nginx/nginx.conf test is successful\r\n```\r\n\r\nå¯ä»¥ä»ä¸Šé¢ä¿¡æ¯è·å–åˆ°é»˜è®¤çš„é…ç½®æ–‡ä»¶è·¯å¾„\r\n\r\n## location åŒ¹é…è§„åˆ™\r\n\r\n| åç§°           | æè¿°                                                               |\r\n| -------------- | ------------------------------------------------------------------ |\r\n| <kbd>=</kbd>   | è¡¨ç¤ºç²¾ç¡®åŒ¹é…                                                       |\r\n| <kbd>~</kbd>   | è¡¨ç¤ºè¯¥è§„åˆ™æ˜¯ä½¿ç”¨æ­£åˆ™å®šä¹‰çš„ï¼ŒåŒºåˆ†å¤§å°å†™                             |\r\n| <kbd>~\\*</kbd> | è¡¨ç¤ºè¯¥è§„åˆ™æ˜¯ä½¿ç”¨æ­£åˆ™å®šä¹‰çš„ï¼Œä¸åŒºåˆ†å¤§å°å†™                           |\r\n| <kbd>^~</kbd>  | è¡¨ç¤ºå¦‚æœè¯¥ç¬¦å·åé¢çš„å­—ç¬¦æ˜¯æœ€ä½³åŒ¹é…ï¼Œé‡‡ç”¨è¯¥è§„åˆ™ï¼Œä¸å†è¿›è¡Œåç»­çš„æŸ¥æ‰¾ |\r\n| <kbd>/</kbd>   | é€šç”¨åŒ¹é…                                                           |\r\n\r\nå®ƒä»¬ä¹‹å‰ä¼˜å…ˆçº§å¦‚ä¸‹\r\n\r\n1. å¦‚æœåŒ¹é…åˆ° `=` ä¸å†å¯»æ‰¾ï¼›\r\n2. å¦‚æœåŒ¹é…åˆ° `^~` ä¸å†å¯»æ‰¾ï¼›\r\n3. å¦‚æœåŒ¹é…åˆ°æ­£åˆ™è§„åˆ™ï¼ˆå­˜åœ¨å¤šæ¡å–ç¬¬ä¸€æ¡åŒ¹é…ï¼‰ï¼Œä¸å†æŸ¥æ‰¾ï¼›\r\n4. åŒ¹é…ä¸å¸¦ä»»ä½•å‰ç¼€çš„è§„åˆ™ï¼Œä¾‹å¦‚ `location /user/`\r\n5. å¦‚æœéƒ½ä¸å­˜åœ¨ï¼ŒåŒ¹é… `/`;\r\n\r\n### location å®æˆ˜\r\n\r\nä¸‹é¢çœ‹ä¸€ä¸ªä¾‹å­ï¼Œå‡è®¾ nginx é…ç½®å¦‚ä¸‹\r\n\r\n```nginx\r\nlocation = / {\r\n    [ configuration A ]\r\n}\r\n\r\nlocation / {\r\n    [ configuration B ]\r\n}\r\n\r\nlocation /user/ {\r\n    [ configuration C ]\r\n}\r\n\r\nlocation ^~ /images/ {\r\n    [ configuration D ]\r\n}\r\n\r\nlocation ~* \\.(gif|jpg|jpeg)$ {\r\n    [ configuration E ]\r\n}\r\n```\r\n\r\nåˆ†åˆ«è¯·æ±‚ä»¥ä¸‹å†…å®¹ä¼šåŒ¹é…åˆ°é‚£æ¡è§„åˆ™å‘¢ï¼Ÿ\r\n\r\n- /\r\n- /index.html\r\n- /user/index.html\r\n- /images/1.jpg\r\n- /documents/about.html\r\n\r\n## alias ä¸ root åŒºåˆ«\r\n\r\nalias ä¸ root æœ‰ç€ç»†å¾®çš„å·®å¼‚ï¼Œä»¥ä¸‹é¢ nginx é…ç½®ä¸ºä¾‹\r\n\r\n```nginx\r\nserver {\r\n  # çœç•¥å…¶ä»–\r\n  # è‡ªå®šä¹‰ä¸€äº›å˜é‡\r\n  set $path /usr/share/nginx/html/icare/dist;\r\n\r\n  charset utf-8;\r\n\r\n  location / {\r\n    root $path;\r\n    index index.html;\r\n    try_files $uri $uri/ /index.html;\r\n  }\r\n\r\n  location /media/ {\r\n    expires 1h;\r\n    alias /usr/share/nginx/html/icare/static/download/;\r\n  }\r\n\r\n  location ^~ /app/center/assets {\r\n    alias $path/assets/;\r\n    gzip on;\r\n    gzip_http_version 1.1;\r\n    gzip_min_length 1k;\r\n    gzip_comp_level 5;\r\n    gzip_types *;\r\n    expires 30d;\r\n  }\r\n\r\n}\r\n\r\n```\r\n\r\né™æ€èµ„æºçš„å­˜æ”¾è·¯å¾„ä¸ºï¼š `/usr/share/nginx/html/icare/dist`\r\n\r\né™æ€èµ„æºçš„å…¬å…±å‰ç¼€ä¸º/app/center/ï¼Œæ­¤å‰ç¼€æ˜¯é€šè¿‡ vite è®¾ç½® base æ¥å®Œæˆçš„\r\n\r\n```js\r\nbase: command === 'build' ? '/app/center/' : '/';\r\n```\r\n\r\nè€Œå‡å®šæˆ‘ä»¬è¯·æ±‚ä¸€ä¸ªèµ„æº `http://10.0.40.33:8000/app/center/assets/index.d1eb2512.js`\r\n\r\nå¦‚æœä¸Šé¢çš„ alias ä¸º `root` å°±ä¼šè¯·æ±‚ `/usr/share/nginx/html/icare/dist/app/center/assets/index.d1eb2512.js` è¿™æ¡èµ„æº\r\n\r\nè€Œå®é™…ä¸Š app/center è¿™ä¸ªç›®å½•æ˜¯ä¸å­˜åœ¨ï¼Œå¦‚æœä½¿ç”¨ root æŒ‡ä»¤å°±ä¼šå¯¼è‡´èµ„æºæ— æ³•æ­£å¸¸åŠ è½½ã€‚\r\n\r\nå¯¹æ­¤ä½¿ç”¨ aliasa æŒ‡ä»¤æ¥æŒ‡å®šç›®å½•ï¼Œè¿˜æ˜¯ä»¥ä¸Šé¢èµ„æºä¸ºä¾‹ï¼ŒæŒ‡å®š alias æƒ…å†µä¸‹ï¼ŒçœŸæ­£è¯·æ±‚çš„èµ„æºåœ°å€ä¸º `/usr/share/nginx/html/icare/dist/assets/index.d1eb2512.js`\r\n\r\næ‰€ä»¥æ¦‚æ‹¬ä¸€ä¸‹ï¼š\r\n\r\n- root è¯·æ±‚çš„èµ„æºè·¯å¾„ä¸º root + location åŒ¹é…è§„åˆ™ + èµ„æºåç¼€ï¼ˆindex.d1eb2512.jsï¼‰\r\n- alias è¯·æ±‚èµ„æºè·¯å¾„ä¸º alias + èµ„æºåç¼€ï¼ˆindex.d1eb2512.jsï¼‰\r\n\r\n## å®æˆ˜\r\n\r\nä¸Šé¢ç®€çŸ­çš„ä»‹ç»äº†ä¸€ä¸‹ nginx çš„ä¸€äº›çŸ¥è¯†ç‚¹ï¼Œä¸‹é¢çœ‹å‡ ç§å¸¸è§çš„åœºæ™¯\r\n\r\n- éƒ¨ç½²é™æ€ç«™ç‚¹\r\n- éƒ¨ç½² spa å•é¡µé¢\r\n\r\n### éƒ¨ç½²é™æ€ç«™ç‚¹\r\n\r\nä¸éœ€è¦ä»»ä½•åç«¯æœåŠ¡çš„é¡¹ç›®ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªçº¯å±•ç¤ºä¿¡æ¯ï¼Œå‡è®¾é™æ€èµ„æºæ”¾ç½®åˆ°äº†/app/dist ä¸‹\r\n\r\n```nginx\r\nworker_processes  1;\r\n\r\nevents {\r\n\tworker_connections  1024;\r\n}\r\n\r\nhttp {\r\n    include       mime.types;\r\n    default_type  application/octet-stream;\r\n    sendfile        on;\r\n    keepalive_timeout  65;\r\n\r\n    gzip on;\r\n    gzip_types text/plain application/x-javascript text/css application/xml text/javascript application/javascript image/jpeg image/gif image/png;\r\n    gzip_vary on;\r\n\r\n    server {\r\n\t\tlisten       80;\r\n\t\tserver_name  static.zp.cn;\r\n\r\n\t\tlocation / {\r\n\t\t\troot /app/dist;\r\n\t\t\tindex index.html;\r\n\t\t\t#è½¬å‘ä»»ä½•è¯·æ±‚åˆ° index.html\r\n\t\t}\r\n\t}\r\n}\r\n```\r\n\r\nè¿è¡Œ nginx å°±å¯ä»¥çœ‹åˆ°å±•ç¤ºçš„ä¿¡æ¯äº†ã€‚\r\n\r\n### éƒ¨ç½² spa å•é¡µé¢\r\n\r\nspa å•é¡µé¢éƒ¨ç½²å¯ä»¥æ ¹æ®è·¯ç”±åˆ†ä¸º history å’Œ hash æ¨¡å¼ï¼Œå³(/hello or #hello)åŒºåˆ«ã€‚\r\n\r\n- hash è·¯ç”±\r\n\r\n![hash](https://user-images.githubusercontent.com/39508895/171322500-143846c6-7d38-4909-99e0-c2d7c9dc0927.jpg)\r\n\r\n- history è·¯ç”±\r\n\r\n![history](https://user-images.githubusercontent.com/39508895/171322578-5d9dc8a3-841b-417b-9995-b74d1e5e5286.jpg)\r\n\r\n\r\nå¯¹äº hash åªéœ€è¦å‰ç«¯è¿™è¾¹è·¯ç”±å¤„ç†å³å¯ä¸æ¶‰åŠåˆ°æœåŠ¡ç«¯ï¼Œæ‰€ä»¥åªéœ€è¦ç¡®ä¿æŒ‡å‘æ­£ç¡®çš„ index.html å³å¯ã€‚\r\n\r\nè€Œ history æ¨¡å¼éœ€è¦åˆ™ä¿è¯åœ¨åˆ·æ–°é¡µé¢ä¹‹åï¼Œç”¨æˆ·è¯·æ±‚çš„é¡µé¢åœ°å€ä¾ç„¶å¯ä»¥æ­£ç¡®è¿”å›å†…å®¹ï¼Œåé¢ä¼šè¯¦ç»†ä»‹ç»ï¼Œä¸‹é¢çœ‹ä¸€ä¸‹ hash æ¨¡å¼ nginx å¦‚ä½•é…ç½®ï¼Ÿ\r\n\r\n#### hash nginx é…ç½®\r\n\r\n```nginx\r\nworker_processes 1;\r\n\r\nevents {\r\n  worker_connections 1024;\r\n}\r\n\r\nhttp {\r\n  include mime.types;\r\n  default_type application/octet-stream;\r\n  sendfile on;\r\n  keepalive_timeout 65;\r\n\r\n  gzip on;\r\n  gzip_types text/plain application/x-javascript text/css application/xml text/javascript application/javascript image/jpeg image/gif image/png;\r\n  gzip_vary on;\r\n\r\n  root /app/dist;\r\n\r\n  server {\r\n    listen 80;\r\n    server_name static.zp.cn;\r\n\r\n    location / {\r\n      index index.html index.htm;\r\n    }\r\n    location ^~ /assets/ {\r\n      add_header Cache-Control \"public,max-age=31536000\";\r\n      # Allow cross origin access\r\n      add_header Access-Control-Expose-Headers \"Access-Control-Allow-Origin\";\r\n      add_header Access-Control-Allow-Origin \"*\";\r\n    }\r\n\r\n  }\r\n}\r\n```\r\n\r\nè¿™é‡Œæ–°å¢äº† `^~ /assets/`å®ƒçš„æ„æ€æ˜¯å¦‚æœè¯·æ±‚ url åŒ…å«/assets/å†…å®¹å°±é‡‡ç”¨è¯¥åŒ¹é…è§„åˆ™ã€‚\r\n\r\n#### history nginx é…ç½®\r\n\r\n```nginx\r\nworker_processes 1;\r\n\r\nevents {\r\n  worker_connections 1024;\r\n}\r\n\r\nhttp {\r\n  include mime.types;\r\n  default_type application/octet-stream;\r\n  sendfile on;\r\n  keepalive_timeout 65;\r\n\r\n  gzip on;\r\n  gzip_types text/plain application/x-javascript text/css application/xml text/javascript application/javascript image/jpeg image/gif image/png;\r\n  gzip_vary on;\r\n\r\n  root /app/dist;\r\n\r\n  server {\r\n    listen 80;\r\n    server_name static.zp.cn;\r\n\r\n    location / {\r\n      try_files $uri /index.html;\r\n      index index.html index.htm;\r\n    }\r\n    location ^~ /assets/ {\r\n      add_header Cache-Control \"public,max-age=31536000\";\r\n      # Allow cross origin access\r\n      add_header Access-Control-Expose-Headers \"Access-Control-Allow-Origin\";\r\n      add_header Access-Control-Allow-Origin \"*\";\r\n    }\r\n\r\n  }\r\n}\r\n```\r\n\r\nå¯¹æ¯”ä¹‹ä¸‹ history æ¨¡å¼åˆ™å¤šäº†ä¸€ä¸ª try_filesã€‚\r\n\r\ntry_files çš„ä½œç”¨æ˜¯æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨è¿”å›è¯¥æ–‡ä»¶ï¼Œå¦åˆ™è¿”å›åç½®æ–‡ä»¶ã€‚\r\n\r\nä¸¾ä¸ªä¾‹å­ è®¿é—® static.zp.cn/a çš„æ—¶å€™$uri ä¸º/aï¼Œæ­¤æ—¶æŒ‰ç…§é¡ºåºä¼šæ£€æŸ¥å¦‚ä¸‹æ–‡ä»¶\r\n\r\n- æ£€æŸ¥ /$root/a æ–‡ä»¶æ˜¯å¦å­˜åœ¨\r\n- æ£€æŸ¥ /$root/a/ ç›®å½•æ˜¯å¦å­˜åœ¨\r\n- éƒ½ä¸å­˜åœ¨è¿”å› index.html å†…å®¹\r\n\r\n> ä¸ºäº†æ¼”ç¤ºæ–¹ä¾¿æ²¡æœ‰åŒ…å«æ¥å£è¯·æ±‚ï¼Œç”Ÿäº§ç¯å¢ƒä¸­ä¸€èˆ¬ä¼šå‡ºç° proxy_pass æŒ‡å®šã€‚\r\n\r\n# æœ€å\r\n\r\nåˆ°æ­¤åˆ†äº«å°±ç»“æŸäº†ï¼Œä¸‹é¢æ˜¯ä¸€äº›å·¥å…·é“¾æ¥ï¼Œå¦‚æœæœ‰éœ€è¦å¯ä»¥æ”¶è—ã€‚\r\n\r\nå¦‚æœæ–‡ç« æœ‰é”™è¯¯çš„åœ°æ–¹ä¹Ÿæ¬¢è¿æŒ‡å‡ºã€‚\r\n\r\n- [NGINX é…ç½®ç”Ÿæˆ](https://www.digitalocean.com/community/tools/nginx?global.app.lang=zhCN)\r\n- [æ­£åˆ™å¯è§†åŒ–å·¥å…·](https://regexper.com/#)\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/93/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/93/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/69",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/69/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/69/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/69/events",
          "html_url": "https://github.com/bosens-China/blog/issues/69",
          "id": 911281718,
          "node_id": "MDU6SXNzdWU5MTEyODE3MTg=",
          "number": 69,
          "title": "Webpack æ’ä»¶å…¥é—¨",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1740577858,
              "node_id": "MDU6TGFiZWwxNzQwNTc3ODU4",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3",
              "name": "å·¥å…·ç›¸å…³",
              "color": "f73d62",
              "default": false,
              "description": "å·¥ç¨‹åŒ–ç›¸å…³çš„ä¸œè¥¿"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2021-06-04T08:53:06Z",
          "updated_at": "2021-12-21T10:04:02Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "# webpack æ’ä»¶å…¥é—¨\r\n\r\n![bg](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/69547c8c2fe9429faf29c425de792cb3~tplv-k3u1fbpfcp-zoom-1.image)\r\n\r\næœ€è¿‘å†™äº†ä¸€ä¸ªç§»åŠ¨ç«¯é¡¹ç›®ï¼Œä¸è¿‡æ¯æ¬¡ build çš„æ—¶å€™è¿˜éœ€è¦æ‰‹åŠ¨ä¸Šä¼ æœåŠ¡å™¨æ„Ÿè§‰å¾ˆä¸æ–¹ä¾¿ï¼Œæ¯•ç«Ÿæ¯æ¬¡åˆ é™¤æ–‡ä»¶å¤¹ç„¶åæ‹–æ‹½ä¸Šä¼ çš„è¿‡ç¨‹å¤ªé‡å¤äº†ï¼Œæœ¬ç€ä¸é‡å¤é€ è½®å­çš„åŸåˆ™å» Github ç¿»äº†ä¸€ä¸‹ï¼Œå‘ç° `Upload`ä¸Šä¼ æ’ä»¶è¿˜æ˜¯è›®å¤šçš„ï¼Œä¸è¿‡è·ç¦»è‡ªå·±çš„è¦æ±‚è¿˜æ˜¯æœ‰äº›å·®å¼‚ï¼Œå¾ˆå¤šæ’ä»¶åªæ˜¯åªæ˜¯å•ä¸€èŒè´£ï¼Œåªè´Ÿè´£ä¸Šä¼ è¿™ä»¶äº‹æƒ…ã€‚\r\n\r\nè€Œå¦‚æœåªè´Ÿè´£ä¸Šä¼ æ–‡ä»¶ä¸åšåˆ é™¤ä¼šå¯¼è‡´æœåŠ¡å™¨æ–‡ä»¶è¶Šæ¥è¶Šå¤šï¼Œå ç”¨é¢å¤–çš„å‚¨å­˜æˆæœ¬ï¼ŒWebPack åœ¨ build è¿‡ç¨‹ä¸­ä¼šæ£€æµ‹ç›¸å…³ä¾èµ–æ˜¯å¦å˜æ›´ï¼Œå¦‚æœå˜æ›´ç›¸å…³æ–‡ä»¶çš„ `hash` ä¹Ÿæ˜¯å‘ç”Ÿå˜æ›´ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´æ–°çš„æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œè€Œæ—§èµ„æºå´ä¸ä¼šè¢«è¦†ç›–æ›¿æ¢æ‰ã€‚\r\n\r\n## åŸºæœ¬æ¦‚å¿µ\r\n\r\nWebPack çš„æ’ä»¶æ˜¯åŸºäº `Tapable` å®ç°çš„ï¼Œå®ƒæ˜¯ä¸€ç§å‘å¸ƒè®¢é˜…çš„å®ç°ï¼Œä½œç”¨å°±æ˜¯å°†æ’ä»¶çš„å„ä¸ªç”Ÿå‘½å‘¨æœŸé’©å­å¹¿æ’­å‡ºå»ï¼Œç„¶ååœ¨åˆé€‚çš„æ—¶æœºæ‰§è¡Œã€‚åŒæ—¶åªè®©æ’ä»¶å…³æ³¨è‡ªèº«çš„è®¢é˜…ï¼Œä¿è¯æ’ä»¶ç»„åˆèµ·æ¥æœ‰åºè¿›è¡Œã€‚\r\n\r\n`Tapable`æš´éœ²äº†ä¸‰ä¸ªæ–¹æ³•ï¼š\r\n\r\n- tapï¼š å¯ä»¥æ³¨å†ŒåŒæ­¥é’©å­å’Œå¼‚æ­¥é’©å­\r\n- tapAsyncï¼š å›è°ƒå½¢å¼æ³¨å†Œå¼‚æ­¥é’©å­\r\n- tapPromiseï¼š Promise å½¢å¼æ³¨å†Œå¼‚æ­¥é’©å­\r\n\r\nåœ¨ç¼–å†™æ’ä»¶æ—¶ WebPack æ˜¾ç¤ºè¦æ±‚æˆ‘ä»¬æœ‰ `apply` æ–¹æ³•ï¼Œè¿™æ ·åšçš„åŸå› æ˜¯ WebPack æ‰§è¡ŒæœŸé—´ä¼šæ‰§è¡Œ apply æ–¹æ³•ï¼Œå¹¶ä¸”æ³¨å…¥`compiler`ï¼Œä¹‹ååœ¨`compiler`ä¸Šè®¢é˜…é’©å­äº‹ä»¶ï¼Œåœ¨åˆé€‚æ—¶é—´è§¦å‘å·²è®¢é˜…çš„ apply æ–¹æ³•\r\n\r\nå†çœ‹ä¸€ä¸‹å®˜æ–¹ç»™å‡ºçš„ç¤ºä¾‹ä»£ç \r\n\r\n```js\r\n// A JavaScript class.\r\nclass MyExampleWebpackPlugin {\r\n  // Define `apply` as its prototype method which is supplied with compiler as its argument\r\n  apply(compiler) {\r\n    // Specify the event hook to attach to\r\n    compiler.hooks.emit.tapAsync('MyExampleWebpackPlugin', (compilation, callback) => {\r\n      console.log('This is an example plugin!');\r\n      console.log(\r\n        'Hereâ€™s the `compilation` object which represents a single build of assets:',\r\n        compilation\r\n      );\r\n\r\n      // Manipulate the build using the plugin API provided by webpack\r\n      compilation.addModule(/* ... */);\r\n\r\n      callback();\r\n    });\r\n  }\r\n}\r\n```\r\n\r\nä¸Šé¢æ’ä»¶åœ¨`compiler`ä¸­è®¢é˜…äº† `emit` çš„å¼‚æ­¥é’©å­ï¼Œç„¶ååšäº†ä¸€äº›æ“ä½œä¹‹åï¼Œæ‰§è¡Œ `callback()` å›è°ƒ\r\n\r\n> è¿™é‡Œç¨å¾®è¯´ä¸‹ï¼Œå¯¹äº `tapAsync` çš„é’©å­ï¼Œ`callback` å¿…é¡»æ‰§è¡Œï¼Œå¦åˆ™ç¨‹åºä¼šä¸€è‡´åœ¨ç­‰å¾…ï¼Œè€Œ callback å·¦ä¾§çš„ `compilation` æ˜¯ç”¨æ¥è®¿é—®è¿™ä¸€æ¬¡çš„èµ„æºæ„å»ºä¿¡æ¯ï¼Œä¾‹å¦‚ä¸€äº›è¾“å‡ºçš„èµ„æºï¼Œç›¸äº’ä¾èµ–çš„å…³ç³»ç­‰ã€‚\r\n\r\näº†è§£äº†ä¸Šé¢çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬æ‰¾ä¸€ä¸‹ [compiler é’©å­ ](https://webpack.docschina.org/api/compiler-hooks/)æœ‰æ²¡æœ‰æˆ‘ä»¬éœ€è¦çš„ï¼Œæ–‡æ¡£ä¸­åˆ—ä¸¾çš„é’©å­å¾ˆå¤šï¼š\r\n\r\n- environment\r\n- afterEnvironment\r\n- entryOption\r\n- ...\r\n\r\nç¿»åˆ°æœ€åä¼šçœ‹åˆ°ä¸€ä¸ª `done` çš„é’©å­ï¼Œå®ƒåœ¨ `compilation` å®Œæˆæ—¶æ‰§è¡Œã€‚\r\n\r\nè¿™é‡Œæˆ‘ä»¬éœ€è¦çš„å‰ç½®åŸºæœ¬å‡†å¤‡é½å…¨äº†ï¼Œä¸‹é¢è¦åšçš„å°±æ˜¯åœ¨ `done` è§¦å‘æ—¶\r\n\r\n- è¿æ¥ ssh æœåŠ¡å™¨ï¼Œæ‰§è¡Œ`rm-rf xx`çš„æ“ä½œ\r\n- ä¸Šä¼  build åçš„èµ„æºåˆ° xx ç›®å½•ä¸‹\r\n\r\n## æ’ä»¶å¼€å‘å‡†å¤‡\r\n\r\n> ä¹‹åçš„å†…å®¹é‡‡ç”¨ `TypeScript` ä½œä¸ºå¼€å‘ï¼Œå¦‚æœä½ æ²¡æœ‰ç›¸å…³ç»éªŒç›´æ¥è·³è¿‡ç±»å‹æ³¨é‡Šå³å¯\r\n\r\nä¸ºäº†æ–¹ä¾¿è§£è€¦å’Œå¤ç”¨æ–‡ä»¶ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª utils.ts æ–‡ä»¶\r\n\r\n```ts\r\n// utils.ts\r\nimport { NodeSSH } from 'node-ssh';\r\n\r\nimport { Option } from './typings';\r\n\r\nexport const isObject = (obj: any): obj is Object => typeof obj === 'object' && obj;\r\n\r\n// åˆ é™¤æ–‡ä»¶å¤¹\r\nexport const removeDir = async (option: Option) => {\r\n  const ssh = new NodeSSH();\r\n  await ssh.connect(option);\r\n  await ssh.execCommand(`rm -rf ${option.to}`);\r\n  await ssh.dispose();\r\n};\r\n\r\n// ä¸Šä¼ æ–‡ä»¶å¤¹\r\nexport const uploadDir = async (option: Option) => {\r\n  const ssh = new NodeSSH();\r\n  await ssh.connect(option);\r\n  await ssh.putDirectory(option.src!, option.to, {\r\n    recursive: true,\r\n  });\r\n  await ssh.dispose();\r\n};\r\n```\r\n\r\nå®ƒæš´éœ²ä¸‰ä¸ªæ–¹æ³•ï¼Œåˆ é™¤æ–‡ä»¶å¤¹å’Œä¸Šä¼ æ–‡ä»¶å¤¹è¿˜æœ‰ä¸€ä¸ªåˆ¤æ–­ object çš„æ–¹æ³•ï¼Œä¸Šé¢çš„åˆ é™¤å’Œä¸Šä¼ æ–‡ä»¶å¤¹åŸºäº [node-ssh](https://github.com/steelbrain/node-ssh) å°è£…è€Œæ¥ï¼Œå¦‚æœä½ æœ‰å…´è¶£äº†è§£å¯ä»¥å»é˜…è¯»ä¸€ä¸‹æ–‡æ¡£\r\n\r\n## æ’ä»¶å¼€å‘\r\n\r\nå‰©ä¸‹çš„æ’ä»¶å¼€å‘ï¼Œå°±æ˜¯è·å–ç”¨æˆ·å¡«å†™ä¸€äº›å¿…è¦å­—æ®µï¼Œä¾‹å¦‚å¯†ç ã€ä¸Šä¼ çš„æœåŠ¡å™¨è·¯å¾„ã€host ç­‰ä¿¡æ¯ï¼Œç»“åˆä¸Šé¢çš„ `utils` å’Œé’©å­ï¼Œå®Œæˆè¿™ä¸ªä¸Šä¼ è¿‡ç¨‹\r\n\r\n```ts\r\n// upload-plugin.ts\r\nimport { Compiler, Stats } from 'webpack';\r\nimport { isObject, uploadDir, removeDir } from './utils';\r\nimport { Option } from './typings';\r\n\r\nclass UploadPlugin {\r\n  public stats: Stats;\r\n\r\n  public option: Option & Record<string, any>;\r\n\r\n  public removeDir: boolean;\r\n\r\n  constructor(option: Option, remove = true) {\r\n    this.stats = null as unknown as Stats;\r\n    this.option = option;\r\n    this.removeDir = remove;\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    this.checkOption();\r\n    this.setOption();\r\n  }\r\n\r\n  // æ£€éªŒå‚æ•°\r\n  checkOption(option = this.option) {\r\n    if (!isObject(option)) {\r\n      throw new Error('option Must be an object!');\r\n    }\r\n    const result = ['to', 'host'].filter((f) => !option[f]);\r\n    if (result.length) {\r\n      throw new Error(`The ${result.join(',')} parameter is required!`);\r\n    }\r\n    if (!option.password && !option.privateKey) {\r\n      throw new Error('password and privateKey must have one entry!');\r\n    }\r\n  }\r\n\r\n  // åˆå§‹åŒ–é»˜è®¤å€¼\r\n  setOption() {\r\n    const option = {\r\n      port: 22,\r\n      username: 'root',\r\n    };\r\n    this.option = {\r\n      ...option,\r\n      ...this.option,\r\n    };\r\n  }\r\n\r\n  apply(compiler: Compiler) {\r\n    compiler.hooks.done.tap('upload-plugin', async (stats) => {\r\n      console.time('time');\r\n      // è·å–é»˜è®¤çš„ä¿¡æ¯ï¼Œå¦‚æœsrcä¸å­˜åœ¨ç›´æ¥ä½¿ç”¨webpackçš„é…ç½®\r\n      const src = stats.compilation.outputOptions.path;\r\n      this.option.src = this.option.src ?? src;\r\n      if (this.removeDir) {\r\n        await removeDir(this.option);\r\n      }\r\n      await uploadDir(this.option);\r\n      console.timeEnd('time');\r\n    });\r\n  }\r\n}\r\n\r\nexport default UploadPlugin;\r\n```\r\n\r\næ•´ä½“ä»£ç è¿˜æ˜¯å¾ˆç®€æ´çš„ï¼Œå»é™¤å‚æ•°æ ¡éªŒéƒ¨åˆ†è¿˜æœ‰èµ‹å€¼é»˜è®¤å€¼å‚æ•°ï¼Œå‰©ä¸‹çš„å°±æ˜¯æ ¹æ®å‚æ•°æ¥æ˜¯å¦åˆ é™¤è¿œç¨‹æ–‡ä»¶å¤¹ï¼Œä¹‹åæ‰§è¡Œä¸Šä¼ æ–¹æ³•ã€‚\r\n\r\nä½ å¯èƒ½å¾ˆå¥½å¥‡ `Option` çš„å®šä¹‰æ˜¯å•¥ï¼Œè¿™ä¸ªæ˜¯ç»“åˆ `node-ssh` çš„è¿æ¥ä¿¡æ¯åŠ ä¸Šè‡ªå®šä¹‰æ‰©å±•çš„ä¸€äº›å­—æ®µè€Œæ¥çš„\r\n\r\n```ts\r\n// typings.d.ts\r\nexport interface Option {\r\n  src?: string;\r\n  to: string;\r\n  port?: number;\r\n  host: string;\r\n  username?: string;\r\n  password?: string;\r\n  privateKey?: string;\r\n}\r\n```\r\n\r\n## æœ€å\r\n\r\nå®Œæ•´ä»£ç å·²ç»ä¸Šä¼ äº†[Github ä»“åº“](https://github.com/bosens-China/upload-plugin)ï¼Œå¦‚æœä½ æœ‰å…´è¶£å¯ä»¥å…·ä½“çœ‹ä¸‹æ›´å…·ä½“çš„ä¸€äº›ä¿¡æ¯ï¼Œå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ä¹Ÿæ¬¢è¿ `star`ã€‚\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/69/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/69/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/49",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/49/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/49/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/49/events",
          "html_url": "https://github.com/bosens-China/blog/issues/49",
          "id": 548743305,
          "node_id": "MDU6SXNzdWU1NDg3NDMzMDU=",
          "number": 49,
          "title": "GitHubActionsæ„å»ºå®šæ—¶ä»»åŠ¡",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1740577858,
              "node_id": "MDU6TGFiZWwxNzQwNTc3ODU4",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3",
              "name": "å·¥å…·ç›¸å…³",
              "color": "f73d62",
              "default": false,
              "description": "å·¥ç¨‹åŒ–ç›¸å…³çš„ä¸œè¥¿"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2020-01-13T07:07:52Z",
          "updated_at": "2021-12-21T09:53:13Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "å†™è¿™ç¯‡æ–‡ç« æ˜¯æ— æ„ä¹‹é—´çœ‹åˆ°é˜®ä¸€å³°è€å¸ˆå‘å¸ƒçš„[GitHub Actions å…¥é—¨æ•™ç¨‹](http://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html)é‡Œé¢ä»‹ç»äº† GitHub Actions çš„ä¸€äº›æ¦‚å¿µï¼Œç¢°å·§æˆ‘ä¹‹å‰ç”¨çˆ¬è™« + vuePress æ„ä»¶äº†ä¸€ä¸ª[typescript çš„ä¸­æ–‡æ‰‹å†Œ](https://bosens-china.github.io/Typescript-manual/)ï¼Œä¸‹é¢å°±ä»¥æ¯å¤©å®šæ—¶æ„å»ºè¿™ä¸ªåº”ç”¨ä¸ºèƒŒæ™¯ä»‹ç»å¦‚ä½•ä½¿ç”¨ GitHub Actions å®Œæˆä¸‹é¢å·¥ä½œã€‚\r\n\r\nä¸‹é¢å†…å®¹ä¸»è¦ä»¥å®è·µä¸ºä¸»ã€‚\r\n\r\n## æ€è·¯\r\n\r\n1. ç¼–å†™ bash ä¸Šä¼ è„šæœ¬\r\n2. æ‰§è¡Œçˆ¬è™«å‘½ä»¤æ„å»ºåº”ç”¨ï¼›\r\n3. å®šæ—¶æ‰§è¡Œè„šæœ¬ï¼Œå®Œæˆä¸Šä¼ \r\n4. å‡ºç°é”™è¯¯å‘é€é‚®ä»¶é€šçŸ¥æˆ‘ï¼›\r\n\r\n### deploy.sh\r\n\r\n```sh\r\n#!/usr/bin/env sh\r\n\r\n# ç¡®ä¿è„šæœ¬æŠ›å‡ºé‡åˆ°çš„é”™è¯¯\r\nset -e\r\n# ä¸‹é¢æ˜¯è„šæœ¬å‘½ä»¤ï¼Œæ ¹æ®ä½ çš„éœ€æ±‚æ¥é€‰å–ã€‚\r\nnpm run xxxx\r\n# è¿›å…¥ç”Ÿæˆçš„æ–‡ä»¶å¤¹\r\ncd docs/.vuepress/dist\r\ngit init\r\ngit add -A\r\ngit commit -m 'deploy'\r\n# å¼ºåˆ¶æ¨é€åˆ°æŒ‡å®šåˆ†æ”¯\r\ngit push -f git@github.com:bosens-China/Typescript-manual.git master:gh-pages\r\ncd -\r\n```\r\n\r\nè„šæœ¬æ‰§è¡Œçš„åŠŸèƒ½å¾ˆç®€å•ï¼Œæ‰§è¡Œæ„å»ºå‘½ä»¤ï¼Œä¹‹åè¿›å…¥æ„å»ºçš„æ–‡ä»¶å¤¹åˆ›å»º git ä»“åº“ä¹‹åæ¨é€ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„ä¸€ç‚¹çš„å°±æ˜¯æˆ‘ä»¬ä¼šå°†ä»»åŠ¡æ”¾ç½®åœ¨`GitHub Actions`ä¸Šï¼Œ**è€Œ git æ¨é€æ˜¯éœ€è¦æƒé™çš„**ï¼Œä¸‹é¢å°±æ¥è§£å†³å’Œè¿™ä¸ªé—®é¢˜ã€‚\r\n\r\n###  ssh-keygen\r\n\r\nè¿è¡Œ\r\n\r\n```sh\r\nssh-keygen\r\n```\r\n\r\nåˆ›å»º`id_rsa`å’Œ`id_rsa.pub`ä¸¤ä¸ªæ–‡ä»¶ï¼Œåˆ†åˆ«å¯¹åº”ç§é’¥æ–‡ä»¶å’Œå…¬é’¥æ–‡ä»¶ã€‚\r\n\r\nä¹‹åå°†`id_rsa.pub`ä¸­çš„å…¬é’¥æ·»åŠ åˆ° Github å¯¹åº”ä»“åº“çš„ Deploye keys ä¸­\r\n![xx](https://user-gold-cdn.xitu.io/2020/1/13/16f9deb5aa175f0f?w=800&h=439&f=png&s=121430)\r\nå†å°†`id_rsa`çš„ç§é’¥æ–‡ä»¶æ·»åŠ åˆ° Github å¯¹åº”ä»“åº“çš„ Secrets ä¸­ï¼Œè¿™é‡Œå°†åç§°å®šä¹‰ä¸º`ACTION_DEPLOY_KEY`ï¼Œä½ å¯ä»¥è‡ªè¡Œå®šä¹‰ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†è®©è™šæ‹Ÿæœºæ‹¥æœ‰ git ä»“åº“çš„æƒé™\r\n![xx](https://user-gold-cdn.xitu.io/2020/1/13/16f9deb52f7e5467?w=800&h=389&f=png&s=121131)\r\n\r\nOKï¼Œåˆ°è¿™ä¸€æ­¥æˆ‘ä»¬å¾—å‡†å¤‡å·¥ä½œå°±åŸºæœ¬ä¸Šå®Œæˆäº†ï¼Œä¸‹é¢å°±æ˜¯å¯¹ yml é…ç½®æ–‡ä»¶çš„ç¼–å†™äº†ã€‚\r\n\r\n### deploy.yml\r\n\r\næˆ‘ä»¬åœ¨æ ¹ç›®å½•æ–°å»ºä¸€ä¸ª`.github`çš„æ–‡ä»¶å¤¹åœ¨æ–‡ä»¶å¤¹å†…æ–°å»ºä¸€ä¸ªæ–‡ä»¶`deploy.yml`\r\n\r\n```sh\r\n# è§¦å‘çš„äº‹ä»¶\r\non:\r\n  push:\r\n    branches:\r\n      - master\r\n# å®šæ—¶ä»»åŠ¡åœ¨utcçš„9ç‚¹æ‰§è¡Œï¼Œæ¢ç®—åŒ—äº¬æ—¶é—´éœ€è¦ + 8ä¹Ÿå°±æ˜¯å‡Œæ™¨äº”ç‚¹\r\n  schedule:\r\n    - cron: \"0 21 * * *\"\r\n\r\njobs:\r\n  build:\r\n    runs-on: ubuntu-18.04\r\n\r\n    strategy:\r\n      matrix:\r\n        node-version: [12.x]\r\n\r\n    steps:\r\n      - uses: actions/checkout@v1\r\n      - name: Use Node.js ${{ matrix.node-version }}\r\n        uses: actions/setup-node@v1\r\n        with:\r\n          node-version: ${{ matrix.node-version }}\r\n      - name: git Actions\r\n        uses: srt32/git-actions@v0.0.3\r\n      - name: Setup\r\n        env:\r\n          ACTION_DEPLOY_KEY: ${{ secrets.ACTION_DEPLOY_KEY }}\r\n        run: |\r\n          mkdir -p ~/.ssh/\r\n          echo \"$ACTION_DEPLOY_KEY\" > ~/.ssh/id_rsa\r\n          chmod 600 ~/.ssh/id_rsa\r\n          ssh-keyscan github.com >> ~/.ssh/known_hosts\r\n          git config --global user.email \"ä½ çš„é‚®ç®±\"\r\n          git config --global user.name \"ä½ çš„åå­—\"\r\n          npm install\r\n          npm run updata\r\n```\r\n\r\nç®€å•è¯´ä¸‹ä¸Šé¢è„šæœ¬å¹²äº†ä»€ä¹ˆäº‹æƒ…ã€‚\r\n\r\n1. æ‹‰å–æºç ï¼ˆactions/checkout@v1ï¼‰\r\n2. å®‰è£… node å’Œ gitï¼ˆactions/setup-node@v1 å’Œ srt32/git-actions@v0.0.3ï¼‰\r\n3. å°†æˆ‘ä»¬çš„ç§åŒ™æ”¾ç½®åœ¨.ssh ç›®å½•ä¸‹ï¼ˆSetupï¼‰\r\n4. æ‰§è¡Œ`deploy.sh`è„šæœ¬ï¼Œä¸Šè¿°çš„æœ€åæŒ‡å®šçš„ npm run updata å€¼å°±æ˜¯`bash deploy.sh`\r\n\r\nåœ¨ä¸Šé¢æˆ‘æŒ‡å®šäº† on å®ƒæ˜¯è§¦å‘çš„äº‹ä»¶ï¼Œæˆ‘åœ¨è¿™é‡ŒæŒ‡å®šäº†æ¯å¤©å®šæ—¶å’Œ`master`åˆ†æ”¯æäº¤çš„æ—¶å€™æ‰§è¡Œè¿™æ®µè„šæœ¬ï¼›\r\n\r\n`jobs`åˆ™æ˜¯åŠ¨ä½œï¼ŒåŠ¨ä½œå¯ä»¥æœ‰å¾ˆå¤š build å°±æ˜¯ä¸€ä¸ªåŠ¨ä½œï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„ä¸€ç‚¹**runs-on: ubuntu-18.04**çš„å€¼æ˜¯æŒ‡å®šè™šæ‹Ÿæœºè¿™ä¸ªå­—æ®µæ˜¯å¿…å¡«çš„ï¼Œä¸å»ºè®®ä½¿ç”¨`windows`è™šæ‹Ÿæœºã€‚\r\n\r\nè‡³äºä¸Šé¢çš„`uses`å­—æ®µï¼Œè¿™ä¸ªæ˜¯å®˜æ–¹æä¾›çš„æ¨¡å—ï¼Œä½ å¯ä»¥è¿™æ ·ç†è§£ï¼Œå®ƒå¯ä»¥æ–¹ä¾¿æˆ‘ä»¬çš„æ“ä½œï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå·±ç¼–å†™è„šæœ¬ä¹‹åä¸Šä¼ åˆ° github çš„å¸‚åœºä¸Šï¼Œæ›´å¤šçš„å†…å®¹æˆ‘æ¨èåˆ°[å®˜æ–¹æ–‡æ¡£ä¸ŠæŸ¥é˜…](https://github.com/features/actions)\r\n\r\n### æ‰§è¡Œé”™è¯¯é‚®ä»¶é€šçŸ¥\r\n\r\nå› ä¸ºä¸Šé¢è¯´è¿™ä¸ªæ˜¯çˆ¬è™«çš„åº”ç”¨ï¼Œä¸ºäº†çŸ¥é“é”™è¯¯æˆ‘éœ€è¦é‚®ä»¶åŠæ—¶é€šçŸ¥æˆ‘ï¼Œè¿™é‡Œå°±ä½¿ç”¨ç¬¬ä¸‰æ–¹`nodemailer`çš„æ¨¡å—ä¸ºä¾‹ã€‚\r\n\r\n```js\r\nfunction sendMail(e) {\r\n  const mailTransport = nodemailer.createTransport({\r\n    host: \"smtp.qq.com\",\r\n    secureConnection: true,\r\n    auth: {\r\n      user: \"xxx@qq.com\",\r\n      pass: \"vbwjzecplhehibed\"\r\n    }\r\n  });\r\n  const options = {\r\n    from: \"xxxx@qq.com\",\r\n    to: \"xxx@qq.com\",\r\n    subject: \"typescript-bookå‡ºç°é”™è¯¯\",\r\n    text: e instanceof Error ? e.message : e\r\n  };\r\n  mailTransport.sendMail(options);\r\n}\r\n```\r\n\r\nç¨å¾®æ³¨æ„ä¸€ä¸‹`auth`å­—æ®µï¼Œæœ‰ä¸€ä¸ª pass è¿™ä¸ªæœ¬æ¥æ˜¯å¯†ç ä¸è¿‡å¦‚æœç›´æ¥æŠŠå¯†ç æš´éœ²å‡ºæ¥å¯èƒ½ä¼šé€ æˆä¸å®‰å…¨ï¼Œæ‰€ä»¥ä¹Ÿæ”¯æŒæˆæƒç ï¼Œå¦‚æœä½ æƒ³äº†è§£æ›´å¤šå¯ä»¥[ä»€ä¹ˆæ˜¯æˆæƒç ï¼Œå®ƒåˆæ˜¯å¦‚ä½•è®¾ç½®ï¼Ÿ](https://link.jianshu.com/?t=http%3A%2F%2Fservice.mail.qq.com%2Fcgi-bin%2Fhelp%3Fsubtype%3D1%26%26no%3D1001256%26%26id%3D28)ç‚¹å‡»äº†è§£ã€‚\r\n\r\næœ€åä½ éœ€è¦ä¸ºé‚®ç®±å¼€é€š`SMTPæœåŠ¡`ï¼Œqq é‚®ç®±ç›´æ¥ç‚¹å¼€è®¾ç½®æŸ¥æ‰¾å°±è¡Œäº†ï¼Œå…¶ä»–é‚®ç®±ä¹Ÿç±»ä¼¼ã€‚\r\nä¹‹åå†è°ƒç”¨è¿™ä¸ªå‡½æ•°å°± OK äº†ã€‚\r\n\r\n### æŸ¥çœ‹æ•ˆæœ\r\n\r\nä¸Šé¢å†™å®Œåæˆ‘ä»¬çš„å®šæ—¶å‘å¸ƒè„šæœ¬å°±å®Œæˆäº†ï¼Œå‰©ä¸‹çš„å°±æ˜¯æäº¤ä»£ç è§¦å‘é’©å­æ¥æ‰§è¡Œæˆ‘ä»¬çš„ä»»åŠ¡ï¼Œè¿™é‡Œæˆ‘ push`master`åˆ†æ”¯ä»£ç ï¼Œæ‰“å¼€ actions\r\n![xx](https://user-gold-cdn.xitu.io/2020/1/13/16f9ded560ff8454?w=1920&h=937&f=png&s=62950)\r\n\r\nå³ä¾§å°±æ˜¯æˆ‘ä»¬è„šæœ¬çš„æ‰§è¡Œæ¬¡æ•°å’ŒçŠ¶æ€äº†ï¼Œâˆš è¡¨ç¤ºæˆåŠŸï¼Œä½ å¯ä»¥è¯¦ç»†ç‚¹å¼€æŸ¥çœ‹æ›´å¤šçš„ç»†èŠ‚ï¼Œä¾‹å¦‚ä¸‹é¢çš„é”™è¯¯ï¼Œä½ å¯ä»¥å±•å¼€æŸ¥çœ‹æŠ¥é”™çš„åŸå› æ˜¯ä»€ä¹ˆï¼Œæ–¹ä¾¿å¯¹é”™è¯¯å®šä½å’Œè°ƒè¯•ï¼Œè¿™é‡Œä¸åšå±•å¼€äº†ã€‚\r\n\r\n## æœ€å\r\n\r\nè¿™ç¯‡æ–‡ç« å†™å®Œå‘ç°æ›´å¤šæ˜¯åˆ†äº«æˆ‘æ€ä¹ˆå®Œæˆçš„ï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œå¦‚æœå–œæ¬¢è¯·ç»™ä¸€ä¸‹ Star\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/49/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/49/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/7",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/7/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/7/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/7/events",
          "html_url": "https://github.com/bosens-China/blog/issues/7",
          "id": 479646858,
          "node_id": "MDU6SXNzdWU0Nzk2NDY4NTg=",
          "number": 7,
          "title": "ä½¿ç”¨rollupç¼–å†™ç°ä»£åŒ–æ¨¡å—",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1740577858,
              "node_id": "MDU6TGFiZWwxNzQwNTc3ODU4",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%B7%A5%E5%85%B7%E7%9B%B8%E5%85%B3",
              "name": "å·¥å…·ç›¸å…³",
              "color": "f73d62",
              "default": false,
              "description": "å·¥ç¨‹åŒ–ç›¸å…³çš„ä¸œè¥¿"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2019-08-12T13:30:02Z",
          "updated_at": "2021-12-21T09:34:35Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "> ä¹‹æ‰€æœ‰é€‰ç”¨ rollup æ˜¯å› ä¸ºå®ƒå¯ä»¥å‡å°‘æ‰“åŒ…ä½“ç§¯å’Œæé«˜æ„å»ºé€Ÿåº¦ï¼Œä¸‹é¢ä»‹ç»ä¸ä¼šè¯¦ç»†è®²è§£é…ç½®ï¼Œä½ å¯ä»¥è‡ªè¡ŒæŸ¥é˜…å®˜æ–¹æ–‡æ¡£\r\n\r\nES6 å·²ç»å‡ºç°å¾ˆä¹…äº†ï¼Œä½†æ˜¯ä¸ºäº†å…¼å®¹ä»¥å‰çš„æµè§ˆå™¨ï¼Œæˆ‘ä»¬è¿˜æ˜¯éœ€è¦ä½¿ç”¨å„ç§æ„å»ºå·¥å…·ï¼Œä¾‹å¦‚ webpackï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™å¾ˆæ–¹ä¾¿ï¼Œå¯ä»¥é€šè¿‡ babel è½¬æ¢ es6 çš„è¯­æ³•ï¼Œæ¯”å¦‚ä¸‹é¢å¯¼å…¥ä¸€ä¸ªæ¨¡å—\r\n\r\n`import moduleName from 'module';`\r\n\r\nä¸è¿‡ç¼–å†™ä¸€ä¸ªç°ä»£åŒ–æ¨¡å—å‘¢ï¼Œé¢„å®šç›®æ ‡åº”è¯¥æœ‰ä¸‰ç‚¹\r\n\r\n1.  æ”¯æŒ typescriptï¼Œå°† ES6 ä»£ç è½¬åŒ–ä¸º ES5 ç¯å¢ƒä½¿ç”¨\r\n2.  æ”¯æŒæ„å»ºå·¥å…·å’Œ`script type=\"module\"`çš„å¯¼å…¥\r\n3.  æ”¯æŒ umd æ ¼å¼å¼•ç”¨\r\n\r\nå°±ä»¥ä¸‹é¢è¿™æ®µä»£ç ä¸ºæ¼”ç¤ºï¼Œå®ç°ä¸Šè¿°çš„ç›®æ ‡\r\n\r\n```js\r\nexport default (arr = []) => {\r\n  return Array.from(arr).length;\r\n};\r\n```\r\n\r\n## å‡†å¤‡\r\n\r\n```sh\r\nnpm init -y\r\nnpm i rollup -D\r\ncd.>rollup.config.js\r\nmd src\r\ncd.>src/index.js\r\n```\r\n\r\nè¿™æ ·å°±åˆ›å»ºå¥½æˆ‘ä»¬æƒ³è¦çš„åŸºæœ¬ç»“æ„äº†ï¼Œå°†ä¸Šé¢ä¾‹å­å¤åˆ¶åˆ° `index.js` æ–‡ä»¶ä¸‹ã€‚\r\n\r\n`rollup`å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œä¹Ÿå¯ä»¥é€šè¿‡è„šæœ¬æ¥è°ƒç”¨ï¼Œè¿™é‡Œåœ¨`package.json`çš„`scripts`å­—æ®µï¼Œé€šè¿‡è„šæœ¬è°ƒç”¨\r\n\r\n```json\r\n  \"scripts\": {\r\n    \"build\": \"rollup -c\"\r\n  }\r\n```\r\n\r\n`-c`æ˜¯æŒ‡é…ç½®æ–‡ä»¶ï¼Œé»˜è®¤å°±æ˜¯`rollup.config.js`æ‰€ä»¥ä¸éœ€è¦é¢å¤–é…ç½®äº†\r\n\r\n## ç¼–å†™ç¬¬ä¸€ä¸ªä¾‹å­\r\n\r\nrollup.config.js\r\n\r\n```js\r\nexport default {\r\n  input: \"./src/index.js\",\r\n  output: [\r\n    {\r\n      file: \"dist/index.esm.browser.js\",\r\n      format: \"es\",\r\n      sourcemap: true\r\n    }\r\n  ]\r\n};\r\n```\r\n\r\nä¸Šé¢é…ç½®ä¿¡æ¯`input`æŒ‡çš„æ˜¯å…¥å£æ–‡ä»¶ï¼Œ`output` æ˜¯å‡ºå£æ–‡ä»¶ï¼Œ`file`æ˜¯è¾“å‡ºçš„æ–‡ä»¶è·¯å¾„ï¼Œ`sourcemap`æ˜¯æ˜¯å¦è¾“å‡º map æ–‡ä»¶ï¼Œä»–å¯ä»¥æ–¹ä¾¿è°ƒè¯•é”™è¯¯ï¼Œåœ¨å¼€å‘æ¨¡å—ä¸­åº”è¯¥æ˜¯å¿…é¡»çš„ï¼Œ`format`æ˜¯æŒ‡è¾“å‡ºçš„æ ¼å¼\r\n\r\n- amd\r\n  å¼‚æ­¥æ¨¡å—å®šä¹‰ï¼Œç”¨äºåƒ RequireJS è¿™æ ·çš„æ¨¡å—åŠ è½½å™¨\r\n- cjs\r\n  CommonJSï¼Œé€‚ç”¨äº Node å’Œ Browserify/Webpack\r\n- es\r\n  å°†è½¯ä»¶åŒ…ä¿å­˜ä¸º ES æ¨¡å—æ–‡ä»¶\r\n- iife\r\n  ä¸€ä¸ªè‡ªåŠ¨æ‰§è¡Œçš„åŠŸèƒ½ï¼Œé€‚åˆä½œä¸º<\\script>æ ‡ç­¾ã€‚ï¼ˆå¦‚æœè¦ä¸ºåº”ç”¨ç¨‹åºåˆ›å»ºä¸€ä¸ªæ†ç»‘åŒ…ï¼Œæ‚¨å¯èƒ½æƒ³è¦ä½¿ç”¨å®ƒï¼Œå› ä¸ºå®ƒä¼šä½¿æ–‡ä»¶å¤§å°å˜å°ã€‚ï¼‰\r\n- umd\r\n  é€šç”¨æ¨¡å—å®šä¹‰ï¼Œä»¥ amdï¼Œcjs å’Œ iife ä¸ºä¸€ä½“\r\n\r\næ‰§è¡Œ`npm run build`\r\n\r\ndist/index.esm.browser.js\r\n\r\n```js\r\nvar index = (arr = []) => {\r\n  return Array.from(arr).length;\r\n};\r\n\r\nexport default index;\r\n//# sourceMappingURL=index.esm.browser.js.map\r\n```\r\n\r\nå¯ä»¥çœ‹åˆ°ç”Ÿæˆçš„ä¿¡æ¯ååˆ†ç®€æ´ï¼Œä¸Šé¢è¯´åˆ°è¦åŒæ—¶æ”¯æŒ`umd` æ ¼å¼å’Œ `import` å¯¼å…¥ï¼Œ`import`å¯ä»¥é€šè¿‡`es`çš„å½¢å¼æ¥ä¾›æ„å»ºå·¥å…·å’Œ`script type=\"module\"`ä½¿ç”¨ï¼Œä¸‹é¢å°±æ¥å®šä¹‰ä¸€ä¸‹ umd æ ¼å¼\r\n\r\n```js\r\nexport default {\r\n  input: \"./src/index.js\",\r\n  output: [\r\n    {\r\n      file: \"dist/index.esm.browser.js\",\r\n      format: \"es\",\r\n      sourcemap: true\r\n    },\r\n    {\r\n      file: \"dist/index.js\",\r\n      format: \"umd\",\r\n      sourcemap: true,\r\n      name: \"index\"\r\n    }\r\n  ]\r\n};\r\n```\r\n\r\n**æ³¨æ„**ä½¿ç”¨`umd`æˆ–è€…`iife`å¿…é¡»æŒ‡å®š name å­—æ®µï¼Œä»–å†³å®šäº†æš´éœ²åœ¨å…¨å±€ä½œç”¨ä¸‹çš„å˜é‡åï¼Œå†æ¬¡æ‰§è¡Œå¯ä»¥çœ‹åˆ°`index.js`çš„ä¿¡æ¯äº†ã€‚\r\n\r\n## babel\r\n\r\nä¸Šé¢å®Œæˆäº†éœ€æ±‚çš„ç¬¬ä¸€æ­¥ï¼Œä¸è¿‡å¯¹äº es6 çš„ä»£ç ï¼Œå¹¶æ²¡æœ‰è½¬åŒ–ä¸º es5 çš„å½¢å¼ï¼Œåªæ˜¯å°†è¯­æ³•è½¬æ¢äº†ï¼Œ`Array.from`ä¾æ—§å­˜åœ¨ï¼Œä¸‹é¢ä½¿ç”¨`babel`æ¥å®Œæˆéœ€æ±‚\r\n\r\n```sh\r\nnpm i @babel/core @babel/preset-env  core-js rollup-plugin-babel rollup-plugin-node-resolve rollup-plugin-commonjs -D\r\n```\r\n\r\nbabel.config.js\r\n\r\n```js\r\nmodule.exports = {\r\n  presets: [\r\n    [\r\n      \"@babel/preset-env\",\r\n      {\r\n        useBuiltIns: \"usage\",\r\n        corejs: 3,\r\n        modules: false\r\n      }\r\n    ]\r\n  ]\r\n};\r\n```\r\n\r\nä¸Šé¢ä»£ç çš„`useBuiltIns`çš„`usage`æ˜¯ babel7 çš„å®éªŒæ€§ç‰¹æ€§ï¼Œä»–æ”¯æŒæŒ‰éœ€åŠ è½½\r\n\r\nrollup.config.js\r\n\r\n```js\r\nimport babel from \"rollup-plugin-babel\";\r\nimport resolve from \"rollup-plugin-node-resolve\";\r\nimport commonjs from \"rollup-plugin-commonjs\";\r\nexport default {\r\n  input: \"./src/index.js\",\r\n  output: [\r\n    {\r\n      file: \"dist/index.esm.browser.js\",\r\n      format: \"es\",\r\n      sourcemap: true\r\n    },\r\n    {\r\n      file: \"dist/index.js\",\r\n      format: \"umd\",\r\n      sourcemap: true,\r\n      name: \"index\"\r\n    }\r\n  ],\r\n  plugins: [\r\n    commonjs(),\r\n    resolve(),\r\n    babel({\r\n      exclude: [/\\/core-js\\//],\r\n      runtimeHelpers: true,\r\n      sourceMap: true,\r\n      extensions: [\".js\", \".jsx\", \".es6\", \".es\", \".mjs\", \".ts\"]\r\n    })\r\n  ]\r\n};\r\n```\r\n\r\nå†æ¬¡æ‰§è¡Œå¯ä»¥çœ‹åˆ°`Arrar.from`å·²ç»è¢«`babel`è½¬æ¢ä¸º ES5 çš„ç¯å¢ƒäº†\r\n\r\n## typescript\r\n\r\nè¿™ä¸ªæˆ‘ä»¬ç”¨`babel`æä¾›ç»™æˆ‘ä»¬çš„`@babel/preset-typescript`å³å¯å®Œæˆï¼Œä¸è¿‡ä¸ºäº†æ”¯æŒ`typescript`ä¸€äº›å…¶ä»–æ‰©å±•è¯­æ³•ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å®‰è£…ä¸€äº›æ’ä»¶\r\n\r\n```sh\r\nnpm i @babel/preset-typescript @babel/plugin-transform-typescript @babel/plugin-syntax-dynamic-import @babel/plugin-proposal-class-properties -D\r\n```\r\n\r\nbabel.config.js\r\n\r\n```js\r\nmodule.exports = {\r\n  presets: [\r\n    [\r\n      \"@babel/preset-env\",\r\n      {\r\n        useBuiltIns: \"usage\",\r\n        corejs: 3,\r\n        modules: false\r\n      }\r\n    ],\r\n    [\"@babel/preset-typescript\"]\r\n  ],\r\n  plugins: [\r\n    \"@babel/plugin-transform-typescript\",\r\n    \"@babel/plugin-syntax-dynamic-import\",\r\n    \"@babel/plugin-proposal-class-properties\"\r\n  ]\r\n};\r\n```\r\n\r\nä¿®æ”¹ä¸€ä¸‹ `src/index.js` ä¸º `index.ts`ï¼Œ`rollup.config.js` ä¸‹`input`å­—æ®µ\r\n\r\n```js\r\nexport default (arr: Array<any> = []): number => {\r\n  return Array.from(arr).length;\r\n};\r\n```\r\n\r\nå†æ¬¡æ‰§è¡Œ`npm run build`ï¼ŒæˆåŠŸè¾“å‡º\r\n\r\n## ä¼˜åŒ–\r\n\r\n1. è¾“å‡ºä»£ç æ²¡æœ‰è¢«å‹ç¼©\r\n2. æ¯æ¬¡è¾“å‡ºçš„æ—¶å€™æ–‡ä»¶å¤¹æ²¡æœ‰è¢«åˆ é™¤\r\n\r\nä¸Šé¢ä¸¤ä¸ªé—®é¢˜ï¼Œå¯ä»¥é€šè¿‡æ’ä»¶æ¥è§£å†³\r\n\r\n```sh\r\nnpm i rollup-plugin-terser rollup-plugin-clear -D\r\n```\r\n\r\nrollup.config.js\r\n\r\n```js\r\nimport babel from \"rollup-plugin-babel\";\r\nimport clear from \"rollup-plugin-clear\";\r\nimport resolve from \"rollup-plugin-node-resolve\";\r\nimport commonjs from \"rollup-plugin-commonjs\";\r\nimport { terser } from \"rollup-plugin-terser\";\r\nexport default {\r\n  input: \"./src/index.ts\",\r\n  output: [\r\n    {\r\n      file: \"dist/index.esm.browser.js\",\r\n      format: \"es\",\r\n      sourcemap: true\r\n    },\r\n    {\r\n      file: \"dist/index.js\",\r\n      format: \"umd\",\r\n      sourcemap: true,\r\n      name: \"index\"\r\n    }\r\n  ],\r\n  plugins: [\r\n    clear({\r\n      targets: [\"dist\"]\r\n    }),\r\n    resolve(),\r\n    commonjs(),\r\n    terser(),\r\n    babel({\r\n      exclude: [/\\/core-js\\//],\r\n      runtimeHelpers: true,\r\n      sourceMap: true,\r\n      extensions: [\".js\", \".jsx\", \".es6\", \".es\", \".mjs\", \".ts\"]\r\n    })\r\n  ]\r\n};\r\n```\r\nè¿™æ ·åŸºæœ¬çš„æ¨¡å—çš„åŸºæœ¬åŠŸèƒ½å°±ç¼–å†™å®Œæˆäº†",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/7/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/7/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        }
      ]
    ],
    [
      "1371686611",
      [
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/94",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/94/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/94/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/94/events",
          "html_url": "https://github.com/bosens-China/blog/issues/94",
          "id": 1361066184,
          "node_id": "I_kwDOCzPAy85RIDjI",
          "number": 94,
          "title": "TypeScript ç±»å‹æ”¶çª„",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1371686611,
              "node_id": "MDU6TGFiZWwxMzcxNjg2NjEx",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%85%B6%E4%BB%96",
              "name": "å…¶ä»–",
              "color": "f6ecbf",
              "default": false,
              "description": "æœªæ‰¾åˆ°åˆ†ç±»ï¼Œæš‚å®šçš„æ–‡ç« "
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2022-09-04T07:17:35Z",
          "updated_at": "2022-09-04T07:17:35Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "![image-20220904141910530](https://user-images.githubusercontent.com/39508895/188302110-a54f0cf4-ec09-4b1b-bcf0-2caf181351da.png)\r\n\r\n\r\nå†™è¿™ç¯‡æ–‡ç« æ˜¯å› ä¸ºæœ€è¿‘åœ¨å†™ä¸€ä¸ª[ç®¡ç†å¼‚æ­¥é˜Ÿåˆ—çš„åº“](https://github.com/bosens-China/async-queue)ï¼Œä½†æ˜¯æœ‰ä¸€äº›ç±»å‹æ¨å¯¼ä¸å¤ªå¥½å†™ï¼Œä¾‹å¦‚ä¸Šé¢çš„æœŸå¾…æ˜¯\r\n\r\n```js\r\nif (values.stauts === 'error') {\r\n  // values.data to Error\r\n}\r\n```\r\n\r\nåé¢æŸ¥è¯¢äº†ä¸€äº›æ–‡æ¡£å’Œèµ„æ–™å°±æœ‰äº†è¿™ç¯‡æ–‡ç« ã€‚\r\n\r\n## æ”¶çª„æ–¹å¼\r\n\r\nåœ¨å…·ä½“è®²è§£ä¸Šé¢å¦‚ä½•å®ç°ä¹‹å‰ï¼Œå…ˆä»‹ç»ä¸€ä¸‹å‡ ç§æ”¶çª„å¯¹è±¡çš„æ–¹å¼ã€‚\r\n\r\n### typeof ç±»å‹å®ˆå«\r\n\r\n```js\r\nfunction padLeft(padding: number | string, input: string): string {\r\n  throw new Error('Not implemented yet!');\r\n}\r\n```\r\n\r\nå¦‚æœåœ¨ padLeft å‡½æ•°å†…è°ƒç”¨ä¸æ˜¯ stirng å’Œ number ç›¸åŒçš„æ–¹æ³•ï¼Œä¾‹å¦‚ toStringã€valueOf ä¼šæç¤ºæ–¹æ³•ä¸å­˜åœ¨ã€‚\r\n\r\nä¹‹æ‰€ä»¥å‡ºç°è¿™æ ·é—®é¢˜æ˜¯å› ä¸º Typescript å¹¶ä¸çŸ¥é“ padding åˆ°åº•æ˜¯ number è¿˜æ˜¯ stringï¼Œä½†æ˜¯ä½ å¯ä»¥é€šè¿‡ typeof çš„æ˜¾å¼å‘Šè¯‰å®ƒçš„ç±»å‹ã€‚\r\n\r\n```js\r\nfunction padLeft(padding: number | string, input: string): string {\r\n  if (typeof padding === 'string') {\r\n    return padding.charAt(0);\r\n  }\r\n  // æ’é™¤äº†stringï¼Œå‰©ä¸‹å°±æ˜¯number\r\n  return padding.toFixed(2);\r\n}\r\n```\r\n\r\n### æ¡ä»¶è¯­å¥\r\n\r\nåœ¨ä½¿ç”¨æ¡ä»¶è¯­å¥ï¼Œä¾‹å¦‚ `if`ã€`&&`ã€`||` ã€`!` ç­‰æ¡ä»¶è¯­å¥çš„æ—¶å€™ä¹Ÿä¼šç¼©å°ç±»å‹ã€‚\r\n\r\nçœ‹ä¸€ä¸ªä¾‹å­\r\n\r\n```js\r\nfunction printAll(strs: string | string[] | null) {\r\n  //\r\n}\r\n```\r\n\r\næŒ‰ç…§ä¸Šé¢ typeof è¯­å¥å¾ˆè‡ªç„¶å°±æƒ³åˆ°åˆ¤æ–­æ˜¯ä¸æ˜¯ object æ¥å®Œæˆæ•°ç»„åŒºåˆ†\r\n\r\n```js\r\nfunction printAll(strs: string | string[] | null) {\r\n  if (typeof strs === 'object') {\r\n    strs.forEach((item) => {});\r\n    // Object is possibly 'null'.\r\n    //'item' is declared but its value is never read.\r\n  }\r\n}\r\n```\r\n\r\nä¸è¿‡å†™åˆ°ä¸€åŠå°±ä¼šå‘ç°æç¤ºæŠ¥é”™äº†ï¼Œstrs åœ¨ object çš„åˆ¤æ–­ä¸‹ä¾ç„¶å¯èƒ½ä¸º nullï¼Œå›å¿†ä¸€ä¸‹ typeof çš„è¿ç®—ç¬¦å¯ä»¥å¾—çŸ¥è¿™ä¸ªæ˜¯æ­£å¸¸ç°è±¡ï¼Œnull çš„ typeof è¿”å›å€¼ä¹Ÿæ˜¯ objectï¼Œè¿™ä¸ªæ˜¯ JavaScript è¯­è¨€è®¾è®¡çš„ä¸€ä¸ªç¼ºé™·ã€‚\r\n\r\nä¸è¿‡è¦æ€ä¹ˆæ¶ˆé™¤è¿™ä¸ªå½±å“å‘¢ï¼Ÿè¿™å°±ç”¨åˆ°è¿™æ¡ä»¶è¯­å¥ï¼Œå¯ä»¥é€šè¿‡åˆ¤æ–­ strs æ˜¯å¦å­˜åœ¨æ˜¾å¼æ’é™¤ null çš„å­˜åœ¨\r\n\r\n```js\r\nfunction printAll(strs: string | string[] | null) {\r\n  if (typeof strs === 'object' && strs) {\r\n    // object\r\n    return strs;\r\n    // è¿™é‡Œstrsç±»å‹å·²ç»è¢«æ’é™¤objectäº†\r\n  } else if (typeof strs === 'string') {\r\n    return strs;\r\n  }\r\n  // null\r\n  return strs;\r\n}\r\n```\r\n\r\n### ç›¸ç­‰è¿ç®—ç¬¦å’Œ switch æ”¶çª„\r\n\r\nè¿˜å¯ä»¥ä½¿ç”¨ `===`ã€`==`ã€`!=`ã€`!==` è¿ç®—ç¬¦æ¥å®Œæˆæ”¶çª„\r\n\r\n```js\r\ninterface Container {\r\n  value: number | null | undefined;\r\n}\r\n\r\nfunction multiplyValue(container: Container, factor: number) {}\r\n```\r\n\r\nä¾‹å¦‚ä¸Šé¢ï¼Œå¦‚æœæƒ³è®© container æ’é™¤ null å’Œ undefined å°±å¯ä»¥ä½¿ç”¨ `===` æ¥å®Œæˆï¼Œä¸‹é¢æ˜¯ç¤ºä¾‹\r\n\r\n```js\r\ninterface Container {\r\n  value: number | null | undefined;\r\n}\r\n\r\nfunction multiplyValue(container: Container, factor: number) {\r\n  if (container.value === undefined) {\r\n    return 0;\r\n  }\r\n  if (container.value === null) {\r\n    return 1;\r\n  }\r\n  return container.value === factor;\r\n}\r\n```\r\n\r\né€šè¿‡ === å®Œæˆäº† undefined å’Œ null çš„æ”¶çª„è¿‡ç¨‹ï¼Œè¿™é‡Œé¡ºä¾¿è¯´ä¸‹å…¶å®ä¸Šé¢çš„å†™æ³•å¯ä»¥ç®€å†™æˆ `==` ï¼Œ== åœ¨åˆ¤æ–­ undefined è·Ÿ null ä¹‹é—´æ—¶è¿”å› trueã€‚\r\n\r\n```js\r\ninterface Container {\r\n  value: number | null | undefined;\r\n}\r\n\r\nfunction multiplyValue(container: Container, factor: number) {\r\n  if (container.value == undefined) {\r\n    return 0;\r\n  }\r\n\r\n  return container.value === factor;\r\n}\r\n```\r\n\r\n### in è¿ç®—ç¬¦\r\n\r\nin è¿ç®—ç¬¦ç”¨äºåˆ¤æ–­ä¸€ä¸ªå±æ€§æ˜¯å¦å­˜åœ¨å¯¹è±¡ä¸Šï¼Œåœ¨ TypeScript åŒæ ·å¯ä»¥ä½¿ç”¨ in æ¥å®Œæˆæ”¶çª„ã€‚\r\n\r\n```js\r\ntype Fish = { swim: () => void };\r\ntype Bird = { fly: () => void };\r\n\r\nfunction move(animal: Fish | Bird) {\r\n  if ('swim' in animal) {\r\n    return animal.swim();\r\n  }\r\n\r\n  return animal.fly();\r\n}\r\n```\r\n\r\nä¸Šé¢ move é€šè¿‡æŒ‡å®š `swim in animal` å‘Šè¯‰ TypeScriptï¼Œåœ¨ if ä¸­ç±»å‹å°±æ˜¯ Fishï¼Œå› ä¸º Bird ä¸­ä¸å­˜åœ¨è¿™ä¸ªå±æ€§ã€‚\r\n\r\n> ä½¿ç”¨ in è¿ç®—ç¬¦æ”¶çª„æ—¶ï¼Œä½¿ç”¨å…¶ä»–è”åˆç±»å‹ä¸å­˜åœ¨çš„å±æ€§æ¥å®Œæˆå¯¹æŸä¸€ç±»å‹çš„æ”¶çª„\r\n\r\n### instanceof\r\n\r\nä¸ JavaScript ä¸­ä¸€æ ·ï¼Œinstanceof ä¹Ÿå¯ä»¥åˆ¤æ–­æŸä¸ªå±æ€§æ˜¯å¦åŒ¹é…å¯¹è±¡ã€‚\r\n\r\n```js\r\nfunction logValue(x: Date | string) {\r\n  if (x instanceof Date) {\r\n    console.log(x.toUTCString());\r\n  } else {\r\n    console.log(x.toUpperCase());\r\n  }\r\n}\r\n```\r\n\r\n### èµ‹å€¼\r\n\r\nè¿™é‡Œç›´æ¥çœ‹ä¾‹å­\r\n\r\n```js\r\nlet x = Math.random() < 0.5 ? 10 : 'hello world!';\r\n// let x: string | number\r\nx = 1;\r\n\r\nconsole.log(x);\r\n// let x: number\r\nx = 'goodbye!';\r\n\r\nconsole.log(x);\r\n// let x: string\r\n```\r\n\r\nä¸è¿‡æ³¨æ„ï¼Œåˆ†é…ç»™ä¸Šé¢çš„ x ä¸€å®šè¦ç¬¦åˆ x æœ€åˆçš„è”åˆç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¯´ç»™å®š boolean ä¼šæŠ¥é”™ã€‚\r\n\r\n### ç±»å‹è°“è¯\r\n\r\nåœ¨ä½¿ç”¨ lodash ç±»å‹çš„å‡½æ•°åº“ï¼Œé€šå¸¸éƒ½ä¼šæœ‰ isObjectï¼Œä½ å¯èƒ½å¾ˆå¥½å¥‡æ€ä¹ˆå®ç°ã€‚\r\n\r\nå…¶å®å®ƒä»¬å°±æ˜¯ä½¿ç”¨äº†ç±»å‹è°“è¯ï¼Œä¸‹é¢åŠ¨æ‰‹å®ç°ä¸€ä¸ª isObject\r\n\r\n```js\r\nfunction isObject (value:any) : value is object {\r\n    return value && typeof value === 'object'\r\n}\r\n```\r\n\r\nä¹‹ååœ¨é…åˆä½¿ç”¨å°±å¯ä»¥å®Œæˆç±»å‹æ”¶çª„\r\n\r\n```js\r\nfunction test(pet: object | null) {\r\n  if (isObject(pet)) {\r\n    return pet;\r\n  } else {\r\n    return {};\r\n  }\r\n}\r\n```\r\n\r\n### interface æ”¶çª„\r\n\r\nä¸Šé¢å°†æ”¶çª„çš„æ–¹å¼åˆ—ä¸¾äº†ä¸€ç•ªï¼Œä¸‹é¢å°±çœ‹ä¸‹åœ¨ interface ä¸­å¦‚ä½•å®ç°æ”¶çª„ï¼Œæœ€å¼€å§‹å·²ç»è¯´äº†ï¼Œæˆ‘ä»¬æœŸå¾…ä½¿ç”¨ if æ¡ä»¶è¯­å¥å¯ä»¥é€šè¿‡ status çš„ä¸åŒæ¥å®Œæˆ data çš„å˜åŒ–ã€‚\r\n\r\nåœ¨ TypeScript æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è”åˆç±»å‹å°†ä¸¤è€…é€šç”¨éƒ¨åˆ†åŒºåˆ†\r\n\r\n```js\r\nexport interface ChangeError {\r\n  status: 'error';\r\n  data: Error;\r\n}\r\n\r\nexport interface ChangeData<T> {\r\n  status: 'success';\r\n  data: T;\r\n}\r\n```\r\n\r\nä¹‹åæ‹¼æ¥ä¸€èµ·\r\n\r\n```js\r\nexport type Change<T = any> = {\r\n  index: number,\r\n  progress: number,\r\n  total: number,\r\n} & (ChangeError | ChangeData<T>);\r\n```\r\n\r\nä¹‹åé€šè¿‡ TypeScript çš„æ¡ä»¶æ”¶çª„å°±è‡ªåŠ¨å®Œæˆè¿™ä¸€è¿‡ç¨‹ã€‚\r\n\r\n### æ”¶çª„ç±»å‹çš„å®ç”¨ç¤ºä¾‹\r\n\r\næ”¶çª„ + never ç»“åˆå¯ä»¥å®Œæˆä¸€ä¸ªè”åˆç±»å‹æ·»åŠ æ–°å¯¹è±¡ä¸å¤„ç†æŠ¥é”™ã€‚\r\n\r\n```js\r\ninterface A {\r\n  name: 'a';\r\n}\r\ninterface B {\r\n  name: 'b';\r\n}\r\n\r\ntype Types = A | B;\r\n\r\nfunction check(values: Types) {\r\n  switch (values.name) {\r\n    case 'a':\r\n      return '';\r\n    case 'b':\r\n      return '';\r\n    default:\r\n      const _never: never = values;\r\n      return _never;\r\n  }\r\n}\r\n```\r\n\r\nnever è¡¨ç¤ºæ°¸è¿œä¸ºç©ºçš„ç±»å‹ï¼Œç»“åˆ switch å¯ä»¥å°†å¯¹è±¡ç±»å‹æ”¶çª„å°½ï¼Œè¿™æ—¶å¯¹è±¡çš„ç±»å‹å°±æ˜¯ neverã€‚\r\n\r\nç°åœ¨å¦‚æœç»™ Types æ·»åŠ æ–°çš„è”åˆç±»å‹ default å°±ä¼šæŠ›å‡ºé”™è¯¯\r\n\r\n```js\r\ninterface A {\r\n  name: 'a';\r\n}\r\ninterface B {\r\n  name: 'b';\r\n}\r\n\r\ntype Types = A | B | { name: 'c' };\r\n\r\nfunction check(values: Types) {\r\n  switch (values.name) {\r\n    case 'a':\r\n      return '';\r\n    case 'b':\r\n      return '';\r\n    default:\r\n      const _never: never = values;\r\n      return _never;\r\n  }\r\n}\r\n```\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/94/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/94/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        }
      ]
    ],
    [
      "3661376441",
      [
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/92",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/92/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/92/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/92/events",
          "html_url": "https://github.com/bosens-China/blog/issues/92",
          "id": 1187971933,
          "node_id": "I_kwDOCzPAy85GzwNd",
          "number": 92,
          "title": ".gitattributes æ­£ç¡®ä½¿ç”¨å§¿åŠ¿",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 3661376441,
              "node_id": "LA_kwDOCzPAy87aPCu5",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83",
              "name": "ä»£ç è§„èŒƒ",
              "color": "5319e7",
              "default": false,
              "description": "å›¢é˜Ÿè§„èŒƒã€ä»£ç è§„èŒƒã€æŠ€æœ¯é€‰å‹ç­‰ç›¸å…³å†…å®¹"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2022-03-31T12:00:40Z",
          "updated_at": "2022-04-16T03:28:38Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "è¿™ç¯‡æ–‡ç« çš„ç”±æ¥æ˜¯å› ä¸ºé¡¹ç›®ä¸Šçš„ä¸€ä¸ªç¥å¥‡é—®é¢˜ï¼Œä¹‹å‰è§‰å¾—å†™é‡å¤çš„åˆ›å»ºé¡¹ç›®å¤ªç¹çå°±å°è£…äº†ä¸€ä¸ª[åˆ›å»ºæ¨¡æ¿æ–‡ä»¶ CLI](https://github.com/bosens-China/template-create) ï¼Œå½“æ—¶å¿ƒæƒ³è‡ªå·±çœŸæ˜¯ä¸€ä¸ªä¸Šè¿›çš„å°ä¼™å­ã€‚\r\n\r\nåæ¥æŸå¤© xx é¢†å¯¼å¯¹æˆ‘è¯´æœ‰ä¸€ä¸ªæ–°é¡¹ç›®äº¤ç»™æˆ‘åšï¼Œå½“æ—¶å¿ƒæƒ³ç»ˆäºå¯ä»¥å¤§å±•æ‹³è„šè¯•è¯•æ–°çš„å·¥å…·äº†ï¼Œä¸€é¡¿æ“ä½œåé¡¹ç›®å®Œæˆäº†ï¼Œä¸è¿‡åœ¨æ¨é€ GitLab æ—¶å‘ç°å›¾ç‰‡ç«Ÿç„¶æ— æ³•é¢„è§ˆã€‚whyï¼Ÿåé¢æ ¹æ® git log è®°å½•ä¸€ä¸ªä¸ªå›æ»šå’Œä½†æ˜¯è¿™ä¹Ÿæ— æ³•å¤ç° entireï¼Œåé¢åˆå¯¹é¡¹ç›®æ–‡ä»¶å±è”½æ£€æŸ¥ç»ˆäºå‘ç°åŸæ¥æ˜¯ .gitattributes æ–‡ä»¶å¡«å†™é—®é¢˜ã€‚\r\n\r\n> ä¹‹å‰.gitattributes å†™æ³•\r\n>\r\n> ```sh\r\n> * text eol=lf\r\n> ```\r\n\r\né‚£æ˜¯ä¸æ˜¯ç›´æ¥åˆ é™¤ .gitattributes æ–‡ä»¶å°±å¯ä»¥äº†å‘¢ï¼Ÿå¦‚æœåªè€ƒè™‘è§£å†³å›¾ç‰‡æäº¤æ ¼å¼æŸåå½“æ—¶æ˜¯æ²¡é—®é¢˜ã€‚\r\n\r\n## .gitattributes ä½œç”¨\r\n\r\nä¸è¿‡å›åˆ°æ ‡é¢˜ï¼Œå½“æ—¶ä¹‹æ‰€ä»¥åœ¨æ¨¡æ¿æ–‡ä»¶ä¸­æ·»åŠ  .gitattributes ä¸»è¦æ˜¯æœ‰ä¸¤ä¸ªç›®çš„ï¼š\r\n\r\n- ç¡®ä¿æ–‡ä»¶è¡Œå°¾åºåˆ—ç¬¦åˆä¸€è‡´ï¼Œåœ¨ windows ä¸‹è¡Œå°¾åºåˆ—ä¸º CRLF è€Œåœ¨ mac å’Œ linux åˆ™æ˜¯ LFã€‚è¡Œå°¾åºåˆ—ä¸åŒåœ¨æŸäº› Eslint è§„åˆ™ä¸‹ä¼šæ˜¾ç¤ºæŠ¥é”™ï¼Œè¿™æ˜¯ä¸ºäº†è§„èŒƒä½ çš„ä»£ç ã€‚\r\n\r\n![Code File With Prettier Linting Errors - .gitattributes](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/2/11/17033a0f5ed87f6c~tplv-t2oaga2asx-zoom-in-crop-mark:1304:0:0:0.awebp)\r\n\r\n- é¿å… git æäº¤è®°å½•è«åå·®å¼‚ï¼Œä¾‹å¦‚ä»ä»“åº“ä¸‹æ‹‰å–äº†ä¸€ä¸ªé¡¹ç›®ï¼Œæ›´æ”¹äº†ä¸€ä¸ªæŸä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹å‘ç°ä¸å¯¹åˆæ’¤é”€äº†ï¼Œä½†æ˜¯å› ä¸ºç³»ç»Ÿä¸åŒè¡Œå°¾åºåˆ—å·²ç»å‘ç”Ÿäº†å˜æ›´ï¼Œgit ä¼šæ˜¾ç¤ºè¿™ä¸ªæ–‡ä»¶çš„å·®å¼‚ã€‚\r\n\r\n![image-20220410152753128.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4843f675b9cd448eaafa3e944cc5d7ec~tplv-k3u1fbpfcp-watermark.image?)\r\n\r\n> ä»¥ä¸Šæ“ä½œæ˜¯å‡è®¾ä»“åº“çš„æ–‡ä»¶æ˜¯ LF æ ¼å¼ï¼Œä¸”ä½ æ˜¯ windows ç”µè„‘ä¸‹æ“ä½œ\r\n\r\n## å¦‚ä½•ç¼–å†™.gitattributes æ–‡ä»¶\r\n\r\næŒ‰ç…§å¼€å¤´æˆ‘æœ€åˆçš„å†™æ³•è‚¯å®šæ˜¯é”™è¯¯çš„\r\n\r\n```sh\r\n* text eol=lf\r\n```\r\n\r\nè¿™é‡Œä¼šæŠŠä»£ç çš„æ‰€æœ‰æ–‡ä»¶éƒ½ LF åŒ–ï¼Œå¯¹äºæ–‡æœ¬æ–‡ä»¶æ˜¯æ²¡é—®é¢˜çš„ï¼Œä½†æ˜¯å¯¹äºä¸€äº›å›¾ç‰‡æ–‡ä»¶ã€pdf ç­‰äºŒè¿›åˆ¶æ–‡ä»¶å°±ä¼šå¯¼è‡´é¢å¤–çš„é—®é¢˜ã€‚\r\n\r\nè¿™é‡Œå‚è€ƒä¸¤ä¸ªåº“çš„å†™æ³• [v8 .gitattributes](https://github.com/v8/v8/blob/main/.gitattributes)\r\n\r\n```sh\r\n# Automatically normalize line endings (to LF) for all text-based files.\r\n* text=auto eol=lf\r\n# Do not modify line endings for binary files (which are sometimes auto\r\n# detected as text files by git).\r\n*.png binary\r\n# Don't include minified JS in git grep/diff output\r\ntest/mjsunit/asm/sqlite3/*.js -diff\r\n```\r\n\r\nä¸Šé¢ä¼šæŠŠæ‰€æœ‰çš„æ–‡ä»¶éƒ½ LF åŒ–ï¼Œä¸åŒçš„æ˜¯å•ç‹¬ä¸ºéœ€è¦çš„èµ„æºæ·»åŠ äº† binaryï¼Œè€Œç¿»é˜… git å®˜æ–¹ [gitattributes æ–‡æ¡£](https://git-scm.com/docs/gitattributes) å¯ä»¥çœ‹åˆ°\r\n\r\n> å¦‚æœä½ ä¸å¸Œæœ›äº§ç”Ÿæ–‡æœ¬å·®å¼‚ï¼Œä»¥åŠè¡Œå°¾è½¬æ¢åº”ç”¨åˆ°ä»»ä½•äºŒè¿›åˆ¶æ–‡ä»¶ã€‚å¯ä»¥ä½¿ç”¨ç³»ç»Ÿå†…ç½®çš„ binaryï¼Œå®ƒä¼šå–æ¶ˆ text å’Œ diff å±æ€§ã€‚\r\n\r\nè€Œç¬¬ä¸‰è¡Œ `test/mjsunit/asm/sqlite3/*.js -diff` åˆ™æ˜¯è¯´ä¸è¦è·Ÿè¸ª diff å·®å¼‚ã€‚\r\n\r\nå†æ¥çœ‹ä¸€ä¸ª [pdf .gitattributes](https://github.com/mozilla/pdf.js/blob/master/.gitattributes)\r\n\r\n```sh\r\n# Force Unix line endings for most file formats (except binary files)\r\n*.js         text eol=lf\r\n*.jsm        text eol=lf\r\n*.css        text eol=lf\r\n*.html       text eol=lf\r\n*.md         text eol=lf\r\n*.properties text eol=lf\r\n*.yml        text eol=lf\r\n*.json       text eol=lf\r\n*.config     text eol=lf\r\n*.inc        text eol=lf\r\n*.manifest   text eol=lf\r\n*.rdf        text eol=lf\r\n*.jade       text eol=lf\r\n*.coffee     text eol=lf\r\n\r\n# PDF files shall not modify CRLF line endings\r\n*.pdf -crlf\r\n\r\n# Linguist language overrides\r\n*.js linguist-language=JavaScript\r\n*.jsm linguist-language=JavaScript\r\n*.inc linguist-language=XML\r\n```\r\n\r\nå®ƒå°†èµ„æºå‰ç½®åŒ–å¤„ç†ï¼Œéœ€è¦çš„æ–‡ä»¶å…¨éƒ¨ LF å¤„ç†ï¼Œè€Œ `*.pdf -crlf` åˆ™æ˜¯è¯´å¼ºåˆ¶ crlf å¤„ç†ï¼Œä¸‹é¢çš„ `linguist-language` æ˜¯ [Linguist](https://github.com/github/linguist) åº“çš„å±æ€§ï¼Œå®ƒç”¨äºç”Ÿæˆæˆ‘ä»¬å¸¸è§çš„è¯­è¨€åˆ†å¸ƒ\r\n\r\n![image-20220410155340149.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f64c46b840a84381bfcea21d0fe87235~tplv-k3u1fbpfcp-watermark.image?)\r\n\r\nç»¼åˆä¸Šé¢ä¸¤ä¸ªåº“æ¥çœ‹ï¼Œæœ‰ä¸¤ç§ç¼–å†™ .gitattributes çš„æ–¹å¼\r\n\r\n### å‰ç½®åæ·»åŠ \r\n\r\nè¿™å°±æ˜¯ [pdf.js](https://github.com/mozilla/pdf.js) æ‰€é‡‡ç”¨çš„ï¼Œå°†éœ€è¦ç”¨çš„åºåˆ—åŒ–ï¼Œä¾‹å¦‚å¦‚æœä½ æ˜¯ React é¡¹ç›®ï¼Œåªå¯èƒ½åªéœ€è¦è¿™æ ·æŒ‡å®š\r\n\r\n```sh\r\n*.js        text eol=lf\r\n*.jsm       text eol=lf\r\n*.jsx     \ttext eol=lf\r\n*.ts        text eol=lf\r\n*.tsx   \ttext eol=lf\r\n*.json      text eol=lf\r\n*.css       text eol=lf\r\n*.html      text eol=lf\r\n```\r\n\r\nåé¢å¦‚æœè¿˜æœ‰æ–°çš„éœ€è¦è¡Œå°¾åºåˆ—çš„åç¼€å¯ä»¥ç»§ç»­æ·»åŠ \r\n\r\n### å…¨å±€åæ·»åŠ \r\n\r\nè¿™æ˜¯ [V8](https://github.com/v8/v8) çš„åšæ³•ï¼Œå‡å®šæ‰€æœ‰èµ„æºéƒ½æ˜¯æ–‡æœ¬ç›¸å…³ï¼Œå¦‚æœåç»­æœ‰æ–°çš„äºŒè¿›åˆ¶æ–‡ä»¶å†å¯¹ .gitattributes æ–‡ä»¶è¿›è¡Œç¼–è¾‘ã€‚\r\n\r\n```sh\r\n* text eol=lf\r\n# å¦‚æœæœ‰æ–°çš„äºŒè¿›åˆ¶æ–‡ä»¶\r\n* png eol=binary\r\n```\r\n\r\n## è¿ç§»æŒ‡å—\r\n\r\nå¦‚æœä½ çš„é¡¹ç›®å·²ç»å­˜åœ¨å¾ˆä¹…ï¼Œä½†æ˜¯ä¹Ÿæƒ³æ·»åŠ  .gitattributes æ–‡ä»¶æ¥ç»Ÿä¸€è¡Œå°¾åºåˆ—ï¼Œä¸‹é¢å°±ä»‹ç»ä¸€ä¸‹ç›¸å…³æ–¹æ³•ã€‚\r\n\r\n1. æ·»åŠ ç›¸å…³çš„ .gitattributes æ–‡ä»¶åˆ°é¡¹ç›®ï¼ˆè¯¦æƒ…è§å¦‚ä½•ç¼–å†™.gitattributes æ–‡ä»¶\r\n2. è¿è¡Œ `git add .` æ·»åŠ æ‰€æœ‰æ–‡ä»¶\r\n3. è¿è¡Œ `git commit -m \"Saving files before refreshing line endings\"` æ¥ä¿å­˜æœ¬æ¬¡æ›´æ”¹\r\n4. åˆ é™¤æ‰€æœ‰æ–‡ä»¶ï¼Œä¸åŒ…æ‹¬ .git ç›®å½•ï¼Œ`git rm -rf --cached .`\r\n5. è¿è¡Œ `git reset --hard HEAD`ï¼Œæ¢å¤ä¸Šä¸€æ¬¡çš„æäº¤ï¼Œè¿™é‡Œä¼šå¾—åˆ°æ­£ç¡®çš„è¡Œå°¾åºåˆ—\r\n\r\n## å…¼å®¹æŒ‡å—\r\n\r\nå¦‚æœä½ å‘ç° monorepo é¡¹ç›®ä¸­è¿˜æ˜¯æ²¡æœ‰å¾—åˆ°æ­£ç¡®çš„è¡Œå°¾åºåˆ—ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹ä¸‹é¢ [ .gitattributes çš„å†™æ³•](https://gist.github.com/dpalomar/ebc64d6f56cfc25a3e5c20fe7cdfbd4f)\r\n\r\n```sh\r\n* text=auto\r\n\r\n# Force the following filetypes to have unix eols, so Windows does not break them\r\n*.* text eol=lf\r\n\r\n# Windows forced line-endings\r\n/.idea/* text eol=crlf\r\n\r\n#\r\n## These files are binary and should be left untouched\r\n#\r\n\r\n# (binary is a macro for -text -diff)\r\n*.png binary\r\n```\r\n\r\næ·»åŠ äº†å…¼å®¹æ€§çš„å†™æ³•ï¼Œå¼ºåˆ¶åœ¨ window ä¸‹ lf åŒ–\r\n\r\n## æœ€å\r\n\r\nå¦‚æœæ–‡ç« æœ‰ç›¸å…³é”™è¯¯æ¬¢è¿æŒ‡å‡º\r\n\r\n> å‚è€ƒäº†\r\n>\r\n> - [é…ç½® Git å¤„ç†è¡Œç»“æŸç¬¦](https://docs.github.com/cn/get-started/getting-started-with-git/configuring-git-to-handle-line-endings)\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/92/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/92/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/70",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/70/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/70/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/70/events",
          "html_url": "https://github.com/bosens-China/blog/issues/70",
          "id": 913346542,
          "node_id": "MDU6SXNzdWU5MTMzNDY1NDI=",
          "number": 70,
          "title": "å›¢é˜Ÿè§„èŒƒç³»åˆ—ä¹‹ git è§„èŒƒ",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 3661376441,
              "node_id": "LA_kwDOCzPAy87aPCu5",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83",
              "name": "ä»£ç è§„èŒƒ",
              "color": "5319e7",
              "default": false,
              "description": "å›¢é˜Ÿè§„èŒƒã€ä»£ç è§„èŒƒã€æŠ€æœ¯é€‰å‹ç­‰ç›¸å…³å†…å®¹"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2021-06-07T09:37:17Z",
          "updated_at": "2021-12-21T10:03:46Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "æœ€è¿‘ä¸€å‘¨çš„å·¥ä½œé‡å¿ƒå°±æ˜¯åœ¨æ¢³ç†å›¢é˜Ÿè§„èŒƒï¼Œåœ¨å†™çš„è¿‡ç¨‹ä¹ŸæŸ¥ç¼ºè¡¥æ¼äº†ä¸å°‘çŸ¥è¯†ï¼Œå‰”é™¤æ‰å…³äºå…¬å¸åœºæ™¯çš„éƒ¨åˆ†å°±æœ‰äº†è¿™ä¸€ç³»åˆ—çš„æ–‡ç« ï¼Œé¢„è®¡å†™å››éƒ¨åˆ†ï¼š\r\n1. gitè§„èŒƒ\r\n2. [å·¥ç¨‹è§„èŒƒ](https://github.com/bosens-China/blog/issues/71)\r\n3. [ç”¨æˆ·ä½“éªŒè§„èŒƒ](https://github.com/bosens-China/blog/issues/72)\r\n4. [å‘½åè§„èŒƒ](https://github.com/bosens-China/blog/issues/73)\r\n\r\n\r\n# Git è§„èŒƒ\r\n\r\nGit ä½œä¸ºç°åœ¨æœ€æµè¡Œçš„åˆ†å¸ƒå¼ç®¡ç†å·¥å…·ï¼ŒåŸºæœ¬ä¸Šæ˜¯æ¯ä¸ªå›¢é˜Ÿçš„å¿…å¤‡ï¼Œä¸‹é¢å°±ä»åˆ†æ”¯å’Œæäº¤è¿™ä¸¤éƒ¨åˆ†å±•å¼€\r\n\r\n## ä»€ä¹ˆæ˜¯åˆ†æ”¯\r\n\r\nåˆ†æ”¯å°±æ˜¯æŠŠä½ çš„å·¥ä½œä»å¼€å‘ä¸»çº¿ä¸Šåˆ†ç¦»å¼€æ¥ï¼Œä»¥å…å½±å“å¼€å‘ä¸»çº¿ï¼Œå‡è®¾ä½ å‡†å¤‡å¼€å‘ä¸€ä¸ªæ–°åŠŸèƒ½ï¼Œä½†æ˜¯éœ€è¦ä¸¤å‘¨æ‰èƒ½å®Œæˆï¼Œç¬¬ä¸€å‘¨ä½ å†™äº† 50%çš„ä»£ç ï¼Œå¦‚æœç«‹åˆ»æäº¤ï¼Œç”±äºä»£ç è¿˜æ²¡å†™å®Œï¼Œä¸å®Œæ•´çš„ä»£ç åº“ä¼šå¯¼è‡´åˆ«äººä¸èƒ½å¹²æ´»äº†ã€‚å¦‚æœç­‰ä»£ç å…¨éƒ¨å†™å®Œå†ä¸€æ¬¡æäº¤ï¼Œåˆå­˜åœ¨ä¸¢å¤±æ¯å¤©è¿›åº¦çš„å·¨å¤§é£é™©ã€‚\r\n\r\nç°åœ¨æœ‰äº†åˆ†æ”¯ï¼Œå°±ä¸ç”¨æ€•äº†ã€‚ä½ åˆ›å»ºäº†ä¸€ä¸ªå±äºä½ è‡ªå·±çš„åˆ†æ”¯ï¼Œåˆ«äººçœ‹ä¸åˆ°ï¼Œè¿˜ç»§ç»­åœ¨åŸæ¥çš„åˆ†æ”¯ä¸Šæ­£å¸¸å·¥ä½œï¼Œè€Œä½ åœ¨è‡ªå·±çš„åˆ†æ”¯ä¸Šå¹²æ´»ï¼Œæƒ³æäº¤å°±æäº¤ï¼Œç›´åˆ°å¼€å‘å®Œæ¯•åï¼Œå†ä¸€æ¬¡æ€§åˆå¹¶åˆ°åŸæ¥çš„åˆ†æ”¯ä¸Šï¼Œè¿™æ ·ï¼Œæ—¢å®‰å…¨ï¼Œåˆä¸å½±å“åˆ«äººå·¥ä½œã€‚\r\n\r\n![1.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/305ee83c688b49ae859b493fbf7d7218~tplv-k3u1fbpfcp-watermark.image)\r\n\r\n## åˆ†æ”¯å¦‚ä½•å‘½å\r\n\r\nåˆ†æ”¯æŒ‰ç…§ç±»å‹å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç§\r\n\r\n| åˆ†æ”¯åç§°         |       å‘½å        |                                                       è¯´æ˜ |\r\n| ---------------- | :---------------: | ---------------------------------------------------------: |\r\n| ä¸»åˆ†æ”¯           |      master       | ä¸»åˆ†æ”¯ï¼Œæ‰€æœ‰æä¾›ç»™ç”¨æˆ·ä½¿ç”¨çš„æ­£å¼ç‰ˆæœ¬ï¼Œéƒ½åœ¨è¿™ä¸ªä¸»åˆ†æ”¯ä¸Šå‘å¸ƒ |\r\n| å¼€å‘ä¸»åˆ†æ”¯       |      develop      |                         å¼€å‘åˆ†æ”¯ï¼Œæ°¸è¿œæ˜¯åŠŸèƒ½æœ€æ–°æœ€å…¨çš„åˆ†æ”¯ |\r\n| åŠŸèƒ½åˆ†æ”¯         |    feature-\\*     |                         æ–°åŠŸèƒ½åˆ†æ”¯ï¼ŒæŸä¸ªåŠŸèƒ½ç‚¹æ­£åœ¨å¼€å‘é˜¶æ®µ |\r\n| å‘å¸ƒç‰ˆæœ¬         |    release-\\*     |                                       å‘å¸ƒå®šæœŸè¦ä¸Šçº¿çš„åŠŸèƒ½ |\r\n| ä¿®å¤å‘å¸ƒç‰ˆæœ¬åˆ†æ”¯ | bugfix-release-\\* |                                               ä¿®å¤æµ‹è¯• bug |\r\n| ç´§æ€¥ä¿®å¤åˆ†æ”¯     | bugfix-master-\\*  |                                     ç´§æ€¥ä¿®å¤çº¿ä¸Šä»£ç çš„ bug |\r\n\r\n## å¼€å‘æµç¨‹ç¤ºä¾‹\r\n\r\nä¸‹é¢å°±ä»¥ä¸€ä¸ªäº§å“ä»æœ€åˆåˆ°å‘å¸ƒä¸Šçº¿ä¸ºä¾‹å­ï¼Œè®²è§£ git æµç¨‹\r\n\r\n### åˆå§‹åŒ–\r\n\r\nç¬¬ä¸€æ­¥ï¼Œåˆå§‹ä»“åº“çš„ä¿¡æ¯ï¼ŒåŒæ—¶åˆ›å»º`develop`åˆ†æ”¯\r\n\r\n![2.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cf641e319fd14f93a08b9ee748b0706b~tplv-k3u1fbpfcp-watermark.image)\r\n\r\n### å¼€å‘æ–°åŠŸèƒ½\r\n\r\nå¼€å‘äººå‘˜åœ¨`develop`åˆ†æ”¯å¼€å‘æ–°çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬:æ–°ç‰¹æ€§ä¸ Bug ä¿®å¤\r\n\r\n![3.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2656d065a3714906a8a503b318698841~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nå¦‚æœå¹¶è¡Œå¼€å‘å¤šä¸ªéœ€æ±‚ï¼Œå¯ä»¥åˆ›å»º `feature åˆ†æ”¯`ï¼Œå‘½åè§„åˆ™ä¸º`feature-åˆ†æ”¯åˆ›å»ºæ—¥æœŸ-æ–°ç‰¹æ€§å…³é”®å­—`ï¼Œä¾‹å¦‚:`feature-20190919-i18n`\r\n\r\n![4.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dba19d9f51714f7caa6f8e45ebd1e120~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nå¼€å‘å®Œæˆä¹‹åå°† feature åˆ†æ”¯åˆå¹¶åˆ° develop åˆ†æ”¯ï¼Œæœ€ååˆ é™¤ feature åˆ†æ”¯\r\n\r\n> ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ feature\r\n>\r\n> - å¼€å‘ä¸€ä¸ªç‹¬ç«‹çš„æ–°ç‰¹æ€§(å®Œæˆæ—¶ï¼Œéœ€åˆå¹¶åˆ° develop åˆ†æ”¯)\r\n> - æŠ€æœ¯ç ”ç©¶ä¸å°è¯•(è‹¥å¤±è´¥ï¼Œå¯éšæ—¶åˆ é™¤ feature åˆ†æ”¯)\r\n> - æå‰å®ç°ä¸‹ä¸€ä¸ªç‰ˆæœ¬éœ€è¦å¼€å‘çš„ç‰¹æ€§(å¯ä¸åœ¨æœ¬æ¬¡è¿­ä»£ä¸­å‘å¸ƒ)\r\n\r\n### å‡†å¤‡å‘å¸ƒç‰ˆæœ¬\r\n\r\nå¦‚æœ develop åˆ†æ”¯ä¸Šçš„åŠŸå¼€å‘å®Œæ¯•\r\n\r\n1. å»º release åˆ†æ”¯(å‘å¸ƒåˆ†æ”¯)å‘½åè§„åˆ™:release-åˆ†æ”¯åˆ›å»ºæ—¥æœŸ-å¾…å‘å¸ƒç‰ˆæœ¬å·ï¼Œä¾‹å¦‚ï¼š`release-20190919-v1.0.0`\r\n2. å¯¹ release åˆ†æ”¯çš„ç‰ˆæœ¬å·è¿›è¡Œä¿®æ”¹ï¼ˆä¹‹åæäº¤ä¸€æ¬¡ï¼‰\r\n3. é€šçŸ¥æµ‹è¯•äººå‘˜æµ‹è¯•\r\n\r\n![5.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f639127d864f404b9cd12d85cc8e5547~tplv-k3u1fbpfcp-watermark.image)\r\n\r\n### ä¿®å¤é—®é¢˜\r\n\r\nå¼€å‘äººå‘˜åœ¨ release ä¿®å¤é—®é¢˜ï¼Œæ­¤æ—¶ç¦æ­¢å¼€å‘æ–°åŠŸèƒ½ï¼Œåªå¯¹ bug è¿›è¡Œä¿®å¤\r\n\r\n![6.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5566fa0226ee43b78f8daf7d4ed14950~tplv-k3u1fbpfcp-watermark.image)\r\n\r\n### æœ€ç»ˆå‘å¸ƒ\r\n\r\nç»è¿‡æµ‹è¯•æ²¡æœ‰å‘ç°é—®é¢˜ï¼Œæˆ–è€…é—®é¢˜å·²ç»å…¨éƒ¨ä¿®å¤ï¼Œè¿™ä¸ªæ—¶å€™\r\n\r\n1. å°† release åˆ†æ”¯åŒæ—¶åˆå¹¶åˆ° master åˆ†æ”¯ä¸ develop åˆ†æ”¯\r\n\r\n   - é€šçŸ¥æµ‹è¯•ï¼Œè¿›è¡Œä¸»åˆ†æ”¯æµ‹è¯•\r\n   - å¦‚æœæ²¡é—®é¢˜ï¼Œè¿›è¡Œä¸‹ä¸€æ­¥ï¼Œå¦‚æœæœ‰é—®é¢˜å›åˆ° release\r\n\r\n1. åˆ é™¤ release åˆ†æ”¯\r\n1. æ„å»ºåº”ç”¨åˆ°æœåŠ¡å™¨\r\n\r\n![7.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ad87a01a2eb845a99dfc4ff489e6b4e9~tplv-k3u1fbpfcp-watermark.image)\r\n\r\n## commit è§„èŒƒ\r\n\r\nç›®å‰å¼€æºç¤¾åŒºä¸»è¦åº”ç”¨æ˜¯è§„èŒƒæ˜¯[Angular Git Commit Guidelines](https://github.com/angular/angular.js/blob/master/DEVELOPERS.md#-git-commit-guidelines)\r\n\r\nå®ƒç”±ä¸‹é¢å‡ éƒ¨åˆ†ç»„æˆ:\r\n\r\n```sh\r\n<type>: <subject>\r\n<BLANK LINE>\r\n<body>\r\n<BLANK LINE>\r\n<footer>\r\n```\r\n\r\n### type\r\n\r\næœ¬æ¬¡ commit çš„ç±»å‹ï¼Œè¯¸å¦‚ bugfixã€docsã€style ç­‰\r\n\r\nå®Œæ•´çš„ç±»å‹å¦‚ä¸‹ï¼š\r\n\r\n| åç§°     |                        æè¿°                        |\r\n| -------- | :------------------------------------------------: |\r\n| feat     |                     æ·»åŠ æ–°ç‰¹æ€§                     |\r\n| fix      |                      ä¿®å¤ bug                      |\r\n| docs     |                   ä»…ä»…ä¿®æ”¹äº†æ–‡æ¡£                   |\r\n| style    | ä»…ä»…ä¿®æ”¹äº†ç©ºæ ¼ã€æ ¼å¼ç¼©è¿›ã€éƒ½å¥½ç­‰ç­‰ï¼Œä¸æ”¹å˜ä»£ç é€»è¾‘ |\r\n| refactor |         ä»£ç é‡æ„ï¼Œæ²¡æœ‰åŠ æ–°åŠŸèƒ½æˆ–è€…ä¿®å¤ bug         |\r\n| perf     |                å¢åŠ ä»£ç è¿›è¡Œæ€§èƒ½æµ‹è¯•                |\r\n| test     |                    å¢åŠ æµ‹è¯•ç”¨ä¾‹                    |\r\n| chore    |        æ”¹å˜æ„å»ºæµç¨‹ã€æˆ–è€…å¢åŠ ä¾èµ–åº“ã€å·¥å…·ç­‰        |\r\n\r\n### scope\r\n\r\næœ¬æ¬¡ commit æ³¢åŠçš„èŒƒå›´\r\n\r\n### subject\r\n\r\nç®€æ˜æ‰¼è¦çš„é˜è¿°ä¸‹æœ¬æ¬¡ commit çš„ä¸»æ—¨\r\n\r\næœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š\r\n\r\n1. é¦–å­—æ¯ä¸è¦å¤§å†™\r\n2. ç»“å°¾æ— éœ€æ·»åŠ æ ‡ç‚¹\r\n\r\n### body\r\n\r\nä¸»ä½“å†…å®¹ï¼Œæˆ‘ä»¬éœ€è¦æŠŠæœ¬æ¬¡ commit è¯¦ç»†çš„æè¿°ä¸€ä¸‹ï¼Œæ¯”å¦‚æ­¤æ¬¡å˜æ›´çš„åŠ¨æœºç­‰ï¼Œä¸èƒ½è¶…å‡º 72 ä¸ªå­—ç¬¦\r\n\r\n> ä¸ºä»€ä¹ˆéœ€è¦\r\n>\r\n> - å®ƒå¯èƒ½æ˜¯ç”¨æ¥ä¿®å¤ä¸€ä¸ª bugï¼Œå¢åŠ ä¸€ä¸ª featureï¼Œæå‡æ€§èƒ½ã€å¯é æ€§ã€ç¨³å®šæ€§ç­‰ç­‰\r\n> - å®ƒå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜? å…·ä½“æè¿°è§£å†³é—®é¢˜çš„æ­¥éª¤\r\n> - æ˜¯å¦å­˜åœ¨å‰¯ä½œç”¨ã€é£é™©?\r\n\r\n### footer\r\n\r\næè¿°ä¸‹ä¸ä¹‹å…³è”çš„ issue æˆ– break changeï¼Œåœ¨å…¬å¸é¡¹ç›®ä¸­åŸºæœ¬å¿½ç•¥å³å¯\r\n\r\n## å‚è€ƒæ–‡ç« \r\n\r\n- [Git åˆ†æ”¯ç®¡ç†è§„èŒƒ](https://juejin.cn/post/6844903945245048846#heading-1)\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/70/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/70/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/71",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/71/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/71/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/71/events",
          "html_url": "https://github.com/bosens-China/blog/issues/71",
          "id": 914142576,
          "node_id": "MDU6SXNzdWU5MTQxNDI1NzY=",
          "number": 71,
          "title": "å›¢é˜Ÿè§„èŒƒç³»åˆ—ä¹‹å·¥ç¨‹è§„èŒƒ",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 3661376441,
              "node_id": "LA_kwDOCzPAy87aPCu5",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83",
              "name": "ä»£ç è§„èŒƒ",
              "color": "5319e7",
              "default": false,
              "description": "å›¢é˜Ÿè§„èŒƒã€ä»£ç è§„èŒƒã€æŠ€æœ¯é€‰å‹ç­‰ç›¸å…³å†…å®¹"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2021-06-08T01:42:17Z",
          "updated_at": "2021-12-21T10:00:23Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "![bg](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7235b285206d49f5bb8f0cc2e43771c9~tplv-k3u1fbpfcp-zoom-1.image)\r\n\r\næœ€è¿‘ä¸€å‘¨çš„å·¥ä½œé‡å¿ƒå°±æ˜¯åœ¨æ¢³ç†å›¢é˜Ÿè§„èŒƒï¼Œåœ¨å†™çš„è¿‡ç¨‹ä¹ŸæŸ¥ç¼ºè¡¥æ¼äº†ä¸å°‘çŸ¥è¯†ï¼Œå‰”é™¤æ‰å…³äºå…¬å¸åœºæ™¯çš„éƒ¨åˆ†å°±æœ‰äº†è¿™ä¸€ç³»åˆ—çš„æ–‡ç« ï¼Œé¢„è®¡å†™å››éƒ¨åˆ†ï¼š\r\n\r\n1. [git è§„èŒƒ](https://github.com/bosens-China/blog/issues/70)\r\n2. å·¥ç¨‹è§„èŒƒ\r\n3. [ç”¨æˆ·ä½“éªŒè§„èŒƒ](https://github.com/bosens-China/blog/issues/72)\r\n4. [å‘½åè§„èŒƒ](https://github.com/bosens-China/blog/issues/73)\r\n\r\n# å·¥ç¨‹è§„èŒƒ\r\n\r\n## é¡¹ç›®ç›®å½•\r\n\r\né¡¹ç›®ç›®å½•å®šä¹‰çš„åç§°åº”å½“åšåˆ°æ¸…æ™°æ˜“è¯»ï¼Œå¯¹äºæ¯ä¸ªæ–‡ä»¶å¤¹å¯ä»¥æ”¾ç½®ä¸€ä¸ª`README.md`çš„æ–‡ä»¶ï¼Œå¯¹é‡è¦éƒ¨åˆ†å’ŒèŒè´£è¿›è¡Œæè¿°ï¼Œä¸‹é¢ç»™ä¸€ä»½å¸¸ç”¨çš„ç¤ºä¾‹ï¼š\r\n\r\n```sh\r\nâ”œâ”€â”€ public                          // é™æ€é¡µé¢\r\nâ”œâ”€â”€ scripts                         // ç›¸å…³è„šæœ¬é…ç½®\r\nâ”œâ”€â”€ src                             // ä¸»ç›®å½•\r\n    â”œâ”€â”€ assets                      // é™æ€èµ„æº\r\n    â”œâ”€â”€ components                  // å…¨å±€ç»„ä»¶\r\n    â”œâ”€â”€ lib                         // å…¨å±€æ’ä»¶\r\n    â”œâ”€â”€ router                      // è·¯ç”±é…ç½®\r\n    â”œâ”€â”€ store                       // vuex é…ç½®\r\n    â”œâ”€â”€ styles                      // æ ·å¼\r\n    â”œâ”€â”€ utils                       // å·¥å…·æ–¹æ³•(axioså°è£…ï¼Œå…¨å±€æ–¹æ³•ç­‰)\r\n    â”œâ”€â”€ views                       // é¡µé¢\r\n    â”œâ”€â”€ App.vue                     // é¡µé¢ä¸»å…¥å£\r\n    â”œâ”€â”€ main.js                     // è„šæœ¬ä¸»å…¥å£\r\n```\r\n\r\nä¸‹é¢å†è¯´å‡ æ¡å»ºè®®ï¼š\r\n\r\n- å¦‚æœå­˜åœ¨åµŒå¥—è·¯ç”±çš„é¡µé¢ï¼Œå¯ä»¥åœ¨ src å®šä¹‰ä¸€ä¸ª `layout` å½“åšåŸºç¡€çš„è§†å›¾ç»„ä»¶ä½¿ç”¨\r\n- `components` æ–‡ä»¶å†…çš„ç»„ä»¶è¯·ä¿æŒé€šç”¨æ€§\r\n- å¦‚æœ views å­˜åœ¨ä¸šåŠ¡ç»„ä»¶ï¼Œå¯ä»¥åœ¨å½“å‰ç›®å½•ä¸‹æ–°å»º components ä½¿ç”¨ï¼Œæˆ–è€…åŸºäºå…¨å±€ components è¿›è¡ŒäºŒæ¬¡å°è£…\r\n- views ä¸‹çš„é¡µé¢ä½¿ç”¨æ–‡ä»¶å¤¹çš„å½¢å¼æ¥å®šä¹‰ï¼Œä¾‹å¦‚æœ‰ä¸€ä¸ªç»Ÿè®¡é¡µé¢ï¼Œå¦‚æœåªå†™ä¸€ä¸ª`.vue`æ–‡ä»¶ä¼šå¯¼è‡´æ–‡ä»¶å†…å®¹è¿‡å¤šï¼Œè€Œå¦‚æœç›´æ¥åœ¨ views ä¸‹è¿›è¡ŒæŠ½ç¦»å¤šä¸ª`.vue`ä¼šå¯¼è‡´ç»“æ„ä¸ç»Ÿä¸€\r\n\r\n## utils\r\n\r\nå¯¹äº utils ä¸‹çš„æ–‡ä»¶ï¼Œè¯·ä¿æŒæŒ‰ç…§æ–‡ä»¶ç±»å‹è¿›è¡Œåˆ’åˆ†ï¼Œä¸‹é¢æˆªå–[ant-design-pro](https://github.com/ant-design/ant-design-pro/tree/master/src/utils)çš„ utils æ–‡ä»¶ä¸ºä¾‹\r\n\r\n| åç§°          |                            æäº¤ä¿¡æ¯                             |\r\n| ------------- | :-------------------------------------------------------------: |\r\n| Authorized.ts |                     use @umijs/fabric@2.5.0                     |\r\n| authority.ts  |       ğŸŒ localization: docs translated to english (#7938)       |\r\n| request.ts    |       ğŸŒ localization: docs translated to english (#7938)       |\r\n| utils.less    |                clean: remove unuse less (#6214)                 |\r\n| utils.test.ts | feat: @umijs/route-utils replace getAuthorityFromRouter (#7319) |\r\n| utils.ts      |       ğŸŒ localization: docs translated to english (#7938)       |\r\n\r\n> åœ¨å¼€å‘é¡¹ç›®ä¸­ï¼Œè¯·ä¼˜å…ˆä½¿ç”¨ [lodash](https://www.lodashjs.com/) è¿™æ ·çš„å·¥å…·åº“ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šå°è£…è‡ªå·±çš„æ–¹æ³•ï¼Œå¦‚æœçœŸçš„ä¸å­˜å†åœ¨è€ƒè™‘æ‰‹åŠ¨å®ç°ä» 0 åˆ° 1 å®ç°\r\n\r\n## VueX\r\n\r\nåœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œå¯¹ VueX çš„æ‹†åˆ†é€šå¸¸æ ¹æ®ä¸šåŠ¡ï¼Œè¯·ä¸è¦ç›´æ¥ä½¿ç”¨ VueX ä¸‹çš„`State`ã€`Getter`ã€`Mutation`ç­‰ï¼Œè€Œæ˜¯æ”¹ç”¨`Module`å°†ç›¸å…³ä¾èµ–èšåˆåœ¨ä¸€èµ·ï¼Œæœ€åé€šè¿‡`import`æ•´åˆåœ¨ä¸€èµ·ï¼Œä¸‹é¢ä»¥ home æ–‡ä»¶å¤¹ä¸ºä¾‹ï¼š\r\n\r\n```sh\r\nâ”œâ”€â”€ home                            // ä¸»ç›®å½•\r\n    â”œâ”€â”€ index.js                    // VueX state getters mutations action ç®¡ç†\r\n    â”œâ”€â”€ ...                         // å¯èƒ½å­˜åœ¨çš„å…¶å®ƒæ–‡ä»¶\r\nâ””â”€â”€ index.js                        // VueX ä¸»å…¥å£\r\n```\r\n\r\nhome/index.js\r\n\r\n```js\r\nexport default {\r\n  namespaced: true,\r\n  state: () => ({ ... }),\r\n  mutations: { ... },\r\n  actions: { ... },\r\n  getters: { ... }\r\n}\r\n```\r\n\r\nindex.js\r\n\r\n```js\r\nimport { createStore } from 'vuex';\r\nimport home from './home';\r\n\r\nconst store = createStore({\r\n  modules: {\r\n    home,\r\n  },\r\n});\r\n\r\nexport default store;\r\n```\r\n\r\n## Router\r\n\r\n### è·¯ç”±å±‚çº§\r\n\r\nè·¯ç”±å±‚çº§ååˆ†é‡è¦ï¼Œåœ¨ Router4 ä¹‹å‰ï¼Œä¼šæ ¹æ®è·¯ç”±å®šä¹‰çš„é¡ºåºæ¥å†³å®šè·¯ç”±çš„å…ˆåé¡ºåºï¼Œå¦‚æœå±‚çº§å¾ˆä¸æ¸…æ™°ä¼šå¯¼è‡´ä¸¤ä¸ªé—®é¢˜ï¼š\r\n\r\n- ç»´æŠ¤æˆ–è€…å®šä¹‰æ–°è·¯ç”±éœ€è¦æŸ¥æ‰¾åŠå¤©\r\n- éå† routes ä¿¡æ¯ååˆ†å›°éš¾ï¼Œåšæƒé™ä¹‹ç±»çš„çš„å¾ˆéº»çƒ¦\r\n\r\n![1.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8312de118fe34964afb919655f2f7292~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nä¸¾ä¸ªä¾‹å­ï¼Œå¯¹äºä¸Šé¢çš„ä¸€ä¸ªè®¾è®¡å›¾ï¼ŒåŒ…å«ï¼š`headã€contentã€footer`ä¸‰ä¸ªéƒ¨åˆ†ï¼Œè§‚å¯Ÿä»–ä»¬å‰©ä½™è®¾è®¡å›¾é¡¶éƒ¨å’Œåº•éƒ¨åŸºæœ¬ç›¸åŒï¼Œåªæ˜¯ content åŒºåŸŸçš„å†…å®¹æœ‰æ‰€ä¸åŒã€‚\r\n\r\nè€Œå¯¹è¿™æ ·ä¸€ä¸ªè®¾è®¡å›¾è¿›è¡Œå¼€å‘ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ª`layout`ç»„ä»¶å½“åšåŸºç¡€å…¬å…±ç»“æ„ï¼Œä¹‹åä¹¦å†™`routers`çš„å…·ä½“ä¿¡æ¯\r\n\r\n```sh\r\nâ”œâ”€â”€ routes                            // routesçš„å®šä¹‰ç›®å½•\r\n    â”œâ”€â”€ home.js                       // é¦–é¡µ\r\n    â”œâ”€â”€ type.js                       // åˆ†ç±»\r\n    â”œâ”€â”€ food.js                       // ä¸œå®¶èœ\r\n    â”œâ”€â”€ brand.js                       // å¤§ç‰Œ\r\nâ””â”€â”€ index.js                          // vue router ä¸»å…¥å£\r\nâ””â”€â”€ routes.js                         // å°†routersç›®å½•ä¸‹çš„æ–‡ä»¶åˆ†å‘æˆæœ€ç»ˆvue routerä½¿ç”¨ç»“æ„\r\n```\r\n\r\nroutes.js\r\n\r\n```js\r\nimport layout from '@/layout';\r\nimport home from './routes/home';\r\nimport type from './routes/type';\r\nimport food from './routes/food';\r\nimport brand from './routes/brand';\r\n\r\nconst routes = [\r\n  {\r\n    path: '/',\r\n    component: layout,\r\n    children: home,\r\n  },\r\n  {\r\n    path: '/',\r\n    component: layout,\r\n    children: type,\r\n  },\r\n  {\r\n    path: '/',\r\n    component: layout,\r\n    children: food,\r\n  },\r\n  {\r\n    path: '/',\r\n    component: layout,\r\n    children: brand,\r\n  },\r\n];\r\n\r\nexport default routes;\r\n```\r\n\r\nindex.js\r\n\r\n```js\r\nimport { createRouter, createWebHistory, createWebHashHistory } from 'vue-router';\r\n\r\nimport routes from './routes';\r\n\r\nconst router = createRouter({\r\n  routes,\r\n});\r\n\r\n// å…¨å±€å¯¼èˆªå®ˆå«\r\nrouter.beforeEach(async (to) => {\r\n  // ...\r\n});\r\n\r\nexport default router;\r\n```\r\n\r\n### æ•è·æœªçŸ¥è·¯ç”±\r\n\r\næ— è®ºåœ¨åšä¸­å°è¿˜æ˜¯ç§»åŠ¨ç«¯çš„äº§å“ï¼Œéƒ½éœ€è¦æ­£ç¡®å¤„ç†æœªçŸ¥çš„è·¯ç”±ï¼Œä¸€èˆ¬è€Œè¨€æœ‰äºŒç§å¤„ç†æ–¹å¼ï¼Œå…·ä½“å‚è€ƒé¡¹ç›®çš„ç±»å‹è¿›è¡Œé€‰æ‹©ï¼š\r\n\r\n1. ç›´æ¥ç»™å‡º 404 ä¹‹ç±»çš„æç¤ºï¼Œæç¤ºé¡µé¢ä¸å­˜åœ¨ç­‰ä¿¡æ¯ï¼›\r\n2. å¸®åŠ©å…¶é‡å®šå‘åˆ°é¦–é¡µæˆ–è€…å…¶å®ƒé¡µé¢ï¼›\r\n\r\n```js\r\n// vue router4\r\n{ path: '/:pathMatch(._)_', name: 'NotFound', redirect: { name: 'home' } };\r\n\r\n// vue router3\r\n{ path: '*', name: 'NotFound', redirect: { name: 'home' } };\r\n```\r\n\r\n### è·¯ç”±æ‡’åŠ è½½\r\n\r\nä½¿ç”¨æ‡’åŠ è½½å¯ä»¥èŠ‚çœç™½å±æ—¶é—´ï¼Œæ‡’åŠ è½½çš„æœºåˆ¶åˆ©ç”¨äº† webpack ä»£ç åˆ†å‰² + import()ï¼Œåªåœ¨è¿›å…¥å½“å‰è·¯ç”±çš„æ—¶å€™åŠ è½½æ‰€ä¾èµ–çš„ js æ–‡ä»¶ã€‚\r\n\r\n```js\r\n  { path: '/', name: 'home', component: () => import(/* webpackChunkName: \"home\" */ 'views/home/index.vue') }\r\n```\r\n\r\n> é™¤äº†éœ€è¦`children`çš„çˆ¶çº§é¡µé¢ï¼Œæ‰€æœ‰å…¶å®ƒé¡µé¢ç»Ÿä¸€ä½¿ç”¨æ‡’åŠ è½½\r\n>\r\n> `/* webpackChunkName: \"home\" */`è¿™æ ·çš„æ³¨é‡Šè¯­æ³•ï¼Œæ˜¯ webpack ç‹¬æœ‰çš„ï¼Œå®ƒè´Ÿè´£ build æ‰“åŒ…ä¹‹åçš„æ–‡ä»¶åç§°\r\n\r\n## ç»„ä»¶æ‹†åˆ†å»ºè®®\r\n\r\n![2.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/620871b1cb374af4a5995db475119ba6~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nä¸€ä¸ªå¤§å‹é¡¹ç›®ç”±æ— æ•°å­ç»„ä»¶ç»„åˆè€Œæˆï¼Œæœ‰ç‚¹åƒä¹é«˜ç§¯æœ¨ä¸€æ ·ï¼Œç›´æ¥å¼€å‘ä¸€ä¸ªå¤§å‹é¡¹ç›®è‚¯å®šå¾ˆéš¾ï¼Œä½†æ˜¯å¦‚æœç»™æ— æ•°å­ç»„ä»¶è®©ä½ æ‹¼æ¥åˆ™ç›¸å¯¹ç®€å•ã€‚\r\n\r\nç»„ä»¶çš„æ‹†åˆ†ï¼Œåº”è¯¥éµå¾ªä¸¤ä¸ªåŸåˆ™ï¼š\r\n\r\n### é¢—ç²’åº¦ç»†åˆ†\r\n\r\nåœ¨å­¦ä¹ è®¾è®¡æ¨¡å¼ä¸­æœ‰å¾ˆé‡è¦çš„ä¸€å¥è¯å°±æ˜¯**å•ä¸€èŒè´£**ï¼Œåœ¨ç»„ä»¶å¼€å‘ä¹Ÿæ˜¯åŒç†ï¼ŒåŸåˆ™ä¸Šè®©ä¸€ä¸ªç»„ä»¶åªè´Ÿè´£ä¸€ä»¶äº‹æƒ…ï¼Œå¯ä»¥æœ€å¤§ç¨‹åº¦çš„å¤ç”¨ç»„ä»¶ï¼Œæ–¹ä¾¿æµ‹è¯•å’Œå®šä½é—®é¢˜ã€‚\r\n\r\nä½†æ˜¯è¿‡åº¦çš„å•ä¸€èŒè´£ç»„ä»¶ä¹Ÿä¼šå¯¼è‡´ä¸€ä¸ªé—®é¢˜å°±æ˜¯é¢—ç²’åº¦å¤ªç»†é€ æˆç»„ä»¶çš„ç¢ç‰‡åŒ–ï¼Œä¸¾ä¸€ä¸ªä¾‹å­æ¥è¯´ï¼Œè‡ªåŠ¨å®Œæˆç»„ä»¶ï¼Œå®ƒæ˜¯æœç´¢æ¡† + select ç»„åˆè€Œæˆï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æ¥å¤ç”¨ï¼Œå› ä¸ºå‰ä¸¤ä¸ªç»„ä»¶çš„é¢—ç²’åº¦åˆšåˆšå¥½ã€‚\r\n\r\n![3.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0e6da1bee9e44e9a9059520b8555a99b~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nè¿˜æœ‰ä¸€ä¸ªä¾‹å­å°±æ˜¯å¾½ç« æ•°ç»„ä»¶(Badge)ï¼Œå®ƒçš„å³ä¸Šè§’ä¼šæœ‰çº¢ç‚¹æç¤ºï¼Œå¯èƒ½æ˜¯æ•°å­—ä¹Ÿå¯èƒ½æ˜¯ iconï¼Œå®ƒçš„èŒè´£å½“ç„¶ä¹Ÿå¾ˆå•ä¸€ï¼Œè¿™ä¸ªçº¢ç‚¹æç¤ºä¹Ÿç†æ‰€å½“ç„¶ä¹Ÿå¯ä»¥è¢«å•ç‹¬æŠ½è±¡ä¸ºä¸€ä¸ªç‹¬ç«‹ç»„ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¬é€šå¸¸ä¸ä¼šå°†å®ƒä½œä¸ºç‹¬ç«‹ç»„ä»¶ï¼Œå› ä¸ºåœ¨å…¶å®ƒåœºæ™¯ä¸­è¿™ä¸ªç»„ä»¶æ˜¯æ— æ³•è¢«å¤ç”¨çš„ï¼Œå› ä¸ºæ²¡æœ‰ç±»ä¼¼çš„åœºæ™¯å†éœ€è¦å°çº¢ç‚¹è¿™ä¸ªå°ç»„ä»¶äº†\r\n\r\n![4.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/517274f4b3744cd9acd35e15c091425f~tplv-k3u1fbpfcp-watermark.image)\r\n\r\n### é€šç”¨æ€§è€ƒè™‘\r\n\r\nç»„ä»¶åˆ†ä¸ºåŸºç¡€ç»„ä»¶å’Œä¸šåŠ¡ç»„ä»¶ï¼Œå½“å­˜åœ¨ä¸šåŠ¡å¸¸è§é‡å¤ä½¿ç”¨çš„æ—¶å€™é€šå¸¸ä¼šå¯¹é€šç”¨ç»„ä»¶è¿›è¡ŒäºŒæ¬¡å°è£…ï¼Œä¾‹å¦‚æœ‰ä¸€ä¸ªæœç´¢éƒ¨é—¨çš„ç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶åœ¨å¾ˆå¤š view éƒ½æœ‰å¤ç”¨è€Œä¸”ä¹Ÿå¯¹è¿™ä¸ªç»„ä»¶é›†æˆäº†è‡ªåŠ¨æœç´¢ + åˆå§‹ loading + è‡ªåŠ¨åŠ è½½ä¸‹ä¸€é¡µï¼Œæœ€åä½¿ç”¨æ•ˆæœç”¨èµ·æ¥ä¹Ÿå¾ˆæ–¹ä¾¿ã€‚\r\n\r\nä½†æ˜¯ç°åœ¨çªç„¶æ¥ä¸€ä¸ªéœ€æ±‚ï¼Œè¯´å¯¹æœç´¢çš„ç»„ä»¶è¿›è¡Œåº•éƒ¨æç¤ºï¼Œé‚£éš¾é“ç›´æ¥æ›´æ”¹æºç å—ï¼Ÿä½†æ˜¯å¦‚æœç›´æ¥æ›´æ”¹ç»„ä»¶ï¼Œè¿™æ ·ä¹Ÿè¿èƒŒäº†`å¼€æ”¾ã€å…³é—­åŸåˆ™`\r\n\r\nå…¶å®è¯´è¿™ä¸ªä¾‹å­å°±æ˜¯å¸Œæœ›æ€è€ƒç»„ä»¶å¹¿çš„é€‚é…æ€§ï¼Œåœ¨ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„ç»„ä»¶ï¼Œä¼šçœ‹åˆ°å®ƒä»¬æš´éœ²äº†å¾ˆå¤šæ’æ§½ã€jsx çš„æ¸²æŸ“å‡½æ•°ï¼Œæœ€ç»ˆçš„ç›®çš„ä¹Ÿå°±æ˜¯åº”å¯¹å„ç§å„æ ·çš„åœºæ™¯\r\n\r\n> ç»„ä»¶çš„å½¢æ€(DOM ç»“æ„)æ°¸è¿œæ˜¯åƒå˜ä¸‡åŒ–çš„ï¼Œä½†æ˜¯å…¶è¡Œä¸º(é€»è¾‘)æ˜¯å›ºå®šçš„ï¼Œå› æ­¤é€šç”¨ç»„ä»¶çš„ç§˜è¯€ä¹‹ä¸€å°±æ˜¯å°† DOM ç»“æ„çš„æ§åˆ¶æƒäº¤ç»™å¼€å‘è€…,ç»„ä»¶åªè´Ÿè´£è¡Œä¸ºå’Œæœ€åŸºæœ¬çš„ DOM ç»“æ„\r\n\r\n## å·¥ç¨‹ä¼˜åŒ–\r\n\r\nä¼˜åŒ–æ˜¯ä¸€ä¸ªå¾ˆåºå¤§çš„å‘½é¢˜ï¼Œæ ¹æ®é¡¹ç›®çš„ä¸åŒæ‰€é‡‡å–çš„æ–¹å¼ä¹Ÿä¸å°½ç›¸åŒï¼Œä¸‹é¢åªæ€»ç»“ä¸€äº›å¸¸ç”¨çš„æ–¹å¼\r\n\r\n### é¡¹ç›®ä¼˜åŒ–\r\n\r\n- CND\r\n- gzipï¼Œè®©åç«¯æ”¯æŒ gzip å‹ç¼©ï¼Œå‰ç«¯ä¹Ÿç”Ÿæˆ gzip æ–‡ä»¶\r\n- ä½¿ç”¨ webp æ ¼å¼ï¼Œç”Ÿäº§ç¯å¢ƒä¸‹å‹ç¼©å›¾ç‰‡\r\n- è·¯ç”±æ‡’åŠ è½½\r\n- ç¬¬ä¸‰æ–¹ç»„ä»¶æŒ‰éœ€åŠ è½½\r\n- æŠ½ç¦»ç¬¬ä¸‰æ–¹åº“ï¼Œé¿å…å’Œä¸šåŠ¡ç»„ä»¶è€¦åˆä¸€èµ·æ‰“åŒ…\r\n- ...\r\n\r\n### code ä¼˜åŒ–\r\n\r\n- å‡å°‘å¯¹ dom æ“ä½œï¼Œå¦‚æœæ“ä½œå°†æ‰€æœ‰ dom èšåˆåœ¨ä¸€èµ·ä¿®æ”¹\r\n- ä¸ç›´æ¥ä¿®æ”¹ style æ”¹ç”¨ class ä¿®æ”¹ï¼›\r\n- å°½é‡ä¸é€‚ç”¨ tableï¼Œç»‘å®šäº‹ä»¶é‡‡ç”¨äº‹ä»¶å§”æ‰˜å½¢å¼\r\n- å¯¹åŠ¨ç”»å…ƒç´ ï¼Œè®©å…¶è„±ç¦»æ–‡æ¡£æµï¼Œå‡å°‘é‡ç»˜å’Œé‡æ’\r\n- ...\r\n\r\n### æ„å»ºè¿‡ç¨‹ä¼˜åŒ–\r\n\r\n- åˆ é™¤ eslint-loaderï¼Œæ”¹ç”¨ç¼–è¾‘å™¨è‡ªå¸¦çš„ eslint\r\n- ä½¿ç”¨ catch-loaderï¼Œå¯¹èµ„æºè¿›è¡ŒåŠ é€Ÿ\r\n- ç”Ÿäº§ç¯å¢ƒä¸‹åˆ é™¤`.map`æ–‡ä»¶ï¼Œç¼©çŸ­`import`æŸ¥æ‰¾åç¼€\r\n- ...\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/71/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/71/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/72",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/72/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/72/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/72/events",
          "html_url": "https://github.com/bosens-China/blog/issues/72",
          "id": 914175625,
          "node_id": "MDU6SXNzdWU5MTQxNzU2MjU=",
          "number": 72,
          "title": "å›¢é˜Ÿè§„èŒƒç³»åˆ—ä¹‹ç”¨æˆ·ä½“éªŒè§„èŒƒ",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 3661376441,
              "node_id": "LA_kwDOCzPAy87aPCu5",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83",
              "name": "ä»£ç è§„èŒƒ",
              "color": "5319e7",
              "default": false,
              "description": "å›¢é˜Ÿè§„èŒƒã€ä»£ç è§„èŒƒã€æŠ€æœ¯é€‰å‹ç­‰ç›¸å…³å†…å®¹"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2021-06-08T02:22:11Z",
          "updated_at": "2021-12-21T10:00:18Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "![bg](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b9625a50c497462ab14fb45ab08d21d6~tplv-k3u1fbpfcp-zoom-1.image)\r\n\r\næœ€è¿‘ä¸€å‘¨çš„å·¥ä½œé‡å¿ƒå°±æ˜¯åœ¨æ¢³ç†å›¢é˜Ÿè§„èŒƒï¼Œåœ¨å†™çš„è¿‡ç¨‹ä¹ŸæŸ¥ç¼ºè¡¥æ¼äº†ä¸å°‘çŸ¥è¯†ï¼Œå‰”é™¤æ‰å…³äºå…¬å¸åœºæ™¯çš„éƒ¨åˆ†å°±æœ‰äº†è¿™ä¸€ç³»åˆ—çš„æ–‡ç« ï¼Œé¢„è®¡å†™å››éƒ¨åˆ†ï¼š\r\n\r\n1. [git è§„èŒƒ](https://github.com/bosens-China/blog/issues/70)\r\n2. [å·¥ç¨‹è§„èŒƒ](https://github.com/bosens-China/blog/issues/71)\r\n3. ç”¨æˆ·ä½“éªŒè§„èŒƒ\r\n4. [å‘½åè§„èŒƒ](https://github.com/bosens-China/blog/issues/73)\r\n\r\n# ç”¨æˆ·ä½“éªŒè§„èŒƒ\r\n\r\nå…³äºç”¨æˆ·ä½“éªŒæ˜¯ä¸€ä¸ªå¾ˆåºå¤§çš„å‘½é¢˜å¹¶ä¸”æ¯ä¸ªäººå¯¹äºä½“éªŒçš„ç†è§£ä¹Ÿå„ä¸ç›¸åŒï¼ŒåŒæ—¶ä¼´éšç€æ—¶æ•ˆæ€§ï¼Œéšç€æ–°æŠ€æœ¯çš„å‡ºç°å¯èƒ½ä¹‹å‰çš„ä½“éªŒå°±å¾ˆå¿«è½ä¼äº†ï¼Œæ‰€ä»¥ä¸‹é¢å†…å®¹åªèƒ½ç®€çŸ­æ¦‚æ‹¬ä¸‹ã€‚\r\n\r\n## é€šç”¨å‡†åˆ™\r\n\r\n### å¢åŠ å¯ç‚¹å‡»åŒºåŸŸå¤§å°\r\n\r\n![1.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a2fb47391323406d90d3cc8a350bdf0b~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nä»¥ä¸Šå›¾ä¸ºä¾‹ï¼Œå¦‚æœå¿…é¡»ç‚¹å‡»åˆ°`checkbox`åŒºåŸŸæ‰èƒ½ç‚¹å‡»ç”Ÿæ•ˆï¼Œå¿…ç„¶ä¼šå¯¼è‡´ä½“éªŒä¸ä½³\r\n\r\nç»„ä»¶çš„è€ƒè™‘ä¸€è‡´æ€§åŒæ—¶ä¹ŸåŒ…å«äº†é¡µé¢ç»“æ„ï¼Œå¯¹äºä¸Šå›¾æ‰€ç¤º label å’Œ checkbox å°±æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œè¿™é‡ŒæŠ›ç –å¼•ç‰è¯´ä¸€äº›å¸¸è§é€‚ç”¨è¯¥å‡†åˆ™çš„å…ƒç´ ï¼š\r\n\r\n- header åŒºåŸŸå³ä¸Šè§’å¤´åƒå’Œå§“åéƒ¨åˆ†ï¼›\r\n- Labelã€li ç­‰æ•´ä½“ä¸€è¡Œå…ƒç´ ï¼›\r\n- è‡ªå®šä¹‰å›¾æ ‡\r\n- ...\r\n\r\nåœ¨å¯¹ä¸Šé¢å…ƒç´ è¿›è¡Œäº¤äº’çš„æ—¶å€™ï¼Œå°½é‡é¿å…ç”¨æˆ·çš„ç‚¹å‡»æˆæœ¬ï¼Œä¸‹é¢è¯´ä¸¤ä¸ªå¸¸è§çš„åšæ³•\r\n\r\n#### å¢å¤§æ•´ä½“åŒºåŸŸç‚¹å‡»ï¼Œä¾‹å¦‚æœ‰ä¸‹é¢ä¸€ä¸ªå¤´åƒåŒºåŸŸ\r\n\r\n```html\r\n<p class=\"portrait\">\r\n  <img class=\"portrait-img\" src=\"xxx\" />\r\n  <span class=\"portrait-name\">xxxx</span>\r\n</p>\r\n```\r\n\r\nå¦‚æœåŸæœ¬æ˜¯ç‚¹å‡»äº‹ä»¶ç»‘å®šåœ¨`.portrait-img`ï¼Œé‚£ä¹ˆè¯·è€ƒè™‘å¢åŠ åˆ°`.portrait`\r\n\r\n#### å¢å¤§å…ƒç´ æœ¬èº«çš„ç‚¹å‡»åŒºåŸŸ\r\n\r\n```html\r\n<i class=\"i-con\"></i>\r\n```\r\n\r\nå¯¹äºä¸Šé¢çš„ i å…ƒç´ ï¼Œé€šå¸¸ç”¨æ¥è®¾ç½®è‡ªå®šä¹‰å›¾æ ‡ï¼Œä½†æ˜¯åœ¨å®é™…æ“ä½œä¸­ï¼Œç”¨æˆ·çš„é¼ æ ‡æˆ–è€…æ‰‹åŠ¿å¯èƒ½å­˜åœ¨åå·®æ‰€ä»¥éœ€è¦å¢åŠ è¿™ä¸ªå…ƒç´ çš„æœ¬èº«èŒƒå›´ã€‚\r\n\r\nå›å½’`css box`çš„æ¦‚å¿µï¼Œæˆ‘ä»¬å¯ä»¥å¢åŠ `border`æ¥å®Œæˆå¢åŠ åŒºåŸŸçš„æ•ˆæœ\r\n\r\n```css\r\n.i-con {\r\n  /* çœç•¥å…¶å®ƒä»£ç  */\r\n  border: 5px solid transparent;\r\n}\r\n```\r\n\r\n> æ³¨æ„ï¼špc ä¸Šè¿˜éœ€è¦è€ƒè™‘å…‰æ ‡çš„ä¸€è‡´æ€§ï¼Œä»¥åŠ hover ç­‰ä¸€ç³»åˆ—æ•´ä½“çš„æ•ˆæœ\r\n\r\n### å›¾ç‰‡ç›¸å…³ä¼˜åŒ–\r\n\r\nå¯¹äºå¾ˆå¤šé¡¹ç›®è€Œè¨€ï¼Œå›¾ç‰‡æ˜¯å¸¸è§çš„ä¼˜åŒ–ç‚¹ï¼Œæ¯•ç«Ÿå¤šæ–¹é¢çš„ä¼˜åŒ–è¿œæ²¡æœ‰å‹ç¼©ä¸€å¼ å›¾ç‰‡æ¥çš„ç›´è§‚ï¼Œè€Œå¯¹äºç”¨æˆ·ä½“éªŒæ¥è¯´ä¹ŸåŒæ ·æ˜¯\r\n\r\n#### é¢„åŠ è½½\r\n\r\nä¸åŒäºæ‡’åŠ è½½ï¼Œé¢„åŠ è½½çš„ç›®çš„å°±æ˜¯æå‰è¾“å‡ºå›¾ç‰‡ï¼Œé¿å…ç”¨æˆ·ç­‰å¾…ã€‚\r\n\r\nä¸¾ä¸€ä¸ªå¸¸è§çš„ä¾‹å­ï¼šè½®æ’­å›¾å°±å¾ˆé€‚åˆä½¿ç”¨é¢„åŠ è½½ï¼Œå¦åˆ™ç”¨æˆ·çœ‹åˆ°ä¸‹ä¸€å¼ å›¾ç‰‡çš„æ—¶å€™è¿˜ç»§ç»­ç­‰å¾…åŠ è½½å°±ä¼šæ„Ÿè§‰å¾ˆçªå…€ã€‚\r\n\r\né¢„åŠ è½½çš„åŸç†å°±æ˜¯æå‰è¯·æ±‚ï¼Œä¹‹åé‡å¤è¯·æ±‚ç›¸åŒèµ„æºæ—¶ä¼šè¿”å›ç¼“å­˜æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å°è£…ä¸€ä¸ªæ–¹æ³•ï¼Œåˆ©ç”¨`Image`å¯¹ src èµ‹å€¼å³å¯\r\n\r\n```js\r\nconst preloading = (src) => {\r\n  return new Promise((resolve, reject) => {\r\n    const img = new Image();\r\n    img.src = src;\r\n    img.onload = resolve;\r\n    img.onerror = reject;\r\n  });\r\n};\r\n```\r\n\r\n#### é”™è¯¯å›¾ç‰‡\r\n\r\nå„ä¸ªæµè§ˆå™¨å¯¹é”™è¯¯å›¾ç‰‡çš„å¤„ç†æ–¹å¼å„ä¸ç›¸åŒï¼Œè™½ç„¶å­˜åœ¨`alt`æç¤ºä¿¡æ¯ï¼Œä½†æ˜¯ä¸å¤Ÿç»Ÿä¸€å’Œç¾è§‚\r\n\r\n![2.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/eb2385e0dcf34915b0ada7050405f3a5~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nä¾‹å¦‚ä¸Šé¢è¿™ç§é”™è¯¯ä¿¡æ¯çœ‹èµ·æ¥å°±ä¸å¤Ÿç¾è§‚ï¼Œæ›´å¥½çš„åšæ³•ç»™å‡ºé»˜è®¤çš„é”™è¯¯å›¾ç‰‡ï¼Œç›‘å¬å›¾ç‰‡çš„`onerror`äº‹ä»¶æ¥é‡æ–°èµ‹å€¼ï¼Œå¦‚æœä¸æƒ³ä¸€ä¸ªä¸ªå†™ï¼Œå¯ä»¥ç›‘å¬`window.addEventListener error`æ¥å®Œæˆå…¨å±€ç›‘å¬\r\n\r\n```js\r\nwindow.addEventListener(\r\n  'error',\r\n  function (event) {\r\n    var dom = event.target;\r\n    if (/img/i.test(dom.nodeName)) {\r\n      dom.src = 'xxxx.png';\r\n    }\r\n  },\r\n  true\r\n);\r\n```\r\n\r\n> å¦‚æœæƒ³å¢åŠ å¯¹é”™è¯¯å›¾ç‰‡è¿›è¡Œé‡è¯•ï¼Œæˆ–è€…å¯¹ JSP åŠ¨æ€æ¸²æŸ“å†…å®¹è¿›è¡Œæ‹¦æˆªï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« [å¦‚ä½•ä¼˜é›…å¤„ç†å›¾ç‰‡å¼‚å¸¸](https://juejin.cn/post/6844904046705246216#heading-2)\r\n\r\n### ç©ºæ•°æ®é»˜è®¤å¤„ç†\r\n\r\nå¯¹ç©ºæ•°æ®æ”¾ä»»ä¸ç®¡ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç”¨æˆ·è®¤ä¸ºç³»ç»Ÿå‡ºç°äº†é—®é¢˜ï¼Œé€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬è¦å°½é‡é¿å…ç©ºæ•°æ®çš„å‡ºç°ï¼Œä¸€èˆ¬è€Œè¨€æœ‰ä¸¤ç§å¤„ç†æ–¹å¼\r\n\r\n#### ä½¿ç”¨ emptyï¼ˆç©ºçŠ¶æ€ï¼‰è¿›è¡Œå¡«å……\r\n\r\n![3.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1a378691e6c94997ad9cbf2578f3d310~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nä¸€èˆ¬ UI æ¡†æ¶ç°åœ¨éƒ½å†…ç½® empty ç»„ä»¶ï¼Œå¯ä»¥è·Ÿäº§å“å’Œè®¾è®¡æ²Ÿé€šæ— è¯¯åï¼Œå¯¹äºå¸¸è§çš„ table æˆ–è€… list æ— æ•°æ®çš„è¿›è¡Œé»˜è®¤çš„æç¤º\r\n\r\n```vue\r\n<template>\r\n  <template v-if=\"list.length\"> /* ... */ </template>\r\n  <template v-else>\r\n    <empty />\r\n  </template>\r\n</template>\r\n```\r\n\r\n#### éšè—æ•´ä½“åŒºåŸŸ\r\n\r\n![1.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2945ac9ba5ed4a8d83341bf1815157fe~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nå¯¹äºä¸Šé¢çš„ä½œè€…å¸®å½“ï¼Œå¦‚æœå½“å‰å­é¡¹ä¸å­˜åœ¨æ•°æ®ï¼Œåªå±•ç¤ºä¸€ä¸ªæ ‡é¢˜å’Œå®Œæ•´æ¦œå•çš„ä¿¡æ¯å¯èƒ½ä¼šå¾ˆå¥‡æ€ªé‚£ä¸å¦¨è€ƒè™‘åˆ é™¤æ•´ä½“åŒºåŸŸ\r\n\r\n### ä¼˜å…ˆä½¿ç”¨è¯­ä¹‰åŒ–æ ‡ç­¾\r\n\r\nå°½é‡é¿å…æ— è¯­ä¹‰çš„`divã€span`æ»¥ç”¨ï¼Œå› ä¸ºæœç´¢å¼•æ“æŠ“å½•ä¸å‹å¥½ï¼Œç»´æŠ¤èµ·æ¥ä¸å¤Ÿç›´è§‚ï¼Œè€Œä¸”ä½¿ç”¨è¯­ä¹‰åŒ–æ ‡ç­¾å¯ä»¥èŠ‚çœå¾ˆå¤šä»£ç æ€§å·¥ä½œï¼Œä¸‹é¢ä¸¾ä¸€ä¸ªä¾‹å­\r\n\r\n![5.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/942b4d168d254463801b2938ee7c8cbe~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nä¾‹å¦‚ä¸Šé¢çš„æŒ‰é’®ï¼Œå‡è®¾å®ƒçš„åŠŸèƒ½æ˜¯è·³è½¬åˆ°ä¸€ä¸ªæ–°çš„é¡µé¢ï¼Œå¦‚æœåœ¨ spa é¡µé¢ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨`vue-router`è‡ªå¸¦çš„`router-link`è·³è½¬å³å¯å®Œæˆï¼Œè€Œåœ¨ä¼ ç»Ÿå¼€å‘ä¸­å¯ä»¥åœ¨`button`å¤–éƒ¨åµŒå¥—ä¸€ä¸ª`a`æ ‡ç­¾å®Œæˆè·³è½¬\r\n\r\n```html\r\n<a href=\"xxx\">\r\n  <button>xxx</button>\r\n</a>\r\n<!-- æˆ–è€… -->\r\n<router-link to=\"xxx\">\r\n  <button>xxx</button>\r\n</router-link>\r\n```\r\n\r\nè€Œä¸”è¿™æ ·åšå¾ˆå®¹æ˜“é…åˆæµè§ˆå™¨çš„ä¸€äº›å…¶å®ƒè¡Œä¸ºï¼Œæ¯”å¦‚å³å‡»æ‰“å¼€åœ¨æ–°æ ‡ç­¾é¡µ\r\n\r\n### æ“ä½œåé¦ˆ\r\n\r\næ“ä½œåé¦ˆæ˜¯æå‡ç”¨æˆ·ä½“éªŒçš„ä¸€ä¸ªé‡è¦æŒ‡æ ‡ï¼Œå…·ä½“å¯ä»¥å±•å¼€ä¸ºä¸‰éƒ¨åˆ†æ¥è¯´\r\n\r\n#### Require åé¦ˆ\r\n\r\nåœ¨ä¸åç«¯è¿›è¡Œé€šä¿¡çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæˆåŠŸæˆ–è€…å¤±è´¥ï¼Œéƒ½è¯·å‘ŠçŸ¥ç”¨æˆ·ï¼Œè€Œä¸”æç¤ºçš„æ¶ˆæ¯å¿…é¡»å‹å¥½ã€‚\r\n\r\nè¿™é‡Œæœ‰ä¸€ä¸ªå‡†åˆ™\r\n\r\n- æˆåŠŸæ¶ˆæ¯å¯ä»¥ç”±å‰ç«¯æ¥å®šä¹‰ï¼Œå¯ä»¥ç»“åˆå„ç§æ“ä½œåœºæ™¯åšåˆ°æ›´ç»†è‡´çš„æç¤º\r\n- å¯¹äºé”™è¯¯æ¶ˆæ¯ï¼Œåˆ™è¿”å›åç«¯è¿”å›çš„ message ç­‰ä¿¡æ¯\r\n- å¯¹äº 500 ç­‰é”™è¯¯ï¼Œè¯·åœ¨æ‹¦æˆªå™¨ç»Ÿä¸€æ”¹æˆ`ç½‘ç»œè¿æ¥é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•`ï¼Œè€Œä¸æ˜¯æç¤ºä¸€ä¸²è¶…æ—¶ç­‰è‹±æ–‡ä¿¡æ¯\r\n\r\n#### å…ƒç´ åé¦ˆ\r\n\r\nåœ¨è¡¡é‡ä¸€ä¸ª ui æ¡†æ¶çš„æ—¶å€™å°±æœ‰ä¸¤ç‚¹å¾ˆé‡è¦ï¼š\r\n\r\n1. ç»„ä»¶æœ¬èº«çš„äº¤äº’æ˜¯å¦å‹å¥½ï¼Œæ¯”å¦‚åŠ¨ç”»æ˜¯å¦æµç•…ï¼Œæœ‰æ²¡æœ‰ hoverã€active ç­‰æ•ˆæœ\r\n2. å¯¹äºæ— éšœç¢é˜…è¯»æ˜¯å¦å‹å¥½\r\n\r\nå¯è§äº¤äº’çš„é‡è¦æ€§ï¼Œè¦è®©ç”¨æˆ·æ„Ÿè§‰è‡ªå·±åœ¨ç‚¹å‡»ä¸€ä¸ªçœŸå®å­˜åœ¨çš„å…ƒç´ ï¼Œè€Œä¸æ˜¯åƒå›¾ç‰‡ä¸€æ ·çš„é™æ­¢\r\n\r\n![6.gif](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f7548ccd492147eb989ca42b2057e0d6~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nä¾‹å¦‚ä¸Šå›¾ä¸­ï¼Œæœ€å°‘è¦å­˜åœ¨`hover`ã€`active`ç­‰æ•ˆæœ\r\n\r\n#### ç­‰å¾…åé¦ˆ\r\n\r\n![7.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6af4503f4f9c425583118b98b1f3b57e~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nå› ä¸ºä¸åç«¯çš„é€šä¿¡æ˜¯å¼‚æ­¥çš„ï¼Œè€Œä¸”ç”¨æˆ·çš„ç½‘ç»œå¥½åä¹Ÿä¸æ˜¯å›ºå®šä¸å˜çš„ï¼Œæ‰€ä»¥ç»™å…ƒç´ æ·»åŠ `loading`å°±å¾ˆæœ‰å¿…è¦ï¼Œè¿™é‡Œè¯´ä¸¤ä¸ªå¸¸è§çš„åœºæ™¯\r\n\r\n#### è¡¨å•æäº¤\r\n\r\n![7.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6af4503f4f9c425583118b98b1f3b57e~tplv-k3u1fbpfcp-watermark.image)\r\n\r\néœ€è¦æ“ä½œäº¤äº’çš„å¸¸è§éƒ½å¯ä»¥è€ƒè™‘ä½¿ç”¨`loading`ï¼Œè¿™æ ·å¯ä»¥é˜²æ­¢ç”¨æˆ·é‡å¤ç‚¹å‡»å’Œé¿å…ç”¨æˆ·ä¸çŸ¥é“æœ‰æ²¡æœ‰ç‚¹å‡»æˆåŠŸ\r\n\r\n#### é‡æ–°è·å–æ•°æ®\r\n\r\n![8.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/17d967b2947344f5815e114084df2ad8~tplv-k3u1fbpfcp-watermark.image)\r\n\r\n#### è·å–å‰ç½®ä¿¡æ¯\r\n\r\nåœ¨ pc ä¸Šï¼Œæ•´ä½“è¿›å…¥é¡µé¢çš„æ—¶å€™ä¸ºäº†æ©ç›–è·å–ä¸€äº›å‰ç½®çš„ä¿¡æ¯çš„åœºæ™¯ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨ loading å…ƒç´ å‡å°‘ç”¨æˆ·ç­‰å¾…çš„ç„¦è™‘æ„Ÿ\r\n\r\n### ç¼“å­˜\r\n\r\nç¼“å­˜æœ¬è´¨ä¸Šå°±æ˜¯æ‹¿ç©ºé—´æ¢æ—¶é—´ï¼Œå¯¹äºå®¢æˆ·ç«¯è€Œè¨€ï¼Œæ›´å¤šçš„ç“¶é¢ˆæ˜¯åœ¨æ—¶é—´ä¸Šï¼Œä¸‹é¢å°±è¯´ä¸¤ç§å¸¸è§çš„ç¼“å­˜åœºæ™¯\r\n\r\n#### ç»„ä»¶ä¿¡æ¯ç¼“å­˜\r\n\r\n![9.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2dbabc0b5fb8449297b174ca267ef2f2~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nä¾‹å¦‚ä¸Šé¢è¡¨å•ï¼Œå¦‚æœç”¨æˆ·è¯¯æ“ä½œå…³é—­ç½‘é¡µï¼Œä»å¤´å¼€å§‹å¡«å†™ä½“éªŒå°±ä¸æ˜¯ç‰¹åˆ«å¥½ï¼Œå¯ä»¥åœ¨æœªæäº¤æˆåŠŸçš„çŠ¶æ€ä¸‹ç»“åˆæœ¬åœ°åšæŒä¹…åŒ–ç¼“å­˜\r\n\r\nä¸‹é¢ç»™ä¸€ä¸ªç®€å•ç¤ºä¾‹ï¼ˆæ²¡æœ‰ç»™å‡ºå®Œæˆæ¸…é™¤æœ¬åœ°å‚¨å­˜ï¼‰\r\n\r\n```vue\r\n<script>\r\nimport { reactive, watchEffect } from 'vue';\r\n\r\nexport default {\r\n  setUp() {\r\n    const key = 'form';\r\n    const form = reactive({\r\n      name: '',\r\n      password: '',\r\n    });\r\n    const set = (key, value) => {\r\n      localStorage.setItem(key, JSON.stringify(value));\r\n    };\r\n    const get = () => {\r\n      const value = localStorage.getItem(key);\r\n      try {\r\n        return JSON.parse(value);\r\n      } catch {\r\n        return undefined;\r\n      }\r\n    };\r\n    watchEffect(() => {\r\n      set(key, form);\r\n    });\r\n    Object.assign(form, get('form'));\r\n  },\r\n};\r\n</script>\r\n```\r\n\r\n#### æ¥å£ç¼“å­˜\r\n\r\nå¦‚æœå­˜åœ¨é¢‘ç¹è¯·æ±‚ä¸”å¾ˆè€—æ—¶ï¼Œæ¥å£æœ¬èº«åŸºæœ¬ä¸ä¼šå˜æ›´çš„æƒ…å†µï¼Œå¯ä»¥è€ƒè™‘æ¥å£ç¼“å­˜ï¼Œä¸‹é¢ç»™å‡ºä¸€æ®µç®€å•çš„ä»£ç ç¤ºä¾‹\r\n\r\nç”Ÿäº§ç¯å¢ƒå¯ä»¥è€ƒè™‘ä½¿ç”¨ä¸€äº›åº“ [axios-request-cache](https://github.com/ZhengXiaowei/axios-request-cache)\r\n\r\n```js\r\nimport axios from 'axios';\r\nconst { toString } = Object.prototype;\r\n\r\n// æ•°æ®å­˜å‚¨\r\nexport const cache = {\r\n  data: {},\r\n  set(key, data) {\r\n    this.data[key] = data;\r\n  },\r\n  get(key) {\r\n    return this.data[key];\r\n  },\r\n  clear(key) {\r\n    delete this.data[key];\r\n  },\r\n};\r\n\r\n// å»ºç«‹å”¯ä¸€çš„keyå€¼\r\nexport const buildUniqueUrl = (url, method, params = {}, data = {}) => {\r\n  const paramStr = (obj) => {\r\n    if (toString.call(obj) === '[object Object]') {\r\n      return JSON.stringify(\r\n        Object.keys(obj)\r\n          .sort()\r\n          .reduce((result, key) => {\r\n            result[key] = obj[key];\r\n            return result;\r\n          }, {})\r\n      );\r\n    } else {\r\n      return JSON.stringify(obj);\r\n    }\r\n  };\r\n  url += `?${paramStr(params)}&${paramStr(data)}&${method}`;\r\n  return url;\r\n};\r\n\r\n// é˜²æ­¢é‡å¤è¯·æ±‚\r\nexport default (options = {}) =>\r\n  async (config) => {\r\n    const defaultOptions = {\r\n      // è®¾ç½®ä¸º0ï¼Œä¸æ¸…é™¤ç¼“å­˜\r\n      time: 0,\r\n      ...options,\r\n    };\r\n    const index = buildUniqueUrl(config.url, config.method, config.params, config.data);\r\n    let responsePromise = cache.get(index);\r\n    if (!responsePromise) {\r\n      responsePromise = (async () => {\r\n        try {\r\n          const response = await axios.defaults.adapter(config);\r\n          return Promise.resolve(response);\r\n        } catch (reason) {\r\n          cache.clear(index);\r\n          return Promise.reject(reason);\r\n        }\r\n      })();\r\n      cache.set(index, responsePromise);\r\n      if (defaultOptions.time !== 0) {\r\n        setTimeout(() => {\r\n          cache.clear(index);\r\n        }, defaultOptions.time);\r\n      }\r\n    }\r\n    // ä¸ºé˜²æ­¢æ•°æ®æºæ±¡æŸ“\r\n    return responsePromise.then((data) => JSON.parse(JSON.stringify(data)));\r\n  };\r\n```\r\n\r\n### é£æ ¼ä¸€è‡´æ€§\r\n\r\né£æ ¼ä¸€è‡´æ€§åŒ…å«å¾ˆå¤šéƒ¨åˆ†ï¼Œè¿™é‡Œä¸å¤ªå¥½å…¨éƒ¨åˆ—ä¸¾ï¼Œå°±è¯´ä¸¤ä¸ªå¸¸è§çš„\r\n\r\n#### è§†è§‰é¢œè‰²ä¸€è‡´\r\n\r\næ¯ä¸ªé¡µé¢éƒ½æœ‰ä¸€ä¸ªä¸»è‰²å·ï¼Œå¯¹äºè®¾è®¡å›¾æˆ–è€…åŸå‹å›¾æ²¡æœ‰ç»™åˆ°çš„éƒ¨åˆ†ï¼Œè‡ªå·±åŠ¨æ‰‹æˆ–è€…å¼•ç”¨ç»„ä»¶æ—¶éœ€è¦è€ƒè™‘æ˜¯å¦è·Ÿä¸»è‰²å·å­˜åœ¨å†²çªï¼Œè¿™é‡Œæ¨èé˜…è¯»ä¸€ä¸‹`è§†è§‰è§„èŒƒ`ï¼Œä¸‹é¢ç»™å‡ºä¸€ä¸ªç¤ºä¾‹\r\n\r\n![2.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2efab79f3bf4429c852e5f7e4182a8ae~tplv-k3u1fbpfcp-watermark.image)\r\n\r\n![3.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4f0aabbe895d42f0b18b0bdd5b9a7698~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nåœ¨é»˜è®¤çš„ vant ç»„ä»¶ä¸­ï¼Œtab é»˜è®¤çš„é¢œè‰²æ˜¯`#ee0a24`ï¼Œå¦‚æœç›´æ¥æ”¾ä¸Šå»å°±ä¼šå¯¼è‡´é¡µé¢é£æ ¼ä¸ç»Ÿä¸€ï¼Œå› ä¸ºé¡µé¢æ•´ä½“é£æ ¼æ˜¯è“è‰²\r\n\r\n#### ç»„ä»¶äº¤äº’ä¸€è‡´æ€§\r\n\r\nè¿™é‡Œåœ¨è‡ªå®šä¹‰æ‰©å±•æˆ–è€…äºŒæ¬¡å°è£…æ¯”è¾ƒå¸¸è§ï¼Œè¿˜æ˜¯ä»¥è¡¨å•ä¸ºä¾‹\r\n\r\n![9.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/56f9f210d65e4ae9b23516548a1056e1~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nå¦‚æœæˆ‘ä»¬æƒ³è‡ªå®šä¹‰æ ¹æ®ä¸šåŠ¡è¿›è¡Œä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„ç»„ä»¶ï¼Œé™¤äº†è€ƒè™‘åŠŸèƒ½æœ¬èº«çš„å®ç°ï¼Œè¿˜è¦è€ƒè™‘ä¸€è‡´æ€§çš„é—®é¢˜ï¼Œä¾‹å¦‚æ ¡éªŒçš„é—®é¢˜\r\n\r\nè¿™é‡Œ`Ant Design `åœ¨ä¸ç¬¦åˆæ¡ä»¶çš„`form-item`ä¸‹é¢å‡ºç°ä¸€ä¸ªçº¢å­—æç¤ºï¼Œè€Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨`message`æˆ–è€…å…¶ä»–æç¤ºå°±ä¼šé€ æˆæç¤ºä¿¡æ¯çš„ä¸ä¸€è‡´æ€§ï¼Œé‚£æ›´å¥½çš„åšæ³•å°±æ˜¯æ ¹æ®å®˜æ–¹æ–‡æ¡£æä¾›çš„è‡ªå®šä¹‰æ’ä»¶åšæ³•è¿›è¡Œç»„ä»¶å¼€å‘ã€‚\r\n\r\n## pc\r\n\r\n### è€ƒè™‘æœ€å°å¸ƒå±€\r\n\r\nè¯·è®¾ç½®`min-width`ï¼Œé˜²æ­¢å› ä¸ºå®½åº¦ä¸å¤Ÿå¯¼è‡´å…ƒç´ æŒ¤åœ¨ä¸€èµ·\r\n\r\n```css\r\nbody {\r\n  /* çœç•¥å…¶å®ƒ */\r\n  min-width: 1200px;\r\n  overflow: auto;\r\n}\r\n```\r\n\r\n### è¡¨æ ¼å®½åº¦\r\n\r\nå¯¹äºè¡¨æ ¼ï¼Œæ ¹æ®å­—æ®µçš„æƒå€¼ä¸åŒåˆ†é…çš„å®½åº¦ä¹Ÿåº”è¯¥ä¸åŒï¼Œå°½é‡ä¸è¦ä½¿ç”¨`auto`é¿å…äºŒæ¬¡è¡¨æ ¼å®½åº¦è®¡ç®—é€ æˆè§†è§‰ä¸Šçš„æµ®åŠ¨\r\n\r\n![13.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d295a4f0c4544388b1190c62b862bd3c~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nå¯¹äºä¸å¯çœç•¥çš„ä¿¡æ¯å¯ä»¥è®©å…¶æ¢è¡Œå±•ç¤ºï¼Œå¦åˆ™è¯·è€ƒè™‘`ellipsis`\r\n\r\n```css\r\n.ellipsis {\r\n  overflow: hidden;\r\n  white-space: nowrap;\r\n  text-overflow: ellipsis;\r\n}\r\n```\r\n\r\n### æŒ‡æ ‡å¡ç‰‡æ·»åŠ  tip\r\n\r\nåœ¨ä¸€äº›ä¸­å°äº§å“ä¸­ï¼Œå¾ˆå®¹æ˜“é‡åˆ°ä¸€äº›ä¸“ä¸šåè¯ï¼Œæ¯”å¦‚`pv`å’Œ`uv`ç­‰ï¼Œå¯¹äºè¿™ç§ä¸“ä¸šåè¯ï¼Œå»ºè®®æ·»åŠ ä¸€ä¸ªé—®å·çš„æç¤ºå›¾æ ‡ï¼Œé¼ æ ‡ç§»åŠ¨ä¸Šå»ç»™ä¸æç¤º\r\n\r\n![14.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fc35ab89bc294f45b7c0c070d527ec9e~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nä¸Šé¢æ•ˆæœä»…ä¾›å‚è€ƒ\r\n\r\n### æ”¯æŒé”®ç›˜å¿«æ·é”®\r\n\r\n![9.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6a0349131f50469e85f9efbeb0934b2f~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåœ¨æˆ‘ä»¬ä½¿ç”¨`form`æˆ–è€…`input`æ—¶ï¼Œå¦‚æœæŒ‰ä¸‹`enter`æ—¶è¯·ç¡®ä¿å¯ä»¥è¿›è¡Œæ­£å¸¸çš„æœç´¢æˆ–è€…æäº¤æ“ä½œï¼Œä¸ä»…å±€é™äºè¡¨å•æäº¤ï¼Œå¯¹äºä¸€äº›å¸¸è§çš„æœç´¢åœºæ™¯éƒ½éœ€è¦è€ƒè™‘\r\n\r\nä¸€ä¸ªå¥½çš„å»ºè®®ï¼Œå¯¹äºéœ€è¦ submit çš„å­å…ƒç´ ï¼Œéƒ½ç»‘å®š`.enter`ä¿®é¥°ç¬¦\r\n\r\n```vue\r\n<input @keyup.enter=\"submit\" />\r\n```\r\n\r\n### SPA è·¯ç”±å¯¼èˆª\r\n\r\nå¯¹äºå•é¡µé¢å¯¼èˆªè¯·è€ƒè™‘ä½¿ç”¨[nprogress](https://github.com/rstacruz/nprogress)è¿™æ ·çš„è¿›åº¦æ¡ï¼Œä¸ºä½ çš„é¡µé¢æ·»åŠ è¿›åº¦é€šçŸ¥\r\n\r\n![15.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7b2a1bf70cab4c279339f2e11ef5e5e0~tplv-k3u1fbpfcp-watermark.image)\r\n\r\n## ç§»åŠ¨ç«¯\r\n\r\n### å·¦å³æ»‘åŠ¨ç›‘å¬\r\n\r\næµè§ˆäº†è®¸å¤š H5 çš„é¡µé¢ï¼Œå¯¹äºæ‰‹åŠ¿å·¦å³æ»‘åŠ¨åŸºæœ¬ä¸Šéƒ½æ²¡åšæ”¯æŒï¼Œè€Œåœ¨å¾ˆå¤š App ä¸Šï¼Œä¾‹å¦‚çŸ¥ä¹ï¼Œä»é¦–é¡µè¿›å»é—®é¢˜å·¦æ»‘å°±å¯ä»¥è¿”å›\r\n\r\n![å¾®ä¿¡å›¾ç‰‡_20210608100923.jpg](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5e1ef02488054521999304fe663d9867~tplv-k3u1fbpfcp-watermark.image)\r\n\r\nè¿™é‡Œç¨å¾®å»ºè®®ä¸€ä¸‹ï¼Œå¯¹äºä¸‹é¢ä¸¤ç§æƒ…å†µå¯ä»¥è€ƒè™‘å¼•å…¥å·¦æ»‘è¿”å›\r\n\r\n- è·Ÿä¸Šé¢å›¾ç‰‡ä¸€è‡´çš„ tab é¡µæ¯”è¾ƒå¤šï¼Œå¯ä»¥è€ƒè™‘åšæˆ tab ä¸‹çš„å…ƒç´ æ»‘åŠ¨ç›‘å¬\r\n- å¯¹äºä¸€äº›åˆ—è¡¨å’Œè¯¦æƒ…é¡µ\r\n\r\næ¨èä¸€ä¸ªåº“æºç ä¹Ÿå¾ˆç®€æ´å¯ä»¥åŸºäºè¿™ä¸ªåº“è¿›è¡ŒäºŒæ¬¡å°è£…ï¼Œæé«˜ç”¨æˆ·çš„ä½“éªŒ [swipy](https://github.com/whitecube/swipy)\r\n\r\n### å°½é‡ä½¿ç”¨ SVG\r\n\r\nSVG æ˜¯ä¸€ç§å›¾åƒæ–‡ä»¶æ ¼å¼ï¼Œå®ƒçš„è‹±æ–‡å…¨ç§°ä¸º Scalable Vector Graphicsï¼Œæ„æ€ä¸ºå¯ç¼©æ”¾çš„çŸ¢é‡å›¾å½¢ã€‚åŸºäº XML çš„æ ‡è®°è¯­è¨€\r\n\r\nSVG æ˜¯çŸ¢é‡å›¾ï¼Œå®ƒæœ‰å¾ˆå¤šä¼˜ç‚¹\r\n\r\n- SVG æ˜¯å¯ä¼¸ç¼©çš„ï¼Œåœ¨ä»»ä½•çš„åˆ†è¾¨ç‡ä¸‹è¢«é«˜è´¨é‡åœ°æ‰“å°\r\n- SVG å¯åœ¨å›¾åƒè´¨é‡ä¸ä¸‹é™çš„æƒ…å†µä¸‹è¢«æ”¾å¤§\r\n- ä¿®æ”¹æ–¹ä¾¿ï¼Œå¯ä»¥åœ¨è®°äº‹æœ¬ä¹‹ç±»çš„è½¯ä»¶ä¸­è¢«æ‰“å¼€\r\n\r\nè€Œåœ¨å¼€å‘ç§»åŠ¨ç«¯ï¼Œé¢å¯¹çš„ç”¨æˆ·æ‰‹æœºçš„å±å¹•ä¹Ÿå„ä¸ç›¸åŒï¼Œä¹‹å‰çš„åšæ³•æ˜¯å¯¹ä¸åŒ ratio çš„æ‰‹æœºé€‰æ‹©ä¸åŒçš„å›¾ç‰‡ï¼Œä½†æ˜¯æ ¹æ®ä¸Šé¢ SVG çš„ä¼˜ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€‰ç”¨ SVG å½“åšå›¾ç‰‡\r\n\r\nè€Œåœ¨ SVG ä¸é€‚ç”¨çš„åœºæ™¯ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨åª’ä½“æŸ¥è¯¢ï¼Œé€‰æ‹©åˆé€‚çš„é«˜å€å›¾\r\n\r\n```js\r\nexport const getMultipleImg = (img1, img2) => {\r\n  const mql = window.matchMedia('@media only screen and (-webkit-min-device-pixel-ratio:3)');\r\n  if (mql.matches) {\r\n    return img2;\r\n  }\r\n  return img1;\r\n};\r\n```\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/72/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/72/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/73",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/73/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/73/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/73/events",
          "html_url": "https://github.com/bosens-China/blog/issues/73",
          "id": 914211223,
          "node_id": "MDU6SXNzdWU5MTQyMTEyMjM=",
          "number": 73,
          "title": "å›¢é˜Ÿè§„èŒƒç³»åˆ—ä¹‹å‘½åè§„èŒƒ",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 3661376441,
              "node_id": "LA_kwDOCzPAy87aPCu5",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83",
              "name": "ä»£ç è§„èŒƒ",
              "color": "5319e7",
              "default": false,
              "description": "å›¢é˜Ÿè§„èŒƒã€ä»£ç è§„èŒƒã€æŠ€æœ¯é€‰å‹ç­‰ç›¸å…³å†…å®¹"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2021-06-08T02:53:40Z",
          "updated_at": "2021-12-21T10:00:13Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "![bg](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4b7b48b9a67c44eab564bf46e99f1ee0~tplv-k3u1fbpfcp-zoom-1.image)\r\n\r\næœ€è¿‘ä¸€å‘¨çš„å·¥ä½œé‡å¿ƒå°±æ˜¯åœ¨æ¢³ç†å›¢é˜Ÿè§„èŒƒï¼Œåœ¨å†™çš„è¿‡ç¨‹ä¹ŸæŸ¥ç¼ºè¡¥æ¼äº†ä¸å°‘çŸ¥è¯†ï¼Œå‰”é™¤æ‰å…³äºå…¬å¸åœºæ™¯çš„éƒ¨åˆ†å°±æœ‰äº†è¿™ä¸€ç³»åˆ—çš„æ–‡ç« ï¼Œé¢„è®¡å†™å››éƒ¨åˆ†ï¼š\r\n\r\n1. [git è§„èŒƒ](https://github.com/bosens-China/blog/issues/70)\r\n2. [å·¥ç¨‹è§„èŒƒ](https://github.com/bosens-China/blog/issues/71)\r\n3. [ç”¨æˆ·ä½“éªŒè§„èŒƒ](https://github.com/bosens-China/blog/issues/72)\r\n4. å‘½åè§„èŒƒ\r\n\r\n# å‘½åè§„èŒƒ\r\n\r\nå‘½åè§„èŒƒè¯·ç»“åˆå›¢é˜Ÿæƒ…å†µæ¥è¿›è¡Œåˆ¶å®šï¼Œå¦‚æœæƒ³æ›´è¿›é˜¶ä¸€äº›å¯ä»¥é…åˆ git é’©å­å†™æ ¡éªŒå·¥å…·ï¼Œé…åˆè§„èŒƒé£Ÿç”¨\r\n\r\n## ä»£ç å‘½åè§„èŒƒ\r\n\r\n### é¿å…ç”¨ä¸€ä¸ªå­—æ¯å‘½å\r\n\r\n```js\r\n// bad\r\nfunction q() {\r\n  // ...\r\n}\r\n\r\n// good\r\nfunction query() {\r\n  // ...\r\n}\r\n```\r\n\r\n### ç”¨å°é©¼å³°å‘½åæ³•æ¥å‘½åä½ çš„å¯¹è±¡ã€å‡½æ•°ã€å®ä¾‹\r\n\r\n```js\r\n// bad\r\nconst OBJEcttsssss = {};\r\nconst this_is_my_object = {};\r\nfunction c() {}\r\n\r\n// good\r\nconst thisIsMyObject = {};\r\nfunction thisIsMyFunction() {}\r\n```\r\n\r\n### ç”¨å¤§é©¼å³°å‘½åæ³•æ¥å‘½åç±»\r\n\r\n```js\r\n// bad\r\nfunction user(options) {\r\n  this.name = options.name;\r\n}\r\n\r\nconst bad = new user({\r\n  name: 'nope',\r\n});\r\n\r\n// good\r\nclass User {\r\n  constructor(options) {\r\n    this.name = options.name;\r\n  }\r\n}\r\n\r\nconst good = new User({\r\n  name: 'yup',\r\n});\r\n```\r\n\r\n### ä¸è¦ç”¨å‰ç½®æˆ–åç½®ä¸‹åˆ’çº¿\r\n\r\nJavaScript æ²¡æœ‰ç§æœ‰å±æ€§æˆ–ç§æœ‰æ–¹æ³•çš„æ¦‚å¿µã€‚å°½ç®¡å‰ç½®ä¸‹åˆ’çº¿é€šå¸¸çš„æ¦‚å¿µä¸Šæ„å‘³ç€ç§æœ‰ï¼Œäº‹å®ä¸Šï¼Œè¿™äº›å±æ€§æ˜¯å®Œå…¨å…¬æœ‰çš„ï¼Œå› æ­¤è¿™éƒ¨åˆ†ä¹Ÿæ˜¯ä½ çš„ API çš„å†…å®¹ã€‚è¿™ä¸€æ¦‚å¿µå¯èƒ½ä¼šå¯¼è‡´å¼€å‘è€…è¯¯ä»¥ä¸ºæ›´æ”¹è¿™ä¸ªä¸ä¼šå¯¼è‡´å´©æºƒæˆ–è€…ä¸éœ€è¦æµ‹è¯•ã€‚å¦‚æœä½ æƒ³è¦ä»€ä¹ˆä¸œè¥¿å˜æˆç§æœ‰ï¼Œé‚£å°±ä¸è¦è®©å®ƒåœ¨è¿™é‡Œå‡ºç°ã€‚\r\n\r\n```js\r\n// bad\r\nthis.__firstName__ = 'Panda';\r\nthis.firstName_ = 'Panda';\r\nthis._firstName = 'Panda';\r\n\r\n// good\r\nthis.firstName = 'Panda';\r\n```\r\n\r\n### export\r\n\r\n#### export-default å¯¼å‡ºåç§°ä¸ import å¼•ç”¨åç§°ä¿æŒä¸€è‡´\r\n\r\nä¾‹å¦‚ï¼š`export-default æ¨¡å— A`ï¼Œåˆ™è¿™ä¸ªæ–‡ä»¶åä¹Ÿå« `A`ï¼Œ import æ—¶å€™çš„å‚æ•°ä¹Ÿå« `A`ã€‚ å¤§å°å†™å®Œå…¨ä¸€è‡´ã€‚\r\n\r\n```js\r\n// file 1 contents\r\nclass CheckBox {\r\n  // ...\r\n}\r\nexport default CheckBox;\r\n\r\n// file 2 contents\r\nexport default function fortyTwo() { return 42; }\r\n\r\n// file 3 contents\r\nexport default function insideDirectory() {}\r\n\r\n// in some other file\r\n// bad\r\nimport CheckBox from './checkBox'; // PascalCase import/export, camelCase filename\r\nimport FortyTwo from './FortyTwo'; // PascalCase import/filename, camelCase export\r\nimport InsideDirectory from './InsideDirectory'; // PascalCase import/filename, camelCase export\r\n\r\n// bad\r\nimport CheckBox from './check_box'; // PascalCase import/export, snake_case filename\r\nimport forty_two from './forty_two'; // snake_case import/filename, camelCase export\r\nimport inside_directory from './inside_directory'; // snake_case import, camelCase export\r\nimport index from './inside_directory/index'; // requiring the index file explicitly\r\nimport insideDirectory from './insideDirectory/index'; // requiring the index file explicitly\r\n\r\n// good\r\nimport CheckBox from './CheckBox'; // PascalCase export/import/filename\r\nimport fortyTwo from './fortyTwo'; // camelCase export/import/filename\r\nimport insideDirectory from './insideDirectory'; // camelCase export/import/directory name/implicit \"index\"\r\n// ^ supports both insideDirectory.js and insideDirectory/index.js\r\n```\r\n\r\n#### export-default ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œå‡½æ•°åç”¨å°é©¼å³°ï¼Œæ–‡ä»¶åéœ€è¦å’Œå‡½æ•°åä¸€è‡´\r\n\r\n```js\r\nfunction makeStyleGuide() {\r\n  // ...\r\n}\r\n\r\nexport default makeStyleGuide;\r\n```\r\n\r\n#### export ä¸€ä¸ªç»“æ„ä½“/ç±»/å•ä¾‹/å‡½æ•°åº“/å¯¹è±¡ æ—¶ç”¨å¤§é©¼å³°\r\n\r\n```js\r\nconst AirbnbStyleGuide = {\r\n  es6: {},\r\n};\r\n\r\nexport default AirbnbStyleGuide;\r\n```\r\n\r\n### ç®€ç§°å’Œç¼©å†™åº”è¯¥å…¨éƒ¨å¤§å†™æˆ–å…¨éƒ¨å°å†™\r\n\r\n```js\r\n// bad\r\nimport SmsContainer from './containers/SmsContainer';\r\n\r\n// bad\r\nconst HttpRequests = [\r\n  // ...\r\n];\r\n\r\n// good\r\nimport SMSContainer from './containers/SMSContainer';\r\n\r\n// good\r\nconst HTTPRequests = [\r\n  // ...\r\n];\r\n\r\n// also good\r\nconst httpRequests = [\r\n  // ...\r\n];\r\n\r\n// best\r\nimport TextMessageContainer from './containers/TextMessageContainer';\r\n\r\n// best\r\nconst requests = [\r\n  // ...\r\n];\r\n```\r\n\r\n### å¯¼å‡ºé™æ€å˜é‡\r\n\r\nå¦‚æœå¯¼å‡ºé™æ€å˜é‡ï¼Œå®ƒéœ€è¦ä»¥ä¸‹æ¡ä»¶ï¼š\r\n\r\n- ç¡®ä¿è¢«å¯¼å‡º\r\n- å°½é‡å…¨éƒ¨å¤§å†™\r\n- const å®šä¹‰çš„ï¼Œä¿è¯ä¸èƒ½è¢«æ”¹å˜\r\n- å¦‚æœå¯¼å‡ºå¯¹è±¡ï¼Œè¿™ä¸ªå˜é‡æ˜¯å¯ä¿¡çš„ï¼Œä»–çš„å­å±æ€§éƒ½æ˜¯ä¸èƒ½è¢«æ”¹å˜çš„\r\n\r\n```js\r\n// bad\r\nconst PRIVATE_VARIABLE = 'should not be unnecessarily uppercased within a file';\r\n// bad\r\nexport const THING_TO_BE_CHANGED = 'should obviously not be uppercased';\r\n// bad\r\nexport let REASSIGNABLE_VARIABLE = 'do not use let with uppercase variables';\r\n// å…è®¸ä½†ä¸å¤Ÿè¯­ä¹‰åŒ–\r\nexport const apiKey = 'SOMEKEY';\r\n// æ›´å¥½çš„\r\nexport const API_KEY = 'SOMEKEY';\r\n\r\n// bad ä¸å¿…è¦çš„å¤§å†™é”®ï¼Œæ²¡æœ‰å¢åŠ ä»»ä½•è¯­ä¹‰\r\nexport const MAPPING = {\r\n  KEY: 'value',\r\n};\r\n// good\r\nexport const MAPPING = {\r\n  key: 'value',\r\n};\r\n```\r\n\r\n## CSS å‘½åè§„èŒƒ\r\n\r\ncss å‘½åè§„èŒƒæœ‰å¾ˆå¤šæ–¹æ¡ˆï¼Œè¿™é‡Œé‡‡ç”¨`BEM`ä½œä¸ºè§„èŒƒï¼Œä¹‹æ‰€ä»¥é‡‡ç”¨ `BEM` æ˜¯å› ä¸ºå®ƒè®©ä½ çš„å‰ç«¯ä»£ç æ›´å®¹æ˜“é˜…è¯»å’Œç†è§£ï¼Œæ›´å®¹æ˜“åä½œï¼Œæ›´å®¹æ˜“æ§åˆ¶ï¼Œæ›´åŠ å¥å£®å’Œæ˜ç¡®ï¼Œè€Œä¸”æ›´åŠ ä¸¥å¯†ã€‚\r\n\r\nä¸‹é¢ä»‹ç»ä¸€äº›ç›¸å…³çš„æ¦‚å¿µï¼Œä»¥åŠå¦‚ä½•ä¹¦å†™\r\n\r\n### ä»€ä¹ˆæ˜¯ BEM å‘½åè§„èŒƒ\r\n\r\nBem æ˜¯å—ï¼ˆblockï¼‰ã€å…ƒç´ ï¼ˆelementï¼‰ã€ä¿®é¥°ç¬¦ï¼ˆmodifierï¼‰çš„ç®€å†™ï¼Œç”± Yandex å›¢é˜Ÿæå‡ºçš„ä¸€ç§å‰ç«¯ CSS å‘½åæ–¹æ³•è®ºã€‚\r\n\r\n- ä¸­åˆ’çº¿ ï¼šä»…ä½œä¸ºè¿å­—ç¬¦ä½¿ç”¨ï¼Œè¡¨ç¤ºæŸä¸ªå—æˆ–è€…æŸä¸ªå­å…ƒç´ çš„å¤šå•è¯ä¹‹é—´çš„è¿æ¥è®°å·ã€‚\r\n\r\n- åŒä¸‹åˆ’çº¿ï¼šåŒä¸‹åˆ’çº¿ç”¨æ¥è¿æ¥å—å’Œå—çš„å­å…ƒç´ \r\n\r\n- å•ä¸‹åˆ’çº¿ï¼šå•ä¸‹åˆ’çº¿ç”¨æ¥æè¿°ä¸€ä¸ªå—æˆ–è€…å—çš„å­å…ƒç´ çš„ä¸€ç§çŠ¶æ€\r\n\r\n### BEM å‘½åæ¨¡å¼\r\n\r\næ ¹æ®ä¸Šé¢æ¡ä»¶ï¼Œä¸‹é¢å†™ä¸€ä¸ªç¤ºä¾‹\r\n\r\n```css\r\n.block {\r\n}\r\n\r\n.block__element {\r\n}\r\n\r\n.block--modifier {\r\n}\r\n```\r\n\r\nä»”ç»†è§‚å¯Ÿä¸Šé¢ç»“æ„å¯ä»¥å¾—åˆ°ä¸‰ä¸ªä¿¡æ¯ï¼š\r\n\r\n- æ¯ä¸€ä¸ªå—(block)ååº”è¯¥æœ‰ä¸€ä¸ªå‘½åç©ºé—´ï¼ˆå‰ç¼€ï¼‰\r\n- `block__element` ä»£è¡¨ `.block` çš„åä»£ï¼Œç”¨äºå½¢æˆä¸€ä¸ªå®Œæ•´çš„ `.block` çš„æ•´ä½“\r\n- `block--modifier` ä»£è¡¨ `.block` çš„ä¸åŒçŠ¶æ€æˆ–ä¸åŒç‰ˆæœ¬\r\n\r\nä½¿ç”¨ä¸¤ä¸ªè¿å­—ç¬¦å’Œä¸‹åˆ’çº¿è€Œä¸æ˜¯ä¸€ä¸ªï¼Œæ˜¯ä¸ºäº†è®©ä½ è‡ªå·±çš„å—å¯ä»¥ç”¨å•ä¸ªè¿å­—ç¬¦æ¥ç•Œå®šã€‚å¦‚ï¼š\r\n\r\n```css\r\n.sub-block__element {\r\n}\r\n\r\n.sub-block--modifier {\r\n}\r\n```\r\n\r\n### ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ BEM å‘½å\r\n\r\n- ä½ è¦çŸ¥é“ä»€ä¹ˆæ—¶å€™å“ªäº›ä¸œè¥¿æ˜¯åº”è¯¥å†™æˆ BEM æ ¼å¼çš„\r\n\r\næˆ–è€…è¯´ä½ è¦äº‹å…ˆçŸ¥é“æ•ˆæœå›¾æˆ–è€… dom ç»“æ„åº”å½“æ˜¯ä¸€ä¸ªä»€ä¹ˆæ ·å­çš„\r\n\r\n- åªæœ‰æ¨¡å—æˆ–è€…ç»„ä»¶æœ‰å…³è”çš„æ—¶å€™æ‰ä½¿ç”¨ BEM æ ¼å¼\r\n\r\n- å•ç‹¬çš„æ ·å¼ï¼Œæ²¡æœ‰å¿…è¦ä½¿ç”¨ BEM å‘½å\r\n\r\n```css\r\n.hide {\r\n  display: none !important;\r\n}\r\n```\r\n\r\n### ä¸é¢„å¤„ç†å™¨ç»“åˆ\r\n\r\nBEM å†™èµ·æ¥å¯èƒ½ä¼šå­˜åœ¨å‘½åå¾ˆé•¿ï¼Œä½†æ˜¯å¦‚æœæœ‰ less ä¹‹ç±»çš„é¢„å¤„ç†å™¨å°±èƒ½èŠ‚çœæˆ‘ä»¬å¾ˆå¤šæ—¶é—´ï¼Œä¸‹é¢ä»¥ less ä¸ºä¾‹\r\n\r\n```less\r\n.article {\r\n  max-width: 1200px;\r\n  &__body {\r\n    padding: 20px;\r\n  }\r\n  &__button {\r\n    padding: 5px 8px;\r\n    &--primary {\r\n      background: blue;\r\n    }\r\n    &--success {\r\n      background: green;\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n### åœ¨ Vue ä¸­ä½¿ç”¨\r\n\r\nVue ä¸ºäº†ç®€ä¾¿å¼€å‘æä¾›äº† `scope` çš„ css è¯­æ³•ç³–ï¼Œä½†æ˜¯åœ¨ BEM ä¸­å¹¶ä¸æ¨èï¼Œå› ä¸ºä½¿ç”¨`scope`çš„ç›®çš„å°±æ˜¯é¿å…æ ·å¼å†²çªï¼Œè€Œ BEM æœ¬èº«å°±å·²ç»å¯ä»¥åšåˆ°äº†ã€‚\r\n\r\n```vue\r\n<template>\r\n  <form class=\"form form--theme-xmas form--simple\">\r\n    <input class=\"form__input\" type=\"text\" />\r\n    <input class=\"form__submit form__submit--disabled\" type=\"submit\" />\r\n  </form>\r\n</template>\r\n\r\n<script lang=\"css\">\r\n.form { }\r\n.form--theme-xmas { }\r\n.form--simple { }\r\n.form__input { }\r\n.form__submit { }\r\n.form__submit--disabled { }\r\n</script>\r\n```\r\n\r\n## ç»„ä»¶å‘½åè§„èŒƒ\r\n\r\n### æ–‡ä»¶ååº”å§‹ç»ˆå•è¯å¤§å†™å¼€å¤´æˆ–æ¨ªçº¿è¿æ¥\r\n\r\nå•è¯å¤§å†™å¼€å¤´å¯¹äºä»£ç ç¼–è¾‘å™¨çš„è‡ªåŠ¨è¡¥å…¨æœ€ä¸ºå‹å¥½ï¼Œå› ä¸ºè¿™ä½¿å¾—æˆ‘ä»¬åœ¨ `JS(X)` å’Œæ¨¡æ¿ä¸­å¼•ç”¨ç»„ä»¶çš„æ–¹å¼å°½å¯èƒ½çš„ä¸€è‡´ã€‚ç„¶è€Œï¼Œæ··ç”¨æ–‡ä»¶å‘½åæ–¹å¼æœ‰çš„æ—¶å€™ä¼šå¯¼è‡´å¤§å°å†™ä¸æ•æ„Ÿçš„æ–‡ä»¶ç³»ç»Ÿçš„é—®é¢˜ï¼Œè¿™ä¹Ÿæ˜¯æ¨ªçº¿è¿æ¥å‘½ååŒæ ·å®Œå…¨å¯å–çš„åŸå› ã€‚\r\n\r\n```sh\r\n# bad\r\ncomponents/\r\n|- mycomponent.vue\r\n```\r\n\r\n```sh\r\ncomponents/\r\n|- myComponent.vue\r\n```\r\n\r\n```sh\r\n# good\r\ncomponents/\r\n|- TodoList.js\r\n|- TodoItem.js\r\n```\r\n\r\n```sh\r\n# good\r\ncomponents/\r\n|- TodoList.vue\r\n|- TodoItem.vue\r\n```\r\n\r\n### åŸºç¡€ç»„ä»¶ä»¥ä¸€ä¸ªç‰¹å®šçš„å‰ç¼€å¼€å¤´\r\n\r\nåº”ç”¨ç‰¹å®šæ ·å¼å’Œçº¦å®šçš„åŸºç¡€ç»„ä»¶ (ä¹Ÿå°±æ˜¯å±•ç¤ºç±»çš„ã€æ— é€»è¾‘çš„æˆ–æ— çŠ¶æ€çš„ç»„ä»¶) åº”è¯¥å…¨éƒ¨ä»¥ä¸€ä¸ªç‰¹å®šçš„å‰ç¼€å¼€å¤´ï¼Œæ¯”å¦‚ `Base`ã€`App` æˆ– `V`ã€‚\r\n\r\n```sh\r\n# bad\r\ncomponents/\r\n|- MyButton.vue\r\n|- VueTable.vue\r\n|- Icon.vue\r\n```\r\n\r\n```sh\r\n# good\r\ncomponents/\r\n|- BaseButton.vue\r\n|- BaseTable.vue\r\n|- BaseIcon.vue\r\n# or\r\ncomponents/\r\n|- AppButton.vue\r\n|- AppTable.vue\r\n|- AppIcon.vue\r\n# or\r\ncomponents/\r\n|- VButton.vue\r\n|- VTable.vue\r\n|- VIcon.vue\r\n```\r\n\r\n### ä¸€æ¬¡æ€§ç»„ä»¶å‘½å\r\n\r\nå•ä¸ªæ´»è·ƒå®ä¾‹çš„ç»„ä»¶åº”è¯¥ä»¥ `The` å‰ç¼€å‘½åï¼Œä»¥ç¤ºå…¶å”¯ä¸€æ€§ã€‚\r\n\r\nè¿™ä¸æ„å‘³ç€ç»„ä»¶åªå¯ç”¨äºä¸€ä¸ªå•é¡µé¢ï¼Œè€Œæ˜¯æ¯ä¸ªé¡µé¢åªä½¿ç”¨ä¸€æ¬¡ã€‚è¿™äº›ç»„ä»¶æ°¸è¿œä¸æ¥å—ä»»ä½• `prop`ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ä¸ºä½ çš„åº”ç”¨å®šåˆ¶çš„ï¼Œè€Œä¸æ˜¯å®ƒä»¬åœ¨ä½ çš„åº”ç”¨ä¸­çš„ä¸Šä¸‹æ–‡ã€‚å¦‚æœä½ å‘ç°æœ‰å¿…è¦æ·»åŠ  `prop`ï¼Œé‚£å°±è¡¨æ˜è¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ªå¯å¤ç”¨çš„ç»„ä»¶ï¼Œåªæ˜¯ç›®å‰åœ¨æ¯ä¸ªé¡µé¢é‡Œåªä½¿ç”¨ä¸€æ¬¡ã€‚\r\n\r\n```sh\r\n# bad\r\ncomponents/\r\n|- Heading.vue\r\n|- MySidebar.vue\r\n```\r\n\r\n```sh\r\n# good\r\ncomponents/\r\n|- TheHeading.vue\r\n|- TheSidebar.vue\r\n```\r\n\r\n### ç»„ä»¶å‘½åè¯·ä¿æŒå…³è”\r\n\r\nå’Œçˆ¶ç»„ä»¶ç´§å¯†è€¦åˆçš„å­ç»„ä»¶åº”è¯¥ä»¥çˆ¶ç»„ä»¶åä½œä¸ºå‰ç¼€å‘½åã€‚\r\n\r\nå¦‚æœä¸€ä¸ªç»„ä»¶åªåœ¨æŸä¸ªçˆ¶ç»„ä»¶çš„åœºæ™¯ä¸‹æœ‰æ„ä¹‰ï¼Œè¿™å±‚å…³ç³»åº”è¯¥ä½“ç°åœ¨å…¶åå­—ä¸Šã€‚å› ä¸ºç¼–è¾‘å™¨é€šå¸¸ä¼šæŒ‰å­—æ¯é¡ºåºç»„ç»‡æ–‡ä»¶ï¼Œæ‰€ä»¥è¿™æ ·åšå¯ä»¥æŠŠç›¸å…³è”çš„æ–‡ä»¶æ’åœ¨ä¸€èµ·ã€‚\r\n\r\n```sh\r\n# bad\r\ncomponents/\r\n|- TodoList.vue\r\n|- TodoItem.vue\r\n|- TodoButton.vue\r\n```\r\n\r\n```sh\r\n# good\r\ncomponents/\r\n|- TodoList.vue\r\n|- TodoListItem.vue\r\n|- TodoListItemButton.vue\r\n```\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/73/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/73/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        }
      ]
    ],
    [
      "1371686609",
      [
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/91",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/91/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/91/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/91/events",
          "html_url": "https://github.com/bosens-China/blog/issues/91",
          "id": 1187970892,
          "node_id": "I_kwDOCzPAy85Gzv9M",
          "number": 91,
          "title": "yarn.lock å¼•å‘çš„è¡€æ¡ˆ",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1371686609,
              "node_id": "MDU6TGFiZWwxMzcxNjg2NjA5",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/JavaScript",
              "name": "JavaScript",
              "color": "F7DF1E",
              "default": false,
              "description": "JavaScriptç³»åˆ—çš„æ–‡ç« "
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2022-03-31T11:59:44Z",
          "updated_at": "2022-04-08T11:14:47Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "æœ€è¿‘å¼€å‘é¡¹ç›®çš„æ—¶å€™é‡åˆ°ä¸€ä¸ªç¥å¥‡çš„ bugï¼Œåœ¨å›æ»šäº†æ— æ•°æ¬¡ä¹‹åç»ˆäºå®šä½åˆ°äº†é—®é¢˜ï¼Œå°±æ˜¯ yarn.lock å¼•èµ·çš„ï¼Œå½“æ—¶å‡çº§ç›¸å…³ä¾èµ–ç‰ˆæœ¬ä¸å°å¿ƒæŠŠ yanr.lock æ–‡ä»¶ç»™å¹²æ‰äº†ï¼Œå¯¼è‡´ä¾èµ–å¼•ç”¨çš„æ¨¡å—æœ‰é—®é¢˜ã€‚\r\n\r\nä¸è¿‡è¿™ä¹Ÿå¼•èµ·äº†æˆ‘çš„æ€è€ƒä¸ºä»€ä¹ˆ yarn è¦æœ‰ä¸€ä¸ª `yarn.lock` æ–‡ä»¶å‘¢ï¼Ÿæˆ–è€…è¯´ä¸ºä»€ä¹ˆç°ä»£çš„åŒ…å®‰è£…éƒ½éœ€è¦æœ‰ lock æ–‡ä»¶å‘¢ï¼Ÿä¾‹å¦‚ npm çš„å«åš [package-lock.json](http://nodejs.cn/learn/the-package-lock-json-file)ï¼Œpnpm çš„å«åš `pnpm-lock.yaml`ã€‚\r\n\r\nåé¢è°ƒæŸ¥äº†ä¸€ä¸‹å‘ç°å…¶å®æ˜¯ä¸ºäº†ç¡®è®¤ä¾èµ–å…³ç³»ï¼Œè¿™é‡Œä»¥ npm çš„å‘å±•å†å²è¿›è¡Œè®²è§£ã€‚\r\n\r\n## æ‰å¹³åŒ–ä¾èµ–å®‰è£…\r\n\r\nä¸‹é¢çš„ä¾‹å­éƒ½ä»¥è¿™å¼ ä¾èµ–å›¾ä¸ºä¾‹\r\n\r\n![relyon.jpeg](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a70906a65fcb4dab971ee37e894c1e15~tplv-k3u1fbpfcp-watermark.image?)\r\n\r\nåœ¨ npm5 ä¹‹å‰ä¹Ÿå°±æ˜¯è¿˜æ²¡æœ‰ package-lock.json ä¹‹å‰ï¼Œä¼šå°†æ‰€æœ‰çš„ä¾èµ–éƒ½ä¸‹è½½åˆ° `node_modules` ç›®å½•ä¸‹ï¼Œå¦‚æœä¾èµ–è¿˜ä¾èµ–å…¶ä»–ä¾èµ–å°±ä¼šç»§ç»­ä¸‹è½½åˆ°ä¾èµ–æœ¬èº«ä¸‹çš„ `node_modules`ä¸‹ï¼Œä¾‹å¦‚ä¸Šå›¾æ‰€ç¤ºæœ€ç»ˆä¼šç”Ÿæˆå¦‚ä¸‹ä¾èµ–å…³ç³»ã€‚\r\n\r\n```sh\r\nnode_modules\r\n  modules1\r\n    a:1.0\r\n    b:1.0\r\n  modules2\r\n    a:1.0\r\n    b:2.0\r\n```\r\n\r\nè¿™æ ·åšè™½ç„¶ä¸ä¼šé‡åˆ°ä¾èµ–ç®¡ç†é—®é¢˜ï¼Œä½†æ˜¯å¾ˆæ˜æ˜¾å ç”¨ç£ç›˜ç©ºé—´å¤ªå¤§äº†ã€‚\r\nä¾‹å¦‚ä¸Šé¢æœ‰ä¸€ä¸ªå…±åŒæ¨¡å—æ˜¯ `a:1.0`ï¼Œå¦‚æœèƒ½æŠŠç›¸åŒçš„ä¾èµ–æå–å‡ºæ¥ä¸å°±æ˜¯å¯ä»¥å¤§å¤§èŠ‚çœå®‰è£…æ—¶é•¿å˜›ï¼Ÿ\r\n\r\nè€Œä¸”æœ€å…³é”®çš„æ—¶å› ä¸ºåŒ…çš„æ–‡ä»¶ä½“ç§¯å¾ˆå°ï¼Œä¾èµ–ä¸€æ—¦å¤šèµ·æ¥åå¤è¯»å†™åè€Œæˆä¸ºæ€§èƒ½çš„ç“¶é¢ˆã€‚\r\n\r\nnpm5 ä¹‹åå°±å°è¯•äº†æ‰å¹³åŒ–å®‰è£…ï¼Œå®ƒçš„æ€æƒ³å¾ˆç®€å•å°±æ˜¯å®‰è£…çš„æ—¶å€™å¦‚æœæœ‰å­ä¾èµ–å°±å®‰è£…åˆ°æ ¹ç›®å½•ä¸‹çš„ `node_modules` ï¼Œå¦‚æœè¿˜æœ‰ä¾èµ–è·Ÿæ ¹ç›®å½•ä¸‹çš„ä¾èµ–å†²çªå°±å’Œ npm5 ä¹‹å‰çš„å¤„ç†æ–¹å¼ä¸€æ ·ï¼Œåœ¨å­ä¾èµ–çš„ç›®å½•ä¸‹æ–°å»º `node_modules` ç„¶åé‡å¤ã€‚\r\nä»¥ä¸Šé¢çš„ä¾‹å­æ¼”ç¤º\r\n\r\n```sh\r\nnpm i modules1 modules2\r\n```\r\n\r\nä¼šå¾—åˆ°è¿™æ ·ä¸€ä¸ªä¾èµ–\r\n\r\n```sh\r\nnode_modules\r\n  modules1\r\n  a:1.0\r\n  b:1.0\r\n  modules2\r\n    b:2.0\r\n```\r\n\r\nè¿™æ ·åšå¾ˆæ˜æ˜¾æ”¹å–„äº†å®‰è£…æ—¶é•¿å’ŒèŠ‚çœäº†ç£ç›˜ç©ºé—´ï¼Œä½†æ˜¯å¸¦æ¥äº†ä¸€ä¸ªå®‰è£…é¡ºåºçš„é—®é¢˜ï¼Œå°±æ˜¯ä¸Šé¢æ˜¯å®‰è£… module1 ä¸ºå¼€å§‹ï¼Œä½†æ˜¯å‡è®¾å®‰è£… module2 ä¸ºå¼€å§‹å‘¢ï¼Ÿ\r\n\r\n```sh\r\nnpm i modules2 modules1\r\n```\r\n\r\nä¼šå¾—åˆ°è¿™æ ·ä¸€ä¸ªä¾èµ–\r\n\r\n```sh\r\nnode_modules\r\n  modules1\r\n  a:1.0\r\n  b:2.0\r\n  modules2\r\n    b:1.0\r\n```\r\n\r\n> æ³¨æ„ï¼Œä¸Šé¢ä¸è€ƒè™‘ç½‘é€Ÿç­‰é¢å¤–æƒ…å†µ\r\n\r\nä¼šå‘ç°ç»“æ„å·²ç»å‘ç”Ÿäº†æ”¹å˜ã€‚\r\n\r\næ¸©ä¹ ä¸€ä¸‹æŸ¥æ‰¾æ¨¡å—çš„æ–¹å¼ï¼šå¦‚æœåœ¨å½“å‰ `node_modules` æ‰¾ä¸åˆ°æ—¶ä¼šæ€ä¹ˆæŸ¥æ‰¾ï¼Ÿä¼šç»§ç»­å‘ä¸ŠæŸ¥æ‰¾ï¼Œç›´åˆ°æœ€é¡¶å±‚ä¸ºæ­¢ã€‚\r\n\r\nè€Œ module1 import çš„å¾ˆæ˜æ˜¾æ˜¯æœŸå¾… `b:1.0` è¿™ä¸ªä¾èµ–ï¼Œæœ€ç»ˆå´å¾—åˆ°äº† `b:2.0` ä¾èµ–ã€‚è¿™å°±ç»™ä»£ç æ–°å¢äº†ä¸ç¡®å®šæ€§ï¼Œæˆ‘æœ€å¼€å§‹é‡åˆ°çš„é—®é¢˜å°±æ˜¯è¿™ä¸ªåŸå› å¾—æ¥çš„ã€‚\r\n\r\n## è§£å†³æ–¹å¼\r\n\r\nä¸Šé¢æ¼”ç¤ºäº†æ‰å¹³åŒ–ä¾èµ–å¯èƒ½é‡åˆ°çš„ä¾èµ–ä¸ç¡®å®šé—®é¢˜ï¼Œé‚£èƒ½ä¸èƒ½é€šè¿‡æ–°å¢ä¸€ä¸ªæ–‡ä»¶æ¥è®°å½•æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»å‘¢ï¼Œä¹‹åå®‰è£…çš„æ—¶å€™å¤ç”¨ï¼Ÿè¿™å°±æ˜¯ yanr.lockã€package-lock.lock å’Œ pnpm-lock.yml çš„ç”±æ¥ã€‚\r\n\r\nä¸è¿‡é™¤äº†é”å®š lock æ–‡ä»¶çš„è¿™ç§æ–¹å¼è¿˜æœ‰ä»€ä¹ˆæ–°çš„åŠæ³•å‘¢ï¼Ÿpnpm ç»™å‡ºäº†ç­”æ¡ˆï¼Œå¯ä»¥ç»§ç»­é‡‡ç”¨ npm5 ä¹‹å‰çš„å®‰è£…æ–¹å¼ + è½¯è¿æ¥æ¥è§£å†³ã€‚\r\n\r\nä¸Šé¢è¯´åˆ°å› ä¸ºå®‰è£…é‡å¤çš„æ¨¡å—å¯¼è‡´å®‰è£…æ•ˆç‡å¾ˆä½ï¼Œæ‰è¢«è¿«é‡‡ç”¨æå–å…¬å…±æ¨¡å—çš„æ‰å¹³åŒ–å®‰è£…ï¼Œä½†æ˜¯å¦‚æœæŠŠå½“å‰é¡¹ç›®çš„æ¨¡å—æ”¾åˆ°æœ€é¡¶çš„ç£ç›˜æ–‡ä»¶å†…ï¼Œæ¯æ¬¡å®‰è£…æ–°çš„æ¨¡å—å…ˆæœå¯»æœ‰æ²¡æœ‰å¯¹åº”çš„ï¼Œå¦‚æœæœ‰ç»™ä¸€ä¸ªè½¯é“¾æ¥è€Œä¸ç”ŸæˆçœŸæ­£æ–‡ä»¶ï¼Œè¿™æ ·ä¸å°±æ˜¯å¤§å¤§èŠ‚çœäº†å®‰è£…æ•ˆç‡å˜›ï¼Ÿè™½ç„¶ lock æ–‡ä»¶è¿˜æ˜¯å­˜åœ¨ä½†æ˜¯å·²ç»æ”¹å–„é‡å¤ç£ç›˜çš„è¯»å†™é—®é¢˜ã€‚\r\n\r\n## æ–°çš„å±•æœ›\r\n\r\næœ€è¿‘åœ¨çŸ¥ä¹çœ‹åˆ°äº† [å¦‚ä½•çœ‹å¾…èš‚èšåœ¨ SEEConf åˆ†äº«çš„ NPM å®‰è£…ä¼˜åŒ–ï¼Œæé€Ÿ 3 å€ä¹‹å¤šï¼Ÿ](https://www.zhihu.com/question/511006062) æˆ‘è§‰å¾—è¿™å¯èƒ½æ˜¯åé¢çš„ç½‘é€Ÿä¸æ–­æå‡ä½†æ˜¯åŒ…å®‰è£…ä¾ç„¶å¾ˆæ…¢çš„è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯ç›®å‰è¿˜æœªå¼€æºæ‰€ä»¥æš‚æœªèƒ½ä½“éªŒã€‚\r\n\r\n## æœ€å\r\n\r\nå¦‚æœæœ‰ä»€ä¹ˆé”™è¯¯æ¬¢è¿æŒ‡å‡ºã€‚\r\n\r\n> å‚è€ƒäº†ä¸€äº›æ–‡ç« ï¼š\r\n>\r\n> - [æ·±å…¥æµ…å‡º tnpm rapid æ¨¡å¼ - å¦‚ä½•æ¯” pnpm å¿« 10 ç§’](https://zhuanlan.zhihu.com/p/455809528)\r\n> - [å…³äºç°ä»£åŒ…ç®¡ç†å™¨çš„æ·±åº¦æ€è€ƒâ€”â€”ä¸ºä»€ä¹ˆç°åœ¨æˆ‘æ›´æ¨è pnpm è€Œä¸æ˜¯ npm/yarn?](https://juejin.cn/post/6932046455733485575#heading-7)\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/91/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/91/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/48",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/48/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/48/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/48/events",
          "html_url": "https://github.com/bosens-China/blog/issues/48",
          "id": 548738832,
          "node_id": "MDU6SXNzdWU1NDg3Mzg4MzI=",
          "number": 48,
          "title": "ä¼˜é›…å¤„ç†å›¾ç‰‡å¼‚å¸¸",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1371686609,
              "node_id": "MDU6TGFiZWwxMzcxNjg2NjA5",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/JavaScript",
              "name": "JavaScript",
              "color": "F7DF1E",
              "default": false,
              "description": "JavaScriptç³»åˆ—çš„æ–‡ç« "
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2020-01-13T06:54:18Z",
          "updated_at": "2021-12-21T09:47:37Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "## å‰è¨€\r\n\r\nä¸åŒæµè§ˆå™¨å¯¹åŠ è½½å¤±è´¥å›¾ç‰‡çš„å›¾æ ‡å±•ç¤ºä¸ç»Ÿä¸€ï¼Œæ‰€ä»¥ç»™å®šä¸€ä¸ªé»˜è®¤çš„å¤±è´¥å›¾ç‰‡å°±å°¤ä¸ºé‡è¦ã€‚\r\n\r\næ­£å¥½å‰å‡ å¤©å¤„ç†äº†ä¸€ä¸‹å…¬å¸é¦–é¡µå›¾ç‰‡ error é»˜è®¤å›¾ç‰‡çš„é—®é¢˜ï¼Œå°±è¶ç€è®°å¿†æ²¡æœ‰æ¶ˆå¤±åˆ†äº«ä¸€ä¸‹è¿™ç¯‡æ–‡ç« ã€‚\r\n\r\n## error\r\n\r\nimg æ ‡ç­¾æœ‰ä¸€ä¸ª error äº‹ä»¶ï¼Œé€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥æ•æ‰åˆ°å¼‚å¸¸ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿå¾ˆç®€å•\r\n\r\n```html\r\n<img src=\"abc.xxx\" alt=\"xxx\" class=\"cs-img\" />\r\n```\r\n\r\n```js\r\n<img src=\"abc.xxx\" alt=\"xxx\" class=\"cs-img\" onerror=\"this.src = 'xxxx.png'\" />;\r\n// æˆ–è€…\r\nvar img = document.querySelector(\".cs-img\");\r\nimg.addEventListener(\"error\", function(e) {\r\n  e.target.src = \"xxxx.png\";\r\n});\r\n```\r\n\r\n## å…¨å±€\r\n\r\nä¸Šé¢çš„æ–¹æ³•æ²¡æœ‰é—®é¢˜ï¼Œä¸è¿‡éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨ç®¡ç†å›¾ç‰‡è¿™æ ·å†™çš„è¯ç»´æŠ¤æˆæœ¬å¯èƒ½å¾ˆé«˜ï¼Œæœ‰å¯èƒ½ä½ åªæ˜¯æƒ³ä¸ºå›¾ç‰‡å¤±è´¥ç»Ÿä¸€å¤„ç†ã€‚\r\n\r\næˆ‘ä»¬å¸Œæœ›å¯ä»¥ç»Ÿä¸€ç›‘å¬åˆ°`error`çš„äº‹ä»¶æ¥å®Œæˆï¼Œä¸è¿‡å›¾ç‰‡çš„`error`å¤„äºäº‹ä»¶æ¨¡å‹çš„ç¬¬äºŒé˜¶æ®µä¹Ÿå°±æ˜¯ç›®æ ‡é˜¶æ®µï¼Œæ˜¯ä¸ä¼šå‘ä¸Šå†’æ³¡çš„ï¼Œä½†æ˜¯ä¹Ÿæ˜¯å¯ä»¥é€šè¿‡`window.addEventListener.error`æ¥å®Œæˆç›‘å¬ã€‚\r\n\r\n> é¡ºä¾¿è¯´ä¸‹`window.addEventListener.error`ä¸ä»…å¯ä»¥ç›‘å¬åˆ°å›¾ç‰‡çš„å¤±è´¥ä¹Ÿå¯ä»¥ç›‘å¬åˆ° `css,js` ä¹‹ç±»åŠ è½½é”™è¯¯ï¼Œæ³¨æ„åŒºåˆ†`window.onerror`å’Œ`window.addEventListener.error`ä¹‹é—´çš„åŒºåˆ«ï¼Œå‰è€…æ˜¯ js è¿è¡Œé”™è¯¯ï¼Œåè€…æ˜¯èµ„æºé”™è¯¯ï¼Œå¯¹äºäº‹ä»¶æ¨¡å‹ç½‘ä¸Šçš„ä¾‹å­å¾ˆå¤šï¼Œè¿™é‡Œä¸åšå±•å¼€æ¥è¯´äº†ã€‚\r\n\r\næ¥çœ‹ä¸‹å¦‚ä½•ç”¨\r\n\r\n```js\r\nwindow.addEventListener(\r\n  \"error\",\r\n  function(event) {\r\n    var dom = event.target;\r\n    if (/img/i.test(dom.nodeName)) {\r\n      dom.src = \"xxxx.png\";\r\n    }\r\n  },\r\n  true\r\n);\r\n```\r\n\r\næ³¨æ„ `addEventListener` ç¬¬äºŒä¸ªå‚æ•°å¿…é¡»æ˜¯ `true`ï¼Œé»˜è®¤ä¸º `false`ï¼Œè¡¨ç¤ºåªåœ¨å†’æ³¡é˜¶æ®µå‡ºå‘ï¼Œä½†æ˜¯ä¸Šé¢æˆ‘ä»¬è¯´è¿‡å›¾ç‰‡çš„ error äº‹ä»¶å¹¶ä¸ä¼šå‘ä¸Šå†’æ³¡æ‰€ä»¥æ˜¯ä¸ä¼šæ•æ‰åˆ°çš„ã€‚\r\n\r\n## é‡è¯•æ¬¡æ•°\r\n\r\nä¸Šé¢çš„ä»£ç æ²¡æœ‰è€ƒè™‘åˆ°å¤‡é€‰`src`ä¹Ÿä¼šå¤±æ•ˆçš„é—®é¢˜ï¼Œå¦‚æœå¤‡é€‰`src`å¤±æ•ˆå°±ä¼šå¯¼è‡´å›¾ç‰‡æ— é™é‡è¯•ï¼Œä¸‹é¢å°±æŠ›ç –å¼•ç‰å†™ä¸€ç§æ–¹æ³•ã€‚\r\n\r\n```js\r\nwindow.addEventListener(\r\n  \"error\",\r\n  function(event) {\r\n    var dom = event.target;\r\n    if (!/img/i.test(dom.nodeName)) {\r\n      return;\r\n    }\r\n    // ä¸å­˜åœ¨è¿”å›null\r\n    var retry = +dom.getAttribute(\"data-retry\");\r\n    if (retry >= 3) {\r\n      // ç»å¯¹å®‰å…¨çš„å›¾ç‰‡\r\n      dom.src =\r\n        \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\";\r\n    } else {\r\n      dom.src = \"xxxx.png\";\r\n      dom.setAttribute(\"data-retry\", (retry += 1));\r\n    }\r\n  },\r\n  true\r\n);\r\n```\r\n\r\n## åŠ¨æ€å¡«å……\r\n\r\næœ€ååˆ†äº«ä¸€ä¸ªåŠ¨æ€æ¨¡æ¿æ¸²æŸ“å‡ºæ¥çš„ç½‘é¡µ(ä¾‹å¦‚ï¼Œç½‘é¡µçš„å†…å®¹æ˜¯ä»åå°çš„ç¼–è¾‘å™¨ html ç›´æ¥æ’å…¥çš„)å¦‚ä½•ç›‘å¬`error`ï¼Œå¦‚æœä¸è€ƒè™‘å…¼å®¹é—®é¢˜å¯ä»¥åœ¨`head`ä½¿ç”¨`window.addEventListener.error`æ–¹æ³•ï¼Œä½†æ˜¯å¦‚æœéœ€è¦å…¼å®¹æ€§å¾ˆé«˜ä¸å¦¨è¯•è¯•ä¸‹é¢è¿™ç§ã€‚\r\n\r\n```js\r\nconst img = Array.prototype.slice.call(document.images);\r\nfor (let i = 0; i < img.length; i++) {\r\n  var dom = img[i];\r\n  const image = document.createElement(\"img\");\r\n  image.src = dom.src;\r\n  image.style.display = \"none\";\r\n  document.body.appendChild(image);\r\n  image.onerror = function(event) {\r\n    dom.src = \"xxxx.png\";\r\n    document.body.removeChild(image);\r\n  };\r\n  image.onload = function() {\r\n    document.body.removeChild(image);\r\n  };\r\n}\r\n```\r\n\r\nä¸Šé¢æˆ‘ä»¬è¯´äº†å‡è®¾å†…å®¹æ˜¯ç›´æ¥é€šè¿‡ html ä»£ç æ’å…¥çš„ï¼Œæˆ‘ä»¬å¯èƒ½ç›‘å¬ä¸åˆ°å›¾ç‰‡çš„é»˜è®¤é”™è¯¯äº‹ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨ç½‘é¡µåŠ è½½å®Œæˆä¹‹åé‡è¯•ä¸€éæ‰€æœ‰çš„ imgï¼Œåœ¨ä¸º img æŒ‡å®šä¸€æ¬¡é”™è¯¯äº‹ä»¶å°± OK äº†ã€‚\r\n\r\n## æœ€å\r\n\r\nä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºï¼Œä¸Šé¢çš„ä»£ç æˆ‘éƒ½æ²¡æœ‰åšå…¼å®¹æ€§çš„è¡¥å……ï¼Œä½†æ˜¯åœ¨å®é™…ç”Ÿäº§ä¸­ä¸Šé¢ä»£ç éœ€è¦`polyfill`å°¤å…¶æ˜¯ dom çš„ä¸€äº›è¯­æ³•ï¼Œæ¨èç®€å•ä¸€äº›çš„åšæ³•å¯ä»¥æŠŠä¸Šé¢çš„ä¾‹å­è½¬åŒ–ä¸º jquery çš„è¯­æ³•ã€‚\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/48/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/48/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/29",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/29/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/29/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/29/events",
          "html_url": "https://github.com/bosens-China/blog/issues/29",
          "id": 499886565,
          "node_id": "MDU6SXNzdWU0OTk4ODY1NjU=",
          "number": 29,
          "title": "jsonpå®ç°åŸç†",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1371686609,
              "node_id": "MDU6TGFiZWwxMzcxNjg2NjA5",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/JavaScript",
              "name": "JavaScript",
              "color": "F7DF1E",
              "default": false,
              "description": "JavaScriptç³»åˆ—çš„æ–‡ç« "
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2019-09-29T09:16:55Z",
          "updated_at": "2021-12-21T09:46:25Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "ç®€å•è¯´ä¸€ä¸‹å­˜åœ¨çš„å†å²ï¼Œæµè§ˆå™¨å­˜åœ¨åŒæºæ”¿ç­–ï¼Œå³åŸŸå+ç«¯å£+åè®®å¿…é¡»ä¸€è‡´ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬éœ€è¦è·¨åŸŸè®¿é—®ï¼Œå½“ç„¶åœ¨ç°åœ¨æˆ‘ä»¬å¯ä»¥å€ŸåŠ© webpack çš„åå‘ä»£ç†é…åˆæœåŠ¡å™¨è®¾ç½® cors å®ç°è®¿é—®ï¼Œä½†æ˜¯åœ¨ä¹‹å‰å·¥ç¨‹åŒ–è¿˜æ²¡å‡ºç°çš„æ—¶å€™å°±éœ€è¦æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥è®¿é—®æ‰€ä»¥ jsonp å°±å‡ºç°äº†ã€‚\r\njsonp çš„åŸç†å°±æ˜¯æµè§ˆå™¨çš„ `script` æ ‡ç­¾å¯ä»¥åŠ è½½ä¸åŒæºçš„èµ„æºï¼Œé…åˆåç«¯é€šè¿‡æ‰§è¡Œå‡½æ•°ä¼ é€’å‚æ•°ï¼Œè¿™ä¹Ÿæ˜¯ **jsonp åªæ”¯æŒ get** çš„åŸå› ï¼ŒåŒç†çš„æ ‡ç­¾è¿˜æœ‰`img`ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥å®ç°è®¿é—®ç«™ç‚¹æ¬¡æ•°çš„ç»Ÿè®¡ï¼Œæ ¹æ®ä¸Šé¢çš„åŸç†æˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªæ¨¡æ‹Ÿçš„ç‰ˆæœ¬\r\n\r\n## ç¬¬ä¸€ç‰ˆ\r\n\r\n```html\r\n<script>\r\n  function callback(v) {\r\n    console.log(\"å‚æ•°æ˜¯ï¼š\");\r\n    console.log(v);\r\n  }\r\n</script>\r\n<script>\r\n  callback({\r\n    name: \"zhangsan\",\r\n    age: 18\r\n  });\r\n</script>\r\n```\r\n\r\nå¯ä»¥çœ‹åˆ°å°±æ˜¯è¿™ä¸ªæ€è·¯ï¼Œåé¢çš„è„šæœ¬è°ƒç”¨è¿™ä¸ªå‚æ•°å³å¯ã€‚\r\n\r\n## ç®€å•å®ç°ä¸€ä¸ª jsonp çš„å‡½æ•°\r\n\r\n```js\r\ninterface Iparams {\r\n  [propName: string]: any;\r\n}\r\ninterface Ioptions {\r\n  params?: Iparams;\r\n  timeout?: number;\r\n  name?: string;\r\n}\r\nlet uid = 0;\r\nconst jsonp = function jsonp(this: any, url: string, option: Ioptions = {}) {\r\n  return new Promise((resolve, reject) => {\r\n    // æ³¨æ„ï¼Œè¿™ä¸ªidä¸èƒ½é‡å¤\r\n    const id = `__uid${uid++}`;\r\n    Reflect.set(window, id, (...rest: any[]) => {\r\n      clear();\r\n      return resolve.call(this, ...rest);\r\n    });\r\n    const { name = \"callback\", params = {}, timeout = 6000 } = option;\r\n    // æ¸…ç†\r\n    const clear = () => {\r\n      Reflect.set(window, id, () => {});\r\n      script.parentNode.removeChild(script);\r\n      if (timer) {\r\n        clearTimeout(timer);\r\n      }\r\n    };\r\n    // åˆ›å»ºè¶…æ—¶ä»»åŠ¡\r\n    let timer: NodeJS.Timeout;\r\n    if (typeof timeout === \"number\") {\r\n      timer = setTimeout(() => {\r\n        clear();\r\n        return reject(new Error(`Task timeout`));\r\n      }, timeout);\r\n    }\r\n    const script: HTMLScriptElement = document.createElement(\"script\");\r\n    // å¤„ç†ä¸€ä¸‹å‚æ•°æœ€ç»ˆåˆå¹¶\r\n    const par = new URLSearchParams(params);\r\n    par.append(name, id);\r\n    const href = `${url}?${par}`;\r\n    // ç¼–ç ä¸€ä¸‹é˜²æ­¢å‡ºç°ä¸­æ–‡ä¹‹ç±»çš„\r\n    script.src = encodeURI(href);\r\n    document.body.appendChild(script);\r\n    script.addEventListener(\"error\", () => {\r\n      clear();\r\n      return reject(\r\n        new Error(`Failed to create jsonp, request target address is:${url}`)\r\n      );\r\n    });\r\n  });\r\n};\r\nexport default jsonp;\r\n```\r\n\r\nè¿™é‡Œä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºä½¿ç”¨äº†`URLSearchParams`å¯¹è±¡ï¼Œå®ƒæ˜¯æµè§ˆå™¨çš„åŸç”Ÿå¯¹è±¡ï¼Œç”¨æ¥æ„é€ ã€è§£æå’Œå¤„ç† URL çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œå½“ç„¶åœ¨ç”Ÿäº§ä¸­è¿˜éœ€è¦`polyfill`ï¼Œå¦‚æœä¸æ»¡è¶³å…¼å®¹æ€§å»ºè®®æ‰‹å†™ä¸€ä¸ªå·¥å…·å¤„ç†ã€‚\r\n\r\n## æœ€å\r\n\r\nä»£ç æˆ‘å·²ç»æ”¾ç½®åˆ°äº†ä»“åº“ï¼Œæ¬¢è¿æ¥ [Star](https://github.com/bosens-China/promise-jsonp)\r\n\r\nå‚è€ƒï¼š\r\n\r\n- https://github.com/webmodules/jsonp\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/29/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/29/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/23",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/23/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/23/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/23/events",
          "html_url": "https://github.com/bosens-China/blog/issues/23",
          "id": 489595663,
          "node_id": "MDU6SXNzdWU0ODk1OTU2NjM=",
          "number": 23,
          "title": "é•¿åˆ—è¡¨ä¼˜åŒ–",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1371686609,
              "node_id": "MDU6TGFiZWwxMzcxNjg2NjA5",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/JavaScript",
              "name": "JavaScript",
              "color": "F7DF1E",
              "default": false,
              "description": "JavaScriptç³»åˆ—çš„æ–‡ç« "
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2019-09-05T08:10:06Z",
          "updated_at": "2021-12-21T09:45:48Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "## å‰è¨€\r\n\r\nåœ¨é¡¹ç›®ä¸­å¦‚æœèƒ½åˆ†é¡µå®ç°é‚£æœ€å¥½ä¸è¿‡äº†ï¼Œä¸è¿‡å¾ˆå¤šæ—¶å€™é•¿åˆ—è¡¨ä¸å¯é¿å…ï¼Œè¿™é‡Œåˆåˆ†ä¸¤ç§æƒ…å†µ\r\n\r\n1. ç¬¬ä¸€æ¬¡ä¸ç”¨å…¨éƒ¨åŠ è½½å®Œæˆï¼Œè¿™ç§å¯ä»¥ä½¿ç”¨æ‡’åŠ è½½æˆ–è€…è¯´æ— é™æ»šåŠ¨çš„æ–¹å¼æ¥å®ç°\r\n2. å¦å¤–ä¸€ç§åˆ™æ˜¯ä¸€æ¬¡è¦æ¸²æŸ“å…¨éƒ¨æ•°æ®å‡ºç°\r\n\r\nä¸‹é¢å°±æ¥è®¨è®ºè¿™ä¸¤ç§æƒ…å†µå¦‚ä½•è¿›è¡Œä¼˜åŒ–ï¼Œå¯ä»¥å¯¹æ¯”[åˆ—è¡¨ä¼˜åŒ–å…·ä½“å®ç°](https://github.com/bosens-China/VirtualList)çš„æºç æ¥çœ‹\r\n(æ³¨ï¼šä¸‹é¢æ˜¯ç”¨ Vue å®ç°çš„ï¼Œä½¿ç”¨å…¶ä»–æ¡†æ¶å¹¶ä¸å½±å“)\r\n\r\n## æ— é™æ»šåŠ¨\r\n\r\nå®ç°çš„æ€è·¯å¾ˆç®€å•å°±æ˜¯æ ¹æ®æ»šåŠ¨æ¡æ˜¯å¦æ»šåŠ¨åˆ°åº•éƒ¨ï¼ˆæ€»é«˜åº¦ - å¯è§é«˜åº¦ - æ»šåŠ¨æ¡é«˜åº¦ï¼‰ï¼Œæ»šåŠ¨åˆ°åº•éƒ¨å°±æ·»åŠ æ–°çš„æ•°æ®\r\n\r\n```js\r\nfunction scroll({ target }) {\r\n  const DISTANCE = 40;\r\n  const h = target.scrollHeight - (target.clientHeight + target.scrollTop);\r\n  if (h < DISTANCE) {\r\n    for (let i = 0, j = this.list.length, l = this.list.length; i < l; i++) {\r\n      this.list.push(j + i);\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n## è™šæ‹Ÿåˆ—è¡¨\r\n\r\n![v2-f00bb3f5d9815d660d7bcbd87236af86_hd](https://user-images.githubusercontent.com/39508895/64329195-6cc67180-d001-11e9-8104-1256738a1cc2.jpg)\r\n\r\nå¼•ç”¨ä¸€å¼ å›¾ï¼Œå¯ä»¥çœ‹è§æˆ‘ä»¬å®ç°çš„æ€è·¯å°±æ˜¯åªæ¸²æŸ“å¯è§éƒ¨åˆ†çš„åˆ—è¡¨ï¼Œæ¯æ¬¡æ»šåŠ¨æ¡å˜åŒ–çš„æ—¶å€™æ›´æ”¹å±•ç¤ºçš„åˆ—è¡¨ï¼Œåœ¨ä¸‹é¢çš„æ¼”ç¤ºä¸­ï¼Œæˆ‘ä»¬éƒ½ä¼šç”¨åˆ°ä¸€ä¸ªåŸºç¡€çš„ html ç»“æ„ï¼Œè¿™é‡Œå…ˆè´´ä¸€ä¸‹\r\n\r\n```html\r\n<div class=\"root\">\r\n  <div class=\"container\"></div>\r\n  <ul class=\"content\">\r\n    <li class=\"item\" v-for=\"item of nowList\" :key=\"item.value\">\r\n      {{ item.value }}\r\n    </li>\r\n  </ul>\r\n</div>\r\n```\r\n\r\n```less\r\n.root {\r\n  border: 1px solid #999;\r\n  list-style: none;\r\n  overflow: auto;\r\n  height: 400px;\r\n  position: relative;\r\n  .container {\r\n    position: absolute;\r\n    left: 0;\r\n    top: 0;\r\n    right: 0;\r\n    z-index: -1;\r\n  }\r\n  .content {\r\n    .container();\r\n    z-index: 1;\r\n    margin: 0;\r\n    padding: 0;\r\n    list-style: none;\r\n  }\r\n  .item {\r\n    border-bottom: 1px solid #ccc;\r\n    padding-left: 40px;\r\n  }\r\n}\r\n```\r\n\r\nä¸Šé¢ç»“æ„åšäº†ä¸¤ä»¶äº‹æƒ…\r\n\r\n1. å›ºå®šæ€»åˆ—è¡¨çš„é«˜åº¦ï¼Œè®©å…¶å‡ºç°æ»šåŠ¨æ¡\r\n2. ç”¨ä¸€ä¸ªé®ç½© div æ’‘èµ·æ•´ä¸ªåˆ—è¡¨çš„é«˜åº¦\r\n\r\n### å›ºå®š\r\n\r\nè¿™é‡Œå‡è®¾æ¯ä¸ªåˆ—è¡¨çš„é«˜åº¦ä¸º 30pxï¼Œå‰©ä¸‹çš„éƒ¨åˆ†å°±æ˜¯è®¡ç®—å‡ºåˆ—è¡¨çš„`æ€»ä½“é«˜åº¦`ä»¥åŠ`å¼€å§‹ç´¢å¼•`å’Œ`ç»“æŸç´¢å¼•`ï¼Œæ ¸å¿ƒä»£ç åªæœ‰ä¸åˆ° 10 è¡Œ\r\n\r\n```js\r\nscroll() {\r\n  const dom = this.$refs.root;\r\n  const total = Math.ceil(dom.clientHeight / this.height);\r\n  const start = Math.floor(dom.scrollTop / this.height);\r\n  const end = start + total;\r\n  this.start = start;\r\n  this.end = end;\r\n}\r\n```\r\n\r\næ€»ç´¢å¼•: å½“å‰è§†å›¾çš„é«˜åº¦ / å­é¡¹çš„é«˜åº¦ï¼Œä¸è¿‡æ³¨æ„éœ€è¦å‘ä¸Šå–æ•´ï¼›\r\nå¼€å§‹ç´¢å¼•: æ»šåŠ¨çš„è·ç¦» / å­é¡¹çš„é«˜åº¦\r\nç»“æŸç´¢: æ€»ç´¢å¼• + å¼€å§‹ç´¢å¼•\r\nä¸‹é¢æ˜¯å®Œæ•´çš„ä»£ç \r\n\r\n```html\r\n<template>\r\n  <div>\r\n    <div class=\"root\" ref=\"root\" @scroll=\"scroll\">\r\n      <div class=\"container\" :style=\"{ height: totalHeight }\"></div>\r\n      <ul class=\"content\" :style=\"{ transform: getTransform }\">\r\n        <li\r\n          class=\"item\"\r\n          :style=\"{ height: height + 'px', lineHeight: height + 'px' }\"\r\n          v-for=\"(item, i) of nowList\"\r\n          :key=\"i\"\r\n        >\r\n          {{ item }}\r\n        </li>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  export default {\r\n    data() {\r\n      return {\r\n        list: Array(10000)\r\n          .fill(1)\r\n          .map((f, i) => i),\r\n        height: 30,\r\n        start: 0,\r\n        end: 0\r\n      };\r\n    },\r\n    computed: {\r\n      totalHeight() {\r\n        return this.height * this.list.length + \"px\";\r\n      },\r\n      nowList() {\r\n        return this.list.slice(this.start, this.end);\r\n      },\r\n      getTransform() {\r\n        return `translate3d(0,${this.start * this.height}px,0)`;\r\n      }\r\n    },\r\n    mounted() {\r\n      this.scroll();\r\n    },\r\n    methods: {\r\n      scroll() {\r\n        const dom = this.$refs.root;\r\n        const total = Math.ceil(dom.clientHeight / this.height);\r\n        const start = Math.floor(dom.scrollTop / this.height);\r\n        const end = start + total;\r\n        this.start = start;\r\n        this.end = end;\r\n      }\r\n    }\r\n  };\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n  .root {\r\n    border: 1px solid #999;\r\n    list-style: none;\r\n    overflow: auto;\r\n    height: 400px;\r\n    position: relative;\r\n    .container {\r\n      position: absolute;\r\n      left: 0;\r\n      top: 0;\r\n      right: 0;\r\n      z-index: -1;\r\n    }\r\n    .content {\r\n      .container();\r\n      z-index: 1;\r\n      margin: 0;\r\n      padding: 0;\r\n      list-style: none;\r\n    }\r\n    .item {\r\n      border-bottom: 1px solid #ccc;\r\n      padding-left: 40px;\r\n    }\r\n  }\r\n</style>\r\n```\r\n\r\n### éå›ºå®š\r\n\r\néå›ºå®šéœ€è¦è€ƒè™‘çš„æ›´å¤šåˆ™æ˜¯æ€§èƒ½çš„é—®é¢˜ï¼Œä¸‹é¢å…ˆè´´ä¸€ä¸ªå®Œæ•´çš„ä»£ç ï¼Œåœ¨éœ€è¦è¯´æ˜éƒ¨åˆ†å·²ç»æ³¨é‡Šäº†\r\n\r\n```html\r\n<template>\r\n  <div>\r\n    <div class=\"root\" ref=\"root\" @scroll=\"scroll\">\r\n      <div class=\"container\" :style=\"{ height: totalHeight }\"></div>\r\n      <ul class=\"content\" :style=\"{ transform: getTransform }\">\r\n        <li\r\n          class=\"item\"\r\n          v-for=\"item of nowList\"\r\n          :style=\"{\r\n            height: item.height + 'px',\r\n            lineHeight: item.height + 'px'\r\n          }\"\r\n          :key=\"item.value\"\r\n        >\r\n          {{ item.value }}\r\n        </li>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  export default {\r\n    data() {\r\n      return {\r\n        list: Array(10000)\r\n          .fill(1)\r\n          .map((f, i) => {\r\n            return {\r\n              value: i,\r\n              height: this.getRandom(10, 100)\r\n            };\r\n          }),\r\n        start: 0,\r\n        end: 0,\r\n        // æŒ‡é’ˆ\r\n        pointer: -1,\r\n        // ç¼“å­˜\r\n        cache: {},\r\n        // åˆå§‹æ€»æ•°\r\n        initialHeight: 50\r\n      };\r\n    },\r\n    computed: {\r\n      totalHeight() {\r\n        // è¿™é‡Œæ˜¯è·å–æ€»ä½“é«˜åº¦ï¼Œåˆ¤æ–­äº†ä¸¤ç§æƒ…å†µï¼Œç¬¬ä¸€ç§æ˜¯ç»™å®šåˆå§‹æ€»æ•°ï¼Œå¦å¤–ä¸€ç§åˆ™æ˜¯æ²¡æœ‰ï¼Œå¦‚æœæ²¡æœ‰çš„è¯ï¼Œé«˜åº¦å°±æ˜¯å·²ç¼“å­˜çš„ + æœªç¼“å­˜çš„éƒ¨åˆ†\r\n        if (this.initialtotal >= 0) {\r\n          const { top, height } =\r\n            this.pointer >= 0\r\n              ? this.getIndexOffset(this.pointer)\r\n              : { top: 0, height: 0 };\r\n          return `${top +\r\n            height +\r\n            (this.list.length - 1 - this.pointer) * this.initialHeight}px`;\r\n        }\r\n        const { height } = this.list.reduce(function(x, y) {\r\n          return {\r\n            height: x.height + y.height\r\n          };\r\n        });\r\n        return height + \"px\";\r\n      },\r\n      // å¯è§†æ•°æ®\r\n      nowList() {\r\n        return this.list.slice(\r\n          this.start,\r\n          Math.min(this.end + 1, this.list.length)\r\n        );\r\n      },\r\n      getTransform() {\r\n        return `translate3d(0,${this.getIndexOffset(this.start).top}px,0)`;\r\n      }\r\n    },\r\n    mounted() {\r\n      this.scroll();\r\n    },\r\n    methods: {\r\n      // æ»šåŠ¨äº‹ä»¶\r\n      scroll() {\r\n        const dom = this.$refs.root;\r\n        // è·å–ç´¢å¼•\r\n        const start = this.getIndex(dom.scrollTop);\r\n        // æŠŠå½“å‰å¯è§†çš„é«˜åº¦ + æ»šåŠ¨æ¡çš„é«˜åº¦ï¼Œå†å»å–ç´¢å¼•\r\n        const end = this.getIndex(dom.scrollTop + dom.clientHeight);\r\n        this.start = start;\r\n        this.end = end;\r\n      },\r\n      // å–å‡ºæŒ‡å®šèŒƒå›´éšæœºæ•°\r\n      getRandom(min, max) {\r\n        return Math.floor(Math.random() * (max - min + 1)) + min;\r\n      },\r\n      // æ ¹æ®æ»šåŠ¨æ¡yè·å–æŒ‡å®šåæ ‡\r\n      getIndex(scrollTop) {\r\n        // åˆ¤æ–­æ€è·¯å¾ˆç®€å•ï¼Œå¦‚æœé«˜åº¦å¤§äºæ»šåŠ¨æ¡è‚¯å®šå°±å‡ºç°äº†ï¼Œå¦å¤–ä¸€ç§åˆ™æ˜¯åˆ¤æ–­äº†è¾¹ç•Œé—®é¢˜\r\n        let total = 0;\r\n        for (let i = 0, j = this.list.length; i < j; i++) {\r\n          if (total >= scrollTop || j - 1 === i) {\r\n            return i;\r\n          }\r\n          // è¿™é‡Œä¸»è¦æ˜¯èµ·ç¼“å­˜ä½œç”¨çš„\r\n          total += this.getIndexOffset(i).height;\r\n        }\r\n        return 0;\r\n      },\r\n      // è·å–æŒ‡å®šåæ ‡çš„ä½ç½®å’Œé«˜åº¦\r\n      getIndexOffset(index) {\r\n        // å¦‚æœå­˜åœ¨ç¼“å­˜ä¸­ç›´æ¥è¿”å›\r\n        if (this.pointer >= index) {\r\n          return this.cache[index];\r\n        }\r\n        let total = 0;\r\n        // è¿™é‡Œæ˜¯ä¸ºäº†æ¯”è¾ƒæ²¡æœ‰å–åˆ°çš„æƒ…å†µ\r\n        if (this.pointer >= 0) {\r\n          const li = this.cache[this.pointer];\r\n          total = li.top + li.height;\r\n        }\r\n        // æ³¨æ„ä¸Šé¢å› ä¸ºå–çš„å€¼æ˜¯li.top + li.heightï¼Œæ‰€ä»¥iä» + 1å¼€å§‹\r\n        for (let i = this.pointer + 1; i <= index; i++) {\r\n          const size = this.list[i].height;\r\n          this.cache[i] = {\r\n            top: total,\r\n            height: size\r\n          };\r\n          total += size;\r\n        }\r\n        if (index > this.pointer) {\r\n          this.pointer = index;\r\n        }\r\n\r\n        return this.cache[index];\r\n      }\r\n    }\r\n  };\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n  .root {\r\n    border: 1px solid #999;\r\n    list-style: none;\r\n    overflow: auto;\r\n    height: 400px;\r\n    position: relative;\r\n    .container {\r\n      position: absolute;\r\n      left: 0;\r\n      top: 0;\r\n      right: 0;\r\n      z-index: -1;\r\n    }\r\n    .content {\r\n      .container();\r\n      z-index: 1;\r\n      margin: 0;\r\n      padding: 0;\r\n      list-style: none;\r\n    }\r\n    .item {\r\n      border-bottom: 1px solid #ccc;\r\n      padding-left: 40px;\r\n    }\r\n  }\r\n</style>\r\n```\r\n\r\nä¸Šé¢åªæœ€ç»ˆçš„å®ç°ï¼Œå®é™…ä¸Šè·Ÿå›ºå®šé«˜åº¦ç›¸æ¯”å°±æ˜¯å¢åŠ äº†è·å–ç´¢å¼•çš„æ–¹æ³•ï¼Œå›ºå®šé«˜åº¦æˆ‘ä»¬æ˜¯çŸ¥é“å¯¹åº”å­é¡¹çš„é«˜åº¦ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡å¯è§†é«˜åº¦æ¥è®¡ç®—ï¼Œè€Œè¿™é‡Œæˆ‘ç”¨äº†éšæœºæ•°æ¥è®¾ç½®é«˜åº¦ï¼Œæ‰€ä»¥éœ€è¦è·å–åˆ°å¯¹åº”çš„ç´¢å¼•ã€‚\r\nä¸Šé¢ä»£ç åŒæ—¶ä¹Ÿåšäº†ä¸¤ç‚¹ä¼˜åŒ–ï¼Œä¸€æ˜¯ç¼“å­˜ï¼ŒäºŒæ˜¯æ€»é«˜åº¦ä¼˜åŒ–\r\n\r\næ€»é«˜åº¦çš„å®ç°æœ‰ä¸¤ç§æ€è·¯ï¼š\r\n\r\n1. è®¡ç®—æ‰€æœ‰çš„é«˜åº¦ï¼Œè¿™ç§å®é™…ä¸Šæœ‰ç‚¹æµªè´¹æ€§èƒ½ï¼›\r\n2. ç»™å®šä¸€ä¸ªå¤§æ¦‚çš„å€¼ï¼Œæ‹¿ç¼“å­˜çš„å€¼ + æ²¡æœ‰ç¼“å­˜çš„å€¼ï¼Œæ²¡æœ‰ç¼“å­˜çš„å€¼å°±æ˜¯å¯¹åº”æ•°æ®çš„é•¿åº¦ - å·²ç¼“å­˜çš„åæ ‡ï¼Œä¹‹åæ¯æ¬¡ç¼“å­˜å˜åŒ–çš„æ—¶å€™å†è®¡ç®—ï¼›\r\n\r\nç¼“å­˜åˆ™æ¯”è¾ƒç®€å•äº†ï¼Œæ¯æ¬¡è®¡ç®—çš„æ—¶å€™æŠŠæŒ‡é’ˆç§»åŠ¨åˆ°è®¡ç®—çš„ä½ç½®ï¼ŒåŒæ—¶å°†å€¼æ·»åŠ ä¸Š\r\n\r\n## å‚è€ƒæ–‡ç« \r\n\r\n1. https://zhuanlan.zhihu.com/p/34585166\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/23/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/23/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/65",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/65/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/65/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/65/events",
          "html_url": "https://github.com/bosens-China/blog/issues/65",
          "id": 770754319,
          "node_id": "MDU6SXNzdWU3NzA3NTQzMTk=",
          "number": 65,
          "title": "åˆæ¢ node æ¥å£å¼€å‘",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1371686609,
              "node_id": "MDU6TGFiZWwxMzcxNjg2NjA5",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/JavaScript",
              "name": "JavaScript",
              "color": "F7DF1E",
              "default": false,
              "description": "JavaScriptç³»åˆ—çš„æ–‡ç« "
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2020-12-18T10:03:26Z",
          "updated_at": "2021-12-21T03:35:11Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "æ¥å£è¯·æ±‚ä¸å…¶å®ƒèµ„æºè¯·æ±‚æ²¡æœ‰ä»€ä¹ˆä¸åŒï¼Œéƒ½æ˜¯å€ŸåŠ© `http` åè®®è¿”å›å¯¹åº”çš„èµ„æºï¼Œè¿™ç¯‡æ–‡ç« ç®€å•ä»‹ç»ä¸€ä¸‹ `node` å¼€å‘æ¥å£ä»¥åŠå¦‚ä½•ç®¡ç†å¤šä¸ªæ¥å£æƒ…å†µå’Œæ¥å£é£æ ¼ã€‚\r\n\r\næ ‡é¢˜å…³è”äº† nodeï¼Œä¸»è¦å› ä¸º node å¼€å¯ä¸€ä¸ªæœåŠ¡å™¨æ˜¯å¾ˆç®€å•ï¼Œè€Œä¸”è¯­æ³•åŸºæœ¬ç›¸åŒæ²¡æœ‰å¤ªå¤šè´Ÿæ‹…ï¼Œè¿™ç¯‡æ–‡ç« ä¸»è¦è®²è§£æ€è·¯ï¼Œæ¢ç®—åˆ°å…¶å®ƒè¯­è¨€ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚\r\n\r\nå…ˆçœ‹ä¸€ä¸ªå®˜ç½‘çš„ä¾‹å­ï¼Œç¨å¾®æ”¹é€ ä¸€ä¸‹è®©å®ƒè¿”å›ä¸€ä¸ªå›ºå®šçš„`json`æ•°æ®\r\n\r\n```js\r\nconst http = require('http');\r\n\r\nconst hostname = '127.0.0.1';\r\nconst port = 3000;\r\n\r\nconst server = http.createServer((req, res) => {\r\n  res.statusCode = 200;\r\n  res.writeHead(200, { 'Content-Type': 'application/json' });\r\n  res.write(JSON.stringify({ name: 'hello wrold' }));\r\n  res.end();\r\n});\r\n\r\nserver.listen(port, hostname, () => {\r\n  console.log(`æœåŠ¡å™¨è¿è¡Œåœ¨ http://${hostname}:${port}/`);\r\n});\r\n```\r\n\r\nå°†ä¸Šé¢ä»£ç å¤åˆ¶åˆ°æ–‡ä»¶ä¸­ï¼Œä¹‹åå€ŸåŠ© `node xxx.js` çš„å½¢å¼å°±å¯ä»¥é¢„è§ˆåˆ°æ•ˆæœäº†ã€‚\r\n\r\n## koa\r\n\r\nä¸Šé¢æ˜¯å€ŸåŠ© node çš„ `http` åŸç”Ÿæ¨¡å—å®ç°çš„ï¼Œå½“ç„¶è¿™ç§å®ç°æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä¸è¿‡è¿½æ±‚å¯æ‰©å±•å’Œç®€åŒ–å¼€å‘çš„ç›®çš„ï¼Œè¿™é‡Œé€‰æ‹©äº† koa ä½œä¸ºä¸‹é¢ä½¿ç”¨çš„çš„æ¡†æ¶ã€‚\r\n\r\nkoa å·ç§°æ˜¯ä¸‹ä¸€ä»£çš„ web å¼€å‘æ¡†æ¶ï¼ŒåŒæ ·ä»¥ä¸Šé¢çš„ä¾‹å­å®‰è£…ä¸€ä¸‹ koa ï¼Œçœ‹å®ƒæ€ä¹ˆå®ç°ä¸Šé¢çš„åŠŸèƒ½\r\n\r\n```sh\r\nyarn add koa\r\n```\r\n\r\n```js\r\nconst Koa = require('koa');\r\n\r\nconst hostname = '127.0.0.1';\r\nconst port = 3000;\r\n\r\nconst app = new Koa();\r\n\r\napp.use(async (ctx) => {\r\n  ctx.type = 'application/json';\r\n  ctx.body = { name: 'hello wrold' };\r\n});\r\napp.listen(port, hostname, () => {\r\n  console.log(`æœåŠ¡å™¨è¿è¡Œåœ¨ http://${hostname}:${port}/`);\r\n});\r\n```\r\n\r\nä»£ç æ–¹é¢è¿˜æ˜¯ååˆ†ç®€æ´çš„ï¼Œè¿™é‡Œä¸»è¦ä»‹ç»å®ç°æ€è·¯ä¸è¿‡å¤šä»‹ç» koa çš„è¯­æ³•ï¼Œè€Œä¸”å®é™…ä¸Š koa åªæ˜¯å¯¹ http æ¨¡å—è¿›è¡Œäº†å°è£…ï¼Œæ–‡æ¡£ä¹Ÿæ²¡å¤šå°‘æ¨èçœ‹ä¸€ä¸‹å®˜ç½‘çš„ä»‹ç»å³å¯ã€‚\r\n\r\nè¯´åˆ°`koa`è¿™é‡Œè¿˜æ˜¯èŠä¸€ä¸‹ `koa` çš„ä¸­é—´ä»¶ï¼Œä¸‹é¢çš„ä»£ç ä¼šç»å¸¸ä½¿ç”¨åˆ°ï¼Œ`koa` å€ŸåŠ©ä¸­é—´ä»¶æ¥å®ç°å„ç§æ‹“å±•ï¼Œå°±æ˜¯ç±»ä¼¼äºæ’ä»¶çš„åŠŸèƒ½ï¼Œå®ƒæœ¬èº«éå¸¸åƒæ´‹è‘±ç»“æ„\r\n![æ´‹è‘±](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fada01c271eb43c19fa026d988e30642~tplv-k3u1fbpfcp-zoom-1.image)\r\n\r\nä¾‹å¦‚ä¸Šé¢çš„`app.use`å°±æ˜¯ä¸­é—´ä»¶ï¼Œä¸­é—´ä»¶çš„æ‰§è¡Œé¡ºåºä»¥`next`ä¸ºåˆ†å‰²ï¼Œå…ˆæ‰§è¡Œ`next`çš„å‰åŠéƒ¨åˆ†ï¼Œä¹‹åæŒ‰ç…§å€’å™çš„ç»“æ„æ‰§è¡ŒååŠéƒ¨åˆ†çš„`next`ä»£ç ï¼Œçœ‹ä¸€ä¸‹ä¾‹å­\r\n\r\n```js\r\napp.use(async (ctx, next) => {\r\n  console.log(1);\r\n  await next();\r\n  console.log(2);\r\n});\r\n\r\napp.use(async (ctx, next) => {\r\n  console.log(3);\r\n  await next();\r\n  console.log(4);\r\n});\r\n\r\napp.use(async (ctx, next) => {\r\n  console.log(5);\r\n  await next();\r\n  console.log(6);\r\n});\r\n```\r\n\r\nä¸Šé¢ä»£ç çš„æ‰“å°ç»“æœæ˜¯`1,3,5,6,4,2`ï¼Œè¿™å—æœ‰ç‚¹ç»•å¯ä»¥å¤šæƒ³ä¸€ä¸‹ã€‚\r\n\r\næ¥å£å¼€å‘ä¸­ä¸€èˆ¬éƒ½æ˜¯é€šè¿‡`json`æ¥ä¼ é€’æ¶ˆæ¯ï¼Œ`koa`æœ¬èº«çš„è¯­æ³•å·²ç»å¾ˆç®€æ´äº†ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½éœ€è¦è¿”å›æƒ³é‡å¤çš„éƒ¨åˆ†ï¼Œæ—¶é—´é•¿äº†è‚¯å®šä¹Ÿä¼šæœ‰å¤±è¯¯æˆ–è€…æ¼å†™æ‹¼é”™çš„æƒ…å†µï¼Œè¿˜æœ‰æŠ›å‡ºé”™è¯¯ä¹Ÿéœ€è¦æœ‰ä¸€ä¸ªå…¬å…±çš„æ–¹æ³•ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªè¿”å›ä¿¡æ¯å’ŒæŠ›å‡ºé”™è¯¯çš„è®¾æƒ³ã€‚\r\n\r\n```js\r\napp.use(async (ctx) => {\r\n  ctx.sendData({ name: 'hello wrold' });\r\n  // å¦‚æœå‘ç”Ÿé”™è¯¯\r\n  ctx.throwError('ä¸æ»¡è¶³xxx');\r\n});\r\n```\r\n\r\nå¦‚æœä»£ç éƒ½é€šè¿‡è¿™ç§å½¢å¼è¿”å›å°±ç®€å•å¤šäº†ï¼Œè€Œä¸”å®é™…å†™åœ¨ä¸­é—´ä»¶éƒ¨åˆ†çš„ä¹Ÿæ˜¯å¯èƒ½å‡ºç°é—®é¢˜çš„ï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡ `koa` è‡ªå¸¦çš„ç›‘å¬é”™è¯¯æ¥å¤„ç†ï¼Œæˆ–è€…é€šè¿‡ä¸€ä¸ª`try`æ¥åŒ…è£¹ï¼Œå¯ä»¥é¢„æ–™çš„æ˜¯ä¸€ä¸ªä¸ªæ‰‹åŠ¨ç®¡ç†`try`ä¸€å®šä¼šè®©äººæŠ“ç‹‚ã€‚\r\n\r\nå€ŸåŠ©ä¸­é—´ä»¶çš„æœºåˆ¶å¾ˆå®¹æ˜“ç¼–å†™å‡ºä¸€ä¸ªå¸¦æœ‰`sendData`å’Œ`throwError`çš„åŠŸèƒ½ï¼Œåªéœ€è¦åœ¨ ctx ä¸­è¿”å›ï¼Œä¹‹åè°ƒç”¨ next è®©åé¢çš„å®ä¾‹æ‰§è¡Œ\r\n\r\n```js\r\napp.use(async (ctx, next) => {\r\n  ctx.sendData = () => {};\r\n  ctx.throwError = () => {};\r\n  await next();\r\n});\r\n```\r\n\r\nä¸Šé¢çš„ä¾‹å­æ˜¯ç®€åŒ–è¿‡çš„ï¼Œè¿™é‡Œç¨å¾®é”™å¼€ä¸€ä¸‹å…·ä½“å®ç°ä¹‹åå†è¯¦ç»†è®²è§£\r\n\r\n> ä¸­é—´ä»¶çš„é¡ºåºéå¸¸é‡è¦\r\n\r\n## æ¥å£ç»“æ„\r\n\r\nä¸Šé¢è¯´äº†è¦æœ‰ä¸€ä¸ª`sendData`å’Œ`throwError`çš„æ–¹æ³•æ¥ç»Ÿä¸€è¿”å›ä¿¡æ¯å’ŒæŠ›å‡ºé”™è¯¯ï¼Œè¿™é‡Œå°±è¯´ä¸‹è¿™ä¸¤ä¸ªæ–¹æ³•çš„å…·ä½“å‚æ•°ä»¥åŠå®ç°ã€‚\r\n\r\né¦–å…ˆæ¥å£çš„è¿”å›ä¿¡æ¯ï¼ŒæœŸå¾…å®ƒæ˜¯å›ºå®šæˆä¸‹é¢è¿™ç§ç»“æ„\r\n\r\n```json\r\n{\r\n  \"data\": {},\r\n  \"message\": \"ok\",\r\n  \"code\": 200\r\n}\r\n```\r\n\r\nè¿™é‡Œ `data` éƒ¨åˆ†æ˜¯éœ€è¦æ‰‹åŠ¨è¿”å›çš„ï¼Œ`message` æ˜¯å¯é€‰çš„ï¼Œé»˜è®¤çš„æ—¶å€™å¯ä»¥ç»™ä¸€ä¸ª ok ä»¥åŠ 200 çš„ codeï¼Œè¿™é‡Œ`code`å€¼æ˜¯å›ºå®šæ­»çš„ï¼Œæ–¹æ³•ä¸å…è®¸ä¿®æ”¹ï¼Œè¿™æ ·åšæ˜¯å› ä¸ºæˆåŠŸè¿”å›ä¸€èˆ¬ä¸éœ€è¦é¢å¤–çš„ code å€¼\r\n\r\nè€Œé”™è¯¯ä¿¡æ¯ï¼ŒæœŸå¾…å®ƒæ˜¯è¿™ç§ç»“æ„\r\n\r\n```json\r\n{\r\n  \"message\": \"\",\r\n  \"code\": \"400\"\r\n}\r\n```\r\n\r\nè¿™é‡Œ message æ˜¯å¿…å¡«ï¼Œè€Œ code åˆ™æ˜¯å¯é€‰çš„ã€‚\r\n\r\nè¿™é‡Œç¨å¾®è¯´ä¸€ä¸‹é”™è¯¯åˆ°åº•ä½¿ç”¨ `code` æ¥åšåŒºåˆ†ï¼Ÿè¿˜æ˜¯é€šè¿‡`message`æ¥åšåŒºåˆ†ï¼Ÿ\r\nå¦‚æœé€šè¿‡`code`æ¥åšä¸åŒçŠ¶æ€çš„åŒºåˆ†ï¼Œé‚£ä¹ˆå¿…ç„¶è¦ç»´æŠ¤ä¸€ä¸ª code åˆ—è¡¨ï¼Œå…¶å®è¿™æ˜¯å¾ˆç¹ççš„è€Œä¸”å•çº¯çš„æ•°å­—è®°å¿†ä¹Ÿä¸ç¬¦åˆäººçš„è®°å¿†ï¼Œè€Œé€šè¿‡`message`æ¥åšæç¤ºåˆ™åŸºæœ¬ä¸Šå¯ä»¥åšåˆ°å¤§æ¦‚å¯ä»¥çŒœåˆ°é”™è¯¯æƒ…å†µï¼Œä¾‹å¦‚å¯ä»¥è¿™æ ·è¿”å›\r\n\r\n```json\r\n{\r\n  \"message\": \"error_ç”¨æˆ·åä¸èƒ½ä¸ºç©º\"\r\n}\r\n```\r\n\r\nå‰é¢ç±»å‹åé¢æç¤ºï¼Œæ˜¯ä¸æ˜¯ç®€æ´å¾ˆå¤šï¼Œè¿™ä¸¤ç§é”™è¯¯æç¤ºè‡ªå·±é€‰æ‹©ä¸€ç§å³å¯ã€‚\r\n\r\nè¯´äº†éœ€è¦å®ç°çš„åŠŸèƒ½ï¼Œæ–¹æ³•çš„å®ç°å°±å¾ˆç®€å•äº†ï¼Œä¸‹é¢ä»£ç æ˜¯`code`å€¼é£æ ¼çš„å®ç°\r\n\r\n```js\r\n// å¿½ç•¥é¡¶å±‚è¯­æ³•é—®é¢˜ï¼Œè¿™é‡Œæ˜¯æŠŠå®ç°æå–å‡ºæ¥äº†\r\nasync (ctx, next) => {\r\n  const content = {\r\n    ...ctx,\r\n    sendData: (data, message = 'ok') => {\r\n      ctx.body = {\r\n        data,\r\n        message,\r\n        code: 200,\r\n      };\r\n      ctx.type = 'application/json';\r\n    },\r\n    throwError: (message = 'é”™è¯¯', code = 400) => {\r\n      ctx.body = {\r\n        code,\r\n        message,\r\n      };\r\n      ctx.type = 'application/json';\r\n    },\r\n  };\r\n  try {\r\n    await callback(content);\r\n  } catch (e) {\r\n    ctx.body = {\r\n      code: 400,\r\n      message: (e instanceof Error ? e.message : e) || 'ç³»ç»Ÿå‡ºç°é”™è¯¯',\r\n    };\r\n    ctx.status = 400;\r\n  }\r\n  await next();\r\n};\r\n```\r\n\r\n## REST é£æ ¼\r\n\r\nrest æ˜¯ä¸€ç§æ¥å£é£æ ¼ï¼Œç®€å•å¯ä»¥æ¦‚æ‹¬æˆä»¥ä¸‹å‡ ç§\r\n\r\n- ä½¿ç”¨`get`æ¥è·å–èµ„æº\r\n- ä½¿ç”¨`post`æ¥å‘é€è¯·æ±‚\r\n- ä½¿ç”¨`put`æ¥æ›´æ–°èµ„æº\r\n- ä½¿ç”¨`delete`æ¥åˆ é™¤èµ„æº\r\n\r\nè¯´äº†è¿™ä¹ˆå¤šä½¿ç”¨`rest`çš„å¥½å¤„æœ‰å“ªäº›å‘¢ï¼Ÿ\r\n\r\né¦–å…ˆ rest åªæ˜¯ä¸€ç§è§„èŒƒï¼Œå®šä¹‰è¿™ç§è§„èŒƒæ›´æ–¹ä¾¿ç†è§£å’Œé˜…è¯»ï¼Œå’Œä»£ç è§„èŒƒæ˜¯ä¸€ä¸ªæ€§è´¨\r\n\r\n## è‡ªåŠ¨å¯¼å…¥\r\n\r\nåœ¨é¡¹ç›®å¼€å‘ä¸­å¿…ç„¶å­˜åœ¨ä¸åŒçš„æ¥å£ï¼Œå¦‚ä½•ç®¡ç†è¿™äº›æ¥å£å°±å¾ˆæœ‰å¿…è¦çš„ï¼Œä¸€ä¸ªä¸ªæ‰‹åŠ¨å¯¼å…¥ç®¡ç†å›ºç„¶å¯ä»¥ï¼Œä¸è¿‡å½“é¡¹ç›®è¶³å¤Ÿå¤§çš„æ—¶å€™ï¼Œä¸šåŠ¡å˜æ›´çš„æ—¶å€™ä¸€ä¸ªä¸ªè°ƒæ•´ä¸€å®šè®©äººæŠ“ç‹‚ã€‚\r\n\r\nä¸‹é¢å€ŸåŠ©`koa-router`å’Œä¸­é—´ä»¶å°±ç¼–å†™ä¸€ä¸ªè‡ªåŠ¨å¯¼å…¥æ¥å£çš„åŠŸèƒ½ï¼Œå…ˆçœ‹ä¸€ä¸‹`koar-router`çš„ç®€å•ä½¿ç”¨\r\n\r\n```sh\r\nyarn add @koa/router\r\n```\r\n\r\n```js\r\nconst Koa = require('koa');\r\nconst Router = require('@koa/router');\r\n\r\nconst hostname = '127.0.0.1';\r\nconst port = 3000;\r\nconst app = new Koa();\r\nconst router = new Router();\r\n\r\nrouter.get('/', (ctx, next) => {\r\n  ctx.type = 'application/json';\r\n  ctx.body = { name: 'hello wrold' };\r\n});\r\n\r\napp.use(router.routes()).use(router.allowedMethods());\r\n\r\napp.listen(port, hostname, () => {\r\n  console.log(`æœåŠ¡å™¨è¿è¡Œåœ¨ http://${hostname}:${port}/`);\r\n});\r\n```\r\n\r\nè¦å®ç°è¿™ä¸ªåŠŸèƒ½å…ˆå®šä¹‰ä¸€ä¸‹è§„åˆ™\r\n\r\n- åªå¯¼å…¥`src`ç›®å½•ä¸‹`index.js`ç»“å°¾çš„æ¥å£æ–‡ä»¶\r\n\r\n  æœç´¢æ‰€æœ‰ç¬¦åˆè¦æ±‚çš„`index.js`æ–‡ä»¶ï¼Œå¯ä»¥å€ŸåŠ©`glob`æ¨¡å—æ¥å®ç°ï¼Œå€ŸåŠ©é€šé…ç¬¦`'src/**/index.js'`å³å¯ã€‚\r\n\r\n- å¯¼å…¥æ–‡ä»¶ï¼ŒæŠŠå¯¹åº”æ¨¡æ¿è¿”å›çš„å­—æ®µæ·»åŠ åˆ°`router`ä¸Š\r\n\r\n  è¿™é‡Œå¯ä»¥é€šè¿‡ node åŸç”Ÿ`require`æ¥è¯»å–æ–‡ä»¶ï¼Œåœ¨å…·ä½“å®ç°çš„æ—¶å€™éœ€è¦ç¨å¾®æ³¨æ„ï¼Œå¿…é¡»æ»¡è¶³æ ¼å¼çš„æ¨¡å—æ‰èƒ½è¢«å¯¼å…¥ï¼Œè€Œä¸”è¦æ·»åŠ `try`æ¥æ•æ‰ä¸æ˜¯`modules`çš„æ–‡ä»¶\r\n\r\nåœ¨åŠ¨æ‰‹å®ç°è¿™ä¸ªå‡½æ•°ä¹‹å‰ï¼Œè¿˜è¦çº¦å®šä¸€ä¸‹`index.js`æ–‡ä»¶çš„å†…çš„æ¨¡å—æ ¼å¼æ˜¯ä»€ä¹ˆæ ·çš„\r\n\r\n```js\r\nconst api = {\r\n  url: '',\r\n  methods: 'get' || ['post'],\r\n  async callback(ctx) {},\r\n};\r\n```\r\n\r\nä¸Šé¢æ˜¯çº¦å®šçš„æ ¼å¼ï¼Œåªæœ‰æ»¡è¶³è¿™æ ·çš„ç»“æ„æ‰ä¼šè¢«å¯¼å…¥è¿›æ¥ï¼Œå› ä¸ºå¼€å‘ç”¨çš„æ˜¯`ts`è¿™é‡Œå°±ä¸åšè½¬æ¢`js`çš„æ“ä½œäº†ï¼Œå¦‚æœä¸æƒ³ä½¿ç”¨ ts ç›´æ¥å¿½ç•¥æ‰ç±»å‹æ ‡æ³¨çœ‹å¤§æ¦‚å®ç°å³å¯ã€‚\r\n\r\nutils.ts\r\n\r\n```js\r\nimport glob from 'glob';\r\nimport path from 'path';\r\nimport _ from 'lodash';\r\nimport { Iobj, Istructure } from '../../typings/structure';\r\n\r\nexport const globFile = (pattern: string): Promise<Array<string>> => {\r\n  return new Promise((resolve, reject) => {\r\n    glob(pattern, (err, files) => {\r\n      if (err) {\r\n        return reject(err);\r\n      }\r\n      return resolve(files);\r\n    });\r\n  });\r\n};\r\n\r\nexport const importModule = async () => {\r\n  const pattern = 'src/**/index.ts';\r\n  const list = await globFile(pattern);\r\n  const listMap = list.map((item) => {\r\n    const f = path.resolve(process.cwd(), item);\r\n    return import(f)\r\n      .then((res) => {\r\n        // è¿‡æ»¤æ‰defaultçš„å±æ€§ï¼Œå…¶å®ƒçš„è¿”å›\r\n        return _.omit(res, ['default']);\r\n      })\r\n      .catch(() => null);\r\n  });\r\n  return (await Promise.all(listMap)).filter((f) => f) as Array<Iobj<Istructure>>;\r\n};\r\n\r\n```\r\n\r\n> è¿™é‡Œæ³¨æ„ä¸€ä¸‹ï¼Œå› ä¸ºç”¨çš„ ts æ‰€ä»¥ç”¨äº† `import()`å¦‚æœåªæ˜¯ç”¨ node è¯­æ³•ç›´æ¥ `require` å³å¯\r\n\r\nindex.ts\r\n\r\n```js\r\nimport Router from '@koa/router';\r\nimport _ from 'lodash';\r\nimport { Ictx, Iobj } from '../../typings/structure';\r\n\r\nimport { importModule } from './utils';\r\nimport Koa from 'koa';\r\n\r\nconst route = async (koa: Koa) => {\r\n  const router = new Router();\r\n  const list = await importModule();\r\n\r\n  for (const fileAll of list) {\r\n    // å°†æ•°æ®è§£æ„ï¼Œè¿™é‡Œè¿”å›çš„æ˜¯{xxx: {url,methods,callback}}è¿™æ ·è§£æ„\r\n\r\n    // è¿‡æ»¤ä¸ç¬¦åˆæ¡ä»¶çš„æ¨¡å—\r\n    for (const file of Object.values(fileAll)) {\r\n      if (\r\n        !_.isObjectLike(file) ||\r\n        !['url', 'methods', 'callback'].every((f) =>\r\n          Object.keys(file).includes(f)\r\n        )\r\n      ) {\r\n        continue;\r\n      }\r\n      const { url, methods, callback } = file;\r\n      const methodsArr = _.isArray(methods) ? methods : [methods];\r\n      for (const met of methodsArr) {\r\n        router[met](url, async (ctx, next) => {\r\n          const content: Ictx = {\r\n            ...ctx,\r\n            sendData: (data: Iobj, message = 'ok') => {\r\n              ctx.body = {\r\n                data,\r\n                message,\r\n                code: 200,\r\n              };\r\n              ctx.type = 'application/json';\r\n            },\r\n            throwError: (message = 'é”™è¯¯', code = 400) => {\r\n              ctx.body = {\r\n                code,\r\n                message,\r\n              };\r\n              ctx.type = 'application/json';\r\n            },\r\n          };\r\n          try {\r\n            await callback(content);\r\n          } catch (e) {\r\n            ctx.body = {\r\n              code: 400,\r\n              message: (e instanceof Error ? e.message : e) || 'ç³»ç»Ÿå‡ºç°é”™è¯¯',\r\n            };\r\n            ctx.status = 400;\r\n          }\r\n          await next();\r\n        });\r\n      }\r\n    }\r\n  }\r\n  koa.use(router.routes()).use(router.allowedMethods());\r\n};\r\n\r\nexport default route;\r\n```\r\n\r\n## æ—¥å¿—\r\n\r\nå€ŸåŠ© koa çš„ä¸­é—´ä»¶ä¹Ÿå¾ˆå®¹æ˜“å®ç°æ—¥å¿—çš„åŠŸèƒ½ï¼Œè¿™é‡Œä»¥[winston](https://github.com/winstonjs/winston)ä¸ºä¾‹\r\n\r\næ—¥å¿—ä¸»è¦è®°å½•ç³»ç»Ÿè¿è¡Œæ—¶çš„é”™è¯¯ï¼Œè¿˜è®°çš„ä¸Šé¢é€šè¿‡`try`æ¥æ•æ‰é”™è¯¯çš„ä¾‹å­ä¹ˆï¼Œç°åœ¨è®©ä»–ç»§ç»­æŠ›å‡ºé”™è¯¯ï¼Œç›´æ¥é€šè¿‡ä¸­é—´ä»¶ try æ•æ‰é”™è¯¯å†™å…¥åˆ°æ–‡ä»¶ã€‚\r\n\r\n```js\r\nimport winston from 'winston';\r\nimport Koa from 'koa';\r\n\r\nimport 'winston-daily-rotate-file';\r\nconst transport = new winston.transports.DailyRotateFile({\r\n  filename: 'log/%DATE%.log',\r\n  datePattern: 'YYYY-MM-DD-HH',\r\n  zippedArchive: true,\r\n  maxSize: '20m',\r\n  maxFiles: '14d',\r\n});\r\n\r\nconst logger = winston.createLogger({\r\n  transports: [transport],\r\n});\r\n\r\nconst asyncwinston = async (\r\n  _ctx: Koa.ParameterizedContext<Koa.DefaultState, Koa.DefaultContext>,\r\n  next: Koa.Next\r\n) => {\r\n  try {\r\n    await next();\r\n  } catch (err) {\r\n    const data = {\r\n      data: err,\r\n      time: new Date().valueOf(),\r\n    };\r\n    if (err instanceof Error) {\r\n      data.data = {\r\n        content: err.message,\r\n        name: err.name,\r\n        stack: err.stack,\r\n      };\r\n    }\r\n    logger.error(JSON.stringify(data));\r\n  }\r\n};\r\n\r\nexport default asyncwinston;\r\n```\r\n\r\n## å¯åŠ¨\r\n\r\nå¯åŠ¨å°±å¾ˆç®€å•äº†ï¼ŒæŠŠä¸Šé¢æš´éœ²çš„ index.js é€šè¿‡`koa`çš„ use å¼•å…¥\r\n\r\nApp.js\r\n\r\n```js\r\nconst Koa = require('koa');\r\nconst bodyParser = require('koa-bodyparser');\r\nconst route = require('./middleware/route');\r\nconst winston = require('./middleware/winston');\r\n\r\nconst App = async () => {\r\n  const app = new Koa();\r\n  app.use(winston);\r\n  app.use(bodyParser());\r\n  await route(app);\r\n  return app;\r\n};\r\n\r\nmodule.exports = App;\r\n```\r\n\r\nstart.js\r\n\r\n```js\r\nconst Koa = require('koa');\r\nconst ip = require('ip');\r\nconst App = require('./App');\r\n\r\nconst start = async () => {\r\n  const app = await App();\r\n  notice(app);\r\n};\r\n\r\nconst notice = (koa: Koa) => {\r\n  const port = 3000;\r\n  const ipStr = ip.address();\r\n  const str = `http://${ipStr}:${port}`;\r\n  koa.listen(port, () => {\r\n    console.log(`æœåŠ¡å™¨è¿è¡Œåœ¨\\n${str}`);\r\n  });\r\n};\r\n\r\nstart();\r\n```\r\n\r\n**è¿™é‡Œç¨å¾®è¯´æ˜ä¸€ä¸‹ä¸ºä»€ä¹ˆåˆ†æˆä¸¤ä¸ªæ–‡ä»¶ï¼Œè¿™æ˜¯å› ä¸ºæ–¹ä¾¿æ¥å£æµ‹è¯•ç‰¹æ„åˆ†å±‚çš„ï¼Œ`start`åªåšå¯åŠ¨çš„ç”¨é€”**\r\n\r\næœ€åæ·»åŠ ä¸€ä¸ª`node-dev`çš„æ¨¡å—ï¼Œå°±å¤§åŠŸå‘Šæˆäº†\r\n\r\n10/21 è¡¥å……\r\n\r\n> ä¸Šé¢çš„ node-devï¼Œæ˜¯å¼€å‘ç¯å¢ƒä¸‹ä½¿ç”¨çš„ï¼Œæ–¹ä¾¿ä»£ç çš„å¿«é€Ÿé‡å¯ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹å¯ä»¥ä½¿ç”¨ [pm2](https://github.com/Unitech/pm2)\r\n\r\n```js\r\n// å®‰è£…\r\nyarn add node-dev\r\n// å¯åŠ¨\r\nnode-dev start.js\r\n```\r\n\r\né€šè¿‡`node-dev`å¯åŠ¨ä¸»è¦æ˜¯å¯ä»¥æ–¹ä¾¿ä¿®æ”¹æ¥å£å¯ä»¥ç›´æ¥é‡è½½ä»¥åŠé€šçŸ¥çš„æ–¹å¼æ›´æ˜æ˜¾\r\n\r\n## æ¥å£æµ‹è¯•\r\n\r\n12/21 è¡¥ä¸Š\r\n\r\né¦–å…ˆåœ¨ src ç›®å½•ä¸‹ æ–°å»ºä¸€ä¸ª `index.ts` æ–‡ä»¶ï¼Œç”¨äºæµ‹è¯•çš„æ¥å£\r\n\r\n```js\r\nimport { Istructure } from '../typings/structure';\r\n\r\nconst testGet: Istructure = {\r\n  url: '/api/:id',\r\n  methods: 'get',\r\n  async callback(ctx) {\r\n    const { id } = ctx?.params;\r\n    ctx?.sendData({ name: 'hello', id });\r\n  },\r\n};\r\nconst testPost: Istructure = {\r\n  url: '/api',\r\n  methods: 'post',\r\n  async callback(ctx) {\r\n    const body = ctx?.request.body;\r\n    ctx?.sendData(body || {});\r\n  },\r\n};\r\n\r\nexport { testGet, testPost };\r\n```\r\n\r\nä¸Šé¢æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„ post å’Œ get è¯·æ±‚ï¼Œä¹‹åæˆ‘ä»¬æ–°å»ºä¸€ä¸ª`__test__`ç›®å½•ï¼Œåœ¨é‡Œé¢æ–°å»ºä¸€ä¸ª`index.test.js`æ–‡ä»¶\r\n\r\n```sh\r\nyarn add @babel/core @babel/preset-env @babel/preset-typescript babel-jest jest supertest\r\n```\r\n\r\nåœ¨æ ¹ç›®å½•æ–°å»º`babel.config.js`æ–‡ä»¶\r\n\r\n```js\r\n// babel.config.js\r\nmodule.exports = {\r\n  presets: [\r\n    ['@babel/preset-env', { targets: { node: 'current' } }],\r\n    '@babel/preset-typescript',\r\n  ],\r\n};\r\n```\r\n\r\nç®€å•è¯´ä¸‹ï¼Œè¿™ä¸ª babel çš„ä½œç”¨æ˜¯è®©æˆ‘ä»¬å¯ä»¥åœ¨ js é‡Œé¢ä½¿ç”¨ `es6 module` çš„è¯­æ³•ï¼ŒåŒæ—¶å°† ts æ–‡ä»¶è½¬æˆ jsï¼Œå¦åˆ™æˆ‘ä»¬è¿™ä¸ªæµ‹è¯•ç”¨ä¾‹æ˜¯ ts çš„æ ¹æœ¬è·‘ä¸èµ·æ¥ï¼Œæµ‹è¯•æ¡†æ¶æ–¹é¢é€‰ç”¨äº†`jest`æµ‹è¯• http åº“ä½¿ç”¨äº†`supertest`ï¼Œå…¶å®è¿™å—éƒ½æ˜¯å¯ä»¥è°ƒæ•´çš„ï¼Œå•å…ƒæµ‹è¯•çš„ç›®çš„å°±æ˜¯å¯¹æ¯”æ•°æ®æ˜¯å¦ç¬¦åˆé¢„æœŸ\r\n\r\n`__test__ index.test.js`\r\n\r\n```js\r\nimport App from '../App';\r\n\r\nimport supertest from 'supertest';\r\n\r\ntest('getè¯·æ±‚æµ‹è¯•', async () => {\r\n  const app = await App();\r\n  const request = supertest(app.listen());\r\n  const id = 6;\r\n  const data = { name: 'hello', id: `${id}` };\r\n  const res = await request.get(`/api/${id}`).expect(200);\r\n  const body = res.body.data;\r\n  expect(body).toEqual(data);\r\n});\r\n\r\ntest('postè¯·æ±‚æµ‹è¯•', async () => {\r\n  const app = await App();\r\n  const request = supertest(app.listen());\r\n  const data = { name: 'hello', id: 8 };\r\n  const res = await request.post(`/api/`).send(data).expect(200);\r\n  const body = res.body.data;\r\n  expect(body).toEqual(data);\r\n});\r\n```\r\n\r\nè¿è¡Œ `npx jest `ï¼Œå‘½ä»¤è¡Œå¦‚æœæ²¡æœ‰æŠ›å‡ºå¼‚å¸¸è¯´æ˜æˆ‘ä»¬çš„ä»£ç ç¬¦åˆé¢„æœŸï¼Œå…³äºæ›´å¤šçš„ jest å†…å®¹å¯ä»¥æŸ¥çœ‹æ–‡æ¡£\r\n\r\n## æœ€å\r\n\r\nå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©æ¬¢è¿ `stat`ï¼Œå¦‚æœæœ‰ä»€ä¹ˆé”™è¯¯ä¹‹å¤„æ¬¢è¿æŒ‡å‡ºï¼Œå…³äºä»£ç æœ¬æ¥å…¨éƒ¨æƒ³ç”¨ ts ä¸¾ä¾‹çš„ï¼Œä½†æ˜¯ ts å¹¶ä¸æ˜¯ä¸€å®šè¦ä¸Šçš„ï¼Œæ‰€ä»¥æŸäº›åœºæ™¯æˆ‘å°±æ‰‹åŠ¨è½¬äº†ä¸€ä¸‹ï¼Œçœ‹èµ·æ¥æœ‰ç‚¹é£æ ¼ä¸ç»Ÿä¸€è¿˜æœ›è°…è§£\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/65/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/65/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/61",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/61/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/61/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/61/events",
          "html_url": "https://github.com/bosens-China/blog/issues/61",
          "id": 680636174,
          "node_id": "MDU6SXNzdWU2ODA2MzYxNzQ=",
          "number": 61,
          "title": "æ–‡å­—é«˜äº®",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1371686609,
              "node_id": "MDU6TGFiZWwxMzcxNjg2NjA5",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/JavaScript",
              "name": "JavaScript",
              "color": "F7DF1E",
              "default": false,
              "description": "JavaScriptç³»åˆ—çš„æ–‡ç« "
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2020-08-18T02:15:53Z",
          "updated_at": "2021-12-21T03:30:00Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "![bg](https://user-images.githubusercontent.com/39508895/90462493-935eb900-e13b-11ea-902c-dce1e576fbb4.png)\r\n\r\nå¦‚ä¸Šå›¾ï¼Œå¯èƒ½åœ¨æœç´¢ä¹‹ç±»çš„æ—¶å€™éœ€è¦å°†æœç´¢å†…å®¹è¿›è¡Œé«˜äº®ï¼Œä¸‹é¢èŠèŠå°ç¨‹åºå’Œ web ä¸Šå¦‚ä½•å®ç°ã€‚\r\n\r\n## web ä¸Šåšæ³•\r\n\r\nå¯ä»¥é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼`/(é«˜äº®çš„æ–‡å­—)/`æ¥å®ç°\r\n\r\n```js\r\nfunction highlight(str, sep, color) {\r\n  const reg = new RegExp(`\\(${sep}\\)`, 'g');\r\n  return str.replace(reg, `<i style=\"color:${color};\">$1</i>`);\r\n}\r\nhighlight('å®‰å¾½çœåˆè‚¥å¸‚', 'å®‰å¾½', 'reg');\r\n// <i style=\"color:reg;\">å®‰å¾½</i>çœåˆè‚¥å¸‚\r\n```\r\n\r\nè¿™é‡Œå®ç°æ¯”è¾ƒç®€å•ï¼Œç¨å¾®æ³¨æ„ä¸€ä¸‹`replace`api å³å¯ï¼Œå®ƒè¿˜å¯ä»¥æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå…·ä½“å†…å®¹è¿™é‡Œä¸åšè®²è§£äº†åªç®€å•å®ç°ä¸€ä¸‹ã€‚\r\n\r\n## å°ç¨‹åºåšæ³•\r\n\r\nä¸åŒäº webï¼Œå› ä¸ºå°ç¨‹åºæ— æ³•æ‰‹åŠ¨ç®¡ç† `dom` æ ·å¼ï¼Œæ‰€ä»¥æ€è·¯æ˜¯å°†`é«˜äº®æ–‡å­—`å’Œæ™®é€šæ–‡å­—åŒºåˆ†å¼€æ¥ï¼Œä¾‹å¦‚ï¼š\r\n\r\n```js\r\nvar str = 'å®‰å¾½çœåˆè‚¥å¸‚èœ€å±±åŒº';\r\n// å¦‚æœé«˜äº®åˆè‚¥å¸‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬æŠŠä»–è½¬åŒ–ä¸ºä¸‹é¢è¿™ç§å½¢å¼çš„æ•°ç»„\r\n['å®‰å¾½çœ', 'åˆè‚¥å¸‚', 'èœ€å±±åŒº'];\r\n```\r\n\r\nå°†æ™®é€šæ–‡å­—å’Œé«˜äº®æ–‡å­—é€šè¿‡æ•°ç»„çš„å½¢å¼åŒºåˆ†å¼€æ¥ï¼Œä¹‹åå†é€šè¿‡`<text>`æ ‡ç­¾å°†è½¬æ¢åçš„æ•°ç»„`for`å¾ªç¯ï¼Œæ¯æ¬¡å¾ªç¯çš„ç»“æœä¸é«˜äº®æ–‡å­—å¯¹æ¯”ï¼Œå¦‚æœç¬¦åˆå°±æ·»åŠ é«˜äº®æ ·å¼ã€‚\r\n\r\n```html\r\n<view>\r\n  <text\r\n    style=\"{{item === keyWord ? 'color:' + color + ';' : ''}}\"\r\n    wx:for=\"{{arr}}\"\r\n    wx:key=\"item\"\r\n  >\r\n    {{item}}\r\n  </text>\r\n</view>\r\n```\r\n\r\næ•´ä½“çš„æ€è·¯å°±æ˜¯è¿™æ ·ï¼Œä¸‹é¢è¯´ä¸€ä¸‹å®ç°çš„ç»†èŠ‚ã€‚\r\n\r\n- æ€ä¹ˆå°†ä¸€æ®µæ–‡å­—è½¬åŒ–ä¸ºä¸Šé¢æ•°ç»„çš„å½¢å¼\r\n  å…¶å®è¿™å—è¦åˆ†ä¸ºä¸¤æ­¥ï¼Œå°†æ–‡å­—è½¬åŒ–ä¸ºæ•°ç»„æˆ‘ä»¬å¯ä»¥ç”¨`split`çš„æ–¹æ³•ï¼Œä¹‹åé€šè¿‡ä¸€ä¸ªå˜å¼‚çš„`join`å°†ä»–ä»¬æ‹¼æˆæ•°ç»„ã€‚\r\n\r\n```js\r\nfunction join(array, str) {\r\n  const arr = [];\r\n  const len = array.length;\r\n  for (let i = 0; i < len - 1; i++) {\r\n    const value = array[i];\r\n    if (!value) {\r\n      arr.push(str);\r\n    } else {\r\n      arr.push(value, str);\r\n    }\r\n  }\r\n  if (array[len - 1]) {\r\n    arr.push(array[len - 1]);\r\n  }\r\n  return arr;\r\n}\r\n```\r\n\r\næŠŠä¸Šé¢çš„`wxml`ä»£ç ç‰‡æ®µå’Œ`join`ç›¸å…³ç»„åˆä¸€èµ·å°±å¯ä»¥å®ç°ä¸€ä¸ªæ–‡å­—é«˜äº®çš„æ•ˆæœäº†ã€‚\r\n\r\nä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œæˆ‘è¿™é‡Œå·²ç»å°è£…æˆä¸€ä¸ªåº“äº†[highlight](https://github.com/bosens-China/highlight)\r\n\r\n## æœ€å\r\n\r\nç›¸å…³ä»£ç æ•´åˆåˆ°äº†[Github](https://github.com/bosens-China/highlight)\r\n\r\nå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©å¯ä»¥`star`æ”¯æŒä½œè€…ä¸€ä¸‹ã€‚\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/61/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/61/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/44",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/44/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/44/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/44/events",
          "html_url": "https://github.com/bosens-China/blog/issues/44",
          "id": 547208786,
          "node_id": "MDU6SXNzdWU1NDcyMDg3ODY=",
          "number": 44,
          "title": "globalå¯¹è±¡è·å–",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1371686609,
              "node_id": "MDU6TGFiZWwxMzcxNjg2NjA5",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/JavaScript",
              "name": "JavaScript",
              "color": "F7DF1E",
              "default": false,
              "description": "JavaScriptç³»åˆ—çš„æ–‡ç« "
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2020-01-09T02:19:18Z",
          "updated_at": "2021-12-21T03:03:16Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "global åœ¨å¼€å‘ä¸­ç»å¸¸ç»å¸¸ä½¿ç”¨ï¼Œä¾‹å¦‚ä¸‹é¢ä¸€æ®µä»£ç è°ƒç”¨çš„å°±æ˜¯ global å†…ç½®çš„å¯¹è±¡\r\n\r\n```js\r\nconst min = Math.min(...[1, 11, 22, 55, -2, -1]);\r\n```\r\n\r\nè¿™é‡Œçš„ Math å¯¹è±¡å°±æ˜¯ global å†…ç½®çš„ï¼Œåœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹æˆ‘ä»¬å¯ä»¥é€šè¿‡`window.Math.min`æ˜¾ç¤ºè°ƒç”¨ï¼Œè€Œåœ¨ node ç¯å¢ƒä¸‹æˆ‘ä»¬åˆ™è¦é€šè¿‡`global.Math.min`æ¥è°ƒç”¨ï¼Œåœ¨å®é™…ä¸­æˆ‘ä»¬ä¸ä¼šé€šè¿‡`window.Math.min`è¿™ç§æ–¹å¼æ¥è°ƒç”¨ï¼Œä¸è¿‡å´ä¹Ÿèƒ½çœ‹åˆ°ä¸åŒç¯å¢ƒä¸‹è·å– global å¯¹è±¡å„ä¸ç›¸åŒã€‚\r\n\r\nä¸‹é¢å°±ä»¥ç¼–å†™ä¸€ä¸ªç°ä»£çš„å·¥å…·åº“ä¸ºå‡è®¾ï¼Œè¿™ä¸ªåº“è¦æ”¯æŒå…¨å±€å¼•ç”¨ä¹Ÿæ˜¯å¾ˆç§‘å­¦çš„ï¼Œä½†æ˜¯å¦‚ä½•è®©å…¶æŒ‚è½½åœ¨å…¨å±€å±æ€§ä¸Šå‘¢ï¼Ÿ\r\n\r\n## ç¬¬ä¸€ç‰ˆ\r\n\r\n```js\r\n(function() {\r\n  var _global = this;\r\n  var _ = {};\r\n  _.debounce = function() {};\r\n  // ...ä¸€äº›å…¶ä»–çš„æ–¹æ³•\r\n  return (_global._ = _);\r\n})();\r\n```\r\n\r\nè¿™é‡Œçš„æƒ³æ³•æ˜¯é€šè¿‡å…¨å±€ç¯å¢ƒä¸‹è¿è¡Œ this æ¥è¿”å›ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œåœ¨å…¨å±€å¯¹è±¡ä¸ŠæŒ‚è½½æˆ‘ä»¬çš„å·¥å…·å‡½æ•°ï¼Œä¸é€šè¿‡ `window` æ˜¾ç¤ºæŒ‚è½½æ˜¯å› ä¸ºæˆ‘ä»¬ä¸ä»…è¦è®©è¿™ä¸ªå·¥å…·åº“è¿è¡Œåœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹,åŒæ—¶ä¹Ÿè®©ä»–è¿è¡Œåœ¨ `node` ç¯å¢ƒä¸­ã€‚\r\n\r\n## ä¸¥æ ¼æ¨¡å¼\r\n\r\nä¸Šé¢çš„å†™æ³•æ˜¯å‡è®¾åœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹è¿è¡Œï¼Œè€Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹è¿è¡Œï¼Œthis ä¼šè¿”å›ä¸€ä¸ª`undefined`\r\n\r\n```js\r\n(function() {\r\n  \"use strict\";\r\n  console.log(this === undefined); // true\r\n})();\r\n```\r\n\r\nä¸‹é¢æˆ‘ä»¬æ¥å°è¯•ä¿®è®¢ä¸€ä¸‹ä¸¥æ ¼æ¨¡å¼ä¸‹çš„é”™è¯¯\r\n\r\n```js\r\n(function() {\r\n  // é˜²æ­¢nullå‡ºç°\r\n  function isObjectLike(par) {\r\n    return par && typeof par == \"object\";\r\n  }\r\n  var _global;\r\n  if (isObjectLike(global) && global.global === global) {\r\n    _global = global;\r\n  } else {\r\n    _global = window;\r\n  }\r\n  var _ = {};\r\n  _.debounce = function() {};\r\n  // ...ä¸€äº›å…¶ä»–çš„æ–¹æ³•\r\n  return (_global._ = _);\r\n})();\r\n```\r\n\r\nè¿™é‡Œæˆ‘ä»¬é€šè¿‡åˆ¤æ–­ global æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨å°±æ˜¯ `node` ç¯å¢ƒå¦‚æœä¸å­˜åœ¨å°±æ˜¯æµè§ˆå™¨ç¯å¢ƒã€‚\r\n\r\n> `global.global`å’Œ`window.window`éƒ½æ˜¯æŒ‡å‘è‡ªèº«ï¼Œå¯ä»¥ç†è§£ä¸ºæ— é™åµŒå¥—çš„å±æ€§\r\n\r\n## Web Worker\r\n\r\nWeb Worker æ˜¯ä¸º JavaScript åˆ›é€ å¤šçº¿ç¨‹ç¯å¢ƒå‡ºç°çš„ï¼Œä¸è¿‡ä½¿ç”¨å®ƒæ˜¯æœ‰ä¸€äº›é™åˆ¶æ— æ³•ä½¿ç”¨ `documentã€windowã€parent`ç­‰è¿™äº›å¯¹è±¡ï¼Œæ‰€ä»¥åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­å¦‚æœæˆ‘ä»¬åœ¨ Web Worker ç¯å¢ƒä¸­ä¸€å®šä¼šæŠ¥é”™ï¼Œå› ä¸ºä¸å­˜åœ¨ `global` å’Œ `window` å¯¹è±¡\r\n\r\nä¸è¿‡ Worker å¯ä»¥é€šè¿‡`self`æ¥æ‹¿åˆ°å­çº¿ç¨‹çš„å…¨å±€å¯¹è±¡ï¼Œè€Œä¸” self åœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹ä¹ŸæŒ‡å‘ window\r\n\r\n```js\r\n(function() {\r\n  // é˜²æ­¢nullå‡ºç°\r\n  function isObjectLike(par) {\r\n    return par && typeof par == \"object\";\r\n  }\r\n  var _global;\r\n  if (isObjectLike(global) && global.global === global) {\r\n    _global = global;\r\n  } else if (isObjectLike(self) && self === self) {\r\n    _global = self;\r\n  }\r\n  var _ = {};\r\n  _.debounce = function() {};\r\n  // ...ä¸€äº›å…¶ä»–çš„æ–¹æ³•\r\n  return (_global._ = _);\r\n})();\r\n```\r\n\r\n## node è™šæ‹Ÿæœº\r\n\r\nnode vmï¼ˆæ²™ç›’ï¼‰ ç¯å¢ƒä¸‹ä¸å­˜åœ¨ global å’Œ window å¯¹è±¡ï¼Œæ‰€ä»¥ä¸Šé¢ä»£ç è¿˜æ˜¯ä¼šå‡ºç°é—®é¢˜ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥é€šè¿‡\r\n`new Function('return this')()`æˆ–è€…`this`çš„å½¢å¼æ¥è§£å†³\r\n\r\n```js\r\n(function() {\r\n  // é˜²æ­¢nullå‡ºç°\r\n  function isObjectLike(par) {\r\n    return par && typeof par == \"object\";\r\n  }\r\n  var _global;\r\n  if (isObjectLike(global) && global.global === global) {\r\n    _global = global;\r\n  } else if (isObjectLike(self) && self === self) {\r\n    _global = self;\r\n  } else {\r\n    _global = new Function(\"return this\")();\r\n    // æˆ–è€…\r\n    // _global = this;\r\n  }\r\n  var _ = {};\r\n  _.debounce = function() {};\r\n  // ...ä¸€äº›å…¶ä»–çš„æ–¹æ³•\r\n  return (_global._ = _);\r\n})();\r\n```\r\n\r\n## Content Security Policy\r\n\r\nä¸Šé¢ä½ å¯èƒ½æ³¨æ„åˆ°äº†ï¼Œæˆ‘åœ¨ä¸Šä¸€ç‰ˆæåˆ°äº†ä¸¤ä¸ªæ–¹æ³•æ¥æœ€åè·å– `global` çš„å€¼\r\n\r\n- \\_global = new Function(\"return this\")();\r\n- \\_global = this;\r\n\r\nä¸è¿‡åœ¨ç½‘é¡µå®‰å…¨æ”¿ç­–ï¼ˆContent Security Policyï¼‰ä¸‹åªä¼šåŠ è½½ä¿¡ä»»çš„ç™½åå•ï¼Œ`evalã€new Function`è¿™äº›æ–¹æ³•éƒ½å¯èƒ½æ— æ³•ä½¿ç”¨ï¼Œåªèƒ½ä½¿ç”¨`\\_global = this`æ¥è·å– global\r\n\r\n```js\r\n(function() {\r\n  // é˜²æ­¢nullå‡ºç°\r\n  function isObjectLike(par) {\r\n    return par && typeof par == \"object\";\r\n  }\r\n  var _global;\r\n  if (isObjectLike(global) && global.global === global) {\r\n    _global = global;\r\n  } else if (isObjectLike(self) && self === self) {\r\n    _global = self;\r\n  } else {\r\n    // æˆ–è€…\r\n    _global = this;\r\n  }\r\n  var _ = {};\r\n  _.debounce = function() {};\r\n  // ...ä¸€äº›å…¶ä»–çš„æ–¹æ³•\r\n  return (_global._ = _);\r\n})();\r\n```\r\n\r\n## å¾®ä¿¡å°ç¨‹åº\r\n\r\nåœ¨å¾®ä¿¡å°ç¨‹åºä¸­`global`å’Œ`window`éƒ½ä¸å­˜åœ¨å†åŠ ä¸Šä½¿ç”¨çš„æ˜¯ä¸¥æ ¼æ¨¡å¼ï¼Œthis ä¼šè¿”å›`undefined`æ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦åœ¨åŠ ä¸€ä¸ªåˆ¤æ–­\r\n\r\n```js\r\n(function() {\r\n  // é˜²æ­¢nullå‡ºç°\r\n  function isObjectLike(par) {\r\n    return par && typeof par == \"object\";\r\n  }\r\n  var _global;\r\n  if (isObjectLike(global) && global.global === global) {\r\n    _global = global;\r\n  } else if (isObjectLike(self) && self === self) {\r\n    _global = self;\r\n  } else {\r\n    // æˆ–è€…\r\n    _global = this || {};\r\n  }\r\n  var _ = {};\r\n  _.debounce = function() {};\r\n  // ...ä¸€äº›å…¶ä»–çš„æ–¹æ³•\r\n  return (_global._ = _);\r\n})();\r\n```\r\n\r\n## globalThis\r\n\r\nä¸Šé¢çš„åˆ¤æ–­æ–¹å¼æ˜¯ç°åœ¨ç¤¾åŒºä¸»æµåšæ³•ï¼Œä¸è¿‡åœ¨ tc39 çš„ææ¡ˆä¸­`globalThis`å¯ä»¥è·å–å…¨å±€å¯¹è±¡ï¼Œä½¿ç”¨æ–¹æ³•ä¹Ÿå¾ˆç®€å•\r\n\r\n```js\r\n// æµè§ˆå™¨ç¯å¢ƒ\r\nglobalThis === window; // true\r\n// node\r\nglobalThis === global; // true\r\n```\r\n\r\nç›®å‰æ˜¯`Stage 3`ä½¿ç”¨çš„è¯è¿˜æ˜¯éœ€è¦åšä¸€äº›å…¼å®¹æ€§çš„å¤„ç†ï¼Œä¸‹é¢å°±æ¥å†™æœ€åä¸€ç‰ˆ\r\n\r\n```js\r\n(function() {\r\n  // é˜²æ­¢nullå‡ºç°\r\n  function isObjectLike(par) {\r\n    return par && typeof par == \"object\";\r\n  }\r\n  function getGlobal() {\r\n    if (isObjectLike(globalThis) && globalThis.Object === Object) {\r\n      return globalThis;\r\n    }\r\n    if (isObjectLike(global) && global.global === global) {\r\n      return global;\r\n    }\r\n\r\n    if (isObjectLike(self) && self === self) {\r\n      return self;\r\n    }\r\n    return this || {};\r\n  }\r\n\r\n  var _global = getGlobal();\r\n  var _ = {};\r\n  _.debounce = function() {};\r\n  // ...ä¸€äº›å…¶ä»–çš„æ–¹æ³•\r\n  return (_global._ = _);\r\n})();\r\n```\r\n\r\n## æœ€å\r\n\r\næœ¬æ¥å¯ä»¥ä¸€æ¬¡å†™å®Œï¼Œä¸è¿‡è¿˜æ˜¯å¸Œæœ›å¾ªå¾ªè€Œè¿›äº†è§£å†™äº†è¿™ä¹ˆå¤šåˆ¤æ–­ç©¶ç«Ÿæ˜¯ä¸ºä»€ä¹ˆï¼Œæœ€åå¦‚æœæœ‰ä¸æ­£ç¡®çš„åœ°æ–¹å¸Œæœ›æœ‰å°ä¼™ä¼´æŒ‡å‡ºæ¥ï¼Œæ¬¢è¿ starï¼Œå¯¹ä½œè€…ä¹Ÿæ˜¯ä¸€ç§é¼“åŠ±ã€‚\r\n\r\n## å‚è€ƒé“¾æ¥\r\n\r\n- https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CSP\r\n- https://github.com/mqyqingfeng/Blog/issues/56\r\n- https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/globalThis\r\n- https://github.com/lodash/lodash/blob/master/.internal/root.js\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/44/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/44/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/54",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/54/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/54/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/54/events",
          "html_url": "https://github.com/bosens-China/blog/issues/54",
          "id": 588233327,
          "node_id": "MDU6SXNzdWU1ODgyMzMzMjc=",
          "number": 54,
          "title": "ä½¿ç”¨ canvas å®ç°è´ªåƒè›‡",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1371686609,
              "node_id": "MDU6TGFiZWwxMzcxNjg2NjA5",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/JavaScript",
              "name": "JavaScript",
              "color": "F7DF1E",
              "default": false,
              "description": "JavaScriptç³»åˆ—çš„æ–‡ç« "
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2020-03-26T08:13:17Z",
          "updated_at": "2021-12-21T02:57:58Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "<div align=center><img src=\"https://user-images.githubusercontent.com/39508895/139045104-f01d3705-928a-478a-8859-ae6e3cf20c98.png\" alt=\"è´ªåƒè›‡\"></div>\r\n\r\n\r\nç«¥å¹´ä½¿ç”¨çš„è¯ºåŸºäºšåŸºæœ¬ä¸Šéƒ½ä¼šæ­è½½è¿™æ¬¾å°æ¸¸æˆï¼Œæœ€è¿‘å¿ƒè¡€æ¥æ½®æƒ³ç”¨ canvas æ¥å®ç°è¿™ä¸ªæ¸¸æˆå°±æœ‰äº†è¿™ç¯‡æ–‡ç« ï¼Œä¸‹é¢è®²è§£ä¸€ä¸‹å®ç°çš„æ€è·¯ï¼Œæœ¬æ–‡çš„æœ€ç»ˆä»£ç å·²ç»æ”¾åˆ°äº†[codesandbox](https://codesandbox.io/s/peaceful-firefly-c1i43?file=/src/index.js)ä¸Šã€‚\r\n\r\nå½“ç„¶å®ç°çš„æ–¹å¼å¹¶ä¸æ­¢ `canvas` è¿™ä¸€ç§ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ `html` + `css` çš„å½¢å¼ï¼Œè¿™é‡Œä¸è®¨è®ºä¼˜åŠ£å–èˆï¼Œè®©æˆ‘ä»¬å¿«é€Ÿå¼€å§‹å§ã€‚\r\n\r\n## æ¸¸æˆè§„åˆ™\r\n\r\nåœ¨å¼€å‘ä¹‹å‰å…ˆè¦è®¾è®¡æ¸¸æˆçš„å…·ä½“è§„åˆ™æ˜¯æ€ä¹ˆæ ·çš„ï¼Œå°±åƒæ˜¯å®ç°`polyfill`ä¹Ÿè¦å¯¹ç…§è§„èŒƒä¸€æ ·ï¼Œè´ªåƒè›‡æ¸¸æˆè§„åˆ™è¿˜æ˜¯è›®ç®€å•ä¸‹é¢æ¦‚æ‹¬ä¸€ä¸‹ï¼š\r\n\r\n- åˆå§‹çš„æ—¶å€™ä¼šè¢«å››å‘¨å¢™ä½“åŒ…å›´ç€ï¼Œè´ªåƒè›‡è¿™æ—¶å€™å¾ˆè™šå¼±åªæœ‰ä¸€èŠ‚ï¼Œå¢™çš„å‘¨å›´éšæœºåˆ†å¸ƒç€ä¸€ä¸ªé¸¡è›‹ï¼ˆå¥–åŠ±å“ï¼‰\r\n- æŒ‰ä¸‹æ–¹å‘é”®æ¸¸æˆå¼€å§‹ï¼Œåƒåˆ°é¸¡è›‹èº«ä½“ä¼šè¾¹é•¿ï¼ŒåŒæ—¶ä¼šç”Ÿæˆæ–°çš„é¸¡è›‹\r\n- æ’åˆ°å¢™ä½“å’Œæ’åˆ°èº«ä½“ä¼šç»“æŸæ¸¸æˆ\r\n\r\nä¸Šé¢è§„åˆ™æ¦‚æ‹¬æˆä»£ç å°±æ˜¯æˆ‘ä»¬éœ€è¦ç»™ä¸€ä¸ªç•Œé¢èŒƒå›´ã€ç»˜åˆ¶è›‡å’Œé¸¡è›‹ã€è®©è›‡åŠ¨èµ·æ¥ã€‚\r\n\r\n## åŸºæœ¬æ¦‚å¿µ\r\n\r\n`canvas` æ˜¯ `html5` å‡ºç°çš„å…ƒç´ ï¼Œå®ƒå¯ä»¥ç”¨äºæ•°æ®å¯è§†åŒ–ã€åŠ¨ç”»ã€æ¸¸æˆã€å›¾åƒæ“ä½œã€è§†é¢‘ç­‰æ–¹é¢ï¼Œå®ƒä»¥ `JavaScript` çš„æ–¹å¼æ¥è¿›è¡Œäº¤äº’ã€‚\r\n\r\nä¸ºäº†æ–¹ä¾¿ä¸‹é¢çš„ç†è§£ä»‹ç»å‡ ä¸ªåŸºæœ¬æ¦‚å¿µ\r\n\r\n- `var ctx = canvas.getContext(contextType);`\r\n\r\n`getContext` è¿”å› `canvas` çš„ä¸Šä¸‹æ–‡ï¼Œ`contextType` æŒ‡å®šäº†ä½•ç§ä¸Šä¸‹æ–‡ï¼Œå®ƒæœ‰ `2d`ã€`webgl`ã€`webgl2`ã€`bitmaprenderer`è¿™å‡ ç§é€‰é¡¹ï¼Œè¿™é‡Œåªéœ€è¦ 2d ç•Œé¢ï¼Œæ‰€ä»¥å¡«å†™ 2d å³å¯ã€‚\r\n\r\n> å¯ä»¥æ ¹æ® `canvas.getContext` å­˜åœ¨åˆ¤æ–­æµè§ˆå™¨æ”¯ä¸æ”¯æŒ `canvas` å…ƒç´ \r\n\r\n- `CanvasRenderingContext2D.clearRect`\r\n\r\næŒ‡å®šçŸ©å½¢åŒºåŸŸçš„åƒç´ éƒ½å˜æˆé€æ˜ï¼Œ**æ³¨æ„è¿™ä¸ªæ–¹æ³•ä¸ç­‰äºå®Œå…¨æ¸…é™¤ç”»å¸ƒï¼Œå¯¹äºä¸€äº› `path` çš„æ–¹æ³•è®°å¾—æ‰‹åŠ¨ `closePath()`**\r\n\r\n- åŠ¨ç”»çš„ç»„æˆåŸç†\r\n\r\nåç»­æˆ‘ä»¬éœ€è¦è®©è´ªåƒè›‡åŠ¨èµ·æ¥ï¼Œä½†æ˜¯åŠ¨è¿™ä¸ªæ¦‚å¿µæ˜¯ä¸€ä¸ªä¼ªå‘½é¢˜ï¼Œæƒ³ä¸€ä¸‹ç”µè§†å’Œç”µå½±æ˜¯æ€ä¹ˆè®©æˆ‘ä»¬æ„Ÿè§‰åˆ°åŠ¨çš„å‘¢ï¼Ÿå°±æ˜¯é€šè¿‡ä¸€å¸§å¸§çš„ç”»é¢å¿«é€Ÿæ’­æ”¾å¾—åˆ°çš„è§†è§‰æ•ˆæœã€‚\r\n\r\nåé¢è®©è›‡åŠ¨èµ·æ¥ä¹Ÿæ˜¯é€šè¿‡å®šæ—¶å™¨æ¥è®© `canvas` ä¸æ–­é‡ç»˜è¾¾åˆ°åŠ¨ç”»çš„æ•ˆæœã€‚\r\n\r\n## å®ç°æ€è·¯\r\n\r\n![åæ ‡](https://user-images.githubusercontent.com/39508895/139045144-fb2d7562-20a8-4c52-a76b-30a1eca7031c.png)\r\n\r\n\r\nå¦‚æ–‡ç« é¦–é¡µçš„ç¤ºä¾‹å›¾ç‰‡ï¼Œè´ªåƒè›‡å¯ä»¥æƒ³è±¡æˆä¸€ä¸ªåæ ‡ï¼Œæ ¹æ®è¿™ä¸ªåæ ‡å¾ˆå®¹æ˜“å¾—åˆ°ä¸‹é¢å¯ç¤ºï¼š\r\n\r\n- è›‡å’Œé¸¡è›‹éƒ½ä¼šåœ¨åæ ‡ä¸­å‡ºç°ï¼Œä½†ä¸ä¼šè¶…å‡º\r\n- æ’åˆ°åæ ‡çš„è¾¹ç•Œå³æ˜¯æ’å¢™\r\n- æ¯æ¬¡è´ªåƒè›‡ç§»åŠ¨éƒ½éœ€è¦æ“¦æ‹­ç§»åŠ¨çš„è·¯å¾„\r\n- åˆ¤æ–­æœ‰æ²¡æœ‰æ’åˆ°èº«ä½“å’Œåƒä¸æ˜¯åƒåˆ°é¸¡è›‹ï¼Œåˆ¤æ–­ç§»åŠ¨çš„åæ ‡å€¼æ˜¯ä»€ä¹ˆå³å¯\r\n\r\nä¹Ÿå°±æ˜¯è¯´ï¼Œè´ªåƒè›‡è¿™ä¸ªæ¸¸æˆæœ€æ ¸å¿ƒçš„å°±æ˜¯åæ ‡è¿™ä¸ªæ¦‚å¿µï¼Œä¸ºäº†å¿«é€Ÿå¾—åˆ°åæ ‡çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬æœŸå¾…ä»¥ä¸‹é¢çš„å½¢å¼æ¥å‚¨å­˜æ•°æ®ã€‚\r\n\r\n```js\r\ninterface CoordinateAll {\r\n  [x: number]: {\r\n    [y: number]: 'block' | 'egg' | 'sanke';\r\n  };\r\n}\r\n// è½¬åŒ–æˆJavaScriptè¡¨ç¤º\r\n{\r\n  1: {1: 'block', 2: 'egg', 'block'},\r\n  2: {1: 'block', 2: 'block', 'block'},\r\n  // ...\r\n}\r\n```\r\n\r\nä¸ºäº†åç»­çš„ä½¿ç”¨æ–¹ä¾¿ï¼Œæå‰å®šä¹‰ä¸¤ä¸ªæ–‡ä»¶\r\n\r\n```js\r\n// utils.js\r\n// ä¼ é€’ä¸€ä¸ªæ•´æ•°ï¼Œæ¥å¾ªç¯å®ƒ\r\nexport const eachNumber = (n, fn) => {\r\n  for (let i = 0; i < n; i++) {\r\n    fn(i);\r\n  }\r\n};\r\n// è¿”å›éšæœºæ•´æ•°\r\nexport const randomNumber = (min, max) => {\r\n  return Math.floor(Math.random() * (max - min + 1)) + min;\r\n};\r\n```\r\n\r\n```js\r\n// const.js\r\n// canvaså®½åº¦\r\nexport const WIDTH = 400;\r\n// é«˜åº¦\r\nexport const HEIGHT = 400;\r\n// åƒç´ x\r\nexport const PIXEL_X = 20;\r\n// åƒç´ y\r\nexport const PIXEL_Y = 20;\r\n// è¡Œ\r\nexport const ROW = HEIGHT / PIXEL_Y;\r\n// åˆ—\r\nexport const COLUMN = WIDTH / PIXEL_X;\r\n// åŠå¾„\r\nexport const RADIUS = 10;\r\n// å®šæ—¶å™¨é—´éš”\r\nexport const INTERVAL = 150;\r\n// é¸¡è›‹é¢œè‰²\r\nexport const EGG_COLOR = '#767803';\r\n// è›‡é¢œè‰²\r\nexport const SANKE_COLOR = '#6f5f06';\r\n// è¾¹æ¡†é¢œè‰²\r\nexport const BORDER_COLOR = '#796e09';\r\n```\r\n\r\nåé¢å°±å¼€å§‹ç»˜åˆ¶åˆå§‹çš„ç•Œé¢ã€‚\r\n\r\n## åˆå§‹åŒ–ç•Œé¢\r\n\r\n```js\r\nclass Sanke {\r\n  constructor() {\r\n    const canvas = document.createElement('canvas');\r\n    canvas.width = WIDTH;\r\n    canvas.height = HEIGHT;\r\n    this.canvas = canvas;\r\n    document.body.appendChild(canvas);\r\n    const ctx = canvas.getContext('2d');\r\n    this.ctx = ctx;\r\n\r\n    // è›‡èº«\r\n    this.currentSanke = [];\r\n    // å‡ºç°çš„eggä½ç½®\r\n    this.currentEgg = null;\r\n    // åæ ‡ç³»\r\n    this.coordinateAll = {};\r\n    this.init();\r\n  }\r\n  init() {\r\n    // åˆ›å»ºåæ ‡ç³»\r\n    this.coordinateAll = {};\r\n    eachNumber(ROW, (x) => {\r\n      this.coordinateAll[x] = {};\r\n      eachNumber(COLUMN, (y) => {\r\n        this.coordinateAll[x][y] = 'block';\r\n      });\r\n    });\r\n    const sanke = this.randomCoordinate();\r\n    this.setCoordinate(sanke, 'sanke');\r\n    this.currentSanke = [sanke];\r\n    this.currentEgg = this.randomCoordinate();\r\n    this.setCoordinate(this.currentEgg, 'egg');\r\n    this.repaint();\r\n  }\r\n  repaint() {\r\n    const { ctx, canvas, currentSanke } = this;\r\n    // ç»˜åˆ¶eggå’Œç»˜åˆ¶sanke\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n    ctx.strokeStyle = BORDER_COLOR;\r\n    ctx.strokeRect(0, 0, canvas.width, canvas.height);\r\n    ctx.fillStyle = SANKE_COLOR;\r\n    currentSanke.forEach((item) => {\r\n      ctx.fillRect(item.x * PIXEL_X, item.y * PIXEL_Y, PIXEL_X, PIXEL_Y);\r\n    });\r\n    // ç»˜åˆ¶egg\r\n    ctx.beginPath();\r\n    ctx.fillStyle = EGG_COLOR;\r\n    if (!this.currentEgg) {\r\n      this.currentEgg = this.randomCoordinate();\r\n      this.setCoordinate(this.currentEgg, 'egg');\r\n    }\r\n    const { currentEgg } = this;\r\n    ctx.arc(\r\n      0 + RADIUS + currentEgg.x * PIXEL_X,\r\n      0 + RADIUS + currentEgg.y * PIXEL_Y,\r\n      RADIUS,\r\n      0,\r\n      Math.PI * 2,\r\n      true\r\n    );\r\n    ctx.fill();\r\n    ctx.closePath();\r\n  }\r\n\r\n  randomCoordinate() {\r\n    const arr = [];\r\n    eachNumber(ROW, (x) => {\r\n      eachNumber(COLUMN, (y) => {\r\n        const value = this.coordinateAll[x][y];\r\n        if (value === 'block') {\r\n          arr.push({ x, y });\r\n        }\r\n      });\r\n    });\r\n    // è¯´æ˜æ— åæ ‡å¯å–\r\n    if (!arr.length) {\r\n      return null;\r\n    }\r\n    return arr[randomNumber(0, arr.length)];\r\n  }\r\n  setCoordinate({ x, y }, value) {\r\n    this.coordinateAll[x][y] = value;\r\n  }\r\n  getCoordinate({ x, y }) {\r\n    if (x < 0 || y < 0 || x > ROW - 1 || y > COLUMN - 1) {\r\n      return null;\r\n    }\r\n    return this.coordinateAll[x][y];\r\n  }\r\n}\r\n```\r\n\r\nä»£ç çœ‹èµ·æ¥è¿˜æ˜¯è›®å¤šçš„ï¼Œä¸è¿‡ä¹‹å‰å·²ç»ä»‹ç»è¿‡å®ç°çš„æ€è·¯äº†ï¼Œæ¥ä¸‹æ¥ä¸€æ­¥æ­¥åˆ†ææ‰§è¡Œï¼š\r\n\r\n- `constructor`\r\n\r\nè¿™é‡Œä¸»è¦æ˜¯åˆ›å»º `canvas` å¯¹è±¡ï¼Œåœ¨ `this` ä¸Šç»‘å®šä¸€äº›å¿…è¦çš„å±æ€§ï¼Œä¾‹å¦‚`åæ ‡ç³»`ã€`egg ä½ç½®`å’Œ `sanke ä½ç½®`ï¼Œè¿™é‡Œ `currentSanke` ` array` æ˜¯å› ä¸ºè›‡å­˜åœ¨å¤šèŠ‚ï¼Œç”¨æ•°ç»„ç®¡ç†æ¯”è¾ƒæ–¹ä¾¿çš„ã€‚\r\n\r\n- `init`\r\n\r\nç”¨ `init` æ¥å®Œæˆç»„è£…ï¼Œç¬¬ä¸€æ­¥æ˜¯åˆ›å»ºåæ ‡ç³»ï¼Œè¿™é‡Œç»™æ‰€æœ‰çš„åˆå§‹å…ƒç´ æ‰“ä¸Š `block`ï¼Œå®ƒä¸€å…±ä¸‰ä¸ªå€¼ï¼š`'block' | 'egg' | 'sanke'`ã€‚\r\nåé¢éšæœºè·å–è›‹çš„ä½ç½®å’Œè›‡çš„ä½ç½®ï¼Œå‚¨å­˜åˆ°` coordinateAll` ä¸­ï¼Œæœ€åè°ƒç”¨ `repaint` å®Œæˆç»˜åˆ¶\r\n\r\n- `repaint`\r\n\r\nè¿™ä¸€æ­¥å°±æ˜¯è°ƒç”¨ `canvas` å®Œæˆç•Œé¢ç»˜åˆ¶ï¼Œä¸»è¦ç”¨åˆ°äº†ä¸¤ä¸ª `api`\r\n\r\n[ctx.arc](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/arc) å’Œ [ctx.fillRect](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/fillRect)ï¼Œå‰è€…ç»˜åˆ¶å¼§å½¢åè€…å¡«å……çŸ©å½¢ï¼Œå…ˆ `clearRect` åç»˜åˆ¶æ˜¯å› ä¸ºè¿™ä¸ªæ–¹æ³•åç»­ä¼šè¢«é‡å¤è°ƒç”¨ï¼Œåé¢çš„ä¸€äº›`randomCoordinate`ã€`setCoordinate`ã€`getCoordinate`éƒ½æ˜¯è·Ÿåæ ‡æ–¹æ³•æœ‰å…³ï¼Œæ¯”è¾ƒç®€å•çœ‹ä¸€ä¸‹å³å¯ã€‚\r\n\r\n![é™æ€æ•ˆæœ](https://user-images.githubusercontent.com/39508895/139045166-b0b27e8d-3517-4e16-a0e7-c8b3cbdb01a3.png)\r\n\r\n\r\nåˆ°è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°é™æ€çš„æ•ˆæœï¼Œåé¢å°±æ˜¯è®©å…¶åŠ¨èµ·æ¥ã€‚\r\n\r\n## åŠ¨èµ·æ¥\r\n\r\næƒ³è®©è´ªåƒè›‡åŠ¨èµ·æ¥ï¼Œæˆ‘ä»¬éœ€è¦åšä¸¤æ­¥ï¼š\r\n\r\n- ç›‘å¬æ–¹å‘é”®ï¼Œä¹Ÿå°±æ˜¯åŠ¨çš„æ–¹å‘ï¼ˆä¹Ÿå……å½“å¯åŠ¨æ¸¸æˆä½œç”¨ï¼‰\r\n- ä½¿ç”¨å®šæ—¶å™¨ä¸æ–­çš„é‡ç»˜è›‡å’Œé¸¡è›‹çš„ä½ç½®æ¥é€ æˆè§†è§‰çš„ç§»åŠ¨\r\n\r\nç›‘å¬æ–¹å‘é”®å¾ˆç®€å•ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨ `body` ä¸Šç›‘å¬ `keydown` å³å¯ï¼Œè¿™ä¸ªäº‹ä»¶åœ¨é”®ç›˜æŒ‰ä¸‹çš„æ—¶å€™è§¦å‘\r\n\r\n```js\r\nthis.keydownFn = (e) => {\r\n  const code = e.code;\r\n  const result = ['ArrowDown', 'ArrowUp', 'ArrowLeft', 'ArrowRight'].indexOf(\r\n    code\r\n  );\r\n  if (result <= -1) {\r\n    return;\r\n  }\r\n  this.direction = code;\r\n};\r\nmonitor() {\r\n  document.body.addEventListener('keydown', this.keydownFn);\r\n};\r\n```\r\n\r\n```js\r\nmove() {\r\n  if (this.timeId) {\r\n    clearInterval(this.timeId);\r\n  }\r\n  this.timeId = setInterval(() => {\r\n    const { direction, currentSanke, currentEgg } = this;\r\n    // å¦‚æœæ–¹å‘é”®ä¸å­˜åœ¨å°±è¿”å›\r\n    if (!direction) {\r\n      return;\r\n    }\r\n    let nextCoordinate;\r\n    // è›‡å¤´å§‹ç»ˆæ˜¯0\r\n    const { x, y } = currentSanke[0];\r\n    switch (direction) {\r\n      case 'ArrowDown':\r\n      case 'ArrowUp':\r\n        nextCoordinate = { x, y: direction === 'ArrowUp' ? y - 1 : y + 1 };\r\n        break;\r\n      case 'ArrowLeft':\r\n      case 'ArrowRight':\r\n        nextCoordinate = { y, x: direction === 'ArrowLeft' ? x - 1 : x + 1 };\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    // nextCoordinateçš„ä½œç”¨æ˜¯ç¡®è®¤ä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆç±»å‹\r\n    const value = this.getCoordinate(nextCoordinate);\r\n    switch (value) {\r\n      case 'block':\r\n        this.setCoordinate(currentSanke.pop(), 'block');\r\n        currentSanke.unshift(nextCoordinate);\r\n        this.setCoordinate(nextCoordinate, 'sanke');\r\n        break;\r\n      case 'egg':\r\n        this.setCoordinate(currentEgg, 'sanke');\r\n        this.currentEgg = null;\r\n        currentSanke.unshift(nextCoordinate);\r\n        break;\r\n      case 'sanke':\r\n      case null:\r\n        // æ¸¸æˆç»“æŸ\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    this.repaint();\r\n  }, INTERVAL);\r\n};\r\n```\r\n\r\nä¹‹ååœ¨ init ä¸­æ’å…¥è¿™è¿™ä¸¤ä¸ªæ–¹æ³•\r\n\r\n```js\r\ninit() {\r\n  // ...\r\n  this.monitor();\r\n  this.move();\r\n}\r\n```\r\n\r\n![ç¤ºä¾‹](https://user-images.githubusercontent.com/39508895/139045193-71ae885b-bb3d-4613-82b9-9c7b4d9f6e38.png)\r\n\r\n\r\nåˆ°è¿™ä¸€æ­¥ï¼Œè´ªåƒè›‡ä¹Ÿå®ç°äº†åŠ¨èµ·æ¥çš„è¦æ±‚ï¼Œåœ¨ `swtich` ä¸­åˆ¤æ–­ `value` çš„ç±»å‹æ¥å†³å®šåæ ‡å€¼å¦‚ä½•å˜åŒ–ï¼Œä¹‹åç»§ç»­æ‰§è¡Œ `repaint` é‡ç»˜ç•Œé¢\r\n\r\n## ç»“æŸæ¸¸æˆ\r\n\r\nä¸Šé¢ `move` å¯¹æ¸¸æˆç»“æŸåªè¿›è¡Œäº†æ³¨é‡Šï¼Œä¸‹é¢å°±æŠŠ` case null:`ä¸‹é¢è¯­å¥æ›¿æ¢æˆ`this.end`\r\n\r\n```js\r\nend() {\r\n  if (this.timeId) {\r\n    clearInterval(this.timeId);\r\n  }\r\n  this.timeId = null;\r\n  document.body.removeEventListener('keydown', this.keydownFn);\r\n  alert(`æ¸¸æˆç»“æŸï¼Œå½“å‰åˆ†æ•°ï¼š${(this.currentSanke.length - 1) * 10}`);\r\n};\r\n```\r\n\r\n## æœ€å\r\n\r\nå¦‚æœæœ‰ä»€ä¹ˆé”™è¯¯è¯·ä¸åæŒ‡ç‚¹ï¼Œå¯¹ä½ æœ‰å¸®åŠ©ä¹Ÿå¯ä»¥ `start` ä¸€ä¸‹ã€‚\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/54/reactions",
            "total_count": 1,
            "+1": 1,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/54/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/51",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/51/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/51/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/51/events",
          "html_url": "https://github.com/bosens-China/blog/issues/51",
          "id": 566103021,
          "node_id": "MDU6SXNzdWU1NjYxMDMwMjE=",
          "number": 51,
          "title": "åŸºäºHistoryå®ç°å‰ç«¯è·¯ç”±",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1371686609,
              "node_id": "MDU6TGFiZWwxMzcxNjg2NjA5",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/JavaScript",
              "name": "JavaScript",
              "color": "F7DF1E",
              "default": false,
              "description": "JavaScriptç³»åˆ—çš„æ–‡ç« "
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2020-02-17T07:21:46Z",
          "updated_at": "2020-02-17T07:21:46Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "`History`æ˜¯ HTML5 æ–°å¢çš„æ ‡å‡†ï¼Œå¯¹æ¯”`hash`å®ƒçš„å±•ç¤ºæ›´åŠ ä¼˜é›…ï¼Œä½†ä½ç‰ˆæœ¬ ie è¿˜æœ‰å…¼å®¹é—®é¢˜ã€‚\r\n\r\né¦–å…ˆ`History`è¡¨ç¤ºçª—å£æµè§ˆå†å²ï¼Œå¯ä»¥é€šè¿‡`pushState`æ–¹æ³•æ·»åŠ å†å²è®°å½•ï¼Œä»¥åŠé€šè¿‡`go`æ–¹æ³•æ¥å®ç°è·³è½¬ï¼Œè¿˜æœ‰`popstate`äº‹ä»¶å¯ä»¥ç›‘å¬åˆ°è®°å½•å˜æ›´ã€‚\r\n\r\nä¸‹é¢å°±æ¥åˆ†æå®ç°ä¸€ä¸ª`Historyè·¯ç”±`çš„åŸºç¡€æ˜¯ä»€ä¹ˆ\r\n\r\n1. å®ƒéœ€è¦åœ¨å˜æ›´åœ°å€çš„æ—¶å€™ï¼Œä¸ä¼šå¯¼è‡´æ–‡æ¡£ç›´æ¥è·³è½¬ï¼Œä¾‹å¦‚`hashè·¯ç”±`çš„å‡ºç°æ˜¯å› ä¸º url çš„`hash`å˜æ›´ä¸ä¼šå¯¼è‡´æ–‡æ¡£å˜åŒ–ï¼›\r\n2. éœ€è¦æœ‰äº‹ä»¶å¯ä»¥è¾…åŠ©æˆ‘ä»¬ç›‘å¬åˆ°è¿™ä¸ªå˜åŒ–;\r\n\r\nè¿™ä¸¤ä¸ªè¦æ±‚`History`éƒ½èƒ½å¾ˆå¥½æ»¡è¶³ï¼Œå½“ä½¿ç”¨`pushState`æ–¹æ³•æ·»åŠ ä¸€æ¡è®°å½•çš„æ—¶å€™ï¼Œåªä¼šå¯¼è‡´æµè§ˆå™¨çš„åœ°å€æ å‘ç”Ÿå˜åŒ–ï¼Œä½†æ˜¯ä¸ä¼šè·³è½¬åˆ°è¿™ä¸ªåœ°å€ï¼Œå¹¶ä¸”æµè§ˆå™¨ä¹Ÿä¸ä¼šæ£€æŸ¥è¿™ä¸ªåœ°å€ï¼Œåˆ©ç”¨è¿™ä¸ªç‰¹æ€§æˆ‘ä»¬å¯ä»¥å®ç°æ¯”è¾ƒä¼˜é›…çš„è·¯ç”±åœ°å€ï¼Œä¾‹å¦‚`https://xxx.com/a`ï¼Œ`a`å°±æ˜¯è¿™ä¸ªè·¯ç”±åœ°å€ã€‚\r\n\r\nä¸ºäº†æ–¹ä¾¿ç†è§£ä¸‹é¢å®ç°çš„ä»£ç ï¼Œç®€çŸ­ä»‹ç»ä¸€ä¸‹`pushState`\r\n\r\n#### pushState\r\n\r\n`pushState`æ–¹æ³•ï¼Œå®ƒæœ‰ä¸‰ä¸ªå‚æ•°\r\n\r\n- ç¬¬ä¸€ä¸ªæ˜¯`state`ï¼Œè¡¨ç¤ºå‘ç”Ÿ`popstate`äº‹ä»¶çš„æ—¶å€™ä¼ é€’çš„å¯¹è±¡ï¼›\r\n- titleï¼Œå½“å‰æµè§ˆå™¨å·²ç»å¿½ç•¥äº†ï¼Œä¼ é€’`''`å°±å¥½äº†ï¼›\r\n- ç½‘å€ï¼Œè¦æ›´æ”¹çš„åœ°å€ï¼Œæ³¨æ„è¦ç¬¦åˆåŒæºæ”¿ç­–ï¼›\r\n\r\nä¸¾ä¸ªä¾‹å­ï¼Œå½“å‰ç½‘ç«™çš„æ ¹è·¯å¾„æ˜¯`https://xxx.com`ï¼Œæˆ‘ä»¬ä½¿ç”¨`pushState`æ·»åŠ ä¸€æ¡è®°å½•\r\n\r\n```js\r\nhistory.pushState({ path: \"/abc\" }, \"\", \"/abc\");\r\n```\r\n\r\nå½“å‰çš„ç½‘å€å°±æ˜¯`https://xxx.com/abc`ã€‚\r\n\r\n#### popstate\r\n\r\n`pushState`äº‹ä»¶è§¦å‘çš„æ¡ä»¶æ˜¯ç”¨æˆ·ç‚¹å‡»`å‰è¿›`ã€`åé€€`æŒ‰é’®æˆ–è€…è°ƒç”¨ `History.back()`ã€`History.forward()`ã€`History.go()`æ–¹æ³•æ—¶æ‰ä¼šè§¦å‘ã€‚\r\n\r\nè§¦å‘äº‹ä»¶åæœ‰ä¸€ä¸ª`event`å¯¹è±¡ï¼Œå®ƒæœ‰ä¸€ä¸ª`state`å±æ€§ï¼Œå°±æ˜¯å¯¹åº”`pushState`æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚\r\n\r\næ›´å¤šå…³äº`history`çš„ä¿¡æ¯å¯ä»¥æŸ¥é˜…[MDN](https://developer.mozilla.org/zh-CN/docs/Web/API/History)\r\n\r\n### history è·¯ç”±å®ç°\r\n\r\n```js\r\nclass Router {\r\n  constructor() {\r\n    this.routes = new Map();\r\n    this.init();\r\n  }\r\n  change(e) {\r\n    // é˜²æ­¢ä¸ºnull\r\n    const { path } = e.state || {};\r\n    this.implement(path);\r\n  }\r\n  init() {\r\n    window.addEventListener(\"popstate\", this.change.bind(this));\r\n    window.addEventListener(\"load\", () => {\r\n      const { pathname } = location;\r\n      history.replaceState({ path: pathname }, \"\", pathname);\r\n      this.implement(pathname);\r\n    });\r\n  }\r\n  implement(path) {\r\n    if (!this.routes.has(path)) {\r\n      return;\r\n    }\r\n    const fn = this.routes.get(path);\r\n    typeof fn == \"function\" && fn.call(this, path);\r\n  }\r\n  go(num) {\r\n    history.go(num);\r\n  }\r\n  route(state, fn) {\r\n    this.routes.set(state, fn);\r\n  }\r\n  push(state) {\r\n    history.pushState({ path: state }, \"\", state);\r\n    this.implement(state);\r\n  }\r\n  replace(state) {\r\n    history.replaceState({ path: state }, \"\", state);\r\n    this.implement(state);\r\n  }\r\n}\r\n```\r\n\r\nè¿™ä¸€å—æ¯”è¾ƒç®€å•å°±ä¸åšæ›´å¤šèµ˜è¿°äº†ï¼Œå”¯ä¸€ä¸€ç‚¹éœ€è¦æ³¨æ„çš„å°±æ˜¯é¡µé¢åŠ è½½å®Œæ¯•ä¹Ÿéœ€è¦ç›‘å¬ä¸€æ¬¡ï¼Œè¿™é‡Œç”¨äº†`loadäº‹ä»¶`ã€‚\r\n\r\n### ä½¿ç”¨æ–¹æ³•\r\n\r\n```html\r\n<ul>\r\n  <li><a href=\"/\">hash1</a></li>\r\n  <li><a href=\"/hash2\">hash2</a></li>\r\n  <li><a href=\"/hash3\">hash3</a></li>\r\n</ul>\r\n<div><button class=\"f\">å‰è¿›</button> <button class=\"b\">åé€€</button></div>\r\n```\r\n\r\n```js\r\nconst color = {\r\n  \"/\": \"yellow\",\r\n  \"/hash2\": \"#333\",\r\n  \"/hash3\": \"#DDD\"\r\n};\r\nconst route = new Router();\r\nroute.route(\"/\", function(e) {\r\n  document.body.style.background = color[e];\r\n});\r\nroute.route(\"/hash2\", function(e) {\r\n  document.body.style.background = color[e];\r\n});\r\nroute.route(\"/hash3\", function(e) {\r\n  document.body.style.background = color[e];\r\n});\r\nArray.from(document.links).forEach(fn => {\r\n  fn.addEventListener(\"click\", e => {\r\n    e.preventDefault();\r\n    const href = fn.href;\r\n    const { pathname } = new URL(href);\r\n    route.push(pathname);\r\n  });\r\n});\r\nconst backOff = document.querySelector(\".b\");\r\nconst forward = document.querySelector(\".f\");\r\nbackOff.addEventListener(\"click\", () => route.go(-1));\r\nforward.addEventListener(\"click\", () => route.go(1));\r\n```\r\n\r\nè¿™é‡Œæ³¨æ„ï¼Œæˆ‘ç›´æ¥å±è”½äº†`a`é“¾æ¥çš„é»˜è®¤è·³è½¬ï¼Œè¿™ä¸ªæ˜¯é˜²æ­¢å®ƒç›´æ¥åˆ°å…¶ä»–æ–‡æ¡£ã€‚\r\n\r\n### æœ€å\r\n\r\nå…³äºå‰ç«¯è·¯ç”±çš„ä¸¤ç§å®ç°ï¼Œè¿™é‡Œå°±æŠ›ç –å¼•ç‰çš„è®²è§£å®Œæˆäº†ï¼Œå‰©ä¸‹çš„å°±æ˜¯åœ¨è¿™ä¸ªåŸç†ä¸Šæ›´åŠ å®Œå–„ï¼Œä¾‹å¦‚å¯¹ 404 é¡µé¢çš„å¤„ç†ã€‚\r\n\r\nå¦‚æœæœ‰å¸®åŠ©å¯ä»¥ **star** ä¸€ä¸‹ã€‚\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/51/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/51/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/50",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/50/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/50/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/50/events",
          "html_url": "https://github.com/bosens-China/blog/issues/50",
          "id": 566035569,
          "node_id": "MDU6SXNzdWU1NjYwMzU1Njk=",
          "number": 50,
          "title": "åŸºäºhashå®ç°å‰ç«¯è·¯ç”±",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1371686609,
              "node_id": "MDU6TGFiZWwxMzcxNjg2NjA5",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/JavaScript",
              "name": "JavaScript",
              "color": "F7DF1E",
              "default": false,
              "description": "JavaScriptç³»åˆ—çš„æ–‡ç« "
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2020-02-17T03:34:23Z",
          "updated_at": "2020-02-17T03:34:23Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "> å‰ç«¯è·¯ç”±åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œhash è·¯ç”±å’Œ History è·¯ç”±ï¼Œä¾‹å¦‚æˆ‘ä»¬å¸¸ç”¨çš„ vue-roter å°±åŒ…å«è¿™ä¸¤éƒ¨åˆ†ï¼Œè¿™é‡Œå¹¶ä¸æ¢è®¨æ¡†æ¶æ˜¯å¦‚ä½•è¿›è¡Œå°è£…çš„ï¼Œè€Œæ˜¯ä½¿ç”¨åŸç”Ÿçš„ api æ¥å®ç°è¿™æ ·ä¸€ä¸ªåŠŸèƒ½ã€‚\r\n\r\n> é¢„è®¡åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œè¿™é‡Œå…ˆä»‹ç» hash è·¯ç”±ï¼Œå®ç°åŸºæœ¬çš„æ¥å—å“åº”å’Œå‰è¿›åé€€ï¼ˆä¸ºäº†æ–¹ä¾¿ï¼Œä¸‹é¢ä»£ç ä¸åšä»»ä½•å…¼å®¹å¤„ç†ï¼‰\r\n\r\nhash æŒ‡çš„å°±æ˜¯ url æ ‡è¯†ç¬¦åé¢`#`å·éƒ¨åˆ†çš„å†…å®¹ï¼ˆåŒ…å«#ï¼‰ï¼Œä¾‹å¦‚ï¼š`https://xxx#abc`è¿™ä¸ª url çš„ hash å°±æ˜¯`#abc`ã€‚\r\n\r\nè€Œ hash è·¯ç”±å°±æ˜¯æŒ‡æ¥æ”¶ hash çš„å˜åŒ–æ›´æ–°å¯¹åº”çš„è·¯ç”±è§†å›¾ï¼Œå®ƒçš„ä¼˜ç‚¹å°±æ˜¯å…¼å®¹æ€§å¾ˆå¥½ï¼Œåœ¨ ie ä¸‹ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œï¼Œä¸è¶³ä¹‹å¤„å°±æ˜¯`#`è¿™ä¸ªç¬¦å·å¾ˆä¸‘é™‹ã€‚\r\n\r\n### ç›‘å¬ hash å˜åŒ–\r\n\r\nwindow å¯¹è±¡ä¸Šæœ‰`hashchange`äº‹ä»¶å¯ä»¥ç›‘å¬åˆ° hash çš„å˜åŒ–ï¼Œæˆ‘ä»¬å…ˆæ‹¿æ¥ç”¨ç”¨ï¼Œçœ‹çœ‹å¥½ä¸å¥½ç”¨ã€‚\r\n\r\n```js\r\nclass Router {\r\n  constructor() {\r\n    this.hash = new Map();\r\n    this.change = () => {\r\n      const href = this.getHash();\r\n      this.move(href);\r\n    };\r\n    window.addEventListener(\"hashchange\", this.change);\r\n  }\r\n  route(href, fn) {\r\n    this.hash.set(href, fn);\r\n  }\r\n  move(href) {\r\n    if (!this.hash.has(href)) {\r\n      return false;\r\n    }\r\n    const fn = this.hash.get(href);\r\n    if (typeof fn == \"function\") {\r\n      fn.call(this, href);\r\n    }\r\n    return true;\r\n  }\r\n  getHash() {\r\n    return location.hash ? location.hash.slice(1) : \"/\";\r\n  }\r\n}\r\n```\r\n\r\n#### ä½¿ç”¨æ–¹æ³•\r\n\r\n```js\r\nconst color = {\r\n  hash1: \"#333\",\r\n  hash2: \"#666\",\r\n  hash3: \"#DDD\"\r\n};\r\nconst route = new Router();\r\nroute.route(\"hash1\", function(e) {\r\n  document.body.style.background = color[e];\r\n});\r\nroute.route(\"hash2\", function(e) {\r\n  document.body.style.background = color[e];\r\n});\r\nroute.route(\"hash3\", function(e) {\r\n  document.body.style.background = color[e];\r\n});\r\n```\r\n\r\nè¿™é‡Œå·²ç»å®ç°äº† hash å“åº”äº†ï¼Œä¸è¿‡è¿˜æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯å¦‚æœç‚¹å‡» hash ä¹‹ååˆ·æ–°æµè§ˆå™¨ï¼Œå¯¹åº”çš„å›è°ƒå‡½æ•°å¹¶ä¸ä¼šæ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦æµè§ˆå™¨åŠ è½½å®Œæˆåå“åº”å¯¹åº”çš„å›è°ƒå‡½æ•°ï¼Œä¿®è®¢è¿™ä¸ªé—®é¢˜å¾ˆç®€å•ç›‘å¬ load äº‹ä»¶å³å¯ã€‚\r\n\r\n```js\r\n// çœç•¥å…¶ä»–ä»£ç \r\nconstructor() {\r\n    window.addEventListener('load', this.change);\r\n    window.addEventListener(\"hashchange\", this.change);\r\n  }\r\n```\r\n\r\n### åé€€åŠŸèƒ½\r\n\r\nä¸Šé¢å®Œæˆäº†åŸºç¡€åŠŸèƒ½ï¼Œä¸‹é¢å¯¹è¿™ä¸ªä»£ç è¿›è¡Œæ”¹é€ ï¼Œé¦–å…ˆæ–°å¢ä¸€ä¸ªåé€€å¤„ç†ã€‚\r\n\r\nå®ç°çš„æ€è·¯æ˜¯æ–°å¢ä¸€ä¸ª`history`æ•°ç»„æ¥å‚¨å­˜å˜åŒ–çš„ hashï¼Œå¹¶ä¸”åˆ›å»ºä¸€ä¸ªæŒ‡é’ˆï¼Œåœ¨åé€€çš„æ—¶å€™ç§»åŠ¨æŒ‡é’ˆå˜åŒ–ï¼ŒåŒæ—¶è§¦å‘å¯¹åº”çš„å‡½æ•°ã€‚\r\n\r\n```js\r\nclass Router {\r\n  constructor() {\r\n    this.hash = new Map();\r\n    // å‚¨å­˜hashå˜åŒ–çš„æ•°ç»„\r\n    this.history = [];\r\n    // æŒ‡é’ˆ\r\n    this.pointer = this.history.length - 1;\r\n    this.change = () => {\r\n      const href = this.getHash();\r\n      if (!this.move(href)) {\r\n        return console.error(`hashè·¯ç”±${href}æ— å¯¹åº”å¤„ç†å‡½æ•°`);\r\n      }\r\n      // åœ¨è·¯ç”±å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼ŒåŒæ—¶å¯¹historyæ·»åŠ ï¼Œå’Œç§»åŠ¨æŒ‡é’ˆ\r\n      this.history.push(href);\r\n      this.pointer++;\r\n    };\r\n    // åé€€\r\n    this.backOff = () => {\r\n      // æ•°ç»„ä¸‹è¡¨ä¸èƒ½è´Ÿ\r\n      if (this.pointer <= 0) {\r\n        this.pointer = 0;\r\n      } else {\r\n        // ç§»åŠ¨ä¸‹æ ‡\r\n        this.pointer -= 1;\r\n      }\r\n      // è¯»å–å¯¹åº”çš„å€¼ï¼Œç§»åŠ¨hash\r\n      const href = this.history[this.pointer];\r\n      console.log(href, this.pointer, this.history);\r\n      this.setHash(href);\r\n      this.move(href);\r\n    };\r\n    window.addEventListener(\"load\", this.change);\r\n    window.addEventListener(\"hashchange\", this.change);\r\n  }\r\n  route(href, fn) {\r\n    this.hash.set(href, fn);\r\n  }\r\n  move(href) {\r\n    if (!this.hash.has(href)) {\r\n      return false;\r\n    }\r\n    const fn = this.hash.get(href);\r\n    if (typeof fn == \"function\") {\r\n      fn.call(this, href);\r\n    }\r\n    return true;\r\n  }\r\n  getHash() {\r\n    // è¿‡æ»¤æ‰'#'\r\n    return location.hash ? location.hash.slice(1) : \"/\";\r\n  }\r\n  setHash(href) {\r\n    if (!href) {\r\n      return;\r\n    }\r\n    if (!/^/.test(href)) {\r\n      href = `#${href}`;\r\n    }\r\n    location.hash = href;\r\n  }\r\n}\r\n```\r\n\r\nä¸Šé¢çœ‹ä¼¼å®ç°äº†åé€€åŠŸèƒ½ï¼Œä¸è¿‡ä»”ç»†è§‚å¯Ÿä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬ä¼šå‘ç°è¿™æ ·å®ç°æ˜¯æœ‰é—®é¢˜çš„\r\n\r\n1. å›è°ƒå‡½æ•°è¢«æ‰§è¡Œä¸¤æ¬¡ï¼›\r\n2. `history`æ•°ç»„è®°å½•çš„ hash ä¸å¯¹ï¼Œå› ä¸ºåé€€æ˜¯ä¸éœ€è¦è®°å½•çš„ï¼›\r\n\r\nä¸‹é¢æ¥ä¿®æ­£è¿™ä¸¤ä¸ªé—®é¢˜ã€‚\r\n\r\n```js\r\nclass Router {\r\n  constructor() {\r\n    this.hash = new Map();\r\n    // å‚¨å­˜hashå˜åŒ–çš„æ•°ç»„\r\n    this.history = [];\r\n    // æŒ‡é’ˆ\r\n    this.pointer = this.history.length - 1;\r\n    // æ˜¯å¦åé€€ï¼Œé»˜è®¤ç»™false\r\n    this.isBackOff = false;\r\n    this.change = () => {\r\n      const href = this.getHash();\r\n      if (!this.hash.has(href)) {\r\n        return console.error(`hashè·¯ç”±${href}æ— å¯¹åº”å¤„ç†å‡½æ•°`);\r\n      }\r\n      if (!this.isBackOff) {\r\n        // çœ‹ä¸€ä¸‹æŒ‡é’ˆé•¿åº¦å¯¹ä¸å¯¹ï¼Œå¦‚æœå¤šä½™å°±æˆªå–æ‰\r\n        if (this.pointer < this.history.length - 1) {\r\n          this.history = this.history.slice(0, this.pointer + 1);\r\n        }\r\n        // åœ¨è·¯ç”±å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼ŒåŒæ—¶å¯¹historyæ·»åŠ ï¼Œå’Œç§»åŠ¨æŒ‡é’ˆ\r\n        this.history.push(href);\r\n        this.pointer++;\r\n      }\r\n      this.move(href);\r\n      this.isBackOff = false;\r\n    };\r\n    // åé€€\r\n    this.backOff = () => {\r\n      this.isBackOff = true;\r\n      // æ•°ç»„ä¸‹è¡¨ä¸èƒ½è´Ÿ\r\n      if (this.pointer <= 0) {\r\n        this.pointer = 0;\r\n      } else {\r\n        // ç§»åŠ¨ä¸‹æ ‡\r\n        this.pointer -= 1;\r\n      }\r\n      // è¯»å–å¯¹åº”çš„å€¼ï¼Œç§»åŠ¨hash\r\n      const href = this.history[this.pointer];\r\n      console.log(href, this.pointer, this.history);\r\n      this.setHash(href);\r\n    };\r\n    window.addEventListener(\"load\", this.change);\r\n    window.addEventListener(\"hashchange\", this.change);\r\n  }\r\n  route(href, fn) {\r\n    this.hash.set(href, fn);\r\n  }\r\n  move(href) {\r\n    const fn = this.hash.get(href);\r\n    if (typeof fn == \"function\") {\r\n      fn.call(this, href);\r\n    }\r\n  }\r\n  getHash() {\r\n    // è¿‡æ»¤æ‰'#'\r\n    return location.hash ? location.hash.slice(1) : \"/\";\r\n  }\r\n  setHash(href) {\r\n    if (!href) {\r\n      return;\r\n    }\r\n    if (!/^/.test(href)) {\r\n      href = `#${href}`;\r\n    }\r\n    location.hash = href;\r\n  }\r\n}\r\n```\r\n\r\nå€ŸåŠ©å˜é‡`isBackOff`æ¥æ§åˆ¶ï¼Œå¦‚æœæ˜¯åé€€åªæ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œå½“æ­£å¸¸æ“ä½œçš„æ—¶å€™æ–°å¢`history`æ•°æ®ï¼ŒåŒæ—¶æ¸…æ¥šå¤šä½™æ•°ç»„ï¼Œå‰è¿›è·Ÿåé€€ç±»ä¼¼ï¼Œä¸‹é¢å°±æ¥å®ç°å®ƒã€‚\r\n\r\n### å‰è¿›\r\n\r\næ€è·¯è·Ÿåé€€çš„ä¸€è‡´ï¼Œå€ŸåŠ©å˜é‡æ¥è¿›è¡Œæ§åˆ¶ï¼Œå®šä¹‰ä¸€ä¸ªå‰è¿›æ–¹æ³•ã€‚\r\n\r\n```js\r\nclass Router {\r\n  constructor() {\r\n    this.hash = new Map();\r\n    // å‚¨å­˜hashå˜åŒ–çš„æ•°ç»„\r\n    this.history = [];\r\n    // æŒ‡é’ˆ\r\n    this.pointer = this.history.length - 1;\r\n    // æ˜¯å¦åé€€ï¼Œé»˜è®¤ç»™false\r\n    this.isBackOff = false;\r\n    // å‰è¿›æ ‡è¯†\r\n    this.isForward = false;\r\n    this.change = () => {\r\n      const href = this.getHash();\r\n      if (!this.hash.has(href)) {\r\n        return console.error(`hashè·¯ç”±${href}æ— å¯¹åº”å¤„ç†å‡½æ•°`);\r\n      }\r\n      if (!this.isBackOff && !this.isForward) {\r\n        // çœ‹ä¸€ä¸‹æŒ‡é’ˆé•¿åº¦å¯¹ä¸å¯¹ï¼Œå¦‚æœå¤šä½™å°±æˆªå–æ‰\r\n        if (this.pointer < this.history.length - 1) {\r\n          this.history = this.history.slice(0, this.pointer + 1);\r\n        }\r\n        // åœ¨è·¯ç”±å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼ŒåŒæ—¶å¯¹historyæ·»åŠ ï¼Œå’Œç§»åŠ¨æŒ‡é’ˆ\r\n        this.history.push(href);\r\n        this.pointer++;\r\n      }\r\n      this.move(href);\r\n      this.isBackOff = false;\r\n      this.isForward = false;\r\n    };\r\n    // åé€€\r\n    this.backOff = () => {\r\n      this.isBackOff = true;\r\n      // æ•°ç»„ä¸‹è¡¨ä¸èƒ½è´Ÿ\r\n      if (this.pointer <= 0) {\r\n        this.pointer = 0;\r\n      } else {\r\n        // ç§»åŠ¨ä¸‹æ ‡\r\n        this.pointer -= 1;\r\n      }\r\n      // è¯»å–å¯¹åº”çš„å€¼ï¼Œç§»åŠ¨hash\r\n      const href = this.history[this.pointer];\r\n      console.log(href, this.pointer, this.history);\r\n      this.setHash(href);\r\n    };\r\n    // å‰è¿›\r\n    this.forward = () => {\r\n      this.isForward = true;\r\n      // æ•°ç»„ä¸‹è¡¨ä¸èƒ½è´Ÿ\r\n      if (this.pointer >= this.history.length - 1) {\r\n        this.pointer = this.history.length - 1;\r\n      } else {\r\n        // ç§»åŠ¨ä¸‹æ ‡\r\n        this.pointer += 1;\r\n      }\r\n      // è¯»å–å¯¹åº”çš„å€¼ï¼Œç§»åŠ¨hash\r\n      const href = this.history[this.pointer];\r\n      console.log(`å‰è¿›${href}`, this.pointer, this.history);\r\n      this.setHash(href);\r\n    };\r\n    window.addEventListener(\"load\", this.change);\r\n    window.addEventListener(\"hashchange\", this.change);\r\n  }\r\n  route(href, fn) {\r\n    this.hash.set(href, fn);\r\n  }\r\n  move(href) {\r\n    const fn = this.hash.get(href);\r\n    if (typeof fn == \"function\") {\r\n      fn.call(this, href);\r\n    }\r\n  }\r\n  getHash() {\r\n    // è¿‡æ»¤æ‰'#'\r\n    return location.hash ? location.hash.slice(1) : \"/\";\r\n  }\r\n  setHash(href) {\r\n    if (!href) {\r\n      return;\r\n    }\r\n    if (!/^/.test(href)) {\r\n      href = `#${href}`;\r\n    }\r\n    location.hash = href;\r\n  }\r\n}\r\n```\r\n\r\nè·Ÿåé€€å¯¹æ¯”ï¼Œå®è´¨ä¸Šä¹Ÿåªæ˜¯æŠŠåé€€æŒ‡é’ˆæ”¹æˆå‰è¿›äº†ï¼Œå¦‚æœæƒ³è¦å®ç°`go`è·³è½¬çš„åŠŸèƒ½ä¹Ÿè·Ÿå‰è¿›ã€åé€€æ€è·¯ä¸€æ ·ã€‚\r\n\r\n### ä½¿ç”¨æ–¹æ³•\r\n\r\n```html\r\n<ul>\r\n  <li><a href=\"#hash1\">hash1</a></li>\r\n  <li><a href=\"#hash2\">hash2</a></li>\r\n  <li><a href=\"#hash3\">hash3</a></li>\r\n</ul>\r\n<div><button class=\"f\">å‰è¿›</button> <button class=\"b\">åé€€</button></div>\r\n1\r\n```\r\n\r\n```js\r\nconst color = {\r\n  hash1: \"#333\",\r\n  hash2: \"#666\",\r\n  hash3: \"#DDD\"\r\n};\r\nconst route = new Router();\r\nroute.route(\"hash1\", function(e) {\r\n  document.body.style.background = color[e];\r\n});\r\nroute.route(\"hash2\", function(e) {\r\n  document.body.style.background = color[e];\r\n});\r\nroute.route(\"hash3\", function(e) {\r\n  document.body.style.background = color[e];\r\n});\r\nconst backOff = document.querySelector(\".b\");\r\nconst forward = document.querySelector(\".f\");\r\nbackOff.addEventListener(\"click\", route.backOff);\r\nforward.addEventListener(\"click\", route.forward);\r\n```\r\n\r\n### æœ€å\r\n\r\nè¿™é‡Œå®ç°äº† hash è·¯ç”±çš„`å“åº”å˜åŒ–`å’Œ`å‰è¿›`ã€`åé€€`ã€`404` çš„åŠŸèƒ½ï¼Œä½†æ˜¯è¿˜æœ‰å¾ˆå¤šåœ°æ–¹éœ€è¦å®Œå–„ï¼Œæ¯”å¦‚`go`è·³è½¬ã€‚\r\n\r\nä¸‹ä¸€èŠ‚å°†ä»‹ç» `History è·¯ç”±çš„å®ç°`ï¼Œå¦‚æœå–œæ¬¢è¯·ç‚¹å‡»ä¸€ä¸‹ **star**\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/50/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/50/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        }
      ]
    ],
    [
      "1935755992",
      [
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/88",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/88/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/88/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/88/events",
          "html_url": "https://github.com/bosens-China/blog/issues/88",
          "id": 1089747064,
          "node_id": "I_kwDOCzPAy85A9Dh4",
          "number": 88,
          "title": "Babel to Classä¹‹åŸç”Ÿæ„é€ å‡½æ•°ç»§æ‰¿ï¼ˆ4ï¼‰",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1935755992,
              "node_id": "MDU6TGFiZWwxOTM1NzU1OTky",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%BE%85%E5%AE%8C%E6%88%90%E7%B3%BB%E5%88%97",
              "name": "å¾…å®Œæˆç³»åˆ—",
              "color": "cc6e43",
              "default": false,
              "description": "ç­‰å¾…å®Œæˆçš„æ–‡ç« ..."
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2021-12-28T09:44:09Z",
          "updated_at": "2021-12-28T09:44:09Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": null,
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/88/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/88/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/87",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/87/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/87/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/87/events",
          "html_url": "https://github.com/bosens-China/blog/issues/87",
          "id": 1085665660,
          "node_id": "I_kwDOCzPAy85AtfF8",
          "number": 87,
          "title": "å‡½æ•°ç»„åˆ",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1935755992,
              "node_id": "MDU6TGFiZWwxOTM1NzU1OTky",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%BE%85%E5%AE%8C%E6%88%90%E7%B3%BB%E5%88%97",
              "name": "å¾…å®Œæˆç³»åˆ—",
              "color": "cc6e43",
              "default": false,
              "description": "ç­‰å¾…å®Œæˆçš„æ–‡ç« ..."
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2021-12-21T10:17:50Z",
          "updated_at": "2021-12-21T10:17:50Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": null,
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/87/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/87/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/85",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/85/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/85/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/85/events",
          "html_url": "https://github.com/bosens-China/blog/issues/85",
          "id": 1085663742,
          "node_id": "I_kwDOCzPAy85Aten-",
          "number": 85,
          "title": "æ‰‹å†™PromiseA+è§„èŒƒ",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1935755992,
              "node_id": "MDU6TGFiZWwxOTM1NzU1OTky",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%BE%85%E5%AE%8C%E6%88%90%E7%B3%BB%E5%88%97",
              "name": "å¾…å®Œæˆç³»åˆ—",
              "color": "cc6e43",
              "default": false,
              "description": "ç­‰å¾…å®Œæˆçš„æ–‡ç« ..."
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2021-12-21T10:15:52Z",
          "updated_at": "2021-12-21T10:15:52Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": null,
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/85/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/85/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/84",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/84/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/84/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/84/events",
          "html_url": "https://github.com/bosens-China/blog/issues/84",
          "id": 1085661897,
          "node_id": "I_kwDOCzPAy85AteLJ",
          "number": 84,
          "title": "å¦‚ä½•ç¼–å†™çˆ¬è™«",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1935755992,
              "node_id": "MDU6TGFiZWwxOTM1NzU1OTky",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%BE%85%E5%AE%8C%E6%88%90%E7%B3%BB%E5%88%97",
              "name": "å¾…å®Œæˆç³»åˆ—",
              "color": "cc6e43",
              "default": false,
              "description": "ç­‰å¾…å®Œæˆçš„æ–‡ç« ..."
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2021-12-21T10:13:58Z",
          "updated_at": "2021-12-21T10:13:58Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": null,
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/84/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/84/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/79",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/79/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/79/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/79/events",
          "html_url": "https://github.com/bosens-China/blog/issues/79",
          "id": 1085659613,
          "node_id": "I_kwDOCzPAy85Atdnd",
          "number": 79,
          "title": "ä»Vue3çœ‹ç»„ä»¶å¼€å‘æ–°å†™æ³•",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1935755992,
              "node_id": "MDU6TGFiZWwxOTM1NzU1OTky",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%BE%85%E5%AE%8C%E6%88%90%E7%B3%BB%E5%88%97",
              "name": "å¾…å®Œæˆç³»åˆ—",
              "color": "cc6e43",
              "default": false,
              "description": "ç­‰å¾…å®Œæˆçš„æ–‡ç« ..."
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2021-12-21T10:11:38Z",
          "updated_at": "2021-12-21T10:11:38Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": null,
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/79/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/79/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        }
      ]
    ],
    [
      "3041947800",
      [
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/68",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/68/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/68/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/68/events",
          "html_url": "https://github.com/bosens-China/blog/issues/68",
          "id": 906504178,
          "node_id": "MDU6SXNzdWU5MDY1MDQxNzg=",
          "number": 68,
          "title": "å¦‚ä½•é€‰æ‹©åˆé€‚çš„å…¬å¸ï¼Ÿ",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 3041947800,
              "node_id": "MDU6TGFiZWwzMDQxOTQ3ODAw",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E4%BB%A3%E7%A0%81%E4%BA%BA%E7%94%9F",
              "name": "ä»£ç äººç”Ÿ",
              "color": "7B17E3",
              "default": false,
              "description": "å’ŒæŠ€æœ¯æ— å…³ï¼Œäººç”Ÿçš„æ„Ÿæ‚Ÿ"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2021-05-29T16:03:33Z",
          "updated_at": "2021-12-21T10:00:56Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "![èƒŒæ™¯å›¾ç‰‡](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7fc336f293cb45d3a308a9ccc0a1aa17~tplv-k3u1fbpfcp-zoom-1.image)\r\n\r\nè™½ç„¶é‡‘ä¸‰é“¶å››æ—©ä¹Ÿè¿‡å»ï¼Œä¸è¿‡å¦ç‡çš„è¯´å¥½å¤šå…¬å¸æ‹›è˜çš„éœ€æ±‚é‡ä¾ç„¶å¾ˆå¤§ï¼Œå†åŠ ä¸Šè‡ªå·±è¿™æ®µæ—¶é—´ä¹Ÿåœ¨å…³æ³¨ï¼Œè¿™å—æ‰€ä»¥å°±ç®€å•èŠèŠä»é€‰æ‹©å…¬å¸åˆ°å…¥èŒçš„ä¸€ç³»åˆ—é—®é¢˜\r\n\r\n> è¿™é‡Œä¸æ¶‰åŠå¦‚ä½•å†™ç®€å†ä»¥åŠå¦‚ä½•å›ç­”é¢è¯•çš„é—®é¢˜ï¼Œåé¢å¦‚æœæœ‰æ—¶é—´ä¼šè€ƒè™‘æ–°å¼€ä¸€ä¸ªç¯‡å¹…æ¥è¯´\r\n\r\n## æ±‚èŒæ¸ é“\r\n\r\né¦–å…ˆå¦‚æœè‡ªå·±æ—©å·²æœ‰å¿ƒä»ªçš„ç›®æ ‡é‚£å¯ä»¥è·³è¿‡è¿™ä¸€æ­¥ï¼Œç›´æ¥ä»è„‰è„‰æˆ–è€…çŸ¥ä¹ç­‰å„ç§ç¤¾äº¤ app ä¸Šæ‰¾åˆ°å†…æ¨ä¿¡æ¯ï¼Œç„¶åæŠ•é€’ç®€å†ç­‰å¾…é¢è¯•ã€‚\r\n\r\nä½†æ˜¯å¦‚æœæ²¡æœ‰æ‰¾åˆ°æ»¡æ„çš„ç›®æ ‡ï¼Œé‚£ä¸å¦¨ä» `boss ç›´è˜`ç€æ‰‹ï¼Œä¹‹å‰ä¹Ÿç”¨äº†å¾ˆå¤šå…¶ä»–çš„æ‹›è˜ app æ¯”å¦‚æ‹‰é’©ï¼Œä¸è¿‡å¦ç‡çš„è¯´æ²Ÿé€šæ¨¡å¼æˆ–è€…è¯´å›å¤æ¶ˆæ¯è¿™å—å§‹ç»ˆæ²¡æœ‰ boss ç›´è˜æ¥çš„ç®€æ´å’Œæ¸…çˆ½ã€‚\r\n\r\n## ç­›é€‰å…¬å¸\r\n\r\nä¹‹å‰åœ¨çŸ¥ä¹çœ‹åˆ°ä¸€ä¸ªé—®é¢˜å°±æ˜¯è¯´`â€œå¹´è½»äººåˆ°åº•é€‰æ‹©å¤§å…¬å¸è¿˜æœ‰å°å…¬å¸â€`ï¼Œå½“ç„¶å„ç§ç­”æ¡ˆå„ä¸ç›¸åŒï¼Œä½†æ˜¯ç«™åœ¨è‡ªå·±è¸©è¿‡å‘çš„æƒ…å†µæ¥è¯´è¿˜æ˜¯å»ºè®®å¤§å®¶é€‰æ‹©ä¸€ä¸ªå¤§å…¬å¸ï¼Œå› ä¸ºå¯ä»¥èŠ‚çœä½ å¾ˆå¤šé¢å¤–çš„é‡‡å‘æˆæœ¬\r\n\r\n- æœ‰ç€å®Œæ•´åŠ è–ªç»“æ„ï¼Œä¸å†æ˜¯å£å¤´ä¸Šçš„ä¸€å¹´ä¸¤è°ƒæˆ–è€…ä¸€è°ƒï¼›\r\n- å„ç§ç¦åˆ©æ¯”è¾ƒé½å…¨ï¼Œå…¬ç§¯é‡‘å’Œç¤¾ä¿ç¼´çº³ç­‰ï¼›\r\n- å¼€å‘è§„èŒƒå’Œå›¢é˜Ÿåä½œæµç¨‹æ¯”è¾ƒæˆç†Ÿï¼Œå¯ä»¥æ¥è§¦åˆ°å®Œæ•´çš„å¼€å‘æµç¨‹ï¼›\r\n\r\nå…¶æ¬¡è¦æƒ³å¥½è‡ªå·±åšä»€ä¹ˆæ ·çš„äº§å“ï¼Œç›®å‰æŒ‰ç…§äº§å“åˆ’åˆ†å¯ä»¥åˆ†ä¸ºä¸¤ç§\r\n\r\n- to Bï¼šæä¾›ç»™ä¼ä¸šçš„äº§å“\r\n- to Cï¼šæä¾›ç»™ä¸ªäººçš„äº§å“\r\n\r\næ‰€ä»¥æ ¹æ®ä¸Šé¢ä¸¤æ¡ï¼Œåœ¨åŠ ä¸Šè‡ªå·±çš„ä¸€äº›å¿ƒç†åº•çº¿ï¼š\r\n\r\n1. ç¡®å®šå¥½è‡ªå·±æƒ³å»ä»€ä¹ˆè§„æ¨¡çš„å…¬å¸\r\n2. åšçš„äº§å“ä¸šåŠ¡æ˜¯ä»€ä¹ˆæ ·å­çš„\r\n3. æœŸå¾…çš„è–ªèµ„ç»“æ„ + ä¸Šä¸‹ç­æ—¶é—´ + åŸºç¡€æ€§çš„ç¦åˆ©ç­‰\r\n\r\næ ¹æ®ä¸Šé¢æ¡ä»¶åˆæ­¥ç­›é€‰å‡ºä¸€äº›å…¬å¸ï¼Œä¸‹é¢çš„è¯å°±æ˜¯çœ‹å…¬å¸çš„ä»‹ç»è·Ÿè‡ªå·±çš„ç¬¦åˆåº¦æ€ä¹ˆæ ·ï¼Œè¿™é‡Œå»ºè®®å¤§å®¶ä¸è¦å¹¿æ’’ç½‘è€Œæ˜¯ä¸“é—¨ç²¾é€‰è¿™æ ·ä¼šæ›´æœ‰æ•ˆçš„é’ˆå¯¹å…¬å¸è¿›è¡Œå‡†å¤‡ï¼Œå…¶å®ä¸ä»…ä»…æ˜¯å…¬å¸åœ¨é€‰æ‹©ä¸ªäººï¼Œä¸ªäººä¹Ÿè¦é€‰æ‹©å…¬å¸ï¼Œä¸ç„¶å…¶å®ä½ ä¼šå¾…çš„å¾ˆå‹æŠ‘æˆ–è€…è¯´è·Ÿä½ ä¸åŒ¹é…å°±æ˜¯æµªè´¹åŒæ–¹çš„æ—¶é—´ã€‚\r\n\r\nè¿™é‡Œé¢å¤–è¡¥å……ä¸€ç‚¹ï¼Œåœ¨é¢è¯•ä¹‹å‰å¯ä»¥äº‹å…ˆæ²Ÿé€šå¥½ä½ è‡ªå·±çš„ä¸€äº›åº•çº¿ä¿¡æ¯ã€‚é¿å…æ›´å¤šçš„æ—¶é—´æˆæœ¬æµªè´¹ï¼Œæ¯”å¦‚æˆ‘å°±æ˜¯è¦è¿‡æ»¤æ‰å…¬ç§¯é‡‘ç¤¾ä¿ä¸è¶³é¢ç¼´çº³çš„å…¬å¸ï¼Œé‚£ä½ å°±å¯ä»¥ç›´æ¥è¯´ï¼Œä½ å¥½æ–¹ä¾¿é—®ä¸€ä¸‹ä½ ä»¬å…¬ç§¯é‡‘ç¼´çº³æ¯”ä¾‹å’ŒåŸºæ•°å—ï¼Ÿ\r\n\r\næœ€åï¼Œå¦‚æœå¯¹æ–¹å·²è¯»ä¸å›é‚£å°±é»˜è®¤å‡‰äº†ï¼Œä½œä¸ºä¸è¦æ€€ç–‘è‡ªå·±ï¼Œæ‰¾å·¥ä½œä»æ¥ä¸æ˜¯ä¸€ä¸ªç®€å•çš„äº‹æƒ…ã€‚\r\n\r\n## é¢è¯•å‡†å¤‡\r\n\r\nç¡®å®šå¥½ç›®æ ‡è·Ÿ hr æ²Ÿé€šçš„æ—¶å€™æˆ‘ä¸ªäººè§‰å¾—ç¨å¾®çªå‡ºä¸»é¢˜å¯ä»¥æé«˜ä¸å°‘é¢è¯•å‡ ç‡ï¼Œæˆ‘ä¸€èˆ¬å–œæ¬¢è¯´ï¼šâ€œä½ å¥½çœ‹åˆ°è´µå…¬å¸çš„æ‹›è˜æƒ…å†µè§‰å¾—è›®ç¬¦åˆçš„ï¼Œå¯ä»¥å‘ä¸€ä»½ç®€å†ç»™ä½ çœ‹çœ‹å—ï¼Ÿâ€\r\n\r\nä¸è¿‡è¿™ä¸ªä¹Ÿä¸æ˜¯ç»å¯¹çš„ï¼Œæ¯•ç«Ÿæ±‚èŒè¿˜æ˜¯çœ‹ç¬¦ä¸ç¬¦åˆå²—ä½è¦æ±‚ï¼Œå¦‚æœä½ çš„ç®€å†è¶³å¤Ÿä¸°å¯Œï¼Œä¼°è®¡æ¯å¤©æ²Ÿé€šä½ çš„ hr è‡ªå·±éƒ½è¦æ’é˜Ÿå¤„ç†ã€‚\r\n\r\nè¯´å®Œæ‰“æ‹›å‘¼è¿˜æœ‰ä¸€ä¸ªéœ€è¦ç¡®è®¤å°±æ˜¯é¢è¯•æ—¶é—´å’Œæ–¹å¼ï¼Œä¸€èˆ¬è€Œè¨€å¦‚æœæ˜¯åœ¨èŒçš„è¯ä¼˜å…ˆè¿œç¨‹æˆ–è€…ç”µè¯é¢è¯•ï¼Œä¸ç„¶é‡åˆ°å‘çš„é¢è¯•å®˜è®©ä½ æ„Ÿè§‰æ—¶é—´è¢«æµªè´¹ï¼Œè€Œå¦‚æœä½ åœ¨å¤–åœ°æ±‚èŒçš„åœ°ç‚¹è·Ÿä½ ä¸åœ¨åŒä¸€ä¸ªåœ°æ–¹é‚£å¦‚æœå¯¹æ–¹ä¸æ”¯æŒè¿œç¨‹æˆ‘å»ºè®®ä½ å°±ä¸è¦å»äº†ï¼Œå› ä¸ºå¾ˆå¤šå…¬å¸çš„ hr å¯¹æŒ‡æ ‡æœ‰è¦æ±‚ï¼Œå¯èƒ½ä½ åªæ˜¯ä¸€ä¸ªä»–ä»¬çš„ kpiã€‚\r\n\r\nå½“ç„¶å¦‚æœèƒ½å®åœ°é¢è¯•æ›´å¥½ï¼Œå¯ä»¥é€šè¿‡è§‚å¯Ÿå…¬å¸é™„è¿‘çš„ç¯å¢ƒï¼Œå…¬å¸çš„ç¯å¢ƒä»¥åŠäººå‘˜åˆæ­¥åˆ¤æ–­ä¸€ä¸‹ã€‚\r\n\r\n## é¢è¯•ç»“æŸ\r\n\r\nå¦‚æœä½ å·²ç»æŠŠä¸€é¢ã€äºŒé¢ä¹‹ç±»çš„å…¨éƒ¨éƒ½è¿‡äº†ï¼Œåªå‰©ä¸‹ hr è¿™ä¸€å…³äº†é‚£ä½ å°±å¯ä»¥èŠä¸€ä¸‹å…³ä¹åˆ‡èº«çš„ç¦åˆ©ä¹‹ç±»äº†ã€‚\r\n\r\n### å·¥èµ„\r\n\r\nåŠ³åŠ¨åˆåŒä¼šç­¾è®¢å¤šå°‘ï¼Œç»©æ•ˆä¼šå æ¯”å¤šå°‘ï¼Œä»¥åŠç»©æ•ˆæ˜¯æŒ‰ç…§æ¯ä¸ªæœˆå‘æ”¾è¿˜æ˜¯ä¸€ä¸ªå­£åº¦å‘æ”¾ï¼Œè¯•ç”¨æœŸå·¥èµ„éƒ½éœ€è¦è¯¦ç»†äº†è§£æ¸…æ¥šï¼Œè€Œä¸”å…³äºåˆåŒä¸Šçš„å·¥èµ„ï¼Œä¹Ÿæ˜¯åé¢å¦‚æœéœ€è¦ç»´æƒæƒ…å†µçš„çš„ä¸€ä¸ªé‡è¦ä¾æ®ã€‚\r\n\r\n### äº”é™©ä¸€é‡‘ç¼´çº³çš„åŸºæ•°å’Œæ¯”ä¾‹\r\n\r\näº”é™©ä¸€é‡‘ä¸ç¼´çº³æ˜¯è¿æ³•çš„ï¼Œä½†æ˜¯æœ‰çš„ä¼ä¸šä¸ºäº†é™ä½æˆæœ¬é€‰æ‹©åªç¼´çº³æœ€ä½çš„åŸºæ•°ã€‚\r\n\r\nå…¬ç§¯é‡‘ä¼šè·Ÿä½ ä¹°æˆ¿çš„å…¬ç§¯é‡‘è´·æ¬¾è¿˜æœ‰è¿˜æ¬¾æŒ‚é’©ï¼Œæ˜¯ä¸€ä¸ªçœŸæ­£çš„ç¦åˆ©ï¼›\r\n\r\nè€Œäº”é™©è™½ç„¶ç›®å‰å¯èƒ½ç”¨ä¸åˆ°ï¼Œä½†æ˜¯å°‘äº¤è‚¯å®šæ˜¯ä¸ªäººçš„ä¸€ä¸ªæŸå¤±\r\n\r\n### åŠ ç­\r\n\r\næ˜¯å¦æœ‰åŠ ç­å·¥èµ„æˆ–è€…è°ƒä¼‘ï¼Œå…¶å®æˆ‘ä¸ªäººæ˜¯ä¸æ€ä¹ˆå–œæ¬¢åŠ ç­å¤šçš„å…¬å¸ï¼Œå°¤å…¶æ˜¯å› ä¸ºä¸šåŠ¡å¾ˆèµ¶çš„åŸå› æˆ–è€…å›¢é˜Ÿå…¬å¸æ°›å›´é€ æˆçš„ï¼Œå› ä¸ºè¿™ä¸ªä¼šå½±å“åˆ°ä½ çš„åç»­å­¦ä¹ ï¼Œè€Œä¸”æ¯å¤©ä½¿ä½ å¾ˆç–²å€¦ï¼Œä»é•¿è¿œæ¥çœ‹é€ƒç¦»åŠ ç­å¤šçš„å…¬å¸å¯¹ä½ çš„èŒä¸šç”Ÿæ¶¯æ›´å‹å¥½ã€‚\r\n\r\n### ä½œæ¯æ—¶é—´æ˜¯æ€ä¹ˆæ ·çš„\r\n\r\nç¡®å®šå¥½ä½œæ¯æ—¶é—´ï¼Œçœ‹çœ‹è‡ªå·±æ¯å¤©éœ€è¦é€šå‹¤å¤šä¹…ï¼Œå¦‚æœæ¡ä»¶å…è®¸å°±æ¬åˆ°å…¬å¸é™„è¿‘æ¥å§ï¼Œæ¯å¤©é€šå‹¤åå‡ åˆ†é’ŸçœŸçš„å¾ˆæœ‰å¹¸ç¦æ„Ÿã€‚\r\n\r\nè¿˜æœ‰ç¡®å®šå¥½æ˜¯å¦å¯ä»¥å¼¹æ€§æ‰“å¡ï¼Œå¦‚æœä½ åƒæˆ‘ä¸€æ ·æ¯å¤©å–œæ¬¢å¡ç€ç‚¹ä¸Šç­è¿˜æœ‰æ‰£é’±å•¥çš„ï¼Œå°±éœ€è¦ä»”ç»†æƒ³ä¸‹äº†ï¼Œä¸è¿‡å¯¹äºè¿™ç§å…¬å¸å»ºè®®è·‘è·¯ä¹‹ã€‚\r\n\r\n### æ¯å¹´ä¼šæœ‰è°ƒè–ªçš„æœºä¼šå—ï¼Œä¸€ä¸ªæµç¨‹æ˜¯æ€ä¹ˆæ ·çš„\r\n\r\nè¿™é‡Œå¯ä»¥ç®€å•äº†è§£ä¸‹ï¼Œå¯¹äºäº’è”ç½‘æ¥è¯´è·³æ§½æ°¸è¿œæ˜¯æ¶¨è–ªçš„æœ€å¥½æœºä¼šï¼Œä¸è¿‡å¦‚æœå›¢é˜Ÿæ°›å›´ä¸é”™ï¼Œå†åŠ ä¸Šæ¶¨è–ªå¹…åº¦ä¹Ÿ ok æˆ‘è§‰å¾—ç•™ä¸‹æ¥ä¹Ÿæ²¡æœ‰ä»€ä¹ˆä¸å¥½çš„\r\n\r\n### å…¶ä»–å„ç§ç¦åˆ©\r\n\r\næ¯”å¦‚é¤è¡¥ã€æˆ¿è¡¥ã€äº¤é€šè¡¥ã€èŠ‚å‡æ—¥ç¦åˆ©ã€å¦å¤–çš„ä¿é™©ç­‰ï¼Œä¸è¿‡æ³¨æ„ä¸è¦è·Ÿä½ è°ˆçš„è–ªèµ„æ··åˆåœ¨äº†ä¸€èµ·ï¼Œæ¯”å¦‚ä½ ç¨å‰ 20Kï¼Œç»“æœæ˜¯å„ç§ç¦åˆ©åŠ åœ¨ä¸€èµ·çš„ï¼Œé‚£æˆ‘è§‰å¾—å°±æ²¡æœ‰ä»€ä¹ˆå¿…è¦äº†ï¼Œè¿˜ä¸å¦‚ä¸å†™ã€‚\r\n\r\n### å¹´ç»ˆå¥–\r\n\r\nå¹´ç»ˆå¥–ä¹Ÿå¯ä»¥é—®ä¸‹ï¼Œä¸€èˆ¬æ¥è¯´æœ€å°‘ä¸€ä¸ªæœˆï¼Œå¤šçš„è¯ä¸‰å››ä¸ªæœˆçš„ä¹Ÿæ˜¯æœ‰ã€‚\r\n\r\nå¯¹äºæœŸæƒä¹‹ç±»çš„ï¼Œæˆ‘ä¸ªäººå»ºè®®å…ˆæš‚æ—¶æ— è§†ä¹‹ï¼Œå› ä¸ºè¿™ä¸ªä¸œè¥¿éœ€è¦æœ‰æ—¶é—´å‰ç½®æ¡ä»¶ï¼Œåˆ°æ—¶å€™ä½ èƒ½ä¸èƒ½å¾…æ»¡è¿™ä¹ˆä¹…éƒ½ä¸å¥½è¯´ï¼Œå¦‚æœçœŸçš„å¾…è¿™ä¹ˆä¹…å†äº†è§£ä¹Ÿä¸è¿Ÿã€‚\r\n\r\n## æœ€å\r\n\r\nå¦‚æœç¡®å®šå¥½å‡†å¤‡å»ï¼Œè®°å¾—è®©å¯¹æ–¹å…¬å¸å‘ä¸€ä»½`offer`è¿‡æ¥ï¼Œè¾èŒçš„è¯æ­£å¼å‘˜å·¥éœ€è¦ä¸€ä¸ªæœˆï¼Œè¯•ç”¨æœŸä¸‰å¤©ï¼Œæ‰€ä»¥ä½ éœ€è¦è·Ÿæ–°å…¬å¸çš„ hr ç¡®å®šå¥½å…·ä½“çš„å…¥èŒæ—¶é—´ï¼Œä»¥åŠç¡®å®šå¥½ç¤¾ä¿çš„ç¼´çº³æ—¶é—´ï¼Œé¿å…æ–­äº¤ç¤¾ä¿é€ æˆçš„å½±å“ã€‚\r\n\r\næœ€åï¼Œå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©å¯ä»¥ç‚¹ä¸€ä¸‹`statr`\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/68/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/68/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        }
      ]
    ],
    [
      "1602397157",
      [
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/77",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/77/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/77/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/77/events",
          "html_url": "https://github.com/bosens-China/blog/issues/77",
          "id": 1041025871,
          "node_id": "I_kwDOCzPAy84-DMtP",
          "number": 77,
          "title": "åˆ¤æ–­å¯¹è±¡å…¨ç­‰",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1602397157,
              "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
              "name": "æ·±å…¥ç³»åˆ—",
              "color": "719192",
              "default": false,
              "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2021-11-01T10:38:09Z",
          "updated_at": "2021-12-21T09:58:45Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "JavaScript è‡ªå¸¦äº†`==`å’Œ`===`ä¸¤ç§åˆ¤æ–­æ–¹å¼ï¼Œå‰è€…ä¼šéšå¼è½¬æ¢ç±»å‹å¯¼è‡´ä»£ç å‡ºç°é—®é¢˜ï¼Œè€Œåè€…åˆ™æ˜¯æ ¹æ®æŒ‡é’ˆåœ°å€è¿›è¡Œåˆ¤æ–­ã€‚\r\n\r\nåœ¨ç»å¤§å¤šæ•°æƒ…å†µè¿™ä¸¤ç§å·²ç»è¶³å¤Ÿä½¿ç”¨äº†ï¼Œä¸è¿‡å»¶ä¼¸ä¸‹æƒ³åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æˆ–æ•°ç»„å…ƒç´ æ˜¯å¦ç›¸åŒï¼Œåˆ™ä¼šæ˜¾å¾—ä¸å¤ªå‹å¥½ï¼Œè€Œä¸”åœ¨ JavaScript ä¸­æœ‰ä¸€äº›ç‰¹æ®Šçš„è§„åˆ™ï¼š`NaN`å’Œ`NaN`ä¸ç›¸åŒã€`+0`å’Œ`-0`ç›¸åŒï¼Œè¿™å°±å¯¼è‡´æœ‰çš„åœºæ™¯ä½¿ç”¨èµ·æ¥ä¸ä¾¿ï¼Œä¸‹é¢åŠ¨æ‰‹å®ç°ä¸€ä¸ª`equal`å‡½æ•°ï¼Œå®ƒå…·å¤‡ä»¥ä¸‹åŠŸèƒ½ï¼š\r\n\r\n- `+0`å’Œ`-0`ä¸ç›¸åŒ\r\n- `NaN`å’Œ`NaN`ç›¸åŒ\r\n- `{}`å’Œ`{}`ç›¸åŒ\r\n- `[]`å’Œ`[]`ç›¸åŒ\r\n- `new Set()`å’Œ`new Set()`ç›¸åŒ\r\n- `new Map()`å’Œ`new Map()`ç›¸åŒ\r\n- `new Date(111)`å’Œ`new Date(111)`ç›¸åŒ\r\n- `new String(1)`å’Œ`new String(1)`ä¹‹ç±»çš„åŒ…è£…å¯¹è±¡ç›¸åŒ\r\n- `/a/`å’Œ`/a/`ç›¸åŒ -`() => {}`å’Œ`() => {}`ä¸ç›¸åŒ\r\n- å…¶ä»–æƒ…å†µä¸€å¾‹`===`åˆ¤æ–­\r\n\r\n## ç¬¬ä¸€ç‰ˆ\r\n\r\nåœ¨è¿™ä¸€ç‰ˆä¸­ï¼Œæˆ‘ä»¬å…ˆå®ç°`+0`å’Œ`-0`ã€`NaN`çš„åˆ¤æ–­\r\n\r\n```js\r\nfunction equal(a, b) {\r\n  // åˆ¤æ–­NaN\r\n  if (a === b) {\r\n    return 1 / a === 1 / b;\r\n  }\r\n  // åˆ¤æ–­å¯¹è±¡\r\n  if (a && b && typeof a === 'object' && typeof b === 'object') {\r\n    //... ç•™ç©º\r\n  }\r\n  // åˆ¤æ–­NaN\r\n  return a !== a && b !== b;\r\n}\r\n```\r\n\r\nä¸Šé¢åˆ¤æ–­`NaN`çš„æ€è·¯ä¸º`1 / 0`ä¸º`Infinity`ï¼Œè€Œ`1/-0`ä¸º`-Infinity`\r\n\r\n## ç¬¬äºŒç‰ˆ\r\n\r\nç¬¬ä¸€ç‰ˆä¸­æˆ‘ä»¬å·²ç»å®ç°äº†åŸºç¡€çš„åŠŸèƒ½ï¼Œä¸‹é¢å°±æ¥å®ç°ä¸€ä¸‹æ€ä¹ˆæ·±å±‚æ¬¡åˆ¤æ–­å¯¹è±¡å’Œæ•°ç»„æ˜¯å¦ç›¸åŒ\r\n\r\n```js\r\nfunction equal(a, b) {\r\n  // åˆ¤æ–­NaN\r\n  if (a === b) {\r\n    return 1 / a === 1 / b;\r\n  }\r\n  // åˆ¤æ–­å¯¹è±¡\r\n  if (a && b && typeof a === 'object' && typeof b === 'object') {\r\n    if (a.constructor !== b.constructor) {\r\n      return false;\r\n    }\r\n    // åˆ¤æ–­array\r\n    if (Array.isArray(a) && Array.isArray(b)) {\r\n      const len = a.length;\r\n      if (len !== b.length) {\r\n        return false;\r\n      }\r\n      for (let i = 0; i < len; i++) {\r\n        if (!equal(a[i], b[i])) {\r\n          return false;\r\n        }\r\n      }\r\n      return true;\r\n    }\r\n    // é»˜è®¤ä¸ºå¯¹è±¡ï¼Œè¿›è¡Œkeyå’Œé•¿åº¦å¯¹æ¯”\r\n    const keys = Object.keys(a);\r\n    const len = keys.length;\r\n    if (Object.keys(b).length !== len) {\r\n      return false;\r\n    }\r\n    for (let i = 0; i < len; i++) {\r\n      const key = keys[i];\r\n      if (!Object.prototype.hasOwnProperty.call(b, key)) {\r\n        return false;\r\n      }\r\n      if (!equal(a[key], b[key])) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n}\r\n```\r\n\r\nä¸Šé¢ä»£ç ä¸­é¦–å…ˆåˆ¤æ–­`constructor`æ˜¯å¦ç›¸åŒï¼Œ`constructor`å¯ä»¥ä»å®ä¾‹æŒ‡å‘åŸå‹çš„æ„é€ å‡½æ•°ï¼Œä¸Šé¢ä»£ç é¦–å…ˆçš„æ„æ€æ˜¯é¦–å…ˆåˆ¤æ–­æ„é€ å‡½æ•°æ˜¯å¦ç›¸åŒï¼Œå¦‚æœä¸ç›¸åŒç›´æ¥è¿”å›ã€‚\r\n\r\nåé¢çš„è¯åˆ¤æ–­æ•°ç»„çš„æˆå‘˜æ•°é‡ã€æ¯ä¸ªå­å±æ€§æ˜¯å¦ç›¸åŒï¼Œè€Œåˆ¤æ–­å¯¹è±¡ä¹Ÿæ˜¯åˆ¤æ–­`length`ä¹‹ååˆ¤æ–­`b`ä¸‹æ˜¯å¦å­˜åœ¨`name`ï¼Œä¹‹åç»Ÿä¸€å¯¹æ¯”å€¼æ˜¯å¦ç›¸åŒã€‚\r\n\r\nè‡³äºæ‰§è¡Œ`Object.prototype.hasOwnProperty`çš„åŸå› åˆ™æ˜¯`hasOwnProperty`æœ‰å¯èƒ½è¢«æ”¹å†™ï¼Œä¾‹å¦‚ï¼š\r\n\r\n```js\r\nvar foo = {\r\n  hasOwnProperty: function () {\r\n    return false;\r\n  },\r\n  bar: 'Here be dragons',\r\n};\r\n\r\nfoo.hasOwnProperty('bar'); // å§‹ç»ˆè¿”å› false\r\n```\r\n\r\n## ç¬¬ä¸‰ç‰ˆ\r\n\r\nä¸Šé¢çš„ä»£ç åŸºæœ¬å®ç°äº†ä¸€ä¸ªé›å½¢ï¼Œä¸‹é¢åŠ å…¥`Set`ã€`Map`çš„å¯¹æ¯”ï¼Œ`Set`å’Œ`Map`æ˜¯ es6 æ˜¯å¼•å…¥çš„æ–°çš„æ•°æ®ç»“æ„ï¼Œ`Set`æ˜¯ä¸€ç»„ä¸é‡å¤çš„æˆå‘˜ï¼Œ`Map`åˆ™æ˜¯`object`çš„å‡çº§ç‰ˆï¼šé‡ç‚¹è§£å†³äº†é”®åå¾ªç¯ä¸ç¨³å®šä»¥åŠåªèƒ½æ’å…¥ string é”®åçš„é—®é¢˜ã€‚\r\n\r\nå®ƒä»¬ä¸¤è€…éƒ½æ˜¯æœ‰åºçš„ï¼Œä¸”éƒ½éµå¾ª`Symbol.iterator`ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸ä»…è¦å¯¹æ¯”`name`ã€`value`ä¹Ÿè¦å¯¹æ¯”æ‰€åœ¨çš„ä½ç½®æ˜¯å¦ç›¸åŒï¼Œè¿™é‡Œä¸ºäº†ç®€åŒ–åé¢çš„å·¥ä½œæå‰å†™äº†ä¸€ä¸ªå‡½æ•°\r\n\r\n```js\r\nconst iteration = (value, j) => {\r\n  let i = 0;\r\n  for (const iterator of value) {\r\n    if (j === i++) {\r\n      return iterator;\r\n    }\r\n  }\r\n  return undefined;\r\n};\r\n```\r\n\r\nå®ƒçš„ä½œç”¨å°±æ˜¯æ ¹æ®`j`æŒ‡å®šä¸‹æ ‡æ¥è¿è¡Œè¿­ä»£å™¨çš„`next`æ–¹æ³•ï¼Œä¾‹å¦‚ï¼š\r\n\r\n```js\r\niteration(new Set([1, 2, 3]), 1); // 2\r\n```\r\n\r\n```js\r\n// åˆ¤æ–­set\r\nif (a instanceof Set && b instanceof Set) {\r\n  const len = a.size;\r\n  if (len !== b.size) {\r\n    return false;\r\n  }\r\n  for (let i = 0; i < len; i++) {\r\n    if (!equal(iteration(a, i), iteration(b, i))) {\r\n      return false;\r\n    }\r\n  }\r\n  return true;\r\n}\r\n// åˆ¤æ–­Map\r\nif (a instanceof Map && b instanceof Map) {\r\n  const len = a.size;\r\n  if (len !== b.size) {\r\n    return false;\r\n  }\r\n  for (let i = 0; i < len; i++) {\r\n    const [nameA, valueA] = iteration(a.entries(), i);\r\n    const [nameB, valueB] = iteration(b.entries(), i);\r\n    if (!equal(nameA, nameB) || !equal(valueA, valueB)) {\r\n      return false;\r\n    }\r\n  }\r\n  return true;\r\n}\r\n```\r\n\r\nå¯ä»¥å‘ç°`Set`å’Œ`Map`åˆ¤æ–­æ˜¯å¦ç›¸ä¼¼ï¼Œé¦–å…ˆå¯¹æ¯”æˆå‘˜æ•°é‡ï¼Œå…¶æ¬¡å¯¹æ¯”æ¯ä¸€æ¬¡å½“å‰ä½ç½®çš„é”®åå’Œé”®å€¼ã€‚\r\n\r\n## ç¬¬å››ç‰ˆ\r\n\r\nå†™åˆ°è¿™é‡Œæˆ‘ä»¬å·²ç»å®ç°äº† 80%çš„åŠŸèƒ½ï¼Œå‰©ä¸‹çš„ä¸€äº›åˆ¤æ–­è¿˜æœ‰\r\n\r\n- `new Date(111)`å’Œ`new Date(111)`ç›¸åŒ\r\n- `new String(1)`å’Œ`new String(1)`ä¹‹ç±»çš„åŒ…è£…å¯¹è±¡ç›¸åŒ\r\n- `/a/`å’Œ`/a/`ç›¸åŒ\r\n\r\n```js\r\n// åˆ¤æ–­regexp\r\nif (a.constructor === RegExp) {\r\n  return a.source === b.source && a.flags === b.flags;\r\n}\r\nif (a.toString !== Object.prototype.toString) {\r\n  return a.toString() === b.toString();\r\n}\r\nif (a.valueOf !== Object.prototype.valueOf) {\r\n  return a.valueOf() === b.valueOf();\r\n}\r\n```\r\n\r\nåˆ¤æ–­åŒ…è£…ç±»å‹å’Œ`Date`å¯ä»¥`valueOf`å’Œ`toString`æ–¹æ³•å®ç°ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½ä¼šä»`Object.prototype`ç»§æ‰¿`vlaueOf`å’Œ`toString`æ–¹æ³•ã€‚\r\n\r\né€šå¸¸æƒ…å†µä¸‹`valueOf`è¿”å›åŒ…è£…å¯¹è±¡ä¼ é€’çš„å‚æ•°ï¼Œè€Œæœ‰çš„å¯¹è±¡ä¼šæ›´æ”¹`valueOf`æ–¹æ³•ï¼Œä¾‹å¦‚`Date`è¿”å›`number`ç±»å‹ï¼Œæ‰€ä»¥ä¸Šé¢åˆ¤æ–­`valueOf`ä¸€åˆ™æ˜¯ä¸ºäº†`Date`å¦å¤–ä¸€æ–¹åˆ™æ˜¯åˆå§‹è¿‡æ»¤ä¼ é€’çš„å‚æ•°ã€‚\r\n\r\nè‡³äºä¸ºä»€ä¹ˆä¹Ÿåˆ¤æ–­`toString`åˆ™æ˜¯ä¸ºäº†è€ƒè™‘è¾¹ç•Œæƒ…å†µï¼Œä¾‹å¦‚ï¼š\r\n\r\n```js\r\nvar a = new Boolean(true);\r\nvar b = new Boolean(1);\r\na === b ?\r\n```\r\n\r\nå¦‚æœæ²¡æœ‰`toString`è¿™ä¸ªå°±ç›¸åŒäº†\r\n\r\n## æœ€å\r\n\r\nå®Œæ•´çš„æŠŠä»£ç è´´ä¸€ä¸‹ï¼Œå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ä¹Ÿå¯ä»¥`star`æ”¯æŒä¸€ä¸‹ï¼Œæœ‰ä»€ä¹ˆé”™è¯¯ä¹Ÿæ¬¢è¿æŒ‡å‡ºã€‚\r\n\r\n```js\r\nconst iteration = (value, j) => {\r\n  let i = 0;\r\n  for (const iterator of value) {\r\n    if (j === i++) {\r\n      return iterator;\r\n    }\r\n  }\r\n  return undefined;\r\n};\r\nfunction equal(a, b) {\r\n  // åˆ¤æ–­NaN\r\n  if (a === b) {\r\n    return 1 / a === 1 / b;\r\n  }\r\n  // åˆ¤æ–­å¯¹è±¡\r\n  if (a && b && typeof a === 'object' && typeof b === 'object') {\r\n    // åˆ¤æ–­å¯¹è±¡\r\n    if (a && b && typeof a === 'object' && typeof b === 'object') {\r\n      if (a.constructor !== b.constructor) {\r\n        return false;\r\n      }\r\n      // åˆ¤æ–­array\r\n      if (Array.isArray(a) && Array.isArray(b)) {\r\n        const len = a.length;\r\n        if (len !== b.length) {\r\n          return false;\r\n        }\r\n        for (let i = 0; i < len; i++) {\r\n          if (!equal(a[i], b[i])) {\r\n            return false;\r\n          }\r\n        }\r\n        return true;\r\n      }\r\n      // åˆ¤æ–­set\r\n      if (a instanceof Set && b instanceof Set) {\r\n        const len = a.size;\r\n        if (len !== b.size) {\r\n          return false;\r\n        }\r\n        for (let i = 0; i < len; i++) {\r\n          if (!equal(iteration(a, i), iteration(b, i))) {\r\n            return false;\r\n          }\r\n        }\r\n        return true;\r\n      }\r\n      // åˆ¤æ–­Map\r\n      if (a instanceof Map && b instanceof Map) {\r\n        const len = a.size;\r\n        if (len !== b.size) {\r\n          return false;\r\n        }\r\n        for (let i = 0; i < len; i++) {\r\n          const [nameA, valueA] = iteration(a.entries(), i);\r\n          const [nameB, valueB] = iteration(b.entries(), i);\r\n          if (!equal(nameA, nameB) || !equal(valueA, valueB)) {\r\n            return false;\r\n          }\r\n        }\r\n        return true;\r\n      }\r\n      // åˆ¤æ–­regexp\r\n      if (a.constructor === RegExp) {\r\n        return a.source === b.source && a.flags === b.flags;\r\n      }\r\n      if (a.toString !== Object.prototype.toString) {\r\n        return a.toString() === b.toString();\r\n      }\r\n      if (a.valueOf !== Object.prototype.valueOf) {\r\n        return a.valueOf() === b.valueOf();\r\n      }\r\n      // é»˜è®¤ä¸ºå¯¹è±¡ï¼Œè¿›è¡Œkeyå’Œé•¿åº¦å¯¹æ¯”\r\n      const keys = Object.keys(a);\r\n      const len = keys.length;\r\n      if (Object.keys(b).length !== len) {\r\n        return false;\r\n      }\r\n      for (let i = 0; i < len; i++) {\r\n        const key = keys[i];\r\n        if (!Object.prototype.hasOwnProperty.call(b, key)) {\r\n          return false;\r\n        }\r\n        if (!equal(a[key], b[key])) {\r\n          return false;\r\n        }\r\n      }\r\n      return true;\r\n    }\r\n  }\r\n  // åˆ¤æ–­NaN\r\n  return a !== a && b !== b;\r\n}\r\n```\r\n\r\n## å‚è€ƒ\r\n\r\n- [fast-deep-equal](https://github.com/epoberezkin/fast-deep-equal)\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/77/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/77/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/76",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/76/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/76/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/76/events",
          "html_url": "https://github.com/bosens-China/blog/issues/76",
          "id": 1029841361,
          "node_id": "I_kwDOCzPAy849YiHR",
          "number": 76,
          "title": "å‡½æ•°è®°å¿†",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1602397157,
              "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
              "name": "æ·±å…¥ç³»åˆ—",
              "color": "719192",
              "default": false,
              "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2021-10-19T04:16:45Z",
          "updated_at": "2021-12-21T09:58:43Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "> **è®°å¿†åŒ–**ï¼ˆè‹±è¯­ï¼šmemoizationï¼‰æ˜¯ä¸€ç§æé«˜[è®¡ç®—æœºç¨‹åº](https://zh.wikipedia.org/wiki/è®¡ç®—æœºç¨‹åº)æ‰§è¡Œé€Ÿåº¦çš„ä¼˜åŒ–æŠ€æœ¯ã€‚é€šè¿‡å‚¨å­˜å¤§è®¡ç®—é‡[å‡½æ•°](https://zh.wikipedia.org/wiki/å­ç¨‹åº)çš„è¿”å›å€¼ï¼Œå½“è¿™ä¸ªç»“æœå†æ¬¡è¢«éœ€è¦æ—¶å°†å…¶ä»[ç¼“å­˜](https://zh.wikipedia.org/wiki/ç¼“å­˜)æå–ï¼Œè€Œä¸ç”¨å†æ¬¡è®¡ç®—æ¥èŠ‚çœè®¡ç®—æ—¶é—´ã€‚\r\n>\r\n> è®°å¿†åŒ–æ˜¯ä¸€ç§å…¸å‹çš„åœ¨è®¡ç®—æ—¶é—´ä¸[ç”µè„‘å­˜å‚¨å™¨](https://zh.wikipedia.org/wiki/é›»è…¦è¨˜æ†¶é«”)ç©ºé—´ä¹‹ä¸­è·å–å¹³è¡¡çš„æ–¹æ¡ˆã€‚\r\n>\r\n> æ¥æºï¼š[ç»´åŸºç™¾ç§‘](https://zh.wikipedia.org/wiki/%E8%AE%B0%E5%BF%86%E5%8C%96)\r\n\r\nä»ä¸Šé¢çš„å®šä¹‰å¯ä»¥çœ‹å‡ºç¼“å­˜æ˜¯ä¸€ç§éå¸¸æœ‰ç”¨çš„æŠ€å·§ï¼Œå®ƒå¯ä»¥æŠŠä¸€äº›å‡½æ•°ç»“æœå‚¨å­˜èµ·æ¥åœ¨ä¸‹æ¬¡è°ƒç”¨çš„æ—¶å€™è¿”å›ã€‚\r\nè¿™é‡Œä¸è®¨è®ºä»€ä¹ˆæ ·åœºæ™¯ä½¿ç”¨ç¼“å­˜è€Œæ˜¯æŠ›ç –å¼•ç‰å¦‚ä½•ç¼–å†™ä¸€ä¸ªå¯å¤ç”¨çš„ Memoization å‡½æ•°\r\n\r\n## MemoizationSync\r\n\r\nMemoizationSync ä»å­—é¢å°±å¯ä»¥çœ‹å‡ºå®ƒæ˜¯ä¸€ä¸ªåŒæ­¥ç‰ˆæœ¬çš„ Memoizationï¼Œä¸‹é¢çš„ä»¥ `add` å‡½æ•°ä¸ºä¾‹ä»‹ç»å¦‚ä½•ç¼–å†™ä¸€ä¸ªé€šç”¨çš„ memoization æ¥å¯¹ç»“æœè¿›è¡Œç¼“å­˜\r\n\r\n```js\r\nconst memo = {};\r\n\r\nconst add = (...args) => {\r\n  const key = args.join();\r\n  if (Object.prototype.hasOwnProperty.call(memo, key)) {\r\n    return memo[key];\r\n  }\r\n  const result = args.reduce((a, b) => a + b, 0);\r\n  memo[key] = result;\r\n  return result;\r\n};\r\n\r\nadd(1, 2, 3);\r\nadd(1, 2, 3);\r\n```\r\n\r\nå¦‚æœè¦ç»™ `add` å‡½æ•°æ˜¾ç¤ºçš„æ·»åŠ ä¸€ä¸ªç¼“å­˜åŠŸèƒ½å¯èƒ½ä¼šæŒ‰ç…§ä¸Šé¢çš„æƒ…å†µæ¥ç¼–å†™ï¼Œä½†æ˜¯å®ƒå­˜åœ¨é—®é¢˜ã€‚\r\n\r\nè¿™ä¸ªå‡½æ•°åŒæ—¶åšäº†ä¸¤ä»¶äº‹æƒ…\r\n\r\n- è®¡ç®— args\r\n- è¯»å– memo çš„ç¼“å­˜\r\n  ä½†æ˜¯è¿™æ ·æ˜¾ç¤ºè¿èƒŒäº†è®¾è®¡æ¨¡å¼çš„å•ä¸€åŸåˆ™ï¼Œè€Œä¸”ä¼šç»™åç»­çš„ç»´æŠ¤å¸¦æ¥éº»çƒ¦ï¼Œä»¥åŠå¦‚æœæˆ‘ä»¬éœ€è¦æ–°çš„å‡½æ•°ç¼“å­˜æ˜¯ä¸æ˜¯è¿˜è¦é‡æ–°å¤åˆ¶ä¸€ä»½è¿‡å»ï¼Œæ˜¾ç„¶ä¸ç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚ï¼Œæˆ‘ä»¬å°è¯•å°†å®ƒè¿›è¡Œä¸€æ¬¡æŠ½ç¦»\r\n\r\n```js\r\nconst add = (...args) => {\r\n  return args.reduce((a, b) => a + b, 0);\r\n};\r\n\r\nconst memoizationSync = (fn, key) => {\r\n  const memo = {};\r\n  return function callback(...args) {\r\n    if (memo.hasOwnProperty(key)) {\r\n      return memo[key];\r\n    }\r\n    const result = fn.apply(this, args);\r\n    memo[key] = result;\r\n    return result;\r\n  };\r\n};\r\n\r\nconst argumentsArr = [1, 2, 3];\r\nconst memoizationAdd = memoizationSync(add, argumentsArr);\r\nmemoizationAdd(...argumentsArr);\r\nmemoizationAdd(...argumentsArr);\r\n```\r\n\r\nè¿™æ ·å°±å¾—åˆ°äº†ä¸€ä¸ªé€šç”¨çš„ memoizationSync å‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ª `key` ï¼Œé€šè¿‡ `key` æ¥è¿›è¡ŒåŒºåˆ†ç¼“å­˜ã€‚\r\n\r\nä¸è¿‡ä¸ºäº†å®ƒçš„çµæ´»æ€§å’Œç¬¦åˆæ›´å¤šçš„åœºæ™¯çš„è¦æ±‚æˆ‘ä»¬è¿˜æ˜¯éœ€è¦å¯¹å®ƒè¿›è¡Œä¸€æ¬¡æ”¹é€ ï¼Œæ¥æ”¹é€ å‰æˆ‘ä»¬çœ‹ä¸‹è¿™ä¸ªå‡½æ•°åšäº†å•¥\r\n\r\n- æ ¹æ® key æ¥è¯»å–ç¼“å­˜\r\n- æ— ç¼“å­˜æ¥æ‰§è¡Œå‡½æ•°è®¾ç½®ç¼“å­˜\r\n  æ˜¾ç„¶è¿™ä¸¤æ­¥æ˜¯ä¸ä¼šæ”¹å˜çš„ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å¯¹ `key` ä¸‹æ‰‹æé«˜ `key` çš„å”¯ä¸€æ€§ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒå¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°å¹¶ä¸”å­˜åœ¨é»˜è®¤å€¼ï¼Œè¿™æ ·åœ¨å¤æ‚åœºæ™¯ä¸‹å¯ä»¥ç”±ç”¨æˆ·æ ¹æ®å‚æ•°æ¥æŒ‡å®šç¼“å­˜ä»€ä¹ˆå­—æ®µ\r\n\r\n```js\r\nconst memoizationSync = (fn, getKey = (...args) => args.join('')) => {\r\n  const memo = {};\r\n  return function callback(...args) {\r\n    const key = typeof getKey === 'function' ? getKey.apply(this, args) : getKey;\r\n    if (memo.hasOwnProperty(key)) {\r\n      return memo[key];\r\n    }\r\n    const result = fn.apply(this, args);\r\n    memo[key] = result;\r\n    return result;\r\n  };\r\n};\r\n```\r\n\r\n## MemoizationAsync\r\n\r\nåœ¨ JavaScript ä¸­å¼‚æ­¥åœºæ™¯ç²—ç•¥å¯ä»¥åˆ†ä¸ºä¸¤éƒ¨åˆ†\r\n\r\n- å›è°ƒå‡½æ•°\r\n- Promiseï¼ˆasync ã€Generator éƒ½æ˜¯åŸºäº Promiseï¼‰\r\n\r\nä¸‹é¢å°±æ¥è®¨è®ºè¿™ä¸¤éƒ¨åˆ†æˆ‘ä»¬å¦‚ä½•å®ç°ç¼“å­˜\r\n\r\n### Callback\r\n\r\næˆ‘ç°åœ¨æœ‰ä¸€ä¸ª getImgSize çš„å‡½æ•°ï¼Œå®ƒä¼šæ ¹æ® `img` çš„ `src` æ¥è¿”å›å›¾ç‰‡çš„çœŸå®å®½åº¦å’Œé«˜åº¦ï¼Œå¦‚æœæˆåŠŸå°±ä¼šè°ƒç”¨ `callback` æ¥ä¼ é€’å‚æ•°ï¼ˆnode å›è°ƒé£æ ¼ï¼‰ï¼Œä½†æ˜¯æˆ‘å¸Œæœ›å¦‚æœ url ç›¸åŒçš„æ—¶å€™å°±ç›´æ¥è¿”å›è€Œä¸æ˜¯ç»§ç»­è°ƒç”¨ä¸€æ¬¡ getImgSize\r\n\r\n```js\r\nconst getImgSize = (src, callback) => {\r\n  const img = new Image();\r\n  img.src = src;\r\n  img.addEventListener('load', () => {\r\n    callback(null, {\r\n      width: img.naturalWidth,\r\n      height: img.naturalHeight,\r\n    });\r\n  });\r\n\r\n  img.addEventListener('error', (e) => {\r\n    callback(new Error(e), null);\r\n  });\r\n};\r\n\r\nconst url = 'https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png';\r\n\r\ngetImgSize(url, (error, size) => {\r\n  if (error) {\r\n    return;\r\n  }\r\n  console.log(size);\r\n});\r\n```\r\n\r\nåœ¨ç¼–å†™ memoizationAsync å‡½æ•°ä¹‹å‰æˆ‘ä»¬å…ˆæƒ³ä¸€ä¸‹ä»¥ä»€ä¹ˆæ ·çš„æ–¹å¼æ¥ç¼–å†™è¿™ä¸ªå‡½æ•°ï¼ŒæŒ‰ç…§æƒ¯ä¾‹æˆ‘ä»¬å¸Œæœ›ä¸è¦å¯¹ç”¨æˆ·çš„ä½¿ç”¨æ–¹å¼æœ‰å¤ªå¤šå½±å“ï¼Œæ‰€ä»¥æœŸå¾…çš„è°ƒç”¨æ–¹å¼å¦‚ä¸‹\r\n\r\n```js\r\nconst getImgSizeMemoization = memoizationAsync(getImgSize);\r\ngetImgSizeMemoization(url, (error, size) => {\r\n  if (error) {\r\n    return;\r\n  }\r\n  console.log(size);\r\n});\r\n// ç›¸åŒå‚æ•°ä½¿ç”¨ç¼“å­˜\r\ngetImgSizeMemoization(url, (error, size) => {\r\n  if (error) {\r\n    return;\r\n  }\r\n  console.log(size);\r\n});\r\n```\r\n\r\nåé¢å°±æ˜¯æ¥ç¼–å†™è¿™ä¸ªå‡½æ•°\r\n\r\n```js\r\nconst memoizationAsync = (fn, getKey = (...args) => args.join()) => {\r\n  const memo = {};\r\n  const queue = {};\r\n  return function (...rest) {\r\n    const callback = Array.prototype.pop.call(rest);\r\n    const key = getKey.apply(this, rest);\r\n    const cb = (...args) => {\r\n      memo[key] = args;\r\n      queue[key].forEach((item) => {\r\n        item.apply(this, args);\r\n      });\r\n      delete queue[key];\r\n    };\r\n    if (memo.hasOwnProperty(key)) {\r\n      return memo[key];\r\n    }\r\n    if (!queue.hasOwnProperty(key)) {\r\n      queue[key] = [callback];\r\n    } else {\r\n      queue[key].push(callback);\r\n      // åç»­åŠ å…¥ç­‰å¾…ç¬¬ä¸€ä¸ªæ‰§è¡Œç»“æŸ\r\n      return;\r\n    }\r\n    fn.apply(this, [...rest, cb]);\r\n  };\r\n};\r\n```\r\n\r\nè¯´ä¸€ä¸‹è¿™ä¸ªå‡½æ•°ç¼–å†™çš„æ€è·¯ï¼Œé€šè¿‡è‡ªå®šä¹‰åˆ›å»º cb å›è°ƒå‡½æ•°æ¥å®Œæˆè®°å½•ç¼“å­˜å’Œè°ƒç”¨ç”¨æˆ·ä¼ é€’çš„å›è°ƒï¼Œå…¶ä»–çš„è¯»å–å’Œè®¾ç½®ç¼“å­˜ä¸ä¸Šé¢ä¸€è‡´ã€‚\r\n\r\nè€Œå­˜åœ¨ `queue` å˜é‡çš„åŸå› æ˜¯å› ä¸ºå¼‚æ­¥ä»»åŠ¡æ·»åŠ è¿›æ¥çš„æ—¶å€™å¯èƒ½æ­£åœ¨è¯·æ±‚ï¼Œä½†æ˜¯ `memo` è¿˜æ²¡æœ‰è¢«å†™å…¥ç»“æœï¼Œæ‰€ä»¥é€šè¿‡é˜Ÿåˆ—æ¥ç®¡ç†è¿™ä¸ªè¯·æ±‚ï¼Œç­‰å¾…ç¬¬ä¸€ä¸ªè¯·æ±‚ç»“æŸä¹‹åæ‰¹é‡æ¥æ‰§è¡Œé˜Ÿåˆ—çš„ä»»åŠ¡ï¼Œæœ€ååˆ é™¤ã€‚\r\n\r\n### Promise\r\n\r\nå›å¿†ä¸€ä¸‹[Promise å‡½æ•°çš„ç‰¹æ€§](https://es6.ruanyifeng.com/#docs/promise#Promise-%E7%9A%84%E5%90%AB%E4%B9%89)\r\n\r\n- å¯¹è±¡çš„çŠ¶æ€ä¸å—å¤–ç•Œå½±å“\r\n- ä¸€æ—¦çŠ¶æ€æ”¹å˜ï¼Œå°±ä¸ä¼šå†å˜ï¼Œä»»ä½•æ—¶å€™éƒ½å¯ä»¥å¾—åˆ°è¿™ä¸ªç»“æœ\r\n\r\né‡ç‚¹æ˜¯ç¬¬äºŒç‚¹ï¼Œå®ƒä¸åŒäºå›è°ƒå‡½æ•°ï¼Œåªè¦ç»“æœå‡ºæ¥äº†ä»»ä½•æ—¶å€™éƒ½å¯ä»¥è°ƒç”¨ï¼Œæˆ‘ä»¬åœ¨ click ç›‘å¬ä¸€ä¸ªäº‹ä»¶å¦‚æœé”™è¿‡äº†è¿™ä¸ªç›‘å¬æƒ³è¦å›æº¯æ˜¯ä¸å¯èƒ½çš„ï¼Œä½†æ˜¯ promise ä½ é‡å¤æ— æ•°æ¬¡çš„`.then` è°ƒç”¨ï¼ŒåŸºäºè¿™ä¸ªç‰¹æ€§æˆ‘ä»¬æ¥ç¼–å†™ MemoizationAsync\r\n\r\n```js\r\nconst getImgSize = (src) => {\r\n  return new Promise((resolve, reject) => {\r\n    const img = new Image();\r\n    img.src = src;\r\n    img.addEventListener('load', () => {\r\n      return resolve({\r\n        width: img.naturalWidth,\r\n        height: img.naturalHeight,\r\n      });\r\n    });\r\n\r\n    img.addEventListener('error', (e) => {\r\n      return reject(e);\r\n    });\r\n  });\r\n};\r\n\r\nconst url = 'https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png';\r\n\r\nconst memoizationAsync = (fn, getKey = (...args) => args.join()) => {\r\n  const memo = {};\r\n  return async function (...args) {\r\n    const key = getKey.apply(this, args);\r\n    if (memo.hasOwnProperty(key)) {\r\n      return memo[key];\r\n    }\r\n    const result = fn.apply(this, args);\r\n    memo[key] = result;\r\n    return result;\r\n  };\r\n};\r\n\r\nconst getImgSizeMemoization = memoizationAsync(getImgSize);\r\n\r\n(async () => {\r\n  const result = await Promise.all([getImgSizeMemoization(url), getImgSizeMemoization(url)]);\r\n  console.log(result);\r\n})();\r\n```\r\n\r\nmemoizationAsync å‡½æ•°ç¼–å†™çš„ååˆ†ç²¾ç®€è·ŸåŒæ­¥ç‰ˆæœ¬åŸºæœ¬æ²¡åŒºåˆ«ï¼Œä¸åŒç‚¹åœ¨äºæˆ‘ä»¬åªæ˜¯è¿”å›äº† **Promise çš„çŠ¶æ€**ï¼Œè€Œå¾—ç›Šäº Promise çš„ç‰¹æ€§åœ¨ä»»ä½•æ—¶å€™è¿™ä¸ªå‡½æ•°éƒ½ä¼šè¿”å›æ­£ç¡®çš„ç»“æœ\r\n\r\n## æœ€å\r\n\r\nå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©å¯ä»¥`å…³æ³¨`ã€ `star` ä¸€ä¸‹ï¼Œæœ‰ä»€ä¹ˆé”™è¯¯æ¬¢è¿æŒ‡å‡º\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/76/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/76/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/22",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/22/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/22/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/22/events",
          "html_url": "https://github.com/bosens-China/blog/issues/22",
          "id": 485122259,
          "node_id": "MDU6SXNzdWU0ODUxMjIyNTk=",
          "number": 22,
          "title": "é€šç”¨è¿­ä»£å™¨å®ç°",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1602397157,
              "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
              "name": "æ·±å…¥ç³»åˆ—",
              "color": "719192",
              "default": false,
              "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2019-08-26T08:47:04Z",
          "updated_at": "2021-12-21T09:45:27Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "> è¿­ä»£å™¨åœ¨å¾ˆå¤šè¯­è¨€éƒ½å¾ˆå¸¸è§ï¼Œjs çš„ forEach å°±æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼Œä¸‹é¢å°±æ¥ä»‹ç»å®ç°ä¸€ä¸ªæ”¯æŒæ•°ç»„ã€å¯¹è±¡ã€ç±»æ•°ç»„çš„çš„ each å‡½æ•°ã€‚\r\n\r\n## å‰è¨€\r\n\r\nå†™ä¹‹å‰å…ˆæ•´ç†ä¸€ä¸‹æ€è·¯\r\n\r\n1. æˆ‘ä»¬é¦–å…ˆéœ€è¦åˆ¤æ–­æ˜¯ä¸æ˜¯ç±»æ•°ç»„ï¼Œå¦‚æœæ˜¯æ•°ç»„å’Œç±»æ•°ç»„å°±ä½¿ç”¨ for å¾ªç¯ï¼Œå¦‚æœæ˜¯å¯¹è±¡æˆ‘ä»¬å°±ç”¨ for...in å¾ªç¯ã€‚\r\n2. å›è°ƒå‡½æ•°çš„ this å¤„ç†ï¼Œè¿”å› false ç»ˆæ­¢å¾ªç¯\r\n\r\n## åˆ¤æ–­ç±»å‹\r\n\r\nåˆ¤æ–­åŸºæœ¬ç±»å‹æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `typeof`ï¼Œä¸è¿‡å¯¹äºå¼•ç”¨ç±»å‹ï¼Œæ¯”å¦‚æ•°ç»„å’Œå‡½æ•°éƒ½ä¼šè¿”å›`object`ï¼Œé‚£ä¹ˆè¿˜æœ‰æ›´å¥½çš„åˆ¤æ–­æ–¹æ³•ä¹ˆï¼Ÿ\r\né‚£å°±æ˜¯`Object.prototype.toString`\r\n\r\n```js\r\nObject.prototype.toString.call({}); // \"[object Object]\"\r\nObject.prototype.toString.call([]); // \"[object Array]\"\r\n```\r\n\r\nè¿™é‡Œä½¿ç”¨`Object.prototype.toString`çš„åŸå› æ˜¯ä¸€äº›å¼•ç”¨ç±»å‹çš„`toString`æœ‰è‡ªå·±çš„å®ç°æ–¹å¼ï¼Œæ¯”å¦‚æ•°ç»„çš„ `toString` è¿”å›çš„å°±æ˜¯ä»¥`\",\"`åˆ†éš”çš„æ–‡æœ¬ã€‚\r\næ•°ç»„çš„åˆ¤æ–­å¯ä»¥åŸºäºä¸Šé¢æ–¹æ³•ï¼Œä¸‹é¢å°±æ˜¯å°è£…æˆä¸€ä¸ªå‡½æ•°\r\n\r\n```js\r\nfunction isArray(arr) {\r\n  return Object.prototype.toString.call(arr) === \"[object Array]\";\r\n}\r\n```\r\n\r\nä¸‹é¢å°±æ¥å®ç°åˆ¤æ–­ç±»æ•°ç»„çš„çš„æ€è·¯ï¼Œç±»æ•°ç»„å°±æ˜¯æŒ‡ç±»ä¼¼äº\r\n\r\n```js\r\n{1: 123, 2ï¼š45, 6: 789, length: 7}\r\n// or\r\n// nodelist[]\r\n// arguments\r\n// ...\r\n```\r\n\r\nä¸Šé¢åˆ—ä¸¾çš„å‡ ç§å¯¹è±¡ï¼Œéƒ½å­˜åœ¨`length`ï¼Œè€Œä¸”éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»¥è¿™ä¸ªä¸ºåˆ¤æ–­å‡†åˆ™ï¼Œä¸‹é¢å°±æ˜¯å®ç°\r\n\r\n```js\r\nfunction isClassArray(arr) {\r\n  var length = !!arr && length in arr && arr.length;\r\n  return (\r\n    isArray(arr) ||\r\n    length === 0 ||\r\n    (typeof arr === \"number\" && length - 1 in arr)\r\n  );\r\n}\r\n```\r\n\r\nåˆ¤æ–­è¿˜æ˜¯æ¯”è¾ƒç®€æ´çš„ï¼Œåˆ¤æ–­äº†ä¸‰ç§æƒ…å†µ\r\n\r\n1. å¿…é¡»æœ‰ `length` å±æ€§\r\n2. `length` ä¸º 0 çš„æƒ…å†µ\r\n3. `length- 1`å¿…é¡»å­˜åœ¨\r\n\r\nç¬¬ä¸€ç§å°±ä¸è¯´äº†ï¼Œç¬¬äºŒç§ä¸ºä»€ä¹ˆè¦åˆ¤æ–­ length ä¸º `0` çš„æƒ…å†µå‘¢ï¼Ÿ\r\nå‡è®¾æœ‰ä¸€ä¸ªå¯¹è±¡`{a: 1, b: 2, length: 0}`ï¼Œè®¤ä¸ºå®ƒæ˜¯ç±»æ•°ç»„æ˜¯ä¸æ˜¯ä¸å¤ªåˆé€‚ï¼Œè¿˜æœ‰`arguments`æ˜¯ä¸æ˜¯ç±»æ•°ç»„å¯¹è±¡æ ¹æ®å‡½æ•°çš„ä¼ é€’å‚æ•°æ¥å˜åŒ–ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰å‚æ•°`length`ä¸º 0 å°±è¿”å› falseï¼Œæ˜¯ä¸æ˜¯ä¹Ÿä¸å¤ªåˆé€‚ï¼Œå…¶å®è¿™é‡Œä¸»è¦å°±æ˜¯ä¸ºäº†åˆ¤æ–­ä¸€äº›è¾¹ç•Œçš„å¯¹è±¡\r\n\r\n```js\r\nfunction foo() {\r\n  arguments.length; // 0\r\n}\r\nfoo();\r\n```\r\n\r\nç¬¬ä¸‰ç‚¹ï¼Œä¸ºä»€ä¹ˆè¦æ±‚ `length - 1` å­˜åœ¨ï¼Ÿ\r\næ•°ç»„çš„ length æ°¸è¿œæ˜¯æˆå‘˜æ•°+1ï¼Œè¦æ±‚`length - 1` å­˜åœ¨å®é™…ä¸Šè¿™æ˜¯ä¸ºäº†æ•°ç»„å’Œç±»æ•°ç»„çš„å½¢å¼æƒ³å¯¹åº”ï¼Œä¾‹å¦‚ï¼š\r\n\r\n```js\r\nvar a = [, , 2]; // length: 3\r\n// å¯¹åº”ç±»æ•°ç»„\r\nvar obj = {\r\n  2: 2,\r\n  length: 3\r\n};\r\n```\r\n\r\nä¸Šé¢æ•°ç»„å­˜åœ¨`,`æˆ‘ä»¬è®¤ä¸ºå‰é¢ä¸¤ä½å°±æ˜¯ç©ºï¼Œä½†æ˜¯å¦‚æœå–æ¶ˆäº†`length - 1`å¿…é¡»å­˜åœ¨ï¼Œé‚£ä¹ˆä¸‹é¢è¿™ç§å†™æ³•ä¼šå‡ºç°ä¸‹é¢æƒ…å†µ\r\n\r\n```js\r\n// length: 2\r\nvar a = [1, ,];\r\nvar obj = {\r\n  0: 1ï¼Œ\r\n  length: 1\r\n};\r\n```\r\n\r\n## each\r\n\r\nä¸Šé¢æŠŠæ‰€éœ€è¦ç”¨çš„è®²è§£å®Œæ¯•äº†ï¼Œä¸‹é¢å°±æ¥å®ç°ä¸€ä¸ªæœ€ç»ˆç‰ˆçš„ each\r\n\r\n```js\r\nfunction isArray(arr) {\r\n  return Object.prototype.toString.call(arr) === \"[object Array]\";\r\n}\r\nfunction isClassArray(arr) {\r\n  var length = !!arr && length in arr && arr.length;\r\n  return (\r\n    isArray(arr) ||\r\n    length === 0 ||\r\n    (typeof arr === \"number\" && length - 1 in arr)\r\n  );\r\n}\r\nfunction each(obj, callback) {\r\n  if (typeof obj !== \"object\") {\r\n    return obj;\r\n  }\r\n  // æ•°ç»„å’Œç±»æ•°ç»„\r\n  if (isClassArray(obj)) {\r\n    for (let i = 0; i < obj.length; i++) {\r\n      let v = callback.call(obj, i, obj[i]);\r\n      if (v === false) {\r\n        break;\r\n      }\r\n    }\r\n  } else {\r\n    for (let item in obj) {\r\n      let v = callback.call(obj, item, obj[item]);\r\n      if (v === false) {\r\n        break;\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n## å‚è€ƒ\r\n\r\n[JavaScript ä¸“é¢˜ä¹‹ç±»å‹åˆ¤æ–­(ä¸‹) #30](https://github.com/mqyqingfeng/Blog/issues/30)\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/22/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/22/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/13",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/13/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/13/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/13/events",
          "html_url": "https://github.com/bosens-China/blog/issues/13",
          "id": 479666633,
          "node_id": "MDU6SXNzdWU0Nzk2NjY2MzM=",
          "number": 13,
          "title": "ç›¸ç­‰è¿ç®—ç¬¦æ¯”è¾ƒ",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1602397157,
              "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
              "name": "æ·±å…¥ç³»åˆ—",
              "color": "719192",
              "default": false,
              "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2019-08-12T14:08:20Z",
          "updated_at": "2021-12-21T09:40:08Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "> çœ‹ã€Šä½ æ‰€ä¸çŸ¥é“çš„JavaScriptã€‹ä¸€ä¹¦ï¼Œå‘ç°å¯¹ç›¸ç­‰è¿ç®—ç¬¦çš„æè¿°æ¨ç¿»äº†è®¸å¤šäººçš„å›ºæœ‰å½±å“ï¼Œå¦‚æœç†Ÿæ‚‰å…¶æœºåˆ¶ï¼Œå¯ä»¥æ–¹ä¾¿æˆ‘ä»¬å¿«é€Ÿå¼€å‘\r\n``` js\r\nfunction foo(s) {\r\n  s = s == null ?  true: s;\r\n  // ...\r\n};\r\n```\r\nä¸Šé¢è¿™æ®µä»£ç æˆ‘ä»¬ä¼°è®¡ç»å¸¸ä½¿ç”¨ï¼Œå…¶å®å°±æ˜¯ä½¿ç”¨äº†éšå¼è½¬æ¢ï¼Œä¸‹é¢å°±æ¥èŠèŠç›¸ç­‰è¿ç®—ç¬¦\r\n\r\n## è§„åˆ™\r\n1. æ•°å€¼ä¸å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œè½¬åŒ–ä¸ºæ•°å€¼æ¯”è¾ƒ\r\n``` js\r\n42 == \"42\";\r\n// ç­‰äº\r\n42 == Number(\"42\");\r\n```\r\n2. å¸ƒå°”å‹ä¸å…¶ä»–ç±»å‹æ¯”è¾ƒï¼Œè½¬åŒ–ä¸ºæ•°å€¼ï¼Œä¹‹åæ¯”è¾ƒ\r\n``` js\r\n\"42\" == true;\r\n// ç­‰äº\r\n\"42\" == Number(true);\r\n\"42\" == 1;\r\nNumber(\"42\") == 1;\r\n```\r\n3. undefined åªä¸ null ç›¸ç­‰ï¼Œå…¶ä»–è¿”å› false\r\n``` js\r\n// å…¨éƒ¨false\r\nnull == false;\r\nnull == true;\r\nnull == \"\";\r\nnull == 0;\r\nundefined == true;\r\nundefined == false;\r\nundefined == \"\";\r\nundefined == 0;\r\n```\r\n4. å¯¹è±¡\r\nå¯¹è±¡ä¸åŸºæœ¬ç±»å‹æ¯”è¾ƒï¼Œä¼šå°†å¯¹è±¡è½¬åŒ–ä¸ºåŸºæœ¬ç±»å‹ä¹‹åå†è¿›è¡Œæ¯”è¾ƒï¼›\r\nè½¬åŒ–è§„åˆ™å¾ˆç®€å•ï¼Œé»˜è®¤è°ƒç”¨ `valueOf`ï¼Œå¦‚æœè¿”å›ä¸æ˜¯åŸºæœ¬ç±»å‹ç»§ç»­è°ƒç”¨ `toStirng`ï¼Œå¦‚æœè¿”å›è¿˜ä¸æ˜¯åŸºæœ¬ç±»å‹ä¼šæŠ¥é”™ã€‚\r\n``` js\r\n[42] == 42;\r\n// ç­‰äº\r\n\"42\" == 42;\r\nNumber(\"42\") == 42;\r\n\r\n\"abc\" == new String(\"abc\");\r\n// ç­‰äº\r\n\"abc\" == \"abc\";\r\n```\r\næ ¹æ®å¯¹è±¡è½¬åŒ–è§„åˆ™ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰è¿”å›çš„å€¼ï¼Œæ¯”å¦‚ï¼š\r\n``` js\r\nvar a = [];\r\na.valueOf = function() {\r\n  return 42;\r\n};\r\na.toString = function() {\r\n  return \"123\";\r\n};\r\na == 42; //true\r\n```\r\n\r\n## å®æˆ˜\r\nä¸Šé¢ç®€å•ä»‹ç»äº†ä¸€ä¸‹è§„åˆ™ï¼Œå†æ¥çœ‹ä¸€ä¸‹éšå½¢çš„é—®é¢˜\r\n1. [] = ![]\r\nè¿™é‡Œä¼šè¿”å› true åŸå› å¾ˆç®€å•ï¼Œæ ¹æ®ä¸Šè¿°è§„åˆ™å…¶å®ä¹Ÿå°±æ˜¯\"\" == 0æ¯”è¾ƒ\r\n2. 0 == '\\n' \r\nè¿™é‡Œä¼šè¿”å› trueï¼Œå› ä¸ºç©ºæ ¼å’Œä¸€äº›å…¶ä»–åˆ¶è¡¨ç¬¦ä¼šè¢«å¿½ç•¥æ‰ã€‚ å†æ¥çœ‹ä¸€äº›å¸¸è§çš„é™·é˜±\r\n``` js\r\n\"0\" == false; // true\r\nfalse == 0; // true\r\nfalse == \"\"; // true\r\nfalse == []; // true\r\n\"\" == []; // true\r\n0 == []; // true\r\n\"\" == 0; // true\r\n```\r\n3. [null] == \"\"\r\nè¿™é‡Œä¸ºtrueï¼Œå¯èƒ½ä½ åœ¨æƒ³[null]è¿”å›çš„ä¸å°±æ˜¯å­—ç¬¦ä¸² null ä¹ˆï¼Œä¸è¿‡å¾ˆé—æ†¾ï¼Œ**null å’Œ undefinedï¼Œåœ¨æ•°ç»„ä¸­è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ä¸º\"\"**ï¼Œè¿™æ˜¯ JavaScript æ‰€è§„å®šçš„ã€‚\r\n``` js\r\n[null] == \"\";\r\n// è½¬åŒ–ä¸º\r\n\"\" == \"\";\r\n```\r\n\r\n## æœ€å\r\n``` js\r\n// aå¯èƒ½ä¸ºtrueæ‰§è¡Œä¸‹å»ä¹ˆ\r\nif (a == 2 && a == 3) {\r\n  // æ‰§è¡Œé‡Œé¢çš„ä»£ç \r\n}\r\n```",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/13/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/13/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/3",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/3/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/3/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/3/events",
          "html_url": "https://github.com/bosens-China/blog/issues/3",
          "id": 475021768,
          "node_id": "MDU6SXNzdWU0NzUwMjE3Njg=",
          "number": 3,
          "title": "å‡½æ•°é˜²æŠ–",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1602397157,
              "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
              "name": "æ·±å…¥ç³»åˆ—",
              "color": "719192",
              "default": false,
              "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2019-07-31T09:01:16Z",
          "updated_at": "2021-12-21T09:39:39Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "## å‰è¨€\r\n\r\n1. ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨é˜²æŠ–å‡½æ•°\r\n   å½“ä¸€ä¸ªäº‹ä»¶è§¦å‘å¤ªå¤šçš„æ—¶å€™ä¼šå‡ºç°æ€§èƒ½é—®é¢˜ï¼Œæ¯”å¦‚`mousemove`ã€`resize`ã€`scroll`ç­‰ï¼Œçœ‹ä¸€ä¸ªæ²¡æœ‰ä»»ä½•é˜²æŠ–çš„`mousemove`äº‹ä»¶\r\n\r\n![1](https://user-images.githubusercontent.com/39508895/62198507-526ef780-b3b4-11e9-8019-21e510329930.gif)\r\n\r\n2. ä»€ä¹ˆæ˜¯é˜²æŠ–?\r\n   ç®€å•å°±æ˜¯ä½ ä»»æ„è§¦å‘æˆ‘åªæ‰§è¡Œæœ€åä¸€æ¬¡æ“ä½œ\r\n\r\næ ¹æ®ä¸Šé¢çš„å®šä¹‰å¯ä»¥å¾ˆè½»æ¾ç¼–å†™å‡ºä¸€ä¸ªç®€å•çš„é˜²æŠ–å‡½æ•°\r\n\r\n### å®ç°\r\n\r\n```js\r\n// ç¬¬ä¸€ç‰ˆ\r\nfunction antiShake(call, time) {\r\n  var i = null;\r\n  return function() {\r\n    clearTimeout(i);\r\n    i = setTimeout(call, time);\r\n  };\r\n}\r\n```\r\n\r\n![2](https://user-images.githubusercontent.com/39508895/62198572-77fc0100-b3b4-11e9-8ad5-a46ac6a5a2e1.gif)\r\n\r\n### this ä»¥åŠå‚æ•°\r\n\r\nä¸è¿‡è¿™æ ·æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ this æŒ‡å‘ä¸æ­£ç¡®ä»¥åŠå‚æ•°ä¸¢å¤±ï¼Œè¿™é‡Œä»¥`mousemove`ä¸ºä¾‹ï¼Œè§¦å‘å‡½æ•°çš„æ—¶å€™ä¼šæœ‰ä¸€ä¸ª`MouseEvent`å¯¹è±¡ï¼Œå¦‚æœæ‰“å°å‡½æ•°å‚æ•°ä¼šå‘ç°ä¸º`undefined`ï¼Œä¸‹é¢å°±æ¥ä¿®å¤ä¸€ä¸‹\r\n\r\n```js\r\n//  ç¬¬äºŒç‰ˆ\r\nfunction antiShake(call, time) {\r\n  var i = null;\r\n  return function() {\r\n    var that = this;\r\n    var rest = arguments;\r\n    clearTimeout(i);\r\n    i = setTimeout(function() {\r\n      call.apply(that, rest);\r\n    }, time);\r\n  };\r\n}\r\n```\r\n\r\n### ç«‹å³æ‰§è¡Œ\r\n\r\næœ‰æ—¶å€™æˆ‘ä¸æƒ³è®©ä»–ç­‰å¾…æ—¶é—´ç»“æŸåœ¨æ‰§è¡Œï¼Œè€Œæ˜¯ä¸€å¼€å§‹å°±è§¦å‘\r\n![4](https://user-images.githubusercontent.com/39508895/62198651-99f58380-b3b4-11e9-9fbc-78e805b13910.gif)\r\n\r\n```js\r\n// ç¬¬ä¸‰ç‰ˆ\r\nfunction antiShake(call, time, immediately) {\r\n  var i = null;\r\n  return function() {\r\n    var that = this;\r\n    var rest = arguments;\r\n    clearTimeout(i);\r\n    if (immediately) {\r\n      var reversal = !i;\r\n      i = setTimeout(function() {\r\n        i = null;\r\n      }, time);\r\n\r\n      if (reversal) {\r\n        call.apply(that, rest);\r\n      }\r\n    } else {\r\n      i = setTimeout(function() {\r\n        call.apply(that, rest);\r\n      }, time);\r\n    }\r\n  };\r\n}\r\n```\r\n\r\n### è¿”å›å€¼\r\n\r\nå¼‚æ­¥æ‰§è¡Œçš„å‡½æ•°æˆ‘ä»¬æ²¡åŠæ³•åŒæ­¥è¿”å›ä»–çš„å€¼ï¼Œä½†æ˜¯å¯¹äºç«‹å³æ‰§è¡Œçš„å‡½æ•°ï¼Œæˆ‘ä»¬åº”å½“æŠŠå€¼è¿”å›\r\n\r\n```js\r\n// ç¬¬å››ç‰ˆ\r\nfunction antiShake(call, time, immediately) {\r\n  var i = null;\r\n  return function() {\r\n    var that = this;\r\n    var rest = arguments;\r\n    clearTimeout(i);\r\n    if (immediately) {\r\n      var reversal = !i;\r\n      i = setTimeout(function() {\r\n        i = null;\r\n      }, time);\r\n\r\n      if (reversal) {\r\n        return call.apply(that, rest);\r\n      }\r\n    } else {\r\n      i = setTimeout(function() {\r\n        call.apply(that, rest);\r\n      }, time);\r\n    }\r\n  };\r\n}\r\n```\r\n\r\n### å–æ¶ˆ\r\n\r\nåˆ°è¿™é‡ŒåŸºæœ¬ä¸Šé˜²æŠ–å‡½æ•°å°±åŸºæœ¬å†™å®Œäº†ï¼Œä¸Šè¿°æˆ‘ä»¬ç”¨`mousemove`äº‹ä»¶ä¸¾ä¾‹ï¼Œä½†æ˜¯æˆ‘æƒ³å½“é¼ æ ‡ç§»å¼€çš„æ—¶å€™æˆ‘æƒ³å–æ¶ˆè¿™ä¸ªäº‹ä»¶ï¼Œè¿™ä¹Ÿæ˜¯æ­£å¸¸çš„éœ€æ±‚ï¼Œä¸‹é¢å°±æ¥å®ç°å–æ¶ˆåŠŸèƒ½\r\n\r\n```js\r\nfunction antiShake(call, time, immediately) {\r\n  var i = null;\r\n  function _private() {\r\n    var that = this;\r\n    var rest = arguments;\r\n    clearTimeout(i);\r\n    if (immediately) {\r\n      var reversal = !i;\r\n      i = setTimeout(function() {\r\n        i = null;\r\n      }, time);\r\n\r\n      if (reversal) {\r\n        return call.apply(that, rest);\r\n      }\r\n    } else {\r\n      i = setTimeout(function() {\r\n        call.apply(that, rest);\r\n      }, time);\r\n    }\r\n  }\r\n  _private.cancel = function() {\r\n    clearTimeout(i);\r\n    i = null;\r\n  };\r\n  return _private;\r\n}\r\n```\r\n\r\n![5](https://user-images.githubusercontent.com/39508895/62198673-a5e14580-b3b4-11e9-9ced-acc7814031dc.gif)\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/3/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/3/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/5",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/5/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/5/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/5/events",
          "html_url": "https://github.com/bosens-China/blog/issues/5",
          "id": 479484473,
          "node_id": "MDU6SXNzdWU0Nzk0ODQ0NzM=",
          "number": 5,
          "title": "å‡½æ•°èŠ‚æµ",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1602397157,
              "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
              "name": "æ·±å…¥ç³»åˆ—",
              "color": "719192",
              "default": false,
              "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2019-08-12T06:23:18Z",
          "updated_at": "2021-12-21T09:39:31Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "æœ¬æ¥æ‰“ç®—ä»é›¶å†™ä¸€ä¸ªï¼Œä¸è¿‡æ„å¤–çœ‹åˆ°ä¸€ç¯‡å¥½æ–‡ï¼Œä¸‹é¢å°±æ ¹æ®ä»–çš„æ€è·¯æ¥å®ç°ä¸€ä¸ªèŠ‚æµï¼Œ[JavaScriptä¸“é¢˜ä¹‹è·Ÿç€ underscore å­¦èŠ‚æµ ](https://github.com/mqyqingfeng/Blog/issues/26)\r\n\r\n## å‰è¨€\r\nèŠ‚æµæœ‰ä¸¤ç§å®ç°ï¼Œç¬¬ä¸€ç§ä½¿ç”¨å®šæ—¶å™¨ï¼Œå¦å¤–ä¸€ç§åˆ™æ˜¯æ ¹æ®æ—¶é—´æˆ³ï¼Œåˆ¤æ–­ä¸¤æ¬¡æ‰§è¡Œçš„æ—¶é—´é—´éš”ï¼Œä¸‹é¢ç®€å•äº›ä¸€ä¸‹è¿™ä¸¤ç§çš„å®ç°ã€‚\r\n- å®šæ—¶å™¨\r\n``` js\r\nfunction throttle(fn, time) {\r\n  let timing = null;\r\n  return function(...rest) {\r\n    if(!timing) {\r\n      timing = setTimeout(() => {\r\n        timing = null;\r\n        fn.apply(this, rest);\r\n      }, time);\r\n    }\r\n  };\r\n};\r\n```\r\n- æ—¶é—´æˆ³\r\n``` js\r\nfunction throttle (fn, time) {\r\n  let times = 0;\r\n  return function (...rest) {\r\n    const s = time - (new Date().getTime() - times)\r\n    if (s <= 0) {\r\n      times = new Date().getTime();\r\n      fn.apply(this, rest);\r\n    }\r\n  };\r\n};\r\n```\r\nä¸‹é¢å°±æ˜¯å°†ä¸¤è€…ç»“åˆèµ·æ¥\r\n\r\n## èŠ‚æµ\r\n``` js\r\n// èŠ‚æµ\r\n// initialåˆå§‹ç«‹å³æ‰§è¡Œï¼Œfrontæœ€åæ‰§è¡Œä¸€æ¬¡\r\nfunction throttle (fn, time, { initial = true, front = false } = {}) {\r\n  // ä¸Šä¸€æ¬¡æ‰§è¡Œæ—¶é—´\r\n  let times = 0;\r\n  // å®šæ—¶å™¨\r\n  let timing = null;\r\n  function next (...args) {\r\n    // åˆ¤æ–­æ¡ä»¶ï¼Œå¦‚æœä¸æ˜¯åˆå§‹æ‰§è¡Œï¼Œæ”¹ç”¨å®šæ—¶å™¨æ–¹æ³•æ‰§è¡Œ\r\n    if (!initial && !times) {\r\n      times = new Date().getTime();\r\n    }\r\n    const now = time - (new Date().getTime() - times);\r\n    // now > timeæ˜¯åˆ¤æ–­æ›´æ”¹ç³»ç»Ÿæ—¶é—´çš„è¾¹ç•Œé—®é¢˜ï¼Œnowæ­£å¸¸æƒ…å†µä¸‹ï¼Œè‚¯å®šå°äºtime\r\n    if (now <= 0 || now > time) {\r\n      if (!timing) {\r\n        clearTimeout(timing);\r\n        timing = null;\r\n      }\r\n      times = new Date().getTime();\r\n      fn.apply(this, args);\r\n      // æ¸…ç†ä¸€ä¸‹å†…å­˜\r\n      if (!timing) {\r\n        args = null;\r\n      }\r\n    } else if (!timing && front) {\r\n      timing = setTimeout(() => {\r\n        timing = null;\r\n        times = initial ? 0 : new Date().getTime();\r\n        fn.apply(this, args);\r\n        if (!timing) {\r\n          args = null;\r\n        }\r\n      }, time);\r\n    }\r\n  }\r\n  // å–æ¶ˆ\r\n  next.cancel = function () {\r\n    clearTimeout(timing);\r\n    timing = null;\r\n    // ä¸º0å³å¯ï¼Œä¸Šé¢æœ‰åˆå§‹åˆ¤æ–­æ¡ä»¶\r\n    times = 0;\r\n  };\r\n  return next;\r\n};\r\n```\r\n## æ³¨æ„\r\nä¸Šé¢æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä½†æ˜¯ä¸èƒ½åŒæ—¶è®¾ç½®ä¸ºfalse",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/5/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/5/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/14",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/14/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/14/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/14/events",
          "html_url": "https://github.com/bosens-China/blog/issues/14",
          "id": 479671441,
          "node_id": "MDU6SXNzdWU0Nzk2NzE0NDE=",
          "number": 14,
          "title": "ç†è§£åŸå‹å’ŒåŸå‹é“¾",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1602397157,
              "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
              "name": "æ·±å…¥ç³»åˆ—",
              "color": "719192",
              "default": false,
              "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2019-08-12T14:17:35Z",
          "updated_at": "2021-12-21T03:38:33Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "> å‚è€ƒï¼š [æ·±å…¥ç†è§£javascriptåŸå‹å’Œé—­åŒ…ï¼ˆå®Œç»“ï¼‰](https://www.cnblogs.com/wangfupeng1988/p/3977924.html)\r\n\r\nJavaScriptæ˜¯å¼±ç±»å‹ï¼Œé™¤äº†åŸºæœ¬ç±»å‹éƒ½å¯ä»¥ç†è§£ä¸ºå¯¹è±¡ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¯´JavaScriptä¸­ä¸€åˆ‡çš†å¯¹è±¡çš„åŸå› ã€‚\r\n\r\nä¸è¿‡åœ¨å¯¹è±¡ä¸­å‡½æ•°æ¯”è¾ƒç‰¹æ®Šï¼Œå¯¹è±¡å°±æ˜¯ç”±å‡½æ•°åˆ›é€ å‡ºæ¥çš„ï¼Œè¿™å¬èµ·æ¥æ˜¯ä¸æ˜¯æœ‰ç‚¹å…ˆæœ‰é¸¡åæœ‰è›‹ï¼Œå…ˆæœ‰è›‹åæœ‰é¸¡çš„æ„Ÿè§‰ï¼Œè¿™ä¹Ÿè·Ÿåé¢è¦è¯´åˆ°çš„åŸå‹æœ‰å…³ã€‚\r\n\r\nå…ˆè¯´`prototype`å±æ€§ï¼Œè¿™ä¸ªå±æ€§æ˜¯`å‡½æ•°`æ‰€ç‹¬æœ‰çš„ï¼Œå‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ä¹Ÿå¯ä»¥åœ¨è‡ªèº«å®šä¹‰å±æ€§å’Œæ–¹æ³•ï¼Œé‚£è¿™ä¸ª`prototype`å±æ€§æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ\r\n``` js\r\nvar a = {};\r\na.toString();\r\n```\r\nè¿™é‡Œæˆ‘å¹¶æ²¡æœ‰ä¸ºaå®šä¹‰toStringçš„æ–¹æ³•ï¼Œä¸ºä»€ä¹ˆå¯ä»¥è°ƒç”¨å‘¢ï¼Ÿå°±è·Ÿprototypeå±æ€§æœ‰å…³ã€‚\r\n\r\nä¸Šé¢åªæ˜¯ç®€å†™ï¼Œå¦‚æœé€šè¿‡æ„é€ å‡½æ•°æ˜¯è¿™æ ·çš„\r\n``` js\r\nvar a = new Object();\r\na.toString();\r\n```\r\n![https://pic1.zhimg.com/80/v2-038c5818398efc6b4e990b3c2fb3b54c_hd.jpg](https://pic1.zhimg.com/80/v2-038c5818398efc6b4e990b3c2fb3b54c_hd.jpg)\r\nè¿™é‡Œå¯ä»¥çœ‹åˆ°toStringçš„æ–¹æ³•ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæ²¡æœ‰å®šä¹‰å´æ²¡æœ‰æŠ¥é”™çš„åŸå› ã€‚\r\n\r\nä¸€ä¸ªå¯¹è±¡é€šè¿‡æ„é€ å‡½æ•°ç”Ÿæˆä¼šæ‰§è¡Œä¸‹é¢å››ä¸ªæ­¥éª¤\r\n1. åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œä½œä¸ºè¦è¿”å›çš„å®ä¾‹\r\n2. å°†æ–°å¯¹è±¡çš„åŸå‹ï¼ˆ__proto__ï¼‰æŒ‡å‘æ„é€ å‡½æ•°çš„`prototype`å±æ€§\r\n3. å°†å†…éƒ¨çš„thisæŒ‡å‘æ–°å¯¹è±¡\r\n4. æ‰§è¡Œå†…éƒ¨ä»£ç ï¼Œå¦‚æœæ²¡æœ‰æ‰§è¡Œè¿”å›å¯¹è±¡ï¼Œåˆ™è¿”å›`this`ï¼ˆæ–°å¯¹è±¡ï¼‰\r\n\r\nä»ä¸Šé¢å¯ä»¥çœ‹åˆ°ï¼Œå¯¹è±¡çš„åŸå‹ä¼šæŒ‡å‘ç”Ÿæˆå¯¹è±¡å‡½æ•°çš„`prototype`å±æ€§ï¼Œå¯¹è±¡æœ¬èº«å¦‚æœæ²¡æœ‰å±æ€§æˆ–è€…æ–¹æ³•ï¼Œä¼šå‘åŸå‹é“¾æŸ¥æ‰¾ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ä¼šä¸€ç›´æ‰¾åˆ°`Object.prototype`å±æ€§ä¸Šï¼Œå¦‚æœè¿˜æ²¡æœ‰æ‰¾åˆ°å°±ä¼šè¿”å›`undefined`ã€‚\r\n`Object.prototype`å±æ€§ä¸Šè¿˜æœ‰åŸå‹é“¾ä¹ˆï¼Ÿç­”æ¡ˆæ˜¯æœ‰ï¼Œæ˜¯`Null`ã€‚\r\n\r\nä¸Šé¢ç®€çŸ­çš„è¯´äº†ä¸€ä¸‹ï¼Œä¸‹é¢é€šè¿‡ä¾‹å­çš„å½¢å¼æ¥ç»“åˆ\r\n\r\n## ç¤ºä¾‹\r\n``` js\r\nvar a = {};\r\n```\r\nè¿™é‡Œæˆ‘å®šä¹‰äº†ä¸€ä¸ªå¯¹è±¡aï¼Œæ ¹æ®ä¸Šé¢è¯´çš„æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªåŸå‹ï¼Œæ‰§è¡Œæ„é€ å‡½æ•°çš„`prototype`ä¸‹é¢å°±æ˜¯åŸå‹å›¾ã€‚\r\n![https://pic4.zhimg.com/80/v2-c93843e5905a3990c0b1147d0dad7f03_hd.jpg](https://pic4.zhimg.com/80/v2-c93843e5905a3990c0b1147d0dad7f03_hd.jpg)\r\nä¸Šé¢å°±æ˜¯ä¸€ä¸ªç®€å•çš„åŸå‹å›¾ï¼Œä¸‹é¢è¯´ä¸€ä¸‹`constructor`å±æ€§ï¼Œè¿™ä¸ªå±æ€§æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿ\r\n`constructor`æ˜¯`prototype`å¯¹è±¡ä¸‹çš„ä¸€ä¸ªå±æ€§ï¼Œä»–æŒ‡å‘ä¸€ä¸ªå‡½æ•°ï¼Œä¸å‡½æ•°çš„ç›¸äº’ä¾å­˜ï¼Œè¿˜æ˜¯é€šè¿‡ä¸Šé¢å˜é‡aæ¥è¯´æ˜å§ã€‚\r\n![https://pic1.zhimg.com/80/v2-94e4180728a52844d1204a830249c10c_hd.jpg](https://pic1.zhimg.com/80/v2-94e4180728a52844d1204a830249c10c_hd.jpg)\r\n\r\nå¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡`constructor`å¯ä»¥è®¿é—®åˆ°æ„é€ å‡½æ•°ï¼Œè¿™ä¸ªå±æ€§é€šå¸¸æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œä¸è¿‡å¯ä»¥é€šç”¨è¿™ä¸ªå±æ€§è°ƒç”¨ä¸€äº›æ„é€ å‡½æ•°æ‰€ç‹¬æœ‰çš„æ–¹æ³•ï¼Œæ¯”å¦‚`Date`å‡½æ•°çš„`now`æ–¹æ³•\r\n``` js\r\nvar a = new Date();\r\na.__proto__.constructor.now();\r\n```\r\nè¿™é‡Œä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºä½¿ç”¨äº†`_proto_`ï¼Œä¸è¿‡åœ¨å®é™…ä¸­ä¸è¦è¿™æ ·å†™ï¼Œå› ä¸ºè¿™ä¸ªå±æ€§åªæœ‰æµè§ˆå™¨æ‰éƒ¨ç½²ã€‚\r\n![https://pic3.zhimg.com/80/v2-3ee04ff512a68800c014b66de0f6b3f2_hd.jpg](https://pic3.zhimg.com/80/v2-3ee04ff512a68800c014b66de0f6b3f2_hd.jpg)\r\nè¯´äº†è¿™ä¹ˆå¤šï¼Œæœ€åæ ¹æ®ä¸€å¼ å›¾ï¼Œæ¥æ€»ç»“ä¸€ä¸‹ã€‚\r\n\r\né¦–å…ˆå¯¹è±¡æ˜¯ç”±æ„é€ å‡½æ•°åˆ›å»ºçš„ï¼ˆObjectï¼‰ï¼Œä½ å¯èƒ½æœ‰ç–‘é—®ï¼Œå‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ï¼Œé‚£ä¹ˆå‡½æ•°çš„`__proto__`æŒ‡å‘ä»€ä¹ˆï¼Ÿ\r\nç­”æ¡ˆæ˜¯`Function.prototype`ï¼Œæ‰€æœ‰å‡½æ•°éƒ½æ˜¯ç”±`Fcuntion`åˆ›å»ºçš„ï¼Œä¸¾ä¸ªä¾‹å­\r\n``` js\r\nvar a = new Function('a', 'b', 'return a + b');\r\na(1, 2);\r\n```\r\nè¿™é‡Œaçš„`__proto__`ç­‰äº`Function.prototype`ï¼Œä¹‹å‰è¯´è¿‡prototypeæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥`Function.prototype`æŒ‡å‘`Object.prototype`ã€‚\r\næœ€åè¯´ä¸€ç‚¹ï¼Œ`Function.__proto__`æŒ‡å‘çš„æ˜¯`Function`è‡ªèº«ï¼Œä»–æ˜¯å”¯ä¸€ä¸€ä¸ªé€šè¿‡è‡ªèº«ç”Ÿæˆå‡½æ•°çš„ä¾‹å­ï¼Œè¿™é‡Œåªéœ€è¦äº†è§£ä¸€ä¸‹ã€‚\r\n\r\n## æœ€å\r\nè¯´äº†è¿™ä¹ˆå¤šï¼ŒåŸå‹é“¾å¥½åƒè¿˜æ²¡æœ‰è¢«æèµ·ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰è‡ªå·±çš„åŸå‹ï¼ŒåŸå‹çš„å¯¹è±¡ä¹Ÿæ˜¯å¯¹è±¡ï¼Œä¸€æ–¹é¢å¯¹è±¡å¯ä»¥ä½œä¸ºå¦ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ï¼Œè¿™æ ·å±‚å±‚é“¾æ¥èµ·æ¥çš„åŸå‹å°±æˆä¸ºåŸå‹é“¾ã€‚\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/14/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/14/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/30",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/30/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/30/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/30/events",
          "html_url": "https://github.com/bosens-China/blog/issues/30",
          "id": 503803775,
          "node_id": "MDU6SXNzdWU1MDM4MDM3NzU=",
          "number": 30,
          "title": "æ¨¡æ‹Ÿå®ç°callå’Œapply",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1602397157,
              "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
              "name": "æ·±å…¥ç³»åˆ—",
              "color": "719192",
              "default": false,
              "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2019-10-08T03:31:31Z",
          "updated_at": "2021-12-21T03:07:06Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "> call() æ–¹æ³•ä½¿ç”¨ä¸€ä¸ªæŒ‡å®šçš„ this å€¼å’Œå•ç‹¬ç»™å‡ºçš„ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°æ¥è°ƒç”¨ä¸€ä¸ªå‡½æ•°\r\n\r\nä¸Šé¢æ˜¯ call çš„å®šä¹‰ï¼Œapply ä¸ call ç±»ä¼¼åªæ˜¯ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„è€Œ call æ¥æ”¶çš„åˆ™æ˜¯ä¸€ä¸ªå‚æ•°åˆ—è¡¨ã€‚\r\n\r\nçœ‹ä¸€ä¸ªä¾‹å­\r\n\r\n```js\r\nvar obj = {\r\n  name: \"obj\"\r\n};\r\nfunction foo() {\r\n  return this.name;\r\n}\r\nfoo.call(obj); //obj\r\n```\r\n\r\nä¸Šé¢é€šè¿‡ call æ”¹å˜äº† this çš„æŒ‡å‘ï¼Œä¸‹é¢å°±æ˜¯æ¨¡æ‹Ÿå®ç°\r\n\r\n## å®ç°\r\n\r\ncall å’Œ apply æ˜¯ es5 çš„æ–¹æ³•ï¼Œæ—¢ç„¶æ˜¯æ¨¡æ‹Ÿå®ç°é‚£è‚¯å®šä¸èƒ½ç”¨ es5 æ–¹æ³•äº†ï¼Œæˆ‘ä»¬å…ˆåˆ†æä¸€ä¸‹æ€ä¹ˆæ¥æŒ‡å®š thisï¼Œthis è·ŸåŠ¨æ€ä½œç”¨åŸŸç±»ä¼¼æ˜¯åœ¨æ‰§è¡Œæ—¶ç¡®å®šï¼Œé‚£æˆ‘ä»¬åœ¨æŒ‡å®š this çš„å±æ€§ä¸Šæ·»åŠ ä¸€ä¸ªæ–¹æ³•å¹¶ä¸”æ‰§è¡Œï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•çš„ this å°±æ˜¯æŒ‡å®š this\r\n\r\n```js\r\nvar obj = {\r\n  name: \"obj\",\r\n  foo: function foo() {\r\n    return this.name;\r\n  }\r\n};\r\n\r\nobj.foo();\r\n```\r\n\r\nä¸Šé¢è§£å†³äº† thisï¼Œä¸‹é¢æ¥çœ‹ä¸‹æ€ä¹ˆå®ç°å‚æ•°çš„ä¼ é€’ï¼Œcall æ–¹æ³•å¯ä»¥ä¼ é€’ä»»æ„å‚æ•°åˆ—è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡`arguments`æ¥è·å–ï¼Œå®ƒæ˜¯ä¸€ä¸ªç±»æ•°ç»„ã€‚\r\n\r\n```js\r\nfunction getName() {\r\n  console.log(arguments); //Arguments(5) [1, 2, 3, 4, 5]\r\n}\r\nfunction foo() {\r\n  var args = [];\r\n  for (var i = 0; i < arguments.length; i++) {\r\n    args.push(\"arguments[\" + i + \"]\");\r\n  }\r\n  eval(\"getName(\" + args + \")\");\r\n}\r\nfoo(1, 2, 3, 4, 5);\r\n```\r\n\r\nOKï¼Œè¿™ä¸¤å—å·²ç»æå®šäº†ï¼Œä¸‹é¢å°±æ˜¯å®ç°\r\n\r\n### call\r\n\r\n```js\r\nFunction.prototype.calls = function(con) {\r\n  con.fn = this;\r\n  // è·å–å‚æ•°\r\n  var args = [];\r\n  for (var i = 1; i < arguments.length; i++) {\r\n    args.push(\"arguments[\" + i + \"]\");\r\n  }\r\n  var result = eval(\"con.fn(\" + args + \")\");\r\n  delete con.fn;\r\n  return result;\r\n};\r\n```\r\n\r\nä¸Šé¢åˆ é™¤å±æ€§æ˜¯ä¸ºäº†é¿å…æ±¡æŸ“ï¼Œè¿™é‡Œçš„`fn`å¯ä»¥æ˜¯ä»»æ„å±æ€§ååªè¦ä¿è¯ä¸é‡å¤å°±è¡Œäº†ï¼Œä¸è¿‡ä»”ç»†è§‚å¯Ÿä¸Šé¢å‡½æ•°è¿˜æ˜¯æœ‰é—®é¢˜\r\n\r\n1. call çš„ this å¯ä»¥æ˜¯ `null` æˆ–è€… `undefined`ï¼›\r\n2. å¯ä»¥æ˜¯å­—ç¬¦ä¸²æ•°å­—ä¹‹ç±»çš„ï¼Œä¼šè½¬åŒ–ä¸ºåŒ…è£…å¯¹è±¡ï¼›\r\n\r\n```js\r\nFunction.prototype.calls = function(con) {\r\n  if (con == null) {\r\n    con = typeof window === \"object\" ? window : global;\r\n  }\r\n  con = Object(con);\r\n  con.fn = this;\r\n  // è·å–å‚æ•°\r\n  var args = [];\r\n  for (var i = 1; i < arguments.length; i++) {\r\n    args.push(\"arguments[\" + i + \"]\");\r\n  }\r\n  var result = eval(\"con.fn(\" + args + \")\");\r\n  delete con.fn;\r\n  return result;\r\n};\r\n```\r\n\r\næµ‹è¯•ä¸€ä¸‹\r\n\r\n```js\r\nfunction foo() {\r\n  return this.length;\r\n}\r\nconsole.log(foo.calls(\"obj\")); // 3\r\n```\r\n\r\næ’’èŠ±ï¼Œè¿™æ ·å°±å®ç°äº† call\r\n\r\n### apply\r\n\r\nä¸ call ååˆ†ç±»ä¼¼ï¼Œè¿™é‡Œå°±ç›´æ¥è´´ä»£ç äº†\r\n\r\n```js\r\nFunction.prototype.applys = function(con, arr) {\r\n  if (con == null) {\r\n    con = typeof window === \"object\" ? window : global;\r\n  }\r\n  con = Object(con);\r\n  con.fn = this;\r\n  var result;\r\n  if (typeof arr === \"object\" && arr.length) {\r\n    var args = [];\r\n    for (var i = 0; i < arr.length; i++) {\r\n      args.push(\"arr[\" + i + \"]\");\r\n    }\r\n    result = eval(\"con.fn(\" + args + \")\");\r\n  } else {\r\n    result = eval(\"con.fn()\");\r\n  }\r\n  delete con.fn;\r\n  return result;\r\n};\r\n```\r\n\r\n## å‚è€ƒ\r\n\r\n1. https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/call\r\n2. https://github.com/mqyqingfeng/Blog/issues/11\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/30/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/30/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/31",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/31/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/31/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/31/events",
          "html_url": "https://github.com/bosens-China/blog/issues/31",
          "id": 503856924,
          "node_id": "MDU6SXNzdWU1MDM4NTY5MjQ=",
          "number": 31,
          "title": "æ¨¡æ‹Ÿå®ç°bind",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1602397157,
              "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
              "name": "æ·±å…¥ç³»åˆ—",
              "color": "719192",
              "default": false,
              "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2019-10-08T06:35:47Z",
          "updated_at": "2021-12-21T03:06:57Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "ä¹‹å‰è¯´äº†[æ¨¡æ‹Ÿå®ç° call å’Œ apply](https://github.com/bosens-China/blog/issues/30)ï¼Œä¸‹é¢å°±æ¥å®ç° bindï¼Œé¦–å…ˆå…ˆçœ‹ä¸€ä¸‹å®šä¹‰ bind å®šä¹‰\r\n\r\n> bind()æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œåœ¨ bind()è¢«è°ƒç”¨æ—¶ï¼Œè¿™ä¸ªæ–°å‡½æ•°çš„ this è¢« bind çš„ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šï¼Œå…¶ä½™çš„å‚æ•°å°†ä½œä¸ºæ–°å‡½æ•°çš„å‚æ•°ä¾›è°ƒç”¨æ—¶ä½¿ç”¨ã€‚\r\n\r\n## ç¬¬ä¸€ç‰ˆ\r\n\r\næ ¹æ®å®šä¹‰æˆ‘ä»¬å°è¯•å†™ä¸€ä¸‹\r\n\r\n```js\r\nFunction.prototype.binds = function(con) {\r\n  var fn = this;\r\n  var args = Array.prototype.slice.call(arguments, 1);\r\n  return function() {\r\n    return fn.apply(con, args);\r\n  };\r\n};\r\n```\r\n\r\næˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ä¸Šé¢çš„å‡½æ•°\r\n\r\n```js\r\nvar obj = {\r\n  value: \"zhangsan\"\r\n};\r\nfunction foo(name, age) {\r\n  console.log(this.value); //zhangsan\r\n  console.log(name); // name\r\n  console.log(age); // undefined\r\n}\r\nvar f = foo.binds(obj, \"name\");\r\nf(19);\r\n```\r\n\r\n`age` è¾“å‡ºçš„è·Ÿæˆ‘ä»¬é¢„æœŸçš„ä¸å¤ªä¸€è‡´ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ²¡æœ‰å¤„ç†è¿”å›å‡½æ•°çš„å‚æ•°ï¼Œç”¨ concat æŠŠå‚æ•°åˆå¹¶åœ¨ä¸€èµ·å°±å¯ä»¥äº†ã€‚\r\n\r\n```js\r\nFunction.prototype.binds = function(con) {\r\n  var fn = this;\r\n  var args = Array.prototype.slice.call(arguments, 1);\r\n  return function() {\r\n    return fn.apply(con, args.concat(Array.prototype.slice.call(arguments)));\r\n  };\r\n};\r\n```\r\n\r\n## ç¬¬äºŒç‰ˆ\r\n\r\nä¸Šé¢ç®€å•å®ç°äº†å‡½æ•°çš„ bindï¼Œä¸è¿‡æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ bind ä¸æ„é€ å‡½æ•°ç›¸é‡ä¼šæ€ä¹ˆæ ·\r\n\r\n```js\r\nvar obj = {\r\n  value: \"zhangsan\"\r\n};\r\nfunction Foo(name, age) {\r\n  console.log(this.value); //undefined\r\n  console.log(name);\r\n  console.log(age);\r\n}\r\nvar f = Foo.bind(obj, \"name\");\r\nnew f(19);\r\n```\r\n\r\nä¸Šé¢ `this.value` çš„è¾“å‡ºä¸º `undefined`ï¼Œè¿™æ˜¯å› ä¸º **è°ƒç”¨ç»‘å®šå‡½æ•°æ—¶ä½œä¸º this å‚æ•°ä¼ é€’ç»™ç›®æ ‡å‡½æ•°çš„å€¼ã€‚ å¦‚æœä½¿ç”¨ new è¿ç®—ç¬¦æ„é€ ç»‘å®šå‡½æ•°ï¼Œåˆ™å¿½ç•¥è¯¥å€¼**ã€‚\r\n\r\nå¦å¤–ä½œä¸ºæ„é€ å‡½æ•°æ˜¯å¯ä»¥è·å–åˆ°ç»‘å®š bind å‡½æ•°çš„ `prototype` çš„\r\n\r\n```js\r\nfunction Foo() {\r\n  console.log(this.gender); //male\r\n}\r\nFoo.prototype.gender = \"male\";\r\nvar f = Foo.bind(null, \"name\");\r\nnew f();\r\n```\r\n\r\nä¸‹é¢å°±æ˜¯æ¥å®ç°ä¸Šé¢ä¸¤ç‚¹ï¼š\r\n\r\n- æ€ä¹ˆæ¥åˆ¤æ–­æ˜¯å¦é€šè¿‡ new æ¥è°ƒç”¨å‘¢ï¼Ÿå¯ä»¥é€šè¿‡`instanceof`\r\n\r\n```js\r\nfunction Foo() {\r\n  if (!(this instanceof Foo)) {\r\n    throw Error(\"è¯·é€šè¿‡newè°ƒç”¨\");\r\n  }\r\n}\r\nFoo();\r\n```\r\n\r\n- ç»§æ‰¿çš„è¯æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿ï¼Œè¿™ç±»æ–‡ç« æ¯”è¾ƒå¤šï¼Œè¿™é‡Œå°±ç®€å•ä¸¾ä¸€ä¸ªä¾‹å­\r\n\r\n```js\r\nfunction create(con) {\r\n  var f = function() {};\r\n  f.prototype = con;\r\n  return new f();\r\n}\r\nfunction Par(name) {\r\n  this.name = name;\r\n}\r\nPar.prototype.getName = function() {\r\n  return this.name;\r\n};\r\nfunction Chi(name, age) {\r\n  Par.call(this, name);\r\n  this.age = age;\r\n}\r\nChi.prototype = create(Par.prototype);\r\nChi.prototype.constructor = Chi;\r\nChi.prototype.getDetails = function() {\r\n  var n = this.getName();\r\n  console.log(n, this.age);\r\n};\r\nvar d = new Chi(\"zhangsan\", 16);\r\nd.getDetails();\r\n```\r\n\r\nOKï¼Œä¸Šé¢ä¸¤ç‚¹è§£å†³åæˆ‘ä»¬å†æ¥å®ç°ä¸€ç‰ˆ\r\n\r\n```js\r\nFunction.prototype.binds = function(con) {\r\n  var fn = this;\r\n  var args = Array.prototype.slice.call(arguments, 1);\r\n  var f = function() {};\r\n  if (this.prototype) {\r\n    f.prototype = this.prototype;\r\n  }\r\n  var result = function() {\r\n    return fn.apply(\r\n      this instanceof result ? this : con,\r\n      args.concat(Array.prototype.slice.call(arguments))\r\n    );\r\n  };\r\n  result.prototype = new f();\r\n  return result;\r\n};\r\n```\r\n\r\n## ä¼˜åŒ–\r\n\r\nè§‚å¯Ÿä¸Šé¢çš„ä¸éš¾å‘ç° bind è°ƒç”¨çš„å¿…é¡»æ˜¯å‡½æ•°ï¼Œè€Œé€šè¿‡ç»§æ‰¿æˆ‘ä»¬å¯èƒ½ä¼šè°ƒç”¨åˆ° bind æ‰€ä»¥è¿™é‡Œæ˜¾ç¤ºæŠ¥é”™ä¸€ä¸‹\r\n\r\n```js\r\nvar obj = Object.create(Function.prototype);\r\nconsole.log(obj.bind);\r\n```\r\n\r\nå¦å¤–å¯¹äºæˆ‘ä»¬ä¸Šé¢å®šä¹‰çš„`binds`è‚¯å®šä¸å¤ªä¼˜é›…ï¼Œæ±¡æŸ“äº†å‘½åç©ºé—´ï¼Œè¿™é‡Œå¯ä»¥åˆ¤æ–­ä¸€ä¸‹å¦‚æœå­˜åœ¨ `bind` å°±ç”¨ `bind` å¦åˆ™åœ¨å®šä¹‰\r\n\r\n## æœ€ç»ˆ\r\n\r\n```js\r\nif (!Function.prototype.bind) {\r\n  Function.prototype.bind = function(con) {\r\n    if (typeof this !== \"function\") {\r\n      throw new TypeError(\r\n        \"Function.prototype.bind - what is trying to be bound is not callable\"\r\n      );\r\n    }\r\n    var fn = this;\r\n    var args = Array.prototype.slice.call(arguments, 1);\r\n    var f = function() {};\r\n    if (this.prototype) {\r\n      f.prototype = this.prototype;\r\n    }\r\n    var result = function() {\r\n      return fn.apply(\r\n        this instanceof result ? this : con,\r\n        args.concat(Array.prototype.slice.call(arguments))\r\n      );\r\n    };\r\n    result.prototype = new f();\r\n    return result;\r\n  };\r\n}\r\n```\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/31/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/31/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/11",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/11/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/11/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/11/events",
          "html_url": "https://github.com/bosens-China/blog/issues/11",
          "id": 479656673,
          "node_id": "MDU6SXNzdWU0Nzk2NTY2NzM=",
          "number": 11,
          "title": "å˜é‡æå‡",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1602397157,
              "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
              "name": "æ·±å…¥ç³»åˆ—",
              "color": "719192",
              "default": false,
              "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2019-08-12T13:49:40Z",
          "updated_at": "2021-12-21T03:06:32Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "> è¿™é‡Œåªæ˜¯ç”¨ä¼ªä»£ç çš„å½¢å¼æ¥è¯´æ˜ï¼Œå®é™…ä¸Šå˜é‡å£°æ˜åªæ˜¯æ‰§è¡Œä¸Šä¸‹æ–‡æœ‰å…³ï¼Œæ¨èé˜…è¯»[\r\nJavaScriptæ·±å…¥ä¹‹å˜é‡å¯¹è±¡](https://github.com/mqyqingfeng/Blog/issues/5)\r\n\r\n## å¤ªé•¿ä¸çœ‹ç¯‡\r\nå‡½æ•°å‚æ•° > å‡½æ•°å£°æ˜ > å˜é‡å£°æ˜\r\n\r\n## å˜é‡å£°æ˜\r\né¦–å…ˆæƒ³ç”¨ä¸€ä¸ªä¼ªç”Ÿå‘½å‘¨æœŸæ¥è¯´è¿™ä¸ªäº‹æƒ…ï¼Œå‡è®¾è¿™æ®µä»£ç åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼Œåˆå§‹åŒ–é˜¶æ®µå’Œèµ‹å€¼é˜¶æ®µï¼› çœ‹ä¸‹é¢ä¸€æ®µä»£ç ï¼Œç”¨ä¼ªç³»ç»Ÿçš„è¯æ¥é˜è¿°\r\n``` js\r\nconsole.log(a);\r\nvar a = 10;\r\n```\r\nå¦‚æœæŒ‰ç…§ä¸Šé¢çš„å£°æ˜å‘¨æœŸæ¥è¯´ï¼Œé¦–å…ˆå˜é‡ a ä¼šåœ¨ä½œç”¨åŸŸæ³¨å†Œä¸€ä¸ªå˜é‡(å¦‚æœæ²¡æœ‰)é»˜è®¤èµ‹å€¼ä¸º `undefined`\r\n\r\nåˆå§‹åŒ–å®Œæˆåï¼Œå¼€å§‹æ‰§è¡Œä»£ç ï¼Œç¬¬ä¸€è¡Œè¯­å¥çš„æ—¶å€™å› ä¸ºå˜é‡ a æœªç»è¿‡èµ‹å€¼é˜¶æ®µï¼Œè¿™ä¸€é˜¶æ®µçš„å€¼æ˜¯ `ndefined`ï¼Œæ‰€ä»¥æ‰“å°çš„ç»“æœè‡ªç„¶ä¹Ÿå°±æ˜¯ `undefined`;\r\n\r\nåœ¨ç¬¬äºŒè¡Œçš„æ—¶å€™å˜é‡ a ä¼šç»è¿‡èµ‹å€¼é˜¶æ®µï¼Œè¿™æ—¶å˜é‡ a çš„å€¼å°±æ˜¯ 10 äº†ã€‚\r\n\r\n## å‡½æ•°å£°æ˜\r\nå‡½æ•°å£°æ˜ä¸å˜é‡å£°æ˜è§„åˆ™åŸºæœ¬ä¸€è‡´ï¼Œä¼˜å…ˆçº§æ¯”å˜é‡å£°æ˜è¦é«˜\r\n\r\næ˜¯ä¸æ˜¯åªè¯´è¿™ä¸€å¥è¯å¤§å®¶æœ‰äº›å¤±æœ›ï¼Œå¦‚æœåªæ˜¯å•ç‹¬æ¥è¯´å‡½æ•°å£°æ˜æœªå…å¤ªæ²¡æ„æ€ï¼Œä¸‹é¢å°±ç»“åˆå˜é‡å£°æ˜æ¥è¯´è¯´å‡½æ•°å£°æ˜ï¼Œæ¯•ç«Ÿä»£ç åªæœ‰å˜é‡å£°æ˜å°±åšä¸åˆ°æœ‰è¶£äº†ã€‚\r\n``` js\r\na();\r\nvar a = 10;\r\nfunction a() {\r\n  console.log(5);\r\n}\r\n```\r\nä¸Šé¢çš„æ‰§è¡Œç»“æœæ˜¯æ‰“å°æ•°å­— 5ï¼Œä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§æƒ…å†µå‘¢ï¼Ÿä¸Šé¢æˆ‘ä»¬å·²ç»è¯´äº†å‡½æ•°å£°æ˜ä¼˜å…ˆäºå˜é‡å£°æ˜ï¼Œé‚£ä¹ˆä¸Šé¢ä»£ç å®é™…å¯ä»¥æ‹†å°æˆä¸‹é¢å½¢å¼\r\n``` js\r\nfunction a() {\r\n  // ...\r\n}\r\na();\r\na = 10;\r\n```\r\nä½ å¯èƒ½è¿˜æœ‰ç–‘æƒ‘ï¼Œäº‹å®ä¸Šå¦‚æœå˜é‡æå‡çš„æ—¶å€™å‘ç°å·²ç»å­˜åœ¨å˜é‡å°±ä¼šé»˜é»˜å¿½ç•¥æ‰ï¼Œæ¯”å¦‚ä¸Šé¢çš„ä»£ç å˜é‡ a å·²ç»æ˜¯ä¸€ä¸ªå‡½æ•°äº†ï¼Œé‚£ä¹ˆå˜é‡å£°æ˜çš„ a ä¼šè¢«å¿½ç•¥ã€‚\r\n\r\næœ€åè¯´ä¸‹å‡½æ•°å‚æ•°ï¼Œå‚æ•°ä¹Ÿæ˜¯å˜é‡çš„ä¸€ç§å½¢å¼ï¼Œå®ƒçš„ä¼˜å…ˆçº§æœ€é«˜ï¼Œä½†æ˜¯åŒæ ·ä¼šå—åˆ°å‡½æ•°å£°æ˜çš„å½±å“\r\n``` js\r\nfunction a(x) {\r\n  console.log(x);\r\n  function x() {}\r\n}\r\na(5);\r\n```\r\nè¿™é‡Œè¾“å‡ºç»“æœæ˜¯å‡½æ•° xï¼ŒåŸå› æ˜¯å‡½æ•°å£°æ˜æå‡çš„æ—¶å€™ä¼šæ‰§è¡Œä¸€ä¸ªè¦†ç›–æ“ä½œï¼Œå°±åƒæˆ‘ä»¬å†™ä»£ç `x = 5`è¿™æ ·\r\n\r\n## æœ€å\r\nè¿™é‡Œè¯´çš„æœ‰å¾ˆå¤šåœ°æ–¹ä¸è¶³ï¼Œåªæ˜¯è‡ªå·±çš„è§è§£ï¼Œæ›´æ¨èä¸€ç¯‡æ–‡ç« [10 åˆ†é’Ÿç†è§£æ‰§è¡Œä¸Šä¸‹æ–‡](https://zhuanlan.zhihu.com/p/25879753)\r\n\r\næœ€åæ ¹æ®ä¸Šé¢çš„å†…å®¹è®²è§£ä¸€ä¸‹ä»–å¸ƒç½®çš„ä¸€åˆ°é¢˜ç›®\r\n``` js\r\nconsole.log(x);\r\nvar x = 10;\r\n\r\nconsole.log(x);\r\nx = 20;\r\n\r\nfunction x() {}\r\nconsole.log(x);\r\n\r\nif (true) {\r\n  var a = 1;\r\n} else {\r\n  var b = true;\r\n}\r\n\r\nconsole.log(a);\r\nconsole.log(b);\r\n```\r\né¦–å…ˆåˆå§‹åŒ–é˜¶æ®µï¼Œ`function x` æœ€å…ˆè¢«æå‡ï¼Œåé¢çš„å˜é‡æå‡å› ä¸ºå·²ç»å­˜åœ¨å‡½æ•° x çš„åŸå› ä¼šè¢«å¿½ç•¥ ç¬¬ä¸€ä¸ª console è¾“å‡ºçš„æ˜¯å‡½æ•°` x`ï¼Œ\r\n\r\nä¹‹åæ‰§è¡Œåˆ°ç¬¬äºŒè¡Œä»£ç çš„æ—¶å€™ `x` è¢«æ”¹å˜å˜æˆ` 10`ï¼Œç¬¬äºŒä¸ª `console` è¾“å‡ºä¸º `10`ï¼Œä¹‹åç»§ç»­è¢«èµ‹å€¼ä¸º `20`ï¼Œç¬¬ä¸‰ä¸ª` console` è¾“å‡ºä¸º `20`ï¼Œ\r\n\r\nç¬¬å››ä¸ªå’Œç¬¬äº”ä¸ª `console` çš„è¾“å‡ºåˆ†åˆ«ä¸º `1` å’Œ` undefined`ï¼Œè¿™æ˜¯å› ä¸º es5 çš„ç¯å¢ƒä¸‹å¹¶ä¸å­˜åœ¨å—çº§ä½œç”¨åŸŸï¼Œå˜é‡ `a` å’Œ `b` ä¼šæ‰§è¡Œå˜é‡æå‡è¿™ä¸€æ­¥éª¤ï¼Œ \r\nä¸åŒçš„æ˜¯ `a` è¢«èµ‹å€¼ä¸ºäº† `1`ï¼Œè€Œ `b` å› ä¸ºæ²¡æœ‰æ‰§è¡Œåˆ° `var b = true` æ‰€ä»¥å€¼è¿˜æ˜¯ `undefined`ã€‚",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/11/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/11/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/32",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/32/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/32/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/32/events",
          "html_url": "https://github.com/bosens-China/blog/issues/32",
          "id": 503866389,
          "node_id": "MDU6SXNzdWU1MDM4NjYzODk=",
          "number": 32,
          "title": "æ¨¡æ‹Ÿå®ç°new",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1602397157,
              "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
              "name": "æ·±å…¥ç³»åˆ—",
              "color": "719192",
              "default": false,
              "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2019-10-08T07:03:22Z",
          "updated_at": "2021-12-21T03:04:48Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "> new è¿ç®—ç¬¦åˆ›å»ºä¸€ä¸ªç”¨æˆ·å®šä¹‰çš„å¯¹è±¡ç±»å‹çš„å®ä¾‹æˆ–å…·æœ‰æ„é€ å‡½æ•°çš„å†…ç½®å¯¹è±¡çš„å®ä¾‹ã€‚\r\n\r\nä¸Šé¢çš„å®šä¹‰æœ‰ç‚¹æŠ½è±¡ï¼Œæˆ‘ä»¬æ¥é€šè¿‡ä¸€ä¸ªä¾‹å­çœ‹ new è¿ç®—ç¬¦æ‰®æ¼”çš„è§’è‰²\r\n\r\n```js\r\nfunction Foo(name, age) {\r\n  this.name = name;\r\n  this.age = age;\r\n}\r\nFoo.prototype.getName = function() {\r\n  return this.name;\r\n};\r\nFoo.prototype.foo = \"foo\";\r\nvar f = new Foo(\"zhangsan\", 18);\r\nf.getName(); // zhangsan\r\nf.foo; // foo\r\n```\r\n\r\nä¸Šé¢é€šè¿‡ new åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå¹¶ä¸”è¿™ä¸ªå¯¹è±¡é€šè¿‡åŸå‹é“¾è®¿é—®åˆ°äº†åŸå‹ä¸Šçš„æ–¹æ³•å’Œå±æ€§ï¼Œæ‰€ä»¥ new è¿ç®—ç¬¦å°±æ˜¯æ‰§è¡Œæ„é€ å‡½æ•°è¿”å›ä¸€ä¸ªå®ä¾‹å¯¹è±¡ã€‚\r\n\r\nnew è¿ç®—ç¬¦åœ¨æ‰§è¡Œæ—¶æ‰§è¡Œäº†ä¸‹é¢å››æ­¥ï¼š\r\n\r\n1. åˆ›å»ºä¸€ä¸ªç©ºçš„ç®€å• JavaScript å¯¹è±¡ï¼ˆå³{}ï¼‰ï¼›\r\n2. é“¾æ¥è¯¥å¯¹è±¡ï¼ˆå³è®¾ç½®è¯¥å¯¹è±¡çš„æ„é€ å‡½æ•°ï¼‰åˆ°å¦ä¸€ä¸ªå¯¹è±¡ ï¼›\r\n3. å°†æ­¥éª¤ 1 æ–°åˆ›å»ºçš„å¯¹è±¡ä½œä¸º this çš„ä¸Šä¸‹æ–‡ ï¼›\r\n4. å¦‚æœè¯¥å‡½æ•°æ²¡æœ‰è¿”å›å¯¹è±¡ï¼Œåˆ™è¿”å› thisã€‚\r\n\r\n## å®ç°\r\n\r\næ ¹æ®ä¸Šé¢çš„æ‰§è¡Œæ­¥éª¤æˆ‘ä»¬æ¥å°è¯•å®ç°ä¸‹ï¼Œå½“ç„¶ new æ“ä½œç¬¦è‚¯å®šæ˜¯æ¨¡æ‹Ÿä¸äº†äº†ï¼Œä¸‹é¢é€šè¿‡å‡½æ•°çš„å½¢å¼å±•ç¤º\r\n\r\n```js\r\nfunction newCall(fn) {\r\n  var args = Array.prototype.slice.call(arguments, 1);\r\n  var obj = {};\r\n  obj.__proto__ = fn.prototype;\r\n  var result = fn.apply(obj, args);\r\n  return result && typeof result === \"object\" ? result : obj;\r\n}\r\n```\r\n\r\nOkï¼Œåˆ°è¿™é‡Œå°±å®ç°äº†ä¸€ä¸ªæ¨¡æ‹Ÿ new çš„æ“ä½œï¼Œæˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹\r\n\r\n```js\r\nfunction Otaku(name, age) {\r\n  this.name = name;\r\n  this.age = age;\r\n\r\n  this.habit = \"Games\";\r\n}\r\n\r\nOtaku.prototype.strength = 60;\r\n\r\nOtaku.prototype.sayYourName = function() {\r\n  console.log(\"I am \" + this.name);\r\n};\r\n\r\nfunction newCall(fn) {\r\n  var args = Array.prototype.slice.call(arguments, 1);\r\n  var obj = {};\r\n  obj.__proto__ = fn.prototype;\r\n  var result = fn.apply(obj, args);\r\n  return result && typeof result === \"object\" ? result : obj;\r\n}\r\n\r\nvar person = newCall(Otaku, \"Kevin\", \"18\");\r\n\r\nconsole.log(person.name); // Kevin\r\nconsole.log(person.habit); // Games\r\nconsole.log(person.strength); // 60\r\n```\r\n\r\næ’’èŠ± âœ¿âœ¿ ãƒ½(Â°â–½Â°)ãƒ âœ¿ï¼Œä¸è¿‡é¢å¤–æé†’ä¸€ä¸‹`__proto__`æ˜¯æµè§ˆå™¨å®ç°çš„éæ ‡å‡†å±æ€§ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸æ¨èä½¿ç”¨ï¼Œä¸è¿‡æ—¢ç„¶æ˜¯æ¨¡æ‹Ÿ es5 æ¨èçš„`Object.setPrototypeOf`è‚¯å®šæ²¡åŠæ³•ç”¨äº†ï¼Œåªèƒ½å°†å°±ç€ç”¨äº†\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/32/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/32/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/59",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/59/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/59/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/59/events",
          "html_url": "https://github.com/bosens-China/blog/issues/59",
          "id": 647201487,
          "node_id": "MDU6SXNzdWU2NDcyMDE0ODc=",
          "number": 59,
          "title": "æ·±æµ…æ‹·è´å’Œextend",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1602397157,
              "node_id": "MDU6TGFiZWwxNjAyMzk3MTU3",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E6%B7%B1%E5%85%A5%E7%B3%BB%E5%88%97",
              "name": "æ·±å…¥ç³»åˆ—",
              "color": "719192",
              "default": false,
              "description": "ä¸»è¦ä»‹ç»å®ç°çš„æ€è·¯"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2020-06-29T07:59:36Z",
          "updated_at": "2021-12-21T03:04:38Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "## å‰è¨€\r\n\r\næ·±æµ…æ‹·è´å’Œ extend æ˜¯é¡¹ç›®ä¸­å¸¸ç”¨çš„å·¥å…·ç±»å‡½æ•°ï¼Œä»Šå¤©å°±åŠ¨æ‰‹å®ç°ä¸€ä¸‹\r\n\r\nä¸‹é¢ä¼šé‡å¤è¿™å‡ ä¸ªåŸºç¡€å‡½æ•°ï¼Œä¸ºäº†ç®€æ´ä¸‹é¢ä¸ä¼šå‡ºç°ç›¸å…³å®šä¹‰\r\n\r\n```js\r\nfunction isObject(obj) {\r\n  return obj && typeof obj === \"object\";\r\n}\r\nfunction type(obj) {\r\n  return Object.prototype.toString\r\n    .call(obj)\r\n    .replace(/\\[object.(.+?)\\]/, \"$1\")\r\n    .toLowerCase();\r\n}\r\nfunction array(par) {\r\n  return type(par) === \"array\";\r\n}\r\n```\r\n\r\n## æµ…æ‹·è´ç”¨æ³•\r\n\r\n```js\r\nvar obj = { name: \"test\", args: [{ name: 1 }] };\r\nvar test = { ...obj };\r\n// ä¿®æ”¹ä¸‹åŸæ¥å±æ€§\r\nobj.name = \"foo\";\r\n// test.name test\r\nobj.args.push(\"456\");\r\n// args: (2) [{â€¦}, \"456\"]\r\n```\r\n\r\nä»ä¸Šé¢ä¾‹å­å¯ä»¥çœ‹åˆ°ï¼Œå½“ä¸¤ä¸ªå¯¹è±¡å‡ºç°ç›¸åŒå­—æ®µçš„æ—¶å€™ï¼Œåè€…ä¼šè¦†ç›–å‰è€…ï¼Œè€Œä¸ä¼šè¿›è¡Œæ·±å±‚æ¬¡çš„è¦†ç›–ã€‚\r\n\r\nç”±æ­¤å¯ä»¥å¾—åˆ°ä¸€ä¸ªç»“è®ºï¼šæµ…æ‹·è´å¯ä»¥ç®€å•ç†è§£ä¸ºåªæ‹·è´å¯¹è±¡çš„ä¸€å±‚å±æ€§ï¼Œå¦‚æœæ‹·è´çš„å±æ€§è¿˜æ˜¯å¯¹è±¡ï¼Œé‚£ä¹ˆä¿®æ”¹å®ƒåˆ™ä¼šå½±å“åˆ°æ‹¥æœ‰ç›¸åŒå±æ€§çš„å¯¹è±¡ã€‚\r\n\r\n## æµ…æ‹·è´å®ç°\r\n\r\nç»“åˆä¸Šé¢çš„ç»“è®ºï¼Œæˆ‘ä»¬åŠ¨æ‰‹å®ç°ä¸€ä¸ªå‡½æ•°\r\n\r\n```js\r\nexport function copy(obj) {\r\n  if (!isObject(obj)) {\r\n    return;\r\n  }\r\n  const src = array(obj) ? [] : {};\r\n  for (const key in obj) {\r\n    const value = obj[key];\r\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\r\n      src[key] = value;\r\n    }\r\n  }\r\n  return src;\r\n}\r\n```\r\n\r\næµ‹è¯•ç”¨ä¾‹\r\n\r\n```js\r\ntest(\"æµ…æ‹·è´\", () => {\r\n  const value = { a: 123, b: 456, c: [1] };\r\n  const test = copy(value);\r\n  expect(test).toEqual({ a: 123, b: 456, c: [1] });\r\n  expect(value === test).toBeFalsy();\r\n  expect(value.c === test.c).toBeTruthy();\r\n  expect(value.a === test.a).toBeTruthy();\r\n});\r\n```\r\n\r\n## æ·±æ‹·è´\r\n\r\nä¸Šé¢æˆ‘ä»¬å·²ç»å®ç°äº†æµ…æ‹·è´ï¼Œæµ…æ‹·è´åªæ˜¯ç®€å•çš„æ‹·è´äº†ä¸€å±‚å±æ€§ï¼Œå¦‚æœæ˜¯æ·±æ‹·è´å‘¢ï¼Ÿ\r\n\r\nå…¶å®å°±æ˜¯å¯¹å±æ€§ä¸ºå¯¹è±¡è¿›è¡Œé‡å¤çš„è°ƒç”¨ï¼Œåœ¨å®ç°è¿™ä¸ªä¹‹å‰å…ˆçœ‹ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„åšæ³•ã€‚\r\n\r\n#### json\r\n\r\n```js\r\nfunction deepAssign(par) {\r\n  return JSON.parse(JSON.stringify(par));\r\n}\r\n// æµ‹è¯•ç”¨ä¾‹\r\nconst value = {a: {name: 456}};\r\nconst test = deepAssign({value);\r\ntest.a === value.a;\r\n//false\r\ndeepAssign({ a() {}, b: /abc/, c: Math.floor, d: null, e: new Set() });\r\n// {b: {}, d: null, e: {}}\r\n```\r\n\r\néœ€è¦ç‰¹åˆ«æ³¨æ„ç”¨è¿™ä¸ªæ–¹æ³•å¤„ç†å‡½æ•°ã€æ­£åˆ™ä¹‹ç±»çš„å¯¹è±¡ä¸ä¼šå‡ºç°é¢„æœŸç»“æœï¼Œä¸è¿‡åœ¨å¤„ç†æ¥å£è¿”å›çš„æ•°æ®ä¸å¤±ä¸ºä¸€ç§æ–¹æ³•ã€‚\r\n\r\n#### é€’å½’\r\n\r\nç›¸æ¯”`JSON`çš„æ–¹å¼å®ç°ï¼Œå¯ä»¥è®©æˆ‘ä»¬è‡ªç”±å®šåˆ¶ä¸€äº›ç±»å‹ï¼Œä¾‹å¦‚ä¸Šé¢çš„`æ­£åˆ™`å°±å¯ä»¥é€šè¿‡`hack`æ–¹æ³•åˆ›å»ºï¼Œä¸ºäº†ç®€åŒ–æºç ï¼Œè¿™é‡Œåªå¤„ç†å¯¹è±¡å’Œæ•°ç»„ï¼Œå¯¹äºå…¶ä»–ç±»å‹çš„å¤„ç†å¯ä»¥å‚è€ƒä¸€ä¸‹ç¬¬ä¸‰æ–¹åº“\r\n\r\n```js\r\nfunction deepCopy(obj, has = new WeakMap()) {\r\n  if (!isObject(obj)) {\r\n    return;\r\n  }\r\n  // é¿å…å¾ªç¯å¼•ç”¨\r\n  if (has.has(obj)) {\r\n    return has.get(obj);\r\n  }\r\n  const src = array(obj) ? [] : {};\r\n  has.set(obj, src);\r\n  for (const key in obj) {\r\n    const value = obj[key];\r\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\r\n      // æ³¨æ„è¿™ä¸€è¡Œ\r\n      src[key] = isObject(value) ? copy(value, has) : value;\r\n    }\r\n  }\r\n  return src;\r\n}\r\n```\r\n\r\næµ‹è¯•ç”¨ä¾‹\r\n\r\n```js\r\ntest(\"æ·±æ‹·è´\", () => {\r\n  const value = { a: 123, b: 456, c: [1] };\r\n  const test = deepCopy(value);\r\n  expect(test).toEqual({ a: 123, b: 456, c: [1] });\r\n  expect(value === test).toBeFalsy();\r\n  expect(value.c === test.c).toBeFalsy();\r\n  expect(value.a === test.a).toBeTruthy();\r\n});\r\n```\r\n\r\næ³¨æ„ä¸Šé¢ç”¨äº†ä¸€ä¸ª`WeakMap`ï¼Œè¿™ä¸ªæ˜¯ä¸ºäº†é¿å…å¾ªç¯å¼•å…¥ï¼Œä½ å¯ä»¥æŠŠä¸Šé¢çš„`WeakMap`ç›¸å…³ä»£ç å»æ‰ï¼Œç„¶ååœ¨æ§åˆ¶å°è¾“å…¥ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œçœ‹çœ‹ä¼šå‡ºç°ä»€ä¹ˆç»“æœã€‚\r\n\r\n```js\r\nvar a = {};\r\na.a = a;\r\nvar test = deepCopy(a);\r\n```\r\n\r\n## extend\r\n\r\nextend åˆ†ä¸ºä¸¤éƒ¨åˆ†:\r\n\r\n1. æµ…åˆå¹¶ï¼Œ`Object.assign`å°±æ˜¯æµ…æ‹·è´ï¼›\r\n2. æ·±åˆå¹¶ï¼Œæ²¡æœ‰ç›¸å…³çš„çš„ apiï¼Œéœ€è¦æ‰‹åŠ¨å®ç°\r\n\r\n#### æµ…åˆå¹¶ä½¿ç”¨æ–¹æ³•\r\n\r\nåœ¨å®ç°è¿™ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬çº¦å®šä¸€ä¸‹æ ¼å¼\r\n\r\n```js\r\nassign( target [, object1 ] [, objectN ] )\r\n```\r\n\r\nç¬¬ä¸€ä¸ªå‚æ•°ä¸ºç›®æ ‡å¯¹è±¡å¿…é¡»æ˜¯å¯¹è±¡ï¼Œä¹‹åçš„å‚æ•°æ˜¯ç›®æ ‡å¯¹è±¡ï¼Œå¯ä»¥ä¸ä¸ºå¯¹è±¡\r\n\r\n```js\r\nvar obj1 = {\r\n  a: 1,\r\n  b: { b1: 1, b2: 2 },\r\n};\r\n\r\nvar obj2 = {\r\n  b: { b1: 3, b3: 4 },\r\n  c: 3,\r\n};\r\n\r\nvar obj3 = {\r\n  d: 4,\r\n};\r\n\r\nconsole.log(assign(obj1, obj2, obj3));\r\n\r\n// {\r\n//    a: 1,\r\n//    b: { b1: 3, b3: 4 },\r\n//    c: 3,\r\n//    d: 4\r\n// }\r\n```\r\n\r\n#### æµ…åˆå¹¶å®ç°\r\n\r\næ ¹æ®ä¸Šé¢çš„çº¦æŸï¼ŒåŠ¨æ‰‹å®ç°ä¸€ä¸‹\r\n\r\n```js\r\nfunction assign() {\r\n  let target = arguments[0];\r\n  let i = 1,\r\n    leg = arguments.length;\r\n  if (!isObject(target)) {\r\n    target = {};\r\n  }\r\n  for (; i < leg; i++) {\r\n    const value = arguments[i];\r\n    if (value == null) {\r\n      continue;\r\n    }\r\n    for (const name in value) {\r\n      if (Object.prototype.hasOwnProperty.call(value, name)) {\r\n        const copy = value[name];\r\n        target[name] = copy;\r\n      }\r\n    }\r\n  }\r\n  return target;\r\n}\r\n```\r\n\r\næµ‹è¯•ç”¨ä¾‹\r\n\r\n```js\r\ntest(\"æµ…æ‹·è´\", () => {\r\n  const value1 = { name: \"test\", age: 17 };\r\n  const value2 = { name: \"app\", age: [1, 2, 3] };\r\n  const test = assign(value1, value2, null, undefined, \"abc\");\r\n  expect(assign(test)).toEqual({\r\n    name: \"app\",\r\n    age: [1, 2, 3],\r\n    0: \"a\",\r\n    1: \"b\",\r\n    2: \"c\",\r\n  });\r\n  expect(test.age === value2.age).toBeTruthy();\r\n  var obj1 = {\r\n    a: 1,\r\n    b: { b1: 1, b2: 2 },\r\n  };\r\n\r\n  var obj2 = {\r\n    b: { b1: 3, b3: 4 },\r\n    c: 3,\r\n  };\r\n\r\n  var obj3 = {\r\n    d: 4,\r\n  };\r\n  expect(assign(obj1, obj2, obj3)).toEqual({\r\n    a: 1,\r\n    b: { b1: 3, b3: 4 },\r\n    c: 3,\r\n    d: 4,\r\n  });\r\n});\r\n```\r\n\r\n#### æ·±åˆå¹¶\r\n\r\n```js\r\nfunction deepAssign(...args) {\r\n  let obj = {};\r\n  for (const value of args) {\r\n    if (array(value)) {\r\n      if (!array(obj)) {\r\n        obj = [];\r\n      }\r\n      // å¯¹æ•°ç»„å†…å®¹è¿›è¡Œæ·±æ‹·è´\r\n      const arr = value.reduce((x, y) => {\r\n        x = x.concat(isObject(y) ? deepAssign([], y) : y);\r\n        return x;\r\n      }, []);\r\n      obj = [...obj, ...arr];\r\n    } else if (isObject(value)) {\r\n      for (let [name, val] of Object.entries(value)) {\r\n        if (isObject(val) && name in obj) {\r\n          val = deepAssign(obj[name], val);\r\n        }\r\n        obj = {\r\n          ...obj,\r\n          [name]: val,\r\n        };\r\n      }\r\n    }\r\n  }\r\n  return obj;\r\n}\r\n```\r\n\r\n`if (isObject(val) && name in obj)`æ³¨æ„è¿™è¡Œçš„åˆ¤æ–­ï¼Œåªæœ‰å½“ target å±æ€§ä¸Šæœ‰å€¼çš„æ—¶å€™æ‰ä¼šè¿›è¡Œé€’å½’è°ƒç”¨ã€‚\r\n\r\næµ‹è¯•ç”¨ä¾‹\r\n\r\n```js\r\ntest(\"æ·±åˆå¹¶\", () => {\r\n  const value1 = [1, 2, { name: { age: [1, 2, 3, 4, 5] } }];\r\n  const value2 = [1, 2, { age: 18 }];\r\n  const test = deepAssign(value1, value2);\r\n  expect(test[2] === value1[2]).toBe(false);\r\n  expect(test).toEqual([\r\n    1,\r\n    2,\r\n    { name: { age: [1, 2, 3, 4, 5] } },\r\n    1,\r\n    2,\r\n    { age: 18 },\r\n  ]);\r\n  const obj1 = { name: [1, 2, 3] };\r\n  const obj2 = { age: 17, name: [4, 5, 6] };\r\n  const obj = deepAssign(obj1, obj2);\r\n  expect(obj).toEqual({ name: [1, 2, 3, 4, 5, 6], age: 17 });\r\n  const a = {};\r\n  a.a = a;\r\n  expect(deepAssign(a)).toEqual({ a: { a } });\r\n});\r\n```\r\n\r\n## æœ€å\r\n\r\nå¦‚æœæœ‰é”™è¯¯æˆ–è€…ä¸ä¸¥è°¨çš„åœ°æ–¹ï¼Œè¯·åŠ¡å¿…ç»™äºˆæŒ‡æ­£ï¼Œååˆ†æ„Ÿè°¢ã€‚å¦‚æœå–œæ¬¢æˆ–è€…æœ‰æ‰€å¯å‘ï¼Œæ¬¢è¿ `star`ï¼Œå¯¹ä½œè€…ä¹Ÿæ˜¯ä¸€ç§é¼“åŠ±ã€‚\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/59/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/59/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        }
      ]
    ],
    [
      "1371686610",
      [
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/64",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/64/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/64/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/64/events",
          "html_url": "https://github.com/bosens-China/blog/issues/64",
          "id": 767600367,
          "node_id": "MDU6SXNzdWU3Njc2MDAzNjc=",
          "number": 64,
          "title": "ioså±å¹•é€‚é…",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1371686610,
              "node_id": "MDU6TGFiZWwxMzcxNjg2NjEw",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/css%20%E7%9B%B8%E5%85%B3",
              "name": "css ç›¸å…³",
              "color": "42b883",
              "default": false,
              "description": "css æŠ€å·§å’ŒåŸºç¡€ä¸ºä¸»"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2020-12-15T13:34:49Z",
          "updated_at": "2021-12-21T09:51:42Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "è¿™ç¯‡æ–‡ç« ç®—æ˜¯è¿Ÿæ¥çš„æ€»ç»“ï¼Œæœ€è¿‘åšäº†ä¸€ä¸ª h5 é¡¹ç›®å†…åµŒåˆ° app é¡µé¢å†…è”ï¼Œé»˜è®¤æƒ…å†µä¸‹ app é‚£è¾¹ä¸ä¼šåšä»»ä½•å¤„ç†ï¼Œä¹Ÿå°±æ˜¯é¡¶éƒ¨å’Œåº•éƒ¨éœ€è¦é¢å¤–å¤„ç†ä¸€ä¸‹\r\n![bg](https://user-images.githubusercontent.com/39508895/102221576-4211db00-3f1d-11eb-981c-885c51309964.png)\r\n\r\n\r\n## åšæ³•\r\n\r\né»˜è®¤æƒ…å†µä¸‹ ios çš„é¡¶éƒ¨çŠ¶æ€æ æ˜¯`20px`ï¼Œå¦‚æœå­˜åœ¨åˆ˜æµ·åˆ™æ˜¯`44px`ï¼Œå½“ç„¶å®é™…å¼€å‘ä¸­ä¹Ÿä¸éœ€è¦ä½¿ç”¨ js æ¥è¿›è¡Œåˆ¤æ–­ï¼Œå› ä¸º ios11 ä¹‹åæ–°å¢äº†ä¸€ä¸ªå®‰å…¨åŒºåŸŸï¼Œç”¨æ¥å®šä¹‰å¯è§†çª—å£çš„èŒƒå›´ï¼Œå®ƒä¸€å…±æœ‰å››ä¸ªå±æ€§\r\n\r\n- safe-area-inset-leftï¼šå®‰å…¨åŒºåŸŸè·ç¦»å·¦è¾¹è¾¹ç•Œè·ç¦»\r\n- safe-area-inset-rightï¼šå®‰å…¨åŒºåŸŸè·ç¦»å³è¾¹è¾¹ç•Œè·ç¦»\r\n- safe-area-inset-topï¼šå®‰å…¨åŒºåŸŸè·ç¦»é¡¶éƒ¨è¾¹ç•Œè·ç¦»\r\n- safe-area-inset-bottomï¼šå®‰å…¨åŒºåŸŸè·ç¦»åº•éƒ¨è¾¹ç•Œè·ç¦»\r\n\r\nä½¿ç”¨æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼š\r\n\r\n```css\r\npadding-bottom: env(safe-area-inset-bottom);\r\n```\r\n\r\nåœ¨`html`æ–‡ä»¶çš„`meta`ä¸­æ·»åŠ \r\n\r\n```html\r\n   <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0,user-scalable=no, viewport-fit=cover\">\r\n```\r\n\r\n> åªæœ‰è®¾ç½®äº†viewport-fit=coverï¼Œæ‰èƒ½ä½¿ç”¨`env`ï¼Œæ³¨æ„ä¸Šé¢è¯´çš„éƒ½æ˜¯ç«–å±æƒ…å†µ\r\n\r\n\r\n\r\n#### env ç¬¬äºŒä¸ªå‚æ•°\r\n\r\nä¸Šé¢å†™æ³•çš„`env`å’Œ`constant`å…¶å®éƒ½æ”¯æŒç¬¬äºŒä¸ªå‚æ•°ï¼Œä½œä¸ºä¸æ”¯æŒç¯å¢ƒçš„åé€€ï¼Œå¯ä»¥ä½œä¸ºäº†è§£\r\nä¾‹å¦‚ï¼š\r\n``` css\r\n/* ä¸æ”¯æŒå°±å›é€€åˆ°ç¬¬äºŒä¸ªå‚æ•° */\r\npadding-bottom: env(safe-area-inset-bottom, 20px);\r\n```\r\n\r\n#### @supports é¢å¤–åˆ¤æ–­\r\n\r\nä¸ºäº†é˜²æ­¢éƒ¨åˆ†å®‰å“ä¹Ÿä½¿ç”¨`safe-area-inset-top`ä¹‹ç±»çš„å±æ€§ï¼Œå¯ä»¥æ·»åŠ `-webkit-overflow-scrolling: touch`æ¥è¿›è¡ŒåŒé‡åˆ¤æ–­\r\n\r\n> [-webkit-overflow-scrolling](https://caniuse.com/?search=-webkit-overflow-scrolling) åªæœ‰ iOS Safari æ”¯æŒ\r\n\r\n```css\r\n@supports (\r\n    (height: constant(safe-area-inset-top)) or\r\n      (height: env(safe-area-inset-top))\r\n  )\r\n  and (-webkit-overflow-scrolling: touch) {\r\n  /* ä»£ç  */\r\n}\r\n```\r\n\r\n## fixed å†™æ³•\r\n\r\n- calcï¼Œç›´æ¥æŠŠåŸæ¥å†™çš„å€¼åŠ ä¸Šå®‰å…¨åŒºåŸŸèŒƒå›´\r\n\r\n```css\r\nbottom: calc(50px (å‡è®¾å€¼) + env(safe-area-inset-bottom));\r\n```\r\n\r\n- padding: æ·»åŠ  padding çš„å†…è¾¹è·è¿›è¡Œå¡«å……\r\n\r\n```css\r\npadding-bottom: env(safe-area-inset-bottom);\r\n```\r\n\r\n## é¢å¤–æ³¨æ„ç‚¹\r\n\r\næ˜¯ä¸æ˜¯å› ä¸ºä¸Šé¢å°±è¯´å®Œäº†ï¼Œå…¶å®è¿˜æœ‰è¿˜æœ‰ä¸€ç‚¹å…¼å®¹çš„åœ°æ–¹éœ€è¦é¢å¤–å…³æ³¨\r\n\r\n> The env() function shipped in iOS 11 with the name constant(). Beginning with Safari Technology Preview 41 and the iOS 11.2 beta, constant() has been removed and replaced with env(). You can use the CSS fallback mechanism to support both versions, if necessary, but should prefer env() going forward.\r\n\r\nç¿»è¯‘è¿‡æ¥å°±æ˜¯`ios`11.2 ä¹‹åä¸å†æ”¯æŒ`constant`è€Œæ˜¯ä½¿ç”¨`env`ï¼Œæ‰€ä»¥ç”Ÿäº§è¿‡ç¨‹ä¸­å¯ä»¥ä½¿ç”¨ä¸‹é¢å†™æ³•åšå…¼å®¹\r\n\r\n```css\r\npadding-bottom: constant(safe-area-inset-bottom);\r\n/* å…¼å®¹ iOS < 11.2 */\r\npadding-bottom: env(safe-area-inset-bottom);\r\n/* å…¼å®¹ iOS >= 11.2 */\r\n```\r\n\r\n## æœ€å\r\n\r\nå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©å¯ä»¥ç‚¹ä¸€ä¸‹`star`\r\n\r\nå‚è€ƒæ–‡ç« \r\n\r\n- [ç½‘é¡µé€‚é… iPhoneXï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•](https://aotu.io/notes/2017/11/27/iphonex/index.html)\r\n\r\n- [IOSåˆ˜æµ·å±H5 CSSé€‚é…](https://juejin.cn/post/6844903974491930637#heading-4)\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/64/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/64/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/34",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/34/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/34/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/34/events",
          "html_url": "https://github.com/bosens-China/blog/issues/34",
          "id": 512000452,
          "node_id": "MDU6SXNzdWU1MTIwMDA0NTI=",
          "number": 34,
          "title": "é€‰æ‹©å™¨é‚£äº›äº‹",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1371686610,
              "node_id": "MDU6TGFiZWwxMzcxNjg2NjEw",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/css%20%E7%9B%B8%E5%85%B3",
              "name": "css ç›¸å…³",
              "color": "42b883",
              "default": false,
              "description": "css æŠ€å·§å’ŒåŸºç¡€ä¸ºä¸»"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2019-10-24T14:56:12Z",
          "updated_at": "2021-12-21T09:47:07Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "> å¤±è¸ªäººå£å†’ä¸ªæ³¡\r\n\r\n## ä¼˜å…ˆçº§\r\n\r\nå…¥é—¨å­¦ä¹ çš„æ—¶å€™ä¸€å®šå°±å¬è¯´è¿‡è¿™äº›æ¦‚å¿µï¼Œåœ¨èœé¸Ÿæ•™ç¨‹ä¹‹ç±»çš„ç½‘ç«™ä¸Šä¹Ÿè‚¯å®šå­¦ä¹ è¿‡ï¼Œæ¯”å¦‚ç±»çš„ä¼˜å…ˆçº§ä¸º 10ã€æ ‡ç­¾çš„ä¼˜å…ˆçº§ä¸º 1ï¼Œè¿™äº›éƒ½æ˜¯è¾…åŠ©æˆ‘ä»¬è®°å¿†çš„ï¼Œä¸‹é¢å°±æ¥è¯´ä¸€è¯´å®¹æ˜“å‡ºé”™çš„ç‚¹ã€‚\r\n\r\n```css\r\n.top {\r\n  margin: 10px;\r\n}\r\n[class] {\r\n  margin: 20px;\r\n}\r\n```\r\n\r\nè¿™é‡Œè¾“å‡ºçš„`margin`ä¸ºå¤šå°‘ï¼Ÿ\r\n\r\nç­”æ¡ˆæ˜¯`20px`ï¼Œå¯¹äºç±»å’Œå±æ€§é€‰æ‹©å™¨ä»¥åŠä¼ªç±»ä¼˜å…ˆçº§æ˜¯ä¸€è‡´çš„ï¼Œå½“ç„¶è¿™ä¸ªä¾‹å­åªæ˜¯å¸®ä½ æ¸©ä¹ çš„ï¼Œå†æ¥çœ‹ä¸€ä¸ª\r\n\r\n```css\r\n/*ç¬¬ä¸€æ¡*/\r\nbody [class] {\r\n  color: #666;\r\n}\r\n/*ç¬¬äºŒæ¡*/\r\nhtml:not([dir]) {\r\n  color: red;\r\n}\r\n```\r\n\r\nè¿™é‡Œä¸¤æ¡å±æ€§çš„ä¼˜å…ˆçº§ç›¸ç­‰ä¹ˆï¼Ÿ\r\n\r\nç­”æ¡ˆæ˜¯ç›¸ç­‰çš„ï¼Œå¯¹äº`:not`è¿™æ ·çš„é€»è¾‘ç»„åˆä¼ªç±»å½±å“ä¼˜å…ˆçº§çš„æ˜¯é‡Œé¢çš„å…ƒç´ ï¼Œä¸Šé¢ç¬¬ä¸€æ¡æ˜¯ä¸€ä¸ªæ ‡ç­¾åŠ ä¸Šå±æ€§é€‰æ‹©å™¨ä¼˜å…ˆçº§ä¸º 11ï¼Œç¬¬äºŒæ¡ html æ ‡ç­¾åŠ ä¸Šå±æ€§é€‰æ‹©å™¨ä¼˜å…ˆçº§ä¹Ÿæ˜¯ 11ã€‚\r\n\r\n## æ¸²æŸ“é¡ºåº\r\n\r\nä¸Šé¢ä¸¾äº†ä¸€ä¸ªä¾‹å­æœ€ç»ˆé¢œè‰²ç”Ÿæ•ˆä¸º`red`ï¼Œè¿™æ˜¯å› ä¸ºåæ¥å±…ä¸Šçš„åŸåˆ™ï¼Œä¸è¿‡æ³¨æ„è¿™ä¸ªåæ¥å±…ä¸Šè¯´çš„æ˜¯æ•´ä½“æ–‡æ¡£è€Œè¨€ã€‚\r\n\r\n```html\r\n<link rel=\"stylesheet\" href=\"a.css\" /> <link rel=\"stylesheet\" href=\"b.css\" />\r\n```\r\n\r\na.css\r\n\r\n```css\r\nbody .foo {\r\n  color: red;\r\n}\r\n```\r\n\r\nb.css\r\n\r\n```css\r\nhtml .foo {\r\n  color: #666;\r\n}\r\n```\r\n\r\næœ€ç»ˆ`color`çš„å€¼ä¸º`#666`ï¼ŒåŒæ—¶è¿˜æé†’ä¸€ä¸‹ css æœ€ç»ˆç”Ÿæ•ˆå¹¶ä¸æ˜¯çœ‹å…ƒç´ çš„è·ç¦»çš„è¿œè¿‘ï¼Œè€Œæ˜¯æ ¹æ®ä¼˜å…ˆçº§å’Œä½ç½®ï¼Œæ¯”å¦‚ä¸Šé¢çš„ body è‚¯å®šæ¯” html ç¦»å¾—è¿‘ï¼Œä½†æ˜¯å› ä¸ºåæ¥å±…ä¸Šæ‰€ä»¥å¹¶æ²¡æœ‰ç”Ÿæ•ˆã€‚\r\n\r\n## é€‰æ‹©å™¨æ˜¯å¦èƒ½è·¨çº§ï¼Ÿ\r\n\r\nåœ¨å¼€å¤´è¯´äº†æ–¹ä¾¿è®°å¿†æˆ‘ä»¬ä¼šç»™ç±»å’Œæ ‡ç­¾ä¹‹ç±»çš„ä¼˜å…ˆçº§æ·»åŠ ä¸Šæ•°å­—ï¼Œä½†æ˜¯å¦‚æœä½ æƒ³ç”¨æ•°é‡å¤šå°±è¦†ç›–é«˜ä¸€å±‚çº§çš„æ˜¯ä¸å¯èƒ½çš„\r\n\r\n```css\r\n.a {\r\n  color: red;\r\n}\r\na,\r\na,\r\na,\r\na,\r\na,\r\na,\r\na,\r\na,\r\na,\r\na,\r\na,\r\na,\r\na,\r\na,\r\na,\r\na,\r\na,\r\na {\r\n  color: #666;\r\n}\r\n```\r\n\r\nè¾“å‡ºç»“æœè¿˜æ˜¯çº¢è‰²ã€‚\r\n\r\n## å¢åŠ ä¼˜å…ˆçº§\r\n\r\nä¼ ç»Ÿæ·»åŠ ä¼˜å…ˆçº§æˆ‘ä»¬å¯èƒ½ä¼šé€šè¿‡ç»™æ ‡ç­¾æ·»åŠ  id æˆ–è€…ç»§ç»­åµŒå¥—æ¥å®ç°ï¼Œä¸è¿‡è¿™æ ·åšè‚¯å®šä¸åˆé€‚å› ä¸ºåé¢åœ¨æƒ³ä¿®æ”¹å¯èƒ½å°±éœ€è¦ä½¿ç”¨`style`æˆ–è€…`important`äº†ï¼Œä¸‹é¢å°±è¯´ä¸‹ä¸¤ä¸ªå°æŠ€å·§\r\n\r\n1. ä½¿ç”¨å±æ€§é€‰æ‹©å™¨\r\n\r\n```css\r\n.a[class] {\r\n  color: red;\r\n}\r\n.a {\r\n  color: #666;\r\n}\r\n```\r\n\r\n2. åµŒå¥—é€‰æ‹©è‡ªå·±\r\n\r\n```css\r\n.a.a {\r\n  color: red;\r\n}\r\n.a {\r\n  color: #666;\r\n}\r\n```\r\n\r\n## åŒ¹é…é¡ºåº\r\n\r\nè¯´ä¸€ç‚¹æ–°æ‰‹å™©æ¢¦ï¼Œcss çš„åŒ¹é…é¡ºåºæ˜¯ä»å³å¾€å·¦ï¼Œæ‰€ä»¥åµŒå¥—å¤ªå¤šå±‚çš„ css è¯­å¥å°±ä¸è¦åœ¨å†™äº†ï¼Œä¸€èˆ¬è€Œè¨€ id é€‰æ‹©å™¨å’Œç±»é€‰æ‹©å™¨çš„è§£ææœ€å¿«ï¼Œæ ‡ç­¾é€‰æ‹©å™¨çš„é€Ÿåº¦å¾ˆæ…¢ï¼Œæ‰€ä»¥åœ¨é¡¹ç›®ä¸­ä¸è¦åµŒå…¥å¤ªå¤šçš„æ ‡ç­¾é€‰æ‹©å™¨æœ‰åˆ©äºé¡¹ç›®çš„ä¼˜åŒ–ã€‚\r\n\r\n## æ˜¯å¦åŒºåˆ†å¤§å°å†™\r\n\r\nè¯´è¿™ä¸ªé¦–å…ˆè¦è¯´ä¸€ä¸‹ html æ˜¯å¦åŒºåˆ†å¤§å°å†™ï¼Œhtml å¯¹äºæ ‡ç­¾å’Œå±æ€§æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼Œè€Œå¯¹å±æ€§å€¼åˆ™æ˜¯åŒºåˆ†çš„ï¼Œcss ä¸ html ä¿æŒä¸€è‡´\r\n\r\n```html\r\n<style>\r\n  p {\r\n    color: #666;\r\n  }\r\n  [CLASS] {\r\n    color: red;\r\n  }\r\n  .foo {\r\n    color: white;\r\n  }\r\n</style>\r\n<p class=\"FOO\">hello wrold</p>\r\n```\r\n\r\nè¿™é‡Œ p çš„ `color` ä¸º `red`ï¼Œè¯´æ˜äº†æ ‡ç­¾å’Œå±æ€§é€‰æ‹©å™¨ä¸åŒºåˆ†å¤§å°å†™ï¼Œè€Œå¯¹äº class åˆ™æ˜¯åŒºåˆ†çš„ã€‚\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/34/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/34/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/18",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/18/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/18/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/18/events",
          "html_url": "https://github.com/bosens-China/blog/issues/18",
          "id": 479907836,
          "node_id": "MDU6SXNzdWU0Nzk5MDc4MzY=",
          "number": 18,
          "title": "æ— æ•ˆçš„height100%ï¼Ÿ",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1371686610,
              "node_id": "MDU6TGFiZWwxMzcxNjg2NjEw",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/css%20%E7%9B%B8%E5%85%B3",
              "name": "css ç›¸å…³",
              "color": "42b883",
              "default": false,
              "description": "css æŠ€å·§å’ŒåŸºç¡€ä¸ºä¸»"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2019-08-13T00:34:13Z",
          "updated_at": "2019-08-13T00:34:13Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "ä¹‹æ‰€ä»¥å†™ heightï¼Œæ˜¯å› ä¸ºå®ƒå‡ºç°çš„åœºæ‰€æ¯”è¾ƒå¤š\r\n``` css\r\nbody {\r\n  height: 100%;\r\n}\r\n```\r\nä¸çŸ¥é“ä½ ä»¬æœ‰æ²¡æœ‰è¿™æ ·å†™è¿‡ css å±æ€§ï¼Œä¸è¿‡å¾ˆé—æ†¾è¿™æ˜¯æ— æ•ˆçš„ã€‚\r\n\r\nçˆ¶çº§æ²¡æœ‰ç»™å®šæ˜ç¡®çš„é«˜åº¦ä¹ˆï¼Ÿ è¿™æ ·è¯´æœ‰ä¸€å®šæ­£ç¡®æ€§ï¼Œä¸è¿‡ä¸å¤Ÿå…¨é¢ï¼Œåœ¨ height çš„è§„èŒƒä¸­è§„å®šäº†ä¸¤ç§æƒ…å†µ 100%å¯ä»¥è§£æå‡ºæ¥\r\n\r\n1. çˆ¶çº§ç»™å®šæ˜ç¡®çš„é«˜åº¦\r\nè¿™ä¸ªæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œå¹³æ—¶æˆ‘ä»¬ä¹Ÿæ˜¯è¿™æ ·å†™çš„ æ¯”å¦‚ä¸Šé¢ body æ²¡æœ‰ç”Ÿæ•ˆå°±æ˜¯å› ä¸ºæ²¡æœ‰æŒ‡å®š html çš„é«˜åº¦ï¼Œæ‰€ä»¥è¦è¿™æ ·å†™\r\n``` css\r\nhtml,\r\nbody {\r\n  height: 100%;\r\n}\r\n```\r\n\r\n2. ä½¿ç”¨ç»å¯¹å®šä½å…ƒç´ \r\n``` css\r\n.box {\r\n  position: relative;\r\n  .child {\r\n    position: absolute;\r\n    height: 100%;\r\n    widows: 100%;\r\n  }\r\n}\r\n```\r\nè¿™æ ·å°±è·å–åˆ°äº†é«˜åº¦ï¼Œä¸è¿‡æ³¨æ„ç»å¯¹å®šä½è·å–çš„é«˜åº¦ä¸çˆ¶çº§ç»™å®šé«˜åº¦æœ‰ä¸€å®šåŒºåˆ«\r\n\r\n## åŒºåˆ«\r\ncss æ˜¯å­˜åœ¨ç›’å­æ¨¡å‹çš„ï¼Œå¹³æ—¶é«˜åº¦å’Œå®½åº¦éƒ½æ˜¯ä½œç”¨åœ¨ `content-box` ä¸Šçš„ï¼Œè€Œä¸Šé¢è¯´çš„ç¬¬ä¸€ç§æ–¹å¼ï¼Œé«˜åº¦è·å–åˆ°çš„å°±æ˜¯çˆ¶çº§ content ç›’å­çš„é«˜åº¦ï¼Œæ€ä¹ˆæ¥è¯æ˜å‘¢ï¼Ÿ `box-sizing` å¯ä»¥æ”¹å˜ä½œç”¨é«˜åº¦å’Œå®½åº¦çš„ç›’å­ï¼Œæˆ‘ä»¬æ¥ç”¨è¿™ä¸ªå®éªŒã€‚\r\n``` html\r\n<div class=\"box\">\r\n  <div class=\"child\"></div>\r\n</div>\r\n.box {\r\n  width: 180px;\r\n  background: #ddd;\r\n  height: 150px;\r\n  padding: 30px;\r\n  box-sizing: border-box;\r\n  .child {\r\n    height: 100%;\r\n    background: #666;\r\n  }\r\n}\r\n```\r\nå¯ä»¥å°†ä¸Šé¢ä»£ç å¤åˆ¶åˆ°æœ¬åœ°è¿è¡Œä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°å­å…ƒç´ çš„é«˜åº¦å¹¶æ²¡æœ‰å ç”¨çˆ¶å…ƒç´ çš„ 100%ã€‚ æ”¹å†™ä¸€ä¸‹ï¼Œæ”¹æˆç»å¯¹å®šä½æ¥å®ç°\r\n``` css\r\n.box {\r\n  width: 180px;\r\n  background: #ddd;\r\n  height: 150px;\r\n  padding: 30px;\r\n  box-sizing: border-box;\r\n  position: relative;\r\n  border: 20px solid;\r\n  .child {\r\n    height: 100%;\r\n    background: #666;\r\n    position: absolute;\r\n    width: 100%;\r\n  }\r\n}\r\n```\r\nå¯¹æ¯”ä¸€ä¸‹å¯ä»¥çœ‹åˆ°ç»å¯¹å®šä½çš„é«˜åº¦æ˜¯åŒ…å«` padding` åŒºåŸŸçš„\r\n\r\næœ€åä»¥ä¸€ä¸ªç¤ºä¾‹ç»“å°¾\r\n``` html\r\n<div class=\"box\">\r\n  <a href=\"javascript:\" class=\"nav\"></a>\r\n  <a href=\"javascript:\" class=\"nav nav1\"></a>\r\n  <img src=\"https://demo.cssworld.cn/images/common/l/1.jpg\" alt=\"\" />\r\n</div>\r\n.box {\r\n  display: inline-block;\r\n  position: relative;\r\n  .nav {\r\n    position: absolute;\r\n    height: 100%;\r\n    left: 0;\r\n    width: 50%;\r\n    opacity: 0.7;\r\n    background: #ddd;\r\n  }\r\n  .nav1 {\r\n    left: 50%;\r\n    background: #34538b;\r\n  }\r\n}\r\n```\r\nå€ŸåŠ©ç»å¯¹å®šä½å®ç°äº†é«˜åº¦è‡ªé€‚åº”çš„æ•ˆæœ\r\n\r\n## å‚è€ƒ\r\nã€Šcss ä¸–ç•Œã€‹",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/18/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/18/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        }
      ]
    ],
    [
      "1580833992",
      [
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/42",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/42/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/42/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/42/events",
          "html_url": "https://github.com/bosens-China/blog/issues/42",
          "id": 542405907,
          "node_id": "MDU6SXNzdWU1NDI0MDU5MDc=",
          "number": 42,
          "title": "IntersectionObserverå®ç°å›¾ç‰‡æ‡’åŠ è½½",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1580833992,
              "node_id": "MDU6TGFiZWwxNTgwODMzOTky",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%AE%9E%E9%AA%8C%E6%80%A7%20API",
              "name": "å®éªŒæ€§ API",
              "color": "7aa9d6",
              "default": false,
              "description": "è¿˜æœªå®šç¨¿çš„API"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2019-12-26T01:53:33Z",
          "updated_at": "2021-12-21T09:48:12Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "> ä¼ ç»Ÿçš„å›¾ç‰‡æ‡’åŠ è½½å®ç°æ€è·¯æ˜¯åˆ¤æ–­å›¾ç‰‡çš„ top åŒºåŸŸæ˜¯å¦å°äºçˆ¶çº§åŒºåŸŸï¼Œä¸”è‡ªèº«é«˜åº¦åŠ ä¸Š top å¤§äº 0ï¼Œ\r\n> ä¾‹å¦‚\r\n\r\n```js\r\n// å…ƒç´ æ˜¯å¦å¯è§†\r\nconst viewVisible = el => {\r\n  const { top, width, height, left } = el.getBoundingClientRect();\r\n  const w = window.innerWidth || document.documentElement.clientWidth;\r\n  const h = window.innerHeight || document.documentElement.clientHeight;\r\n  return top < h && top + height >= 0 && left < w && left + width >= 0;\r\n};\r\n```\r\n\r\n> ä¸è¿‡è¿™æ ·å†™çš„è¯æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯æˆ‘ä»¬ç›‘å¬çš„äº‹ä»¶ä¼šé‡å¤å¤šæ¬¡è§¦å‘ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦å†™ä¸€ä¸ªèŠ‚æµæˆ–è€…é˜²æŠ–å‡½æ•°ï¼Œä¸è¿‡ä½¿ç”¨`IntersectionObserver`æˆ‘ä»¬å¯ä»¥è½»æ¾å®ç°ï¼Œé¦–å…ˆçœ‹ä¸‹å…¼å®¹æ€§\r\n\r\n>![IntersectionObserverå…¼å®¹æ€§](https://user-images.githubusercontent.com/39508895/146864557-35c7c4d6-600c-4379-a433-1d38225500f5.png)å¯ä»¥çœ‹åˆ°å·®å¼ºäººæ„ï¼Œä¸è¿‡å¥½åœ¨å¯ä»¥[polyfill](https://github.com/w3c/IntersectionObserver/tree/master/polyfill)ï¼Œä¸‹é¢å°±ä»‹ç»ä½¿ç”¨\r\n\r\n## ä½¿ç”¨æ–¹æ³•\r\n\r\n`IntersectionObserver`ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•\r\n\r\n```js\r\nvar observer = new IntersectionObserver(callback[, options]);\r\n```\r\n\r\n`callback`æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ª IntersectionObserverEntry å¯¹è±¡åˆ—è¡¨(list)ï¼Œä»¥åŠè§¦å‘ IntersectionObserverEntry çš„å®ä¾‹\r\n\r\n| æ–¹æ³•         | è¯´æ˜                                           |\r\n| ------------ | ---------------------------------------------- |\r\n| disconnect() | ä½¿ IntersectionObserver å¯¹è±¡åœæ­¢ç›‘å¬å·¥ä½œã€‚     |\r\n| observe()    | ä½¿ IntersectionObserver å¼€å§‹ç›‘å¬ä¸€ä¸ªç›®æ ‡å…ƒç´ ã€‚ |\r\n| unobserve()  | ä½¿ IntersectionObserver åœæ­¢ç›‘å¬ç‰¹å®šç›®æ ‡å…ƒç´ ã€‚ |\r\n\r\n**æ³¨æ„**\r\n`callback`çš„å›è°ƒå‡½æ•°ä¼šè§¦å‘ä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡æ˜¯å…ƒç´ å¼€å§‹å¯è§ï¼Œç¬¬äºŒæ¬¡æ˜¯å…ƒç´ ä¸å¯è§çš„æ—¶å€™ã€‚\r\n\r\n## é€‰é¡¹(options)\r\n\r\næ³¨æ„å¯é€‰å±æ€§\r\n\r\n| å±æ€§       | è¯´æ˜                                                                                                                                                                                           |\r\n| ---------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\r\n| root       | ç›‘å¬å…ƒç´ çš„ç¥–å…ˆå…ƒç´  Element å¯¹è±¡                                                                                                                                                                |\r\n| rootMargin | ä¸€ä¸ªåœ¨è®¡ç®—äº¤å‰å€¼æ—¶æ·»åŠ è‡³æ ¹çš„è¾¹ç•Œç›’(bounding_box)ä¸­çš„ä¸€ç»„åç§»é‡ï¼Œç±»å‹ä¸ºå­—ç¬¦ä¸²ï¼Œå¯ä»¥æœ‰æ•ˆçš„ç¼©å°æˆ–æ‰©å¤§æ ¹çš„åˆ¤å®šèŒƒå›´ä»è€Œæ»¡è¶³è®¡ç®—éœ€è¦ã€‚è¯­æ³•å¤§è‡´å’Œ CSS ä¸­çš„ margin å±æ€§ç­‰åŒï¼Œé»˜è®¤å€¼æ˜¯\"0px 0px 0px 0px\" |\r\n| threshold  | è§„å®šäº†ä¸€ä¸ªç›‘å¬ç›®æ ‡ä¸è¾¹ç•Œç›’äº¤å‰åŒºåŸŸçš„æ¯”ä¾‹å€¼ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå…·ä½“çš„æ•°å€¼æˆ–æ˜¯ä¸€ç»„ 0.0 åˆ° 1.0 ä¹‹é—´çš„æ•°ç»„ã€‚è‹¥æŒ‡å®šå€¼ä¸º 0.0ï¼Œåˆ™æ„å‘³ç€ç›‘å¬å…ƒç´ å³ä½¿ä¸æ ¹æœ‰ 1 åƒç´ äº¤å‰ï¼Œæ­¤å…ƒç´ ä¹Ÿä¼šè¢«è§†ä¸ºå¯è§.                   |\r\n\r\n## å®ä¾‹\r\n\r\n```js\r\nconst dom = new IntersectionObserver(a => {\r\n  console.log(a);\r\n});\r\nArray.from(document.querySelectorAll(\"img\")).forEach(f => {\r\n  dom.observe(f);\r\n});\r\n```\r\n\r\nè¿”å›çš„ a æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‡Œé¢å­˜æ”¾ç€ä¸€äº›å…ƒç´ ä¿¡æ¯ï¼Œä¸‹é¢æ‰€æœ‰å±æ€§éƒ½æ˜¯åªè¯»\r\n\r\n| å±æ€§               | è¯´æ˜                                                                                                                                                                                                                                |\r\n| ------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\r\n| boundingClientRect | è¿”å›åŒ…å«ç›®æ ‡å…ƒç´ çš„è¾¹ç•Œä¿¡æ¯çš„ DOMRectReadOnly. è¾¹ç•Œçš„è®¡ç®—æ–¹å¼ä¸ Element.getBoundingClientRect() ç›¸åŒ.                                                                                                                                |\r\n| intersectionRatio  | è¿”å› intersectionRect ä¸ boundingClientRect çš„æ¯”ä¾‹å€¼,**å¦‚æœå¤§äº 0 åˆ™è¡¨ç¤ºå¯è§ï¼Œå®Œå…¨å¯è§ä¸º 1**.                                                                                                                                       |\r\n| intersectionRect   | è¿”å›ä¸€ä¸ª DOMRectReadOnly ç”¨æ¥æè¿°æ ¹å’Œç›®æ ‡å…ƒç´ çš„ç›¸äº¤åŒºåŸŸ.                                                                                                                                                                            |\r\n| isIntersecting     | è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼, å¦‚æœç›®æ ‡å…ƒç´ ä¸äº¤å‰åŒºåŸŸè§‚å¯Ÿè€…å¯¹è±¡(intersection observer) çš„æ ¹ç›¸äº¤ï¼Œåˆ™è¿”å› true .å¦‚æœè¿”å› true, åˆ™ IntersectionObserverEntry æè¿°äº†å˜æ¢åˆ°äº¤å‰æ—¶çš„çŠ¶æ€; å¦‚æœè¿”å› false, é‚£ä¹ˆå¯ä»¥ç”±æ­¤åˆ¤æ–­,å˜æ¢æ˜¯ä»äº¤å‰çŠ¶æ€åˆ°éäº¤å‰çŠ¶æ€. |\r\n| rootBounds         | è¿”å›ä¸€ä¸ª DOMRectReadOnly ç”¨æ¥æè¿°äº¤å‰åŒºåŸŸè§‚å¯Ÿè€…(intersection observer)ä¸­çš„æ ¹.                                                                                                                                                       |\r\n| target             | ä¸æ ¹å‡ºç°ç›¸äº¤åŒºåŸŸæ”¹å˜çš„å…ƒç´  (Element).                                                                                                                                                                                               |\r\n| time               | è¿”å›ä¸€ä¸ªè®°å½•ä» IntersectionObserver çš„æ—¶é—´åŸç‚¹(time origin)åˆ°äº¤å‰è¢«è§¦å‘çš„æ—¶é—´çš„æ—¶é—´æˆ³(DOMHighResTimeStamp).                                                                                                                         |\r\n\r\n## å®ç°\r\n\r\nä¸Šé¢å·²ç»å®ç°åˆ¤æ–­å…ƒç´ æ˜¯å¦å¯è§ï¼Œä¸‹é¢æˆ‘ä»¬åªéœ€è¦æ ¹æ®ä¸Šé¢æ€è·¯å®Œå–„ä¸€ä¸‹å³å¯å¼€å‘ä¸€ä¸ªå›¾ç‰‡æ‡’åŠ è½½çš„ç±»ï¼Œé¦–å…ˆå…ˆè¯´æ˜ä¸€ä¸‹å›¾ç‰‡æ‡’åŠ è½½ä¸€èˆ¬æƒ…å†µä¸‹ä¸ºäº†é˜²æ­¢å›¾ç‰‡`src`ä¸ºç©ºæ ·å¼ä¸ç»Ÿä¸€å’ŒåŠ è½½å›¾ç‰‡çªç„¶æ‹‰ä¼¸ç©ºé—´ï¼Œä¼šç»™é»˜è®¤çš„å›¾ç‰‡è®¾ç½®ä¸€ä¸ªå ä½å›¾ç‰‡ï¼Œæˆ–è€…ç»™å®šä¸€ä¸ªæ ·å¼\r\n\r\n```css\r\nimg {\r\n  width: 400px;\r\n  height: 400px;\r\n  display: inline-block;\r\n}\r\n```\r\n\r\n```html\r\n<img />\r\n```\r\n\r\nä¸Šé¢ç»™äº†ä¸€ä¸ªç®€å•çš„æ¼”ç¤ºï¼Œæ³¨æ„ `src` å±æ€§ä¸è¦å†™ï¼Œå› ä¸ºå³ä½¿ä¸ºç©ºä¹Ÿè¿˜ä¼šåŠ è½½ã€‚ é¡ºä¾¿è¯´ä¸‹ç«ç‹æµè§ˆå™¨å¦‚æœ img æ ‡ç­¾æ²¡æœ‰å…¶ä»–å±æ€§çš„è¯ä¼šç†è§£æˆå†…è”å…ƒç´ ï¼Œå°±æ˜¯ span æ ‡ç­¾ä¸€æ ·çš„å†…è”å…ƒç´ ï¼Œæ‰€ä»¥å¦‚æœä¸æ”¾ç½®å ä½å›¾ç‰‡çš„è¯æ¨èé‡ç½® img ä¸º `inline-block` ç„¶åè®¾ç½®å›ºå®šå®½é«˜ã€‚\r\n\r\nä¹‹åå°±æ˜¯ç»™å›¾ç‰‡åŠ¨æ€æ·»åŠ  src å±æ€§ï¼Œæ¯”è¾ƒæ¨èçš„æ˜¯`data-`çš„è‡ªå®šä¹‰å±æ€§ï¼Œè®¸å¤šåº“ç”¨çš„ä¹Ÿæ˜¯è¿™ä¸ªæ–¹æ³•ï¼Œæ›¿æ¢å®Œæˆä¹‹åå°†å›¾ç‰‡å…ƒç´ ä»`IntersectionObserver`ç§»é™¤ã€‚\r\n\r\n## æœ€å\r\n\r\n`IntersectionObserver`ä½¿ç”¨çš„æ˜¯å¼‚æ­¥çš„æ–¹å¼ï¼Œå¯ä»¥ä¸ç”¨æ‹…å¿ƒæ€§èƒ½é—®é¢˜\r\n\r\n- å‚è€ƒ\r\n  [IntersectionObserver MDN](https://developer.mozilla.org/zh-CN/docs/Web/API/IntersectionObserver/IntersectionObserver)\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/42/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/42/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/28",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/28/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/28/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/28/events",
          "html_url": "https://github.com/bosens-China/blog/issues/28",
          "id": 499359943,
          "node_id": "MDU6SXNzdWU0OTkzNTk5NDM=",
          "number": 28,
          "title": "MatchMedia API",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1580833992,
              "node_id": "MDU6TGFiZWwxNTgwODMzOTky",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%AE%9E%E9%AA%8C%E6%80%A7%20API",
              "name": "å®éªŒæ€§ API",
              "color": "7aa9d6",
              "default": false,
              "description": "è¿˜æœªå®šç¨¿çš„API"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2019-09-27T10:12:54Z",
          "updated_at": "2019-09-27T10:14:33Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "\r\n![456](https://user-images.githubusercontent.com/39508895/65761913-63d54580-e152-11e9-89e1-76f82d5df39f.jpg)\r\n\r\n\r\n> æ³¨æ„`matchMedia`ä¸ºå®éªŒæ€§è¯­æ³•æ–‡æ¡£å¯èƒ½è¢«é‡æ–°ä¿®è®¢ï¼Œåé¢æœ‰å¯èƒ½ä¼šæ”¹å˜è¯­æ³•ï¼Œåœ¨ç”Ÿäº§ä¸­è¯·é…åˆ[matchMedia polyfill](https://github.com/paulirish/matchMedia.js)ä½¿ç”¨\r\n\r\né€šè¿‡åª’ä½“æŸ¥è¯¢ï¼Œæ‚¨å¯ä»¥æ ¹æ®å„ç§è®¾å¤‡ç‰¹å¾å’Œå‚æ•°çš„å€¼æˆ–è€…æ˜¯å¦å­˜åœ¨æ¥è°ƒæ•´æ‚¨çš„ç½‘ç«™æˆ–åº”ç”¨ï¼›\r\n\r\nä¸Šé¢æ˜¯ MDN å¯¹åª’ä½“æŸ¥è¯¢çš„å®šä¹‰ï¼Œç®€å•æƒ…å†µé€šè¿‡ css åª’ä½“æŸ¥è¯¢ è°ƒæ•´é¡µé¢å·²ç»è¶³å¤Ÿäº†ï¼Œä¸è¿‡ç°åœ¨é¡µé¢äº¤äº’å’ŒåŠŸèƒ½è¶Šæ¥è¶Šå¤šï¼Œæ¯”å¦‚ä¸€ä¸ªé¡µé¢è¦å“åº”å¼å¸ƒå±€ï¼ŒåŒæ—¶åœ¨ä¸åŒå±å¹•ä¸‹é¡µé¢ç»“æ„ä¸åŒï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰æœ‰äº›åŠ›ä¸ä»å¿ƒäº†ï¼Œä¸‹é¢ä»‹ç»ä¸€ä¸‹`matchMedia`ã€‚\r\n\r\n## ä½¿ç”¨æ–¹æ³•\r\n\r\n```js\r\nvar mqList = window.matchMedia(mediaQueryString);\r\n```\r\n\r\nmatchMedia å¯ä»¥å®ç°ç¼–ç¨‹æ–¹æ³•å¼åª’ä½“æŸ¥è¯¢ï¼Œå‚æ•°`mediaQueryString`ä¸ºåª’ä½“è¯­å¥ï¼Œè¿”å›ç±»å‹ä¸º`MediaQueryList`ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­\r\n\r\n```js\r\nif (window.matchMedia(\"(min-width: 400px)\").matches) {\r\n  // çª—å£å¤§äºç­‰äº400 æƒ…å†µ\r\n} else {\r\n  // çª—å£å°äº400\r\n}\r\n```\r\n\r\n## MediaQueryListÂ \r\n\r\n- å±æ€§\r\n\r\n  - matches:booleanï¼š å¦‚æœå½“å‰ document åŒ¹é…è¯¥åª’ä½“æŸ¥è¯¢åˆ—è¡¨åˆ™å…¶å€¼ä¸º trueï¼›åä¹‹å…¶å€¼ä¸º falseã€‚åªè¯»ï¼›\r\n  - media:DOMString åºåˆ—åŒ–çš„åª’ä½“æŸ¥è¯¢åˆ—è¡¨ï¼›\r\n\r\n- æ–¹æ³•\r\n  - addListener(call: Function):void\r\n  - removeListener(call: Function):void\r\n\r\n### addListener\r\n\r\n```js\r\nMediaQueryList.addListener(func);\r\n```\r\n\r\nfunc æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œåˆç‰ˆå‚æ•°çš„ç±»å‹ä¸º[MediaQueryListListener ](https://developer.mozilla.org/en-US/docs/Web/API/MediaQueryListListener)æ–°ä¿®è®¢çš„å‚æ•°ç±»å‹ä¸º[MediaQueryListEvent,](https://developer.mozilla.org/en-US/docs/Web/API/MediaQueryListEvent)\r\n\r\n```js\r\nvar mql = window.matchMedia(\"(max-width: 600px)\");\r\n\r\nfunction screenTest(e) {\r\n  if (e.matches) {\r\n    // å±å¹•å°äºç­‰äº600\r\n  } else {\r\n    // å±å¹•å¤§äº600\r\n  }\r\n}\r\nmql.addListener(screenTest);\r\n```\r\n\r\n### removeListener\r\n\r\n```js\r\nMediaQueryList.removeListener(func);\r\n```\r\n\r\nfunc è¡¨ç¤ºè¦åˆ é™¤çš„å›è°ƒå‡½æ•°çš„å‡½æ•°æˆ–å‡½æ•°å¼•ç”¨\r\n\r\n```js\r\nvar mql = window.matchMedia(\"(max-width: 600px)\");\r\n\r\nfunction screenTest(e) {\r\n  if (e.matches) {\r\n    // å±å¹•å°äºç­‰äº600\r\n  } else {\r\n    // å±å¹•å¤§äº600\r\n  }\r\n}\r\n\r\nmql.addListener(screenTest);\r\n\r\n// å–æ¶ˆç›‘å¬\r\nmql.removeListener(screenTest);\r\n```\r\n\r\n## å‚è€ƒ\r\n\r\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaQueryList/media\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/28/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/28/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/26",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/26/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/26/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/26/events",
          "html_url": "https://github.com/bosens-China/blog/issues/26",
          "id": 498112062,
          "node_id": "MDU6SXNzdWU0OTgxMTIwNjI=",
          "number": 26,
          "title": "ResizeObserver API",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1580833992,
              "node_id": "MDU6TGFiZWwxNTgwODMzOTky",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E5%AE%9E%E9%AA%8C%E6%80%A7%20API",
              "name": "å®éªŒæ€§ API",
              "color": "7aa9d6",
              "default": false,
              "description": "è¿˜æœªå®šç¨¿çš„API"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2019-09-25T07:51:27Z",
          "updated_at": "2019-09-27T02:03:01Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "\r\n![123](https://user-images.githubusercontent.com/39508895/65580529-6d24ad80-dfac-11e9-868f-328d7427391e.jpg)\r\n\r\næ— æ„ä¹‹é—´çœ‹åˆ°è¿™ä¸ª APIï¼Œå‘ç°è¿™ä¸ª API ååˆ†å®ç”¨ç‰¹æ¥åˆ†äº«ä¸€ä¸‹ã€‚\r\n\r\nResizeObserver å¯ä»¥ç›‘å¬åˆ° Element çš„å…ƒç´ çš„å˜åŒ–ï¼Œä¾‹å¦‚å¤§å°å˜åŒ–ï¼Œåœ¨ä¹‹å‰æˆ‘ä»¬å¯èƒ½è¦ç›‘å¬ window å¯¹è±¡ï¼Œå› ä¸º resize å®šä¹‰åœ¨ window ä¸Šï¼Œä¸è¿‡æ³¨æ„è¿™ä¸ª API è¿˜æ˜¯å¤„äºå®éªŒæ€§é˜¶æ®µï¼Œåœ¨é¡¹ç›®ä¸­è¦é…åˆ [polyfill](https://github.com/que-etc/resize-observer-polyfill) æ¥ä½¿ç”¨\r\n\r\n## constructor\r\n\r\n```js\r\nvar ResizeObserver = new ResizeObserver(callback);\r\n```\r\n\r\nä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼ŒResizeObserver æ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå½“å°ºå¯¸å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ `callback` å‡½æ•°æ¥æ”¶ä¸€ä¸ª `ResizeObserverEntry` æ•°ç»„ï¼Œä¸‹é¢çœ‹ä¸€ä¸ªä¾‹å­\r\n\r\n```html\r\n<div class=\"box\"></div>\r\n<script>\r\n  const box = document.querySelector(\".box\");\r\n  const resizeObserver = new ResizeObserver(entries => {\r\n    for (let entry of entries) {\r\n      const dimensions = entry.contentRect;\r\n      console.log(`${dimensions.width} x ${dimensions.height}`);\r\n    }\r\n  });\r\n  resizeObserver.observe(box);\r\n  setTimeout(() => {\r\n    box.style.width = \"99px\";\r\n  }, 1000);\r\n</script>\r\n```\r\n\r\nä¸Šé¢å®šä¹‰äº†ä¸€ä¸ª box çš„å…ƒç´ ï¼Œå¹¶åœ¨ä¸€ç§’åæ›´æ”¹å®½åº¦ `ResizeObserver` å¯ä»¥ç›‘å¬åˆ°è¿™ä¸€æ›´æ”¹ã€‚\r\n\r\n> ç‰¹åˆ«æé†’ä¸€ä¸‹ï¼Œæ·»åŠ åˆå§‹å…ƒç´ çš„æ—¶å€™é»˜è®¤å°±ä¼šæ‰§è¡Œæ‰§è¡Œä¸€æ¬¡å›è°ƒï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ç”¨æ‰‹åŠ¨æ‰§è¡Œä¸€æ¬¡è·å–åˆå§‹ä¿¡æ¯äº†ã€‚\r\n\r\n## ResizeObserverEntry\r\n\r\nä½ å¯èƒ½å¥½å¥‡ ResizeObserverEntry ä¼šè¿”å›ä»€ä¹ˆæ ¼å¼çš„æ•°æ®ï¼Ÿ\r\nå®ƒç”±ä¸¤éƒ¨åˆ†ç»„æˆ\r\n\r\n- target\r\n  target å¾ˆå¥½ç†è§£å°±æ˜¯æˆ‘ä»¬æ·»åŠ çš„å…ƒç´ \r\n\r\n- contentRect\r\n  contentRect å…¶å®å°±æ˜¯ä¸€ä¸ªç›’å­ä¿¡æ¯ï¼Œå®ƒçš„ç±»å‹æ˜¯ [DOMRectReadOnly](https://developer.mozilla.org/zh-CN/docs/Web/API/DOMRectReadOnly),æœ‰ä»¥ä¸‹å‡ ä¸ªå±æ€§\r\n  - bottom\r\n    è¿”å›çš„åº•éƒ¨åæ ‡å€¼ï¼ˆé€šå¸¸ä¸ y + é«˜åº¦ç›¸åŒï¼‰\r\n  - height\r\n    é«˜åº¦\r\n  - width\r\n    å®½åº¦\r\n  - left\r\n    è¿”å›çš„å·¦åæ ‡å€¼ï¼ˆé€šå¸¸ä¸ x ç›¸åŒï¼‰\r\n  - right\r\n    è¿”å›çš„å³åæ ‡å€¼ï¼ˆé€šå¸¸ä¸ x + width ç›¸åŒï¼‰\r\n  - top\r\n    è¿”å›çš„é¡¶éƒ¨åæ ‡å€¼ï¼ˆé€šå¸¸ä¸ y ç›¸åŒï¼‰\r\n  - x\r\n    åŸç‚¹çš„ x åæ ‡\r\n  - y\r\n    åŸç‚¹çš„ y åæ ‡\r\n\r\n## æ–¹æ³•\r\n\r\n### observe\r\n\r\n```js\r\nresizeObserver.observe(target);\r\n```\r\n\r\nä¸Šé¢çš„ç¤ºä¾‹ä¸­ä¹Ÿæœ‰ç”¨åˆ°è¿™ä¸ªæ–¹æ³•ï¼Œç”¨äºæ·»åŠ ç›‘å¬çš„å…ƒç´ ï¼Œæ³¨æ„ target çš„ç±»å‹å¿…é¡»æ˜¯ Element æˆ– SVGElement å¼•ç”¨ã€‚\r\n\r\n### disconnect\r\n\r\n```js\r\nresizeObserver.disconnect();\r\n```\r\n\r\nåœæ­¢å’Œå–æ¶ˆç›®æ ‡å¯¹è±¡ä¸Šæ‰€æœ‰å¯¹ Element æˆ– SVGElement çš„ç›‘å¬ã€‚\r\n\r\n### unobserve\r\n\r\n```js\r\nresizeObserver.unobserve(target);\r\n```\r\n\r\næ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œåœæ­¢å¯¹æŒ‡å®šç›®æ ‡çš„ç›‘å¬ï¼Œtarget çš„ç±»å‹ä¸º Element æˆ– SVGElement å¼•ç”¨\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/26/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/26/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        }
      ]
    ],
    [
      "1740561541",
      [
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/43",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/43/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/43/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/43/events",
          "html_url": "https://github.com/bosens-China/blog/issues/43",
          "id": 544505720,
          "node_id": "MDU6SXNzdWU1NDQ1MDU3MjA=",
          "number": 43,
          "title": "ä»formè¡¨å•æ¥çœ‹ç­–ç•¥æ¨¡å¼",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1740561541,
              "node_id": "MDU6TGFiZWwxNzQwNTYxNTQx",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F",
              "name": "è®¾è®¡æ¨¡å¼",
              "color": "d1a540",
              "default": false,
              "description": "è®¾è®¡æ¨¡å¼åœ¨JavaScriptçš„å®ç°"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2020-01-02T09:36:08Z",
          "updated_at": "2021-12-21T09:47:57Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "### å‰è¨€\r\n\r\nä¹‹å‰å†™ç¨‹åºçš„æ—¶å€™ä¸ºäº†å¿«é€Ÿå¼€å‘å†™äº†è®¸å¤š`if`ã€`else if`çš„è¯­å¥ï¼Œå½“æ—¶å¼€å‘å€’æ˜¯æŒºçˆ½çš„ï¼Œäº‹åç»´æŠ¤çš„æ—¶å€™æƒ³éª‚äººï¼Œä¸ºäº†ä¸å‘è‡ªå·±å’Œå…¶ä»–å°ä¼™ä¼´ï¼Œä¸‹é¢ä»é›¶å¼€å§‹ç”¨ä¸€ä¸ªåŸºç¡€è¡¨å• + ç­–ç•¥æ¨¡å¼æ¸…é™¤`if`åˆ†æ”¯è¯­å¥\r\n\r\n```html\r\n<form class=\"cs-form\">\r\n  <label>\r\n    <span>è´¦å·ï¼š</span>\r\n    <input name=\"account\" type=\"text\" />\r\n  </label>\r\n  <label>\r\n    <span>å¯†ç ï¼š</span>\r\n    <input name=\"password\" type=\"password\" />\r\n  </label>\r\n  <label>\r\n    <span>æ‰‹æœºå·ï¼š</span>\r\n    <input name=\"mobile\" type=\"number\" />\r\n  </label>\r\n  <button class=\"submit\" type=\"submit\">ç™»å½•</button>\r\n</form>\r\n```\r\n\r\nä¸Šé¢æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„è¡¨å•å…ƒç´ ï¼Œé‡Œé¢æœ‰è´¦å·å’Œå¯†ç ä»¥åŠæ‰‹æœºå·ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æäº¤ä¹‹å‰å¯¹ä»–è¿›è¡Œä¸€äº›æ ¡éªŒï¼Œè¿™é‡Œé»˜è®¤çš„è§„åˆ™æ˜¯è´¦å·å’Œå¯†ç ä¸èƒ½ä¸ºç©ºï¼Œæ‰‹æœºå·çš„é•¿åº¦å¿…é¡»æ˜¯ 11 çš„çº¯æ•°å­—ã€‚\r\n\r\n### ç¬¬ä¸€ç‰ˆ\r\n\r\n```ts\r\ninterface Iform {\r\n  [k: string]: any;\r\n  account: HTMLInputElement;\r\n  password: HTMLInputElement;\r\n  mobile: HTMLInputElement;\r\n}\r\nconst form = document.querySelector(\".cs-form\") as HTMLFormElement;\r\n\r\nform.addEventListener(\"submit\", function(e) {\r\n  e.preventDefault();\r\n  const { account, password, mobile } = (form as unknown) as Iform;\r\n  if (!account.value) {\r\n    // æç¤º\r\n    alert(\"è¯·è¾“å…¥è´¦å·\");\r\n    return false;\r\n  }\r\n  if (!password.value) {\r\n    // æç¤º\r\n    alert(\"è¯·è¾“å…¥å¯†ç \");\r\n    return false;\r\n  }\r\n  if (!/\\d{11}/.test(mobile.value)) {\r\n    // æç¤º\r\n    alert(\"è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·\");\r\n    return false;\r\n  }\r\n  return false;\r\n});\r\n```\r\n\r\næ ¹æ®ä¸Šé¢çš„è¦æ±‚ï¼Œæˆ‘ä»¬å®ç°äº†ç¬¬ä¸€ç‰ˆä»£ç ï¼Œä»ä»£ç çš„å®ç°çœ‹æ¯«æ— ç–‘é—®æ˜¯æ­£ç¡®çš„ï¼Œä¸ºäº†å¯¹æ¯”ä¸‹é¢å†ç”¨ç­–ç•¥æ¨¡å¼å®ç°ä»¥ä¸‹ä¸Šè¿°çš„åŠŸèƒ½\r\n\r\n### ç¬¬äºŒç‰ˆ\r\n\r\n```ts\r\ninterface Iform {\r\n  [k: string]: any;\r\n  account: HTMLInputElement;\r\n  password: HTMLInputElement;\r\n  mobile: HTMLInputElement;\r\n}\r\n\r\ninterface Ilist {\r\n  value: string;\r\n  type: name;\r\n  msg: string;\r\n}\r\n\r\ntype name = keyof typeof rule;\r\nconst rule = {\r\n  account(value: string, msg: string) {\r\n    if (!value) {\r\n      return msg;\r\n    }\r\n  },\r\n  password(value: string, msg: string) {\r\n    if (!value) {\r\n      return msg;\r\n    }\r\n  },\r\n  mobile(value: string, msg: string) {\r\n    if (!/\\d{11}/.test(value)) {\r\n      return msg;\r\n    }\r\n  }\r\n};\r\nclass Verification {\r\n  private list: Ilist[] = [];\r\n  public message: string;\r\n  add<T extends { value: string }>(dom: T, type: name, msg: string) {\r\n    this.list.push({\r\n      value: dom.value,\r\n      type: type,\r\n      msg: msg\r\n    });\r\n  }\r\n  start(): boolean {\r\n    for (let i = 0; i < this.list.length; i++) {\r\n      const { value, type, msg } = this.list[i];\r\n      const fn = rule[type](value, msg);\r\n      if (fn) {\r\n        this.message = msg;\r\n        return false;\r\n      }\r\n    }\r\n    this.message = \"\";\r\n    return true;\r\n  }\r\n}\r\n\r\nconst form = document.querySelector(\".cs-form\") as HTMLFormElement;\r\n\r\nform.addEventListener(\"submit\", function(e) {\r\n  e.preventDefault();\r\n  const { account, password, mobile } = (form as unknown) as Iform;\r\n\r\n  const ruleSet = new Verification();\r\n  ruleSet.add(account, \"account\", \"è¯·è¾“å…¥è´¦å·\");\r\n  ruleSet.add(password, \"password\", \"è¯·è¾“å…¥å¯†ç \");\r\n  ruleSet.add(mobile, \"mobile\", \"è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·\");\r\n\r\n  if (!ruleSet.start()) {\r\n    // æç¤º\r\n    alert(ruleSet.message);\r\n    return false;\r\n  }\r\n  return false;\r\n});\r\n```\r\n\r\nä»ä»£ç é‡çœ‹æ¯”ç¬¬ä¸€ç‰ˆå¤šå‡ºäº†å¾ˆå¤šè¯­å¥ï¼Œè¿™é‡Œåšæ³•æ˜¯æŠŠä»£ç çš„è§„åˆ™æ”¾ç½®åœ¨ rule å¯¹è±¡ä¸­ï¼Œå› ä¸º javascript æœ¬èº«å°±æ˜¯è¿™ä¹ˆçµæ´»ä¸éœ€è¦åœ¨ä½¿ç”¨ä¼ ç»Ÿè¯­è¨€çš„ class æ¥å®ç°äº†ï¼Œå‰©ä¸‹çš„å°±æ˜¯æ–°å»ºä¸€ä¸ªæ ¡éªŒç±»ï¼Œæ–°å¢æ ¡éªŒè§„åˆ™æœ€åæ ¡éªŒï¼Œå½“ç„¶ç°åœ¨éªŒè¯è§„åˆ™è¿˜æ˜¯æ¯”è¾ƒå°‘ï¼Œçœ‹ä¸å‡ºç­–ç•¥æ¨¡å¼çš„ä¼˜ç‚¹ã€‚\r\n\r\nä¸‹é¢å†æ¥æ–°å¢ä¸€ä¸ªè¦æ±‚ï¼Œå¯†ç é•¿åº¦ä¸èƒ½å°äº 6 ä½ï¼Œåœ¨ç¬¬ä¸€ç‰ˆä¸­æˆ‘ä»¬è¦ç´§æ¥åœ¨å¯†ç ä¸èƒ½ä¸ºç©ºçš„æ ¡éªŒä¹‹åå†™ï¼Œå†æ¥çœ‹ä¸‹ç­–ç•¥æ¨¡å¼æ–°å¢è¿™ä¸ªéªŒè¯ä¼šæ–°å¢å“ªäº›ä»£ç ã€‚\r\n\r\n```ts\r\ninterface Iform {\r\n  [k: string]: any;\r\n  account: HTMLInputElement;\r\n  password: HTMLInputElement;\r\n  mobile: HTMLInputElement;\r\n}\r\n\r\ninterface Ilist {\r\n  value: string;\r\n  type: name;\r\n  msg: string;\r\n}\r\n\r\ntype name = keyof typeof rule;\r\nconst rule = {\r\n  account(value: string, msg: string) {\r\n    if (!value) {\r\n      return msg;\r\n    }\r\n  },\r\n  password(value: string, msg: string) {\r\n    if (!value) {\r\n      return msg;\r\n    }\r\n  },\r\n  // å¯†ç é•¿åº¦å°äº6çš„æ—¶å€™æç¤º\r\n  passwordMinLength(value: string, msg: string) {\r\n    if (value.length < 6) {\r\n      return msg;\r\n    }\r\n  },\r\n  mobile(value: string, msg: string) {\r\n    if (!/\\d{11}/.test(value)) {\r\n      return msg;\r\n    }\r\n  }\r\n};\r\nclass Verification {\r\n  private list: Ilist[] = [];\r\n  public message: string;\r\n  add<T extends { value: string }>(dom: T, type: name, msg: string) {\r\n    this.list.push({\r\n      value: dom.value,\r\n      type: type,\r\n      msg: msg\r\n    });\r\n  }\r\n  start(): boolean {\r\n    for (let i = 0; i < this.list.length; i++) {\r\n      const { value, type, msg } = this.list[i];\r\n      const fn = rule[type](value, msg);\r\n      if (fn) {\r\n        this.message = msg;\r\n        return false;\r\n      }\r\n    }\r\n    this.message = \"\";\r\n    return true;\r\n  }\r\n}\r\n\r\nconst form = document.querySelector(\".cs-form\") as HTMLFormElement;\r\n\r\nform.addEventListener(\"submit\", function(e) {\r\n  e.preventDefault();\r\n  const { account, password, mobile } = (form as unknown) as Iform;\r\n\r\n  const ruleSet = new Verification();\r\n  ruleSet.add(account, \"account\", \"è¯·è¾“å…¥è´¦å·\");\r\n  ruleSet.add(password, \"password\", \"è¯·è¾“å…¥å¯†ç \");\r\n  ruleSet.add(password, \"passwordMinLength\", \"å¯†ç é•¿åº¦ä¸ç¬¦åˆè¦æ±‚\");\r\n  ruleSet.add(mobile, \"mobile\", \"è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·\");\r\n\r\n  if (!ruleSet.start()) {\r\n    // æç¤º\r\n    alert(ruleSet.message);\r\n    return false;\r\n  }\r\n  return false;\r\n});\r\n```\r\n\r\næŠŠå¯†ç ä¸èƒ½å°äºå…­ä½çš„è§„åˆ™æ·»åŠ åˆ°`rule`ä¸­ï¼Œä¹‹å add çš„æ—¶å€™æ·»åŠ å®ƒï¼Œè¿™é‡ŒåŸºæœ¬çš„æ ¡éªŒå…¶å®å°±å®Œæˆäº†ï¼Œä¸è¿‡ä»ä¸Šé¢çœ‹ï¼Œæˆ‘ä»¬çš„æ ¡éªŒè‚¯å®šä¸æ˜¯ä¸€ä¸ª input å°±å¯¹åº”ä¸€æ¡ï¼Œå®é™…ä¸Šä¼šå­˜åœ¨å¤šç§æ ¡éªŒï¼Œæ¯”å¦‚æœ€å°é•¿åº¦æœ€å¤§é•¿åº¦ï¼Œä¸èƒ½åŒ…å«æ•æ„Ÿè¯ç­‰ï¼Œæ·»åŠ å¤šæ¡è§„åˆ™ä¹Ÿæ˜¯å¾ˆåˆç†çš„è¦æ±‚ï¼Œä¸‹é¢å°±æ˜¯æœ€ç»ˆç‰ˆçš„å®ç°ã€‚\r\n\r\n### æœ€ç»ˆç‰ˆ\r\n\r\n```ts\r\ninterface Iform {\r\n  [k: string]: any;\r\n  account: HTMLInputElement;\r\n  password: HTMLInputElement;\r\n  mobile: HTMLInputElement;\r\n}\r\n\r\ninterface Ilist {\r\n  value: string;\r\n  type: name;\r\n  msg: string;\r\n}\r\ninterface Iadd {\r\n  type: name;\r\n  msg: string;\r\n}\r\n\r\ntype name = keyof typeof rule;\r\nconst rule = {\r\n  require(value: string, msg: string) {\r\n    if (!value) {\r\n      return msg;\r\n    }\r\n  },\r\n  minLength(value: string, msg: string) {\r\n    if (value.length < 6) {\r\n      return msg;\r\n    }\r\n  },\r\n  mobile(value: string, msg: string) {\r\n    if (!/\\d{11}/.test(value)) {\r\n      return msg;\r\n    }\r\n  }\r\n};\r\nclass Verification {\r\n  private list: Ilist[] = [];\r\n  public message: string;\r\n  // ç”¨å‡½æ•°é‡è½½çš„å½¢å¼å®ç°\r\n  add<T extends { value: string }>(dom: T, type: name, msg: string): void;\r\n  add<T extends { value: string }>(dom: T, ruleArr: Array<Iadd>): void;\r\n  add<T extends { value: string }>(\r\n    dom: T,\r\n    ruleArr: Array<Iadd> | name,\r\n    msg?: string\r\n  ): void {\r\n    if (Array.isArray(ruleArr)) {\r\n      this.list.push(\r\n        ...ruleArr.map(f => {\r\n          return {\r\n            value: dom.value,\r\n            type: f.type,\r\n            msg: f.msg\r\n          };\r\n        })\r\n      );\r\n    } else {\r\n      this.list.push({\r\n        value: dom.value,\r\n        type: ruleArr,\r\n        msg: msg\r\n      });\r\n    }\r\n  }\r\n  start(): boolean {\r\n    for (let i = 0; i < this.list.length; i++) {\r\n      const { value, type, msg } = this.list[i];\r\n      const fn = rule[type](value, msg);\r\n      if (fn) {\r\n        this.message = msg;\r\n        return false;\r\n      }\r\n    }\r\n    this.message = \"\";\r\n    return true;\r\n  }\r\n}\r\n\r\nconst form = document.querySelector(\".cs-form\") as HTMLFormElement;\r\n\r\nform.addEventListener(\"submit\", function(e) {\r\n  e.preventDefault();\r\n  const { account, password, mobile } = (form as unknown) as Iform;\r\n\r\n  const ruleSet = new Verification();\r\n  ruleSet.add(account, \"require\", \"è¯·è¾“å…¥è´¦å·\");\r\n  ruleSet.add(password, [\r\n    {\r\n      type: \"require\",\r\n      msg: \"è¯·è¾“å…¥å¯†ç \"\r\n    },\r\n    {\r\n      type: \"minLength\",\r\n      msg: \"å¯†ç é•¿åº¦ä¸ç¬¦åˆè¦æ±‚\"\r\n    }\r\n  ]);\r\n  ruleSet.add(mobile, [\r\n    {\r\n      type: \"require\",\r\n      msg: \"è¯·è¾“å…¥æ‰‹æœºå·\"\r\n    },\r\n    {\r\n      type: \"mobile\",\r\n      msg: \"è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·\"\r\n    }\r\n  ]);\r\n\r\n  if (!ruleSet.start()) {\r\n    // æç¤º\r\n    alert(ruleSet.message);\r\n    return false;\r\n  }\r\n  return false;\r\n});\r\n```\r\n\r\næ’’èŠ±ï¼Œè¿™é‡Œå°±å·²ç»å†™å®Œäº†ï¼Œæ•´ä½“æ¥çœ‹ä»£ç é‡è¿˜æ˜¯è›®å¤šçš„ï¼Œä¸»è¦æ˜¯ç”¨ ts å†™éœ€è¦å®šä¹‰å„ç§æ¥å£å’Œç±»å‹ï¼Œæœ€ç»ˆç‰ˆæœ¬çš„æ—¶å€™æˆ‘å°†ä¸Šè¿°çš„æ‰‹æœºå’Œè´¦å·çš„éªŒè¯æŠ½ç¦»æˆ require å‡½æ•°ï¼Œåç»­å¦‚æœæœ‰ç”¨åˆ°åªéœ€è¦åœ¨ `rule` è§„åˆ™ä¸­æ–°å¢å³å¯ã€‚\r\n\r\nå½“ç„¶å› ä¸ºåªæ˜¯è®²è§£ç­–ç•¥æ¨¡å¼çš„ä½¿ç”¨æ‰€ä»¥è¿™é‡Œå¹¶æ²¡æœ‰å¯¹è¿™ä¸ªæ ¡éªŒæ›´å®Œæ•´çš„å®šä¹‰ï¼Œå¦‚æœæœ‰è¿›ä¸€æ­¥éœ€è¦å¯ä»¥å°† min å’Œ max å±æ€§ä»¥åŠ regexp å±æ€§æ–°å¢ä¸Šï¼Œè¿›ä¸€æ­¥æé«˜æ ¡éªŒçš„è§„åˆ™\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/43/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/43/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/19",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/19/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/19/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/19/events",
          "html_url": "https://github.com/bosens-China/blog/issues/19",
          "id": 479944938,
          "node_id": "MDU6SXNzdWU0Nzk5NDQ5Mzg=",
          "number": 19,
          "title": "å•ä¾‹æ¨¡å¼",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1740561541,
              "node_id": "MDU6TGFiZWwxNzQwNTYxNTQx",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F",
              "name": "è®¾è®¡æ¨¡å¼",
              "color": "d1a540",
              "default": false,
              "description": "è®¾è®¡æ¨¡å¼åœ¨JavaScriptçš„å®ç°"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2019-08-13T03:44:23Z",
          "updated_at": "2021-12-21T09:43:21Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "å•ä¾‹æ¨¡å¼æ˜¯å¾ˆå¸¸è§çš„ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹ã€‚\r\n\r\n## å•ä¾‹å®ç°\r\n\r\næ ¹æ®ä¸Šé¢å®šä¹‰å¾ˆå®¹æ˜“æƒ³åˆ°ç”¨é—­åŒ…æ¥å®ç°\r\n\r\n```js\r\nvar dom = (function() {\r\n  var d;\r\n  function createdDiv(html) {\r\n    if (d) {\r\n      return d;\r\n    }\r\n    this.html = html;\r\n    this.init();\r\n    return (d = this);\r\n  }\r\n  createdDiv.prototype.init = function() {\r\n    var dom = document.createElement(\"div\");\r\n    dom.innerHTML = this.html;\r\n    document.body.append(dom);\r\n  };\r\n  return createdDiv;\r\n})();\r\nvar d1 = new dom(\"hello wrold\");\r\nvar d2 = new dom(\"ä½ å¥½ä¸–ç•Œ\");\r\nconsole.log(d1 === d2); // true\r\n```\r\n\r\nä¸Šé¢é€šè¿‡å˜é‡`d`æ¥åˆ¤æ–­ï¼Œæ²¡æœ‰å°±ç”Ÿæˆä¸€ä¸ª`div`ï¼Œæœ‰çš„è¯å°±è¿”å›`d`ï¼Œä¸è¿‡ä¸Šé¢ä»£ç ç”Ÿæˆå’Œä¿è¯å•ä¸€ç»„åˆåœ¨ä¸€èµ·å®é™…ä¸Šè¿åäº†é¢å‘å¯¹è±¡çš„å•ä¸€èŒè´£ï¼Œä¸‹é¢å°±ç”¨ä»£ç†çš„æ–¹å¼æ¥æ¸…é™¤è¿™ç§è€¦åˆã€‚\r\n\r\n## ä»£ç†\r\n\r\nè¿˜æ˜¯é€šè¿‡ä¸Šé¢ä»£ç ä¸ºä¾‹ï¼Œæˆ‘ä»¬é€šè¿‡è§‚å¯Ÿå‘ç°`createdDiv`å‡½æ•°è´Ÿè´£`div`çš„åˆ›å»ºå’Œç”Ÿæˆï¼Œå¦‚ä½•ä¿è¯ç±»çš„å•ä¸€ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦å¤–ä¸€ä¸ªå‡½æ•°æ¥æ£€æµ‹å’Œè¿”å›ã€‚\r\n\r\n```js\r\nvar dom = (function() {\r\n  var d;\r\n  function createdDiv(html) {\r\n    this.html = html;\r\n    this.init();\r\n  }\r\n  createdDiv.prototype.init = function() {\r\n    var dom = document.createElement(\"div\");\r\n    dom.innerHTML = this.html;\r\n    document.body.append(dom);\r\n  };\r\n  return function(h) {\r\n    if (!d) {\r\n      d = new createdDiv(h);\r\n    }\r\n    return d;\r\n  };\r\n})();\r\nvar d1 = new dom(\"hello wrold\");\r\nvar d2 = new dom(\"ä½ å¥½ä¸–ç•Œ\");\r\nconsole.log(d1 === d2); // true\r\n```\r\n\r\n## æƒ°æ€§\r\n\r\nä»¥å…¼å®¹ dom äº‹ä»¶ä¸ºä¾‹ï¼Œie æœ‰è‡ªå·±çš„ dom äº‹ä»¶æ·»åŠ æ–¹æ³•ï¼Œå¦‚æœæˆ‘ä»¬è¦å†™ä¸€ä¸ªå…¼å®¹çš„å‡½æ•°å¯èƒ½ä¼šè¿™æ ·å†™\r\n\r\n```js\r\nfunction addEvent(type, el, fn) {\r\n  if (window.addEventListener) {\r\n    el.addEventListener(type, fn, false);\r\n  } else if (window.attachEvent) {\r\n    el.attachEvent(\"on\" + type, fn);\r\n  }\r\n}\r\n```\r\n\r\nä¸è¿‡è¿™é‡Œæ¯æ¬¡è¿è¡Œå‡½æ•°éƒ½ä¼šåˆ¤æ–­ä¸€æ¬¡ï¼Œå®é™…ä¸Šæ²¡æœ‰å¿…è¦ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é—­åŒ…çš„å½¢å¼åªåˆ¤æ–­ä¸€æ¬¡\r\n\r\n```js\r\nfunction addEvent(type, el, fn) {\r\n  if (window.addEventListener) {\r\n    return function() {\r\n      el.addEventListener(type, fn, false);\r\n    };\r\n  } else if (window.attachEvent) {\r\n    return function() {\r\n      el.attachEvent(\"on\" + type, fn);\r\n    };\r\n  }\r\n}\r\n```\r\n\r\næƒ°æ€§çš„åº”ç”¨å¾ˆå¹¿æ³›ï¼Œè®¸å¤šä¼˜åŒ–ä¹Ÿç‰µæ‰¯å…¶ä¸­ï¼Œæ¯”å¦‚ webpack å¯¹`import()`å¯ä»¥åšåˆ°ä»£ç åˆ†å‰²ï¼Œå‡å°‘é¦–å±åŠ è½½æ—¶é—´ã€‚\r\n\r\n## ä¿¡ä»»å‡½æ•°\r\n\r\nè¿˜æ˜¯é€šè¿‡æƒ°æ€§çš„ä¾‹å­ä¸ºä¾‹ï¼Œæˆ‘ä»¬ç”¨äº†ä¸€ä¸ªé—­åŒ…æ¥å®ç°ï¼Œä¸è¿‡ä¹Ÿå¯ä»¥é€šè¿‡æ”¹å†™è¿™ä¸ªå‡½æ•°æ¥å®ç°\r\n\r\n```js\r\nfunction addEvent(type, el, fn) {\r\n  if (window.addEventListener) {\r\n    addEvent = function(type, el, fn) {\r\n      el.addEventListener(type, fn, false);\r\n    };\r\n  } else if (window.attachEvent) {\r\n    addEvent = function(type, el, fn) {\r\n      el.attachEvent(\"on\" + type, fn);\r\n    };\r\n  }\r\n}\r\n```\r\n\r\n## es6 ä¹‹åçš„å•ä¾‹\r\n\r\nåœ¨ javascript ä¸­å•ä¾‹å®é™…ä¸Šæœ‰äº›ç‰¹æ®Šï¼Œå› ä¸ºå¹¶æ²¡æœ‰ç±»ï¼Œè€Œä¸”å•ä¾‹çš„ä½œç”¨åªæ˜¯ä¸ºäº†ä¿è¯ç±»çš„å•ä¸€æ€§ï¼Œé‚£æˆ‘ä»¬å¯ä»¥ç›´æ¥å®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡å°±å¯ä»¥åšåˆ°äº†\r\n\r\n```js\r\nvar a = {};\r\n```\r\n\r\nè¿™é‡Œ`a`åœ¨å…¨å±€åªä¼šå­˜åœ¨ä¸€æ¬¡ï¼Œä¸è¿‡ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯ä¼šè¢«è¦†ç›–å’Œä¿®æ”¹ä»¥åŠæ±¡æŸ“äº†å…¨å±€å˜é‡ï¼Œè€Œä» es6 å¼€å§‹å¼•ç”¨äº†æ¨¡å—çš„æœºåˆ¶ï¼Œå®ƒæœ‰äº›ç‰¹æ®Šï¼Œå®ƒæ˜¯è¿è¡Œå‰åŠ è½½ï¼Œè€Œä¸”ä¼šå°†æ¨¡å—çš„å€¼åŠ¨æ€åŒæ­¥ï¼Œæ€ä¹ˆç†è§£è¿™å¥è¯å‘¢ï¼Ÿ\r\n\r\n```js\r\nlet d = 5;\r\nsetTimeout(() => {\r\n  d = 10;\r\n}, 1000);\r\nexport { d };\r\n// å¼•ç”¨\r\n\r\nimport { d } from \"./demo.js\";\r\nconsole.log(d);\r\nsetTimeout(() => {\r\n  console.log(d);\r\n}, 1000);\r\n```\r\n\r\nä¸Šé¢ä¼šè¾“å‡º 5 å’Œ 10,æ‰€ä»¥æ ¹æ®æ¨¡å—è¿™ä¸€ç‰¹æ€§å¯ä»¥å¾ˆè½»æ¾å®ç°å•ä¾‹æ¨¡å¼\r\n\r\n```js\r\nlet event;\r\nif (!event) {\r\n  if (window.addEventListener) {\r\n    event = function(type, el, fn) {\r\n      el.addEventListener(type, fn, false);\r\n    };\r\n  } else if (window.attachEvent) {\r\n    event = function(type, el, fn) {\r\n      el.attachEvent(\"on\" + type, fn);\r\n    };\r\n  }\r\n}\r\nexport default event;\r\n```\r\n\r\n## æœ€å\r\n\r\nä¸Šé¢ç®€å•ä»‹ç»äº†å•ä¾‹çš„ä¼ ç»Ÿå®ç°ï¼Œä»¥åŠåœ¨ javascript ä¸­çš„å®ç°ï¼Œæœ€åé¢å¤–æä¸€ä¸‹ï¼Œes6 æ–°å¢çš„`symbol`ä¹Ÿå¯ä»¥è·Ÿå•ä¾‹æƒ³ç»“åˆä½¿ç”¨ï¼Œå®ƒç¡®ä¿äº†è¿™ä¸ªå±æ€§åæ˜¯å”¯ä¸€çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡`symbol.for`æ¥åˆ¤æ–­æœ‰æ²¡æœ‰è¿™ä¸ª`symbol`\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/19/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/19/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/20",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/20/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/20/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/20/events",
          "html_url": "https://github.com/bosens-China/blog/issues/20",
          "id": 480491465,
          "node_id": "MDU6SXNzdWU0ODA0OTE0NjU=",
          "number": 20,
          "title": "å‘å¸ƒè®¢é˜…æ¨¡å¼",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1740561541,
              "node_id": "MDU6TGFiZWwxNzQwNTYxNTQx",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F",
              "name": "è®¾è®¡æ¨¡å¼",
              "color": "d1a540",
              "default": false,
              "description": "è®¾è®¡æ¨¡å¼åœ¨JavaScriptçš„å®ç°"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2019-08-14T05:44:57Z",
          "updated_at": "2021-12-21T09:42:53Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "å‘å¸ƒè®¢é˜…æ¨¡å¼ä¹Ÿæˆä¸ºè§‚å¯Ÿè€…æ¨¡å¼ï¼Œä»¥ä¸‹é¢ä¸‰éƒ¨åˆ†ç»„æˆ\r\n\r\n1. å‘å¸ƒè€…\r\n2. è®¢é˜…è€…\r\n3. æ¶ˆæ¯é˜Ÿåˆ—\r\n\r\nä¸Šé¢ä»‹ç»äº†ç»„æˆå¯èƒ½ä½ è¿˜æœ‰ç–‘æƒ‘ï¼Œä¸‹é¢å°±ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå°æ˜æ‰“ç®—å»å”®æ¥¼å¤„å»ä¹°ä¸€å¥—æˆ¿å­ï¼Œé”€å”®å°å§å‘Šè¯‰ä»–è¿™å¥—ä½å®…æš‚æ—¶æ²¡æœ‰æˆ¿æºï¼Œå°æ˜äºæ˜¯ç•™äº†æ‰‹æœºå·ç ç»™ä»–ï¼ŒæŸä¸€å¤©æœ‰æˆ¿æºçš„æ—¶å€™é€šçŸ¥ä»–ã€‚\r\nä¸Šé¢ä¾‹å­ä¸­ï¼Œå‘å¸ƒè€…å°±æ˜¯å”®æ¥¼ä¸­å¿ƒï¼Œè®¢é˜…è€…å°±æ˜¯å°æ˜ï¼Œæ¶ˆæ¯é˜Ÿåˆ—å°±æ˜¯å°æ˜ç•™çš„æ‰‹æœºå·ç ï¼Œè§‚å¯Ÿè€…æ¨¡å¼å¯ä»¥è®©å¯¹è±¡æ¾è€¦åˆåœ¨ä¸€èµ·ã€‚\r\n\r\n## å®ç°\r\n\r\n> ä¸‹é¢ä½¿ç”¨ ES6 çš„è¯­æ³•æ¥å†™ï¼Œå¦‚æœæ²¡æœ‰åŸºç¡€ï¼Œæ¨èçœ‹ä¸€é es6 å…¥é—¨å†æ¥\r\n\r\nä¸Šé¢ä»‹ç»äº†å®šä¹‰ï¼Œå°±æ ¹æ®ä¸Šé¢çš„å®šä¹‰ç¼–å†™ä¸€ä¸ªå¯ä»¥å–æ¶ˆä»¥åŠæ”¯æŒä¼ é€’å‚æ•°çš„è§‚å¯Ÿè€…å®ä¾‹\r\n\r\n```js\r\nconst Event = new (class Watch {\r\n  constructor() {\r\n    // æ¶ˆæ¯é˜Ÿåˆ—\r\n    this.list = {};\r\n  }\r\n  // è®¢é˜…\r\n  subscribe(key, fn) {\r\n    if (!this.list[key]) {\r\n      // é¿å…é‡å¤\r\n      this.list[key] = new Set();\r\n    }\r\n    this.list[key].add(fn);\r\n  }\r\n  // è§¦å‘\r\n  trigger(key, ...args) {\r\n    const v = this.list[key];\r\n    if (!v) {\r\n      return;\r\n    }\r\n    v.forEach((f) => f.apply(this, args), this);\r\n  }\r\n  // åˆ é™¤ï¼Œkeyæ˜¯å¿…é¡»çš„\r\n  remove(key, fn) {\r\n    const v = this.list[key];\r\n    if (!v) {\r\n      return false;\r\n    }\r\n    if (v.has(fn)) {\r\n      return v.delete(fn);\r\n    }\r\n    // clearæ²¡æœ‰è¿”å›å€¼ï¼Œè¿™é‡Œè¿”å›ä¸€ä¸ªtrue\r\n    return v.clear() || true;\r\n  }\r\n})();\r\nEvent.subscribe('abc', function (a) {\r\n  console.log(a); // x\r\n});\r\nEvent.trigger('abc', 'x');\r\n```\r\n\r\nä¸Šé¢å°±å®ç°äº†ç®€å•çš„è§‚å¯Ÿè€…æ¨¡å¼ï¼Œä¸è¿‡å¯ä»¥è§‚å¯Ÿä¸Šé¢ä»£ç å¯ä»¥å‘ç°è§‚å¯Ÿè€…è¿è¡Œçš„æœºåˆ¶æ˜¯*å…ˆè®¢é˜…åå‘å¸ƒ*ï¼Œæœ‰æ²¡æœ‰åŠæ³•ç±»ä¼¼äº QQ æ¶ˆæ¯ä¸€æ ·ï¼Œå¯ä»¥æ¥æ”¶åˆ°ç¦»çº¿æ¶ˆæ¯ï¼Œå½“ç„¶è¿™ä¸ªç¦»çº¿æ¶ˆæ¯åªèƒ½æ¥æ”¶ä¸€æ¬¡ã€‚\r\n\r\n## æ”¯æŒå…ˆå‘å¸ƒåè®¢é˜…\r\n\r\nå®ç°çš„æ€è·¯å¾ˆç®€å•ï¼Œå°±æ˜¯é€šè¿‡ä¸€ä¸ªç¦»çº¿æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå‘å¸ƒçš„æ—¶å€™åˆ¤æ–­è¿™ä¸ªç¦»çº¿æ¶ˆæ¯é˜Ÿåˆ—å­˜åœ¨ä¹ˆï¼Œå¦‚æœå­˜åœ¨ï¼Œå°†æ¶ˆæ¯å­˜æ”¾åœ¨ç¦»çº¿æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå½“è®¢é˜…çš„æ—¶å€™å¦‚æœå‘ç°æœ‰ç¦»çº¿æ¶ˆæ¯é˜Ÿåˆ—å°±æ‰§è¡Œä¸€æ¬¡ï¼Œä¹‹åæ¸…ç©º\r\n\r\n```js\r\nconst Event = new (class Watch {\r\n  constructor() {\r\n    // æ¶ˆæ¯é˜Ÿåˆ—\r\n    this.list = {};\r\n    this.offLine = new Set();\r\n  }\r\n  // è®¢é˜…\r\n  subscribe(key, fn) {\r\n    if (!this.list[key]) {\r\n      // é¿å…é‡å¤\r\n      this.list[key] = new Set();\r\n    }\r\n    this.list[key].add(fn);\r\n    if (this.offLine) {\r\n      this.offLine.forEach((f) => f(), this);\r\n    }\r\n    this.offLine = null;\r\n  }\r\n  // è§¦å‘\r\n  trigger(key, ...args) {\r\n    // å…³é”®ä»£ç \r\n    const fn = () => {\r\n      const v = this.list[key];\r\n      if (!v) {\r\n        return;\r\n      }\r\n      v.forEach((f) => f.apply(this, args), this);\r\n    };\r\n    if (this.offLine) {\r\n      this.offLine.add(fn);\r\n    }\r\n    fn();\r\n  }\r\n  // åˆ é™¤ï¼Œkeyæ˜¯å¿…é¡»çš„\r\n  remove(key, fn) {\r\n    const v = this.list[key];\r\n    if (!v) {\r\n      return false;\r\n    }\r\n    if (v.has(fn)) {\r\n      return v.delete(fn);\r\n    }\r\n    // clearæ²¡æœ‰è¿”å›å€¼ï¼Œè¿™é‡Œè¿”å›ä¸€ä¸ªtrue\r\n    return v.clear() || true;\r\n  }\r\n})();\r\nEvent.trigger('abc', 'x');\r\nEvent.subscribe('abc', function (a) {\r\n  console.log(a); // x\r\n});\r\n```\r\n\r\næ’’èŠ±ï¼Œä¸€ä¸ªæ”¯æŒå–æ¶ˆå’Œå…ˆå‘å¸ƒåè®¢é˜…çš„è§‚å¯Ÿè€…æ¨¡å¼å·²ç»å®ç°äº†ï¼Œä¸è¿‡è¿˜æ˜¯æœ‰å¾…ä¼˜åŒ–çš„åœ°æ–¹ï¼Œæ¯”å¦‚å‘½åï¼Œæˆ‘ä»¬èƒ½ä¸èƒ½é€šè¿‡`Event.created('zhangsan').trigger`çš„å½¢å¼æ¥è°ƒç”¨å‘¢ï¼Ÿ\r\n\r\n## å‘½å\r\n\r\nåŠ¨æ‰‹å†™ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆç¼•æ¸…ä¸€ä¸‹å¤´ç»ª\r\n\r\n- å‘½åæ˜¯å¦å¿…é¡»ï¼Œèƒ½ä¸èƒ½ä¸é€šè¿‡`created`å…ˆè°ƒç”¨ï¼Œæ¯”å¦‚ç›´æ¥å°±æ˜¯`Event.trigger`å‘å¸ƒä¹‹åå†è®¢é˜…\r\n\r\nokï¼Œä¸‹é¢å°±æ˜¯é’ˆå¯¹ä¸Šé¢é—®é¢˜å®ç°\r\n\r\n```js\r\n// å®šä¹‰ä¸€ä¸ªåŸºç¡€ç±»ï¼Œè¿™ä¸ªç±»æ˜¯å®ç°çš„æ ¸å¿ƒå±‚\r\nclass Basics {\r\n  _obj = {};\r\n  _default = 'default';\r\n  _created(name = this._default) {\r\n    // å®šä¹‰æ¶ˆæ¯é˜Ÿåˆ—å’Œç¦»çº¿æ¶ˆæ¯é˜Ÿåˆ—\r\n    const list = {};\r\n    let offLine = new Set();\r\n    const then = this;\r\n    const obj = {\r\n      // è§¦å‘ï¼Œå¦‚æœç¬¬ä¸€æ¬¡è§¦å‘å°±æ·»åŠ åˆ°ç¦»çº¿é˜Ÿåˆ—ä¸­\r\n      trigger(key, ...rest) {\r\n        const fn = () => {\r\n          const arr = [list, key, ...rest];\r\n          return then._trigger.apply(then, arr);\r\n        };\r\n        if (offLine) {\r\n          offLine.add(fn);\r\n        }\r\n        return fn();\r\n      },\r\n      // æ·»åŠ è®¢é˜…è€…åŒæ—¶æ‰§è¡Œç¦»çº¿é˜Ÿåˆ—\r\n      subscribe(key, fn) {\r\n        then._subscribe(...[list, key, fn]);\r\n        if (offLine) {\r\n          offLine.forEach((f) => f());\r\n        }\r\n        offLine = null;\r\n      },\r\n      // åˆ é™¤ï¼Œkeyæ˜¯å¿…é¡»çš„\r\n      remove(key, fn) {\r\n        const v = this.list[key];\r\n        if (!v) {\r\n          return false;\r\n        }\r\n        if (v.has(fn)) {\r\n          return v.delete(fn);\r\n        }\r\n        // clearæ²¡æœ‰è¿”å›å€¼ï¼Œè¿™é‡Œè¿”å›ä¸€ä¸ªtrue\r\n        return v.clear() || true;\r\n      },\r\n    };\r\n    // åˆ¤æ–­å‘½åæ¥å†³å®šè¿”å›\r\n    return name ? (this._obj[name] ? this._obj[name] : (this._obj[name] = obj)) : obj;\r\n  }\r\n  // è§¦å‘\r\n  _trigger(l, k, ...args) {\r\n    const v = l[k];\r\n    if (!v || !v.size) {\r\n      return;\r\n    }\r\n    return Array.from(v, (f) => f.apply(this, args), this);\r\n  }\r\n  _subscribe(list, key, fn) {\r\n    if (!list[key]) {\r\n      list[key] = new Set();\r\n    }\r\n    list[key].add(fn);\r\n  }\r\n}\r\n// è¿™ä¸ªæ˜¯å®ç°ç±»\r\nclass Watch extends Basics {\r\n  constructor() {\r\n    // å¿…é¡»ï¼Œes6è§„å®š\r\n    super();\r\n    this.created = super._created;\r\n  }\r\n  trigger(key, ...rest) {\r\n    const v = this.created();\r\n    v.trigger(key, ...rest);\r\n  }\r\n  subscribe(key, fn) {\r\n    const v = this.created();\r\n    v.subscribe(key, fn);\r\n  }\r\n  remove(key, fn) {\r\n    const v = this.created();\r\n    v.remove(key, fn);\r\n  }\r\n}\r\nconst Event = new Watch();\r\nEvent.trigger('abc');\r\nEvent.subscribe('abc', function () {\r\n  console.log(123);\r\n});\r\nEvent.created('zhangsan').subscribe('abc', function (c) {\r\n  console.log(c);\r\n});\r\nEvent.created('zhangsan').trigger('abc', 456);\r\n```\r\n\r\nåœ¨å®é™…ä¸­æˆ‘ä»¬ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼çš„ä¾‹å­ä¹Ÿæœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ä¸€ä¸ªç½‘ç«™ï¼Œåˆ†ä¸ºå¯¼èˆªå’Œä¾§è¾¹ï¼Œå½“ç”¨æˆ·ä¿¡æ¯æ›´æ–°çš„æ—¶å€™å±•ç¤ºéƒ¨åˆ†éœ€è¦æ›´æ¢å°±å¯ä»¥ç”¨åˆ°ï¼Œè¿˜æœ‰æˆ‘ä»¬ç”¨çš„æ¡†æ¶ï¼Œæ¯”å¦‚`vueã€React`ç­‰\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/20/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/20/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        },
        {
          "url": "https://api.github.com/repos/bosens-China/blog/issues/21",
          "repository_url": "https://api.github.com/repos/bosens-China/blog",
          "labels_url": "https://api.github.com/repos/bosens-China/blog/issues/21/labels{/name}",
          "comments_url": "https://api.github.com/repos/bosens-China/blog/issues/21/comments",
          "events_url": "https://api.github.com/repos/bosens-China/blog/issues/21/events",
          "html_url": "https://github.com/bosens-China/blog/issues/21",
          "id": 482752452,
          "node_id": "MDU6SXNzdWU0ODI3NTI0NTI=",
          "number": 21,
          "title": "ä»£ç†æ¨¡å¼",
          "user": {
            "login": "bosens-China",
            "id": 39508895,
            "node_id": "MDQ6VXNlcjM5NTA4ODk1",
            "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bosens-China",
            "html_url": "https://github.com/bosens-China",
            "followers_url": "https://api.github.com/users/bosens-China/followers",
            "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
            "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
            "organizations_url": "https://api.github.com/users/bosens-China/orgs",
            "repos_url": "https://api.github.com/users/bosens-China/repos",
            "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
            "received_events_url": "https://api.github.com/users/bosens-China/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1740561541,
              "node_id": "MDU6TGFiZWwxNzQwNTYxNTQx",
              "url": "https://api.github.com/repos/bosens-China/blog/labels/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F",
              "name": "è®¾è®¡æ¨¡å¼",
              "color": "d1a540",
              "default": false,
              "description": "è®¾è®¡æ¨¡å¼åœ¨JavaScriptçš„å®ç°"
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2019-08-20T09:37:17Z",
          "updated_at": "2021-12-21T09:41:37Z",
          "closed_at": null,
          "author_association": "OWNER",
          "active_lock_reason": null,
          "body": "## å‰è¨€\r\n\r\nä»£ç†æ¨¡å¼æ˜¯ä¸ºä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ä¸ªä»£ç”¨å“æˆ–å ä½ç¬¦ï¼Œä»¥ä¾¿æ§åˆ¶å¯¹å®ƒçš„è®¿é—®ã€‚\r\nä¾‹å¦‚ï¼š\r\n![1](https://user-images.githubusercontent.com/39508895/63336089-23272700-c371-11e9-8bf0-f31c74e016b6.jpg)\r\n\r\nä¸‹é¢å°±ä»‹ç»æœ€å¸¸ç”¨çš„å‡ ç§åœºæ™¯\r\n\r\n## ä¿æŠ¤ä»£ç†\r\n\r\nä¾‹å¦‚ä½œä¸ºå­©å­æˆ‘ä»¬æ€»å¸Œæœ›ä»–å¥åº·æˆé•¿ï¼Œåœ¨æˆé•¿è·¯ä¸Šé‡åˆ°çš„çƒ¦æ¼ä¼šè¢«å®¶é•¿è§£å†³ï¼Œè¿™æ ·æ¥çœ‹å…¶å®å°±æ˜¯ä¿æŠ¤ä»£ç†ï¼Œä¸‹é¢ç”¨ä¸€æ®µä¼ªä»£ç æ¥å®ç°ã€‚\r\n\r\n```js\r\nfunction Children() {\r\n  this.knowledge = [];\r\n}\r\nChildren.prototype.Study = function(content) {\r\n  // ...å­¦ä¹ ï¼Œå¢åŠ çŸ¥è¯†\r\n  this.knowledge.push(content);\r\n};\r\nvar Parent = (function() {\r\n  var small = new Children();\r\n  return {\r\n    knowledge: function(content) {\r\n      if (content === \"bad\") {\r\n        // åçš„ï¼Œè¿‡æ»¤æ‰\r\n      } else {\r\n        small.Study(content);\r\n      }\r\n    }\r\n  };\r\n})();\r\n```\r\n\r\nä¸Šé¢ç”¨ä¼ªä»£ç çš„å½¢å¼æ¥å®ç°äº†ä¸€ä¸ªä¿æŠ¤ä¾‹å­ï¼Œä¸è¿‡ä½ å¯èƒ½ä¼šå›°æƒ‘ï¼Œè¿™æ ·ä¸æ˜¯å¤šæ­¤ä¸€ä¸¾ä¹ˆï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥åœ¨`Children`å†…éƒ¨å®ç°ï¼Œä¸è¿‡è¿™æ ·åš\r\n\r\n1. å¢åŠ äº†ç¨‹åºè€¦åˆåº¦ï¼Œå¦‚æœæƒ³è¦è¿‡æ»¤æ›´å¤šï¼Œæˆ–è€…æŸä¸€å¤©ä¸è¿‡æ»¤äº†ï¼Œè¿˜è¦æ›´æ”¹ä»£ç \r\n2. è¿èƒŒäº†å•ä¸€åŸåˆ™ï¼Œå¯¹äºä»£ç çš„é˜…è¯»å’Œç»´æŠ¤ï¼Œé€ æˆäº†æ›´å¤šçš„æˆæœ¬\r\n\r\n## ç¼“å­˜ä»£ç†\r\n\r\nç¼“å­˜ä»£ç†æ˜¯å¾ˆå®ç”¨çš„ä¸€ä¸ªä¾‹å­ï¼Œä¾‹å¦‚ä¸€ä¸ª`é˜¶ä¹˜å‡½æ•°`ï¼Œè®¡ç®— n çš„é˜¶ä¹˜ï¼Œæœ€å¤šéœ€è¦ä¿å­˜ n ä¸ªè°ƒç”¨è®°å½•ï¼Œæˆ‘ä»¬å¯èƒ½è¿™æ ·å†™\r\n\r\n```js\r\nfunction factorial(n) {\r\n  if (n === 1) return 1;\r\n  return n * factorial(n - 1);\r\n}\r\nfactorial(5); // 120\r\n```\r\n\r\nä¸è¿‡å¦‚æœé‡å¤è®¡ç®— 5 æˆ–è€… 10ï¼Œå¾ˆæ˜æ˜¾é€ æˆäº†å¤šæ¬¡æµªè´¹ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨ä»£ç†ï¼ŒæŠŠç»“æœç¼“å­˜ä¸‹æ¥ï¼Œå¦‚æœå­˜åœ¨å°±ç›´æ¥è¿”å›ã€‚\r\n\r\n```js\r\nfunction next(n, total) {\r\n  if (n === 1) return 1;\r\n  return n * factorial(n - 1);\r\n}\r\nvar factorial = (function() {\r\n  var obj = {};\r\n  return function(v) {\r\n    if (obj[v]) {\r\n      return obj[v];\r\n    }\r\n    obj[v] = next(v);\r\n    return obj[v];\r\n  };\r\n})();\r\nfactorial(5); // 120\r\nfactorial(5); // 120\r\n```\r\n\r\nä¸Šé¢å°±å°†ç»“æœç¼“å­˜äº†ä¸‹æ¥ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥å¼•ç”¨åœ¨å¼‚æ­¥è¯·æ±‚ä¸­å¯ä»¥èŠ‚çœåŠ è½½çš„æ—¶é—´ã€‚\r\n\r\n## åº”ç”¨åœºæ™¯\r\n\r\nä¸Šé¢ç®€å•ä»‹ç»äº†ä¸¤ç§æ¨¡å¼ï¼Œå®é™…ä¸Šè¿˜æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚è™šæ‹Ÿä»£ç†ã€è¿œç¨‹ä»£ç†ã€é˜²ç«å¢™ä»£ç†ç­‰ï¼Œä¸è¿‡è¿™é‡Œä¸åšä»‹ç»äº†ï¼Œä¸‹é¢çœ‹çœ‹ä½¿ç”¨åœºæ™¯ã€‚\r\n\r\n### jquery\r\n\r\n`jquery`åŸºäºé“¾å¼è°ƒç”¨ï¼Œæ¯”å¦‚`$('.a').html('').text('')`ï¼Œä¸è¿‡ä½ ä¼šä¸ä¼šå¾ˆå¥½å¥‡ï¼Œ`$()`è°ƒç”¨çš„æ—¶å€™å®ƒæ˜¯æ€ä¹ˆè®°å½•è¿™ä¸ªå€¼çš„å‘¢ï¼Œæ¯æ¬¡è°ƒç”¨`$()`å­˜å‚¨çš„ dom éƒ½ä¸ç›¸åŒï¼Œå®é™…ä¸Šå®ƒå°±æ˜¯å€Ÿç”¨äº†ä»£ç†æ¨¡å¼ï¼Œè¿™é‡Œç›´æ¥è´´ä»£ç äº†\r\n\r\n```js\r\nfunction Jquery(dom) {\r\n  this.dom = dom;\r\n}\r\n// ä»£ç†è€…\r\nfunction $(dom) {\r\n  return new Jquery(dom);\r\n}\r\n$.prototype = Jquery.prototype = {\r\n  // åªåšæ¼”ç¤ºï¼Œä¸æ¶‰åŠå…·ä½“ä»£ç \r\n  html() {\r\n    return this;\r\n  },\r\n  text() {\r\n    return this;\r\n  }\r\n};\r\n$(\".a\")\r\n  .html(\"\")\r\n  .text(\"\");\r\n```\r\n\r\n### vue\r\n\r\næˆ‘ä»¬åœ¨ä½¿ç”¨ vue çš„æ—¶å€™ç»™å®šäº†é…ç½®é¡¹`data`ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œé¢çš„å±æ€§ä¼šè¢« vue å“åº”å¼å¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡`this.`çš„æ–¹å¼æ¥ç®€å•è®¿é—®ï¼Œä¹Ÿæ˜¯ç”¨äº†ä»£ç†æ¨¡å¼ï¼Œä¸‹é¢å°±ç”¨ä¸€æ®µä¼ª vue ä»£ç æ¥è¯´æ˜\r\n\r\n```js\r\nclass Mvvm {\r\n  constructor(option = {}) {\r\n    this.$option = option;\r\n    this._data = option.data || {};\r\n    // ä»£ç†æ•°æ®\r\n    for (const name in this._data) {\r\n      Object.defineProperty(this, name, {\r\n        configurable: true,\r\n        enumerable: true,\r\n        get() {\r\n          return this._data[name];\r\n        },\r\n        set(v) {\r\n          return (this._data[name] = v);\r\n        }\r\n      });\r\n    }\r\n  }\r\n}\r\nexport default Mvvm;\r\n```\r\n\r\nå¯ä»¥å¤åˆ¶ä¸Šé¢ä»£ç ï¼Œè‡ªå·±ç®€å•è¯•ä¸‹ã€‚\r\n",
          "reactions": {
            "url": "https://api.github.com/repos/bosens-China/blog/issues/21/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "timeline_url": "https://api.github.com/repos/bosens-China/blog/issues/21/timeline",
          "performed_via_github_app": null,
          "state_reason": null
        }
      ]
    ]
  ],
  "user": {
    "login": "bosens-China",
    "id": 39508895,
    "node_id": "MDQ6VXNlcjM5NTA4ODk1",
    "avatar_url": "https://avatars.githubusercontent.com/u/39508895?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bosens-China",
    "html_url": "https://github.com/bosens-China",
    "followers_url": "https://api.github.com/users/bosens-China/followers",
    "following_url": "https://api.github.com/users/bosens-China/following{/other_user}",
    "gists_url": "https://api.github.com/users/bosens-China/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bosens-China/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bosens-China/subscriptions",
    "organizations_url": "https://api.github.com/users/bosens-China/orgs",
    "repos_url": "https://api.github.com/users/bosens-China/repos",
    "events_url": "https://api.github.com/users/bosens-China/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bosens-China/received_events",
    "type": "User",
    "site_admin": false,
    "name": "yliu",
    "company": null,
    "blog": "http://yangliu.pub/",
    "location": "china",
    "email": null,
    "hireable": true,
    "bio": "æ—¶æ¥å¤©åœ°çš†åŒåŠ›ï¼Œè¿å»è‹±é›„ä¸è‡ªç”±",
    "twitter_username": null,
    "public_repos": 19,
    "public_gists": 0,
    "followers": 10,
    "following": 3,
    "created_at": "2018-05-22T03:17:00Z",
    "updated_at": "2023-11-10T10:46:34Z",
    "private_gists": 2,
    "total_private_repos": 0,
    "owned_private_repos": 0,
    "disk_usage": 12354,
    "collaborators": 0,
    "two_factor_authentication": true,
    "plan": {
      "name": "free",
      "space": 976562499,
      "collaborators": 0,
      "private_repos": 10000
    },
    "GITHUB_REPOSITORY": "bosens-China/blog"
  }
}
